(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{"2NsA":function(e,t,a){"use strict";a.d(t,"a",function(){return _});var n=a("dtw8"),r=a("1ZXz"),i=a("TdMD"),s=a.n(i),o=a("fvjX"),l=a("L3Ur");function c(e){return Object(o.e)(e,Object(o.d)(Object(o.a)(s.a,Object(r.createLogger)()),window.devToolsExtension?window.devToolsExtension():function(e){return e}))}function u(e){return Object(o.e)(e,Object(o.a)(s.a))}function _(e,t){var a=u(e),r=t&&"hash"===t?n.g:n.f;return{store:a,history:Object(l.syncHistoryWithStore)(r,a)}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"configureStoreDev","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/utils/reduxUtils.js"),__REACT_HOT_LOADER__.register(u,"configureStoreProd","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/utils/reduxUtils.js"),__REACT_HOT_LOADER__.register(_,"getStore","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/utils/reduxUtils.js"))},"3J6H":function(e,t,a){},"6EK8":function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a("QbLZ"),r=a.n(n),i=(a("LvDl"),a("CMun")),s={id:0,dtuicUserId:0,userName:"未登录",isRoot:!1};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case i.a.GET_USER:return t.data;case i.a.UPDATE_USER:return null!==t.data?r()({},e,t.data):e;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initalUser","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/main/reducers/modules/user.js"),__REACT_HOT_LOADER__.register(o,"user","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/main/reducers/modules/user.js"))},"95Qq":function(e,t,a){},EMQV:function(e,t,a){},F2FU:function(e,t,a){"use strict";var n=a("zbcj"),r=a.n(n)()(["GET_USER_LIST","GET_ALL_DICT"],{prefix:"common/"}),i=r;t.a=i;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(r,"commonActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/commonActionType.js"),__REACT_HOT_LOADER__.register(i,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/commonActionType.js"))},"FL+A":function(e,t,a){"use strict";a.d(t,"a",function(){return O});a("93XW");var n=a("d1El"),r=a.n(n),i=(a("FGdI"),a("Pbn2")),s=a.n(i),o=a("QbLZ"),l=a.n(o),c=a("jo6Y"),u=a.n(c),_=(a("tL+A"),a("QpBz")),d=a.n(_),p=a("Yz+Y"),m=a.n(p),E=a("iCc5"),h=a.n(E),T=a("V7oC"),g=a.n(T),f=a("FYw3"),y=a.n(f),R=a("mRg0"),v=a.n(R),C=a("sbe7"),A=a.n(C),O=(a("kH9T"),function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={},n.copy=function(){var e;return(e=n).__copy__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentWillUnmount",value:function(){this.removeFake()}},{key:"__copy__REACT_HOT_LOADER__",value:function(e){var t=this;this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style.left="-9999px";var a=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=a+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=e,document.body.appendChild(this.fakeElem),this.fakeElem.select(),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand("copy")}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){e?d.a.success("复制成功"):d.a.error("不支持")}},{key:"render",value:function(){var e=this.props,t=e.copyText,a=e.style,n=u()(e,["copyText","style"]);return a=l()({cursor:"pointer",fontSize:"13px"},a),A.a.createElement(r.a,{placement:"right",title:"复制"},A.a.createElement(s.a,l()({className:"copy-hover",onClick:this.copy.bind(this,t),style:a},n,{type:"copy"})))}}]),t}(C.Component));"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(O,"CopyIcon","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/main/components/copy-icon/index.js")},FdzR:function(e,t,a){},KnRw:function(e,t,a){var n={"./af":"/Tvm","./af.js":"/Tvm","./ar":"yRKQ","./ar-dz":"2Mgn","./ar-dz.js":"2Mgn","./ar-kw":"SyK9","./ar-kw.js":"SyK9","./ar-ly":"Km2t","./ar-ly.js":"Km2t","./ar-ma":"k+3Q","./ar-ma.js":"k+3Q","./ar-sa":"dbzX","./ar-sa.js":"dbzX","./ar-tn":"E7L0","./ar-tn.js":"E7L0","./ar.js":"yRKQ","./az":"marO","./az.js":"marO","./be":"c9Cq","./be.js":"c9Cq","./bg":"Rxhz","./bg.js":"Rxhz","./bm":"Zf0k","./bm.js":"Zf0k","./bn":"qbSa","./bn.js":"qbSa","./bo":"aPmz","./bo.js":"aPmz","./br":"V/F2","./br.js":"V/F2","./bs":"CToL","./bs.js":"CToL","./ca":"GuxH","./ca.js":"GuxH","./cs":"qrel","./cs.js":"qrel","./cv":"wv9F","./cv.js":"wv9F","./cy":"7JVd","./cy.js":"7JVd","./da":"PtRy","./da.js":"PtRy","./de":"xhqU","./de-at":"bJtj","./de-at.js":"bJtj","./de-ch":"fRjz","./de-ch.js":"fRjz","./de.js":"xhqU","./dv":"tEna","./dv.js":"tEna","./el":"vE8+","./el.js":"vE8+","./en-au":"aGvD","./en-au.js":"aGvD","./en-ca":"TyIU","./en-ca.js":"TyIU","./en-gb":"xbvL","./en-gb.js":"xbvL","./en-ie":"8wpQ","./en-ie.js":"8wpQ","./en-nz":"mRnY","./en-nz.js":"mRnY","./eo":"nEfC","./eo.js":"nEfC","./es":"QqXE","./es-do":"OH6n","./es-do.js":"OH6n","./es-us":"VqXm","./es-us.js":"VqXm","./es.js":"QqXE","./et":"/BjE","./et.js":"/BjE","./eu":"lS/Y","./eu.js":"lS/Y","./fa":"Xl2a","./fa.js":"Xl2a","./fi":"pKmA","./fi.js":"pKmA","./fo":"1sIW","./fo.js":"1sIW","./fr":"t+gs","./fr-ca":"ApVP","./fr-ca.js":"ApVP","./fr-ch":"mR/r","./fr-ch.js":"mR/r","./fr.js":"t+gs","./fy":"zrXP","./fy.js":"zrXP","./gd":"7WNt","./gd.js":"7WNt","./gl":"EkHg","./gl.js":"EkHg","./gom-latn":"IlNN","./gom-latn.js":"IlNN","./gu":"SIlg","./gu.js":"SIlg","./he":"RWgf","./he.js":"RWgf","./hi":"fVgC","./hi.js":"fVgC","./hr":"QeL5","./hr.js":"QeL5","./hu":"UGq4","./hu.js":"UGq4","./hy-am":"powx","./hy-am.js":"powx","./id":"+gpe","./id.js":"+gpe","./is":"3azS","./is.js":"3azS","./it":"T/vC","./it.js":"T/vC","./ja":"n/+T","./ja.js":"n/+T","./jv":"pOn/","./jv.js":"pOn/","./ka":"5BLU","./ka.js":"5BLU","./kk":"i4p7","./kk.js":"i4p7","./km":"Rdvl","./km.js":"Rdvl","./kn":"x+k7","./kn.js":"x+k7","./ko":"+Fhz","./ko.js":"+Fhz","./ky":"dDLa","./ky.js":"dDLa","./lb":"Gudj","./lb.js":"Gudj","./lo":"VShb","./lo.js":"VShb","./lt":"5eMR","./lt.js":"5eMR","./lv":"JdG9","./lv.js":"JdG9","./me":"VVnP","./me.js":"VVnP","./mi":"oQ6b","./mi.js":"oQ6b","./mk":"tXUT","./mk.js":"tXUT","./ml":"uPxb","./ml.js":"uPxb","./mr":"b8N1","./mr.js":"b8N1","./ms":"Wnnz","./ms-my":"b+tO","./ms-my.js":"b+tO","./ms.js":"Wnnz","./mt":"V6YG","./mt.js":"V6YG","./my":"rt8X","./my.js":"rt8X","./nb":"xyXD","./nb.js":"xyXD","./ne":"4vTz","./ne.js":"4vTz","./nl":"6QMr","./nl-be":"LMGY","./nl-be.js":"LMGY","./nl.js":"6QMr","./nn":"Qsvx","./nn.js":"Qsvx","./pa-in":"oA7N","./pa-in.js":"oA7N","./pl":"C/jI","./pl.js":"C/jI","./pt":"V7OV","./pt-br":"b3iz","./pt-br.js":"b3iz","./pt.js":"V7OV","./ro":"TwjK","./ro.js":"TwjK","./ru":"YJSy","./ru.js":"YJSy","./sd":"4xdR","./sd.js":"4xdR","./se":"j5S3","./se.js":"j5S3","./si":"Am5L","./si.js":"Am5L","./sk":"sSmc","./sk.js":"sSmc","./sl":"9iY4","./sl.js":"9iY4","./sq":"cnMZ","./sq.js":"cnMZ","./sr":"ss7R","./sr-cyrl":"tGLK","./sr-cyrl.js":"tGLK","./sr.js":"ss7R","./ss":"mYhl","./ss.js":"mYhl","./sv":"IGtO","./sv.js":"IGtO","./sw":"p49z","./sw.js":"p49z","./ta":"VVil","./ta.js":"VVil","./te":"YQaq","./te.js":"YQaq","./tet":"2u18","./tet.js":"2u18","./th":"gJLt","./th.js":"gJLt","./tl-ph":"ogwM","./tl-ph.js":"ogwM","./tlh":"0bHV","./tlh.js":"0bHV","./tr":"BYDG","./tr.js":"BYDG","./tzl":"IUMd","./tzl.js":"IUMd","./tzm":"94jC","./tzm-latn":"Mgge","./tzm-latn.js":"Mgge","./tzm.js":"94jC","./uk":"NrFT","./uk.js":"NrFT","./ur":"U58I","./ur.js":"U58I","./uz":"orAx","./uz-latn":"jCvl","./uz-latn.js":"jCvl","./uz.js":"orAx","./vi":"t2dB","./vi.js":"t2dB","./x-pseudo":"XFnJ","./x-pseudo.js":"XFnJ","./yo":"qKGQ","./yo.js":"qKGQ","./zh-cn":"3O3J","./zh-cn.js":"3O3J","./zh-hk":"Fu0X","./zh-hk.js":"Fu0X","./zh-tw":"2Pdx","./zh-tw.js":"2Pdx"};function r(e){var t=i(e);return a(t)}function i(e){var t=n[e];if(!(t+1)){var a=new Error('Cannot find module "'+e+'".');throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id="KnRw"},MJ9B:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["CHANGE_LOADING","GET_TOP_RECORD","GET_ALARM_SUM","GET_ALARM_TREND","GET_USAGE"],{prefix:"dashBoard/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dashBoardActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/dashBoardActionType.js")},SXSo:function(e,t,a){},THQc:function(e,t,a){},TmhF:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("udPp");function r(e){return{type:n.a.UPDATE_APP,data:e}}"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"updateApp","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/main/actions/app.js")},WaWy:function(e,t,a){"use strict";a("FGdI");var n=a("Pbn2"),r=a.n(n),i=a("Yz+Y"),s=a.n(i),o=a("iCc5"),l=a.n(o),c=a("V7oC"),u=a.n(c),_=a("FYw3"),d=a.n(_),p=a("mRg0"),m=a.n(p),E=a("17x9"),h=a.n(E),T=a("LvDl"),g=a("sbe7"),f=a.n(g),y=(a("THQc"),h.a.oneOfType([h.a.string,h.a.number])),R={children:h.a.node,left:y,width:y,visible:h.a.bool},v=function(e){function t(e){return l()(this,t),d()(this,(t.__proto__||s()(t)).call(this,e))}return m()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.visible,n=e.style,i=e.className,s=e.onClose,o="slide-pane",l={top:0,transform:a?"translate3d(0%, 0, 0)":"translate3d(150%, 0, 0)"};return i&&(o=o+" "+i),n&&(l=Object(T.assign)(l,n)),f.a.createElement("div",{className:o,style:l},f.a.createElement("div",{className:"slide-pane-conent"},t),f.a.createElement("span",{className:"slide-pane-toggle",onClick:s},f.a.createElement(r.a,{type:"double-right"})))}}]),t}(g.Component);v.propTypes=R;var C=v;t.a=C;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(y,"strOrNum","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(R,"propType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(v,"SlidePane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(C,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/slidePane/index.js"))},WyGn:function(e,t,a){},YXul:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["CHANGE_LOADING","GET_LIST","GET_CHECK_DETAIL","CHANGE_PARAMS","GET_SOURCE_PART","RESET_SOURCE_PART"],{prefix:"dataCheck/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dataCheckActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/dataCheckActionType.js")},iEKX:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a("QbLZ"),r=a.n(n),i=a("sbe7"),s=a.n(i);function o(e){var t=e.style,a=r()({},{textIndent:"5px",backgroundColor:"transparent",backgroundImage:"none",width:"100%",border:"none"},t);return s.a.createElement("textarea",r()({},e,{style:a}))}"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"TableCell","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/tableCell/index.js")},j2qn:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["CHANGE_LOADING","GET_TASK_LIST","GET_TASK_DETAIL","GET_TASK_TABLE_REPORT","GET_TASK_ALARM_NUM"],{prefix:"taskQuery/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"taskQueryActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/taskQueryActionType.js")},j7hF:function(e,t,a){"use strict";a.r(t);var n={};a.d(n,"dataFilterDoc",function(){return Rr}),a.d(n,"switchKey",function(){return vr}),a.d(n,"hdfsPath",function(){return Cr}),a.d(n,"jobSpeedLimit",function(){return Ar}),a.d(n,"jobConcurrence",function(){return Or}),a.d(n,"errorCount",function(){return Dr}),a.d(n,"hdfsConfig",function(){return br}),a.d(n,"rdbConfig",function(){return kr}),a.d(n,"hBaseConfig",function(){return Sr}),a.d(n,"recordDirtyData",function(){return Lr}),a.d(n,"errorPercentConfig",function(){return wr});var r,i,s,o=a("sbe7"),l=a.n(o),c=a("i8i4"),u=a.n(c),_=a("0cfB"),d=a("2NsA"),p=a("Yz+Y"),m=a.n(p),E=a("iCc5"),h=a.n(E),T=a("V7oC"),g=a.n(T),f=a("FYw3"),y=a.n(f),R=a("mRg0"),v=a.n(R),C=a("dtw8"),A=a("/MKj"),O=(a("3J6H"),a("EMQV"),a("FdzR"),a("95Qq"),a("t/36"),a("f7r7"),a("5012"),a("s9ml"),a("XLg0")),D=a("2BCK"),b=a("vFRS"),k=a("NX2S"),S=a("UopC"),L=a("X9CO"),w=a("dVc0"),x=a("2Ul7"),H=a("AVFO"),P=a("17x9"),N=a.n(P),I=a("7Qib"),j=a("PVY6"),U=a("QbLZ"),M=a.n(U),F=a("pLPX"),Q=Object(A.b)(function(e){return{user:e.user,apps:e.apps,routing:e.routing,app:e.app}})(r=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.state={},a}return v()(t,e),g()(t,[{key:"render",value:function(){var e=this.props,t=(e.user,e.apps,"/dataQuality.html#"),a=[{id:"dq/overview",name:"概览",link:t+"/dq/overview",enable:!0},{id:"dq/taskQuery",name:"任务查询",link:t+"/dq/taskQuery",enable:!0},{id:"dq/rule",name:"规则配置",link:t+"/dq/rule",enable:!0},{id:"dq/dataCheck",name:"逐行校验",link:t+"/dq/dataCheck",enable:!0},{id:"dq/dataSource",name:"数据源管理",link:t+"/dq/dataSource",enable:!0}],n=l.a.createElement("span",null,l.a.createElement("img",{style:{height:"36px",width:"36px",marginTop:"5px"},alt:"logo",src:"/public/dataQuality/img/logo.svg"}),l.a.createElement("span",{style:{fontSize:"14px",color:"#ffffff",position:"absolute",left:"80px",top:0}},"DTinsight.Valid"));return l.a.createElement(F.c,M()({logo:n,menuItems:a},this.props))}}]),t}(o.Component))||r,V=Q,G=V,z=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Q,"Header","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/layout/header.js"),__REACT_HOT_LOADER__.register(V,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/layout/header.js")),a("zmYW"),a("DtFj")),q=a.n(z),Y=(a("mN36"),a("N9UN")),K=a.n(Y),B=(a("hr7U"),a("9xET")),W=a.n(B),J=(a("fv9D"),a("ZPTe")),X=a.n(J),Z=a("/f1G"),$=a.n(Z),ee=a("GQeE"),te=a.n(ee),ae=a("wd/R"),ne=a.n(ae),re=a("zXZS"),ie=a("YEIV"),se=a.n(ie),oe={WAIT_RUN:0,RUNNING:1,FAIL:2,PASS:3,UNPASS:4},le={EMAIL:"1",SMS:"2",DINGDING:"4"},ce={LOOP:0,HAND:1},ue=(i={},se()(i,ce.LOOP,"周期"),se()(i,ce.HAND,"手动"),i),_e={MYSQL:1,ORACLE:2,SQLSERVER:3,HDFS:6,HIVE:7,HBASE:8,FTP:9,MAXCOMPUTE:10},de={INITIAL:0,RUNNING:1,SUCCESS:2,FAIL:3,PASS:4,UNPASS:5,EXPIRED:6},pe=[{text:"等待运行",value:"0"},{text:"运行中",value:"1"},{text:"运行成功",value:"2"},{text:"运行失败",value:"3"},{text:"校验通过",value:"4"},{text:"校验未通过",value:"5"},{text:"校验结果失效",value:"6"}],me=["未知类型","MySQL","Oracle","SQLServer","PostgreSQL","RDBMS","HDFS","Spark","HBase","FTP","MaxCompute"],Ee=[{text:"MySQL",value:1},{text:"Oracle",value:2},{text:"SQLServer",value:3},{text:"Spark",value:7},{text:"MaxCompute",value:10}],he=["未知类型","小时","天","周","月","手动触发"],Te=[{text:">",value:">"},{text:">=",value:">="},{text:"=",value:"="},{text:"<",value:"<"},{text:"<=",value:"<="},{text:"!=",value:"!="}],ge=[{text:">",value:">"},{text:">=",value:">="},{text:"=",value:"="},{text:"<",value:"<"},{text:"<=",value:"<="}],fe=[{text:"今日告警数",value:"1"},{text:"最近7天告警数",value:"7"},{text:"最近30天告警数",value:"30"}],ye=[{text:"等待运行",value:oe.WAIT_RUN},{text:"运行中",value:oe.RUNNING},{text:"运行失败",value:oe.FAIL},{text:"校验通过",value:oe.PASS},{text:"校验未通过",value:oe.UNPASS}],Re={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},ve={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:10}}},Ce={wrapperCol:{xs:{span:24,offset:0},sm:{span:14,offset:6}}},Ae={labelCol:{span:0},wrapperCol:{span:24}},Oe={title:{text:"堆叠区域图",textStyle:{fontSize:12},textAlign:"left"},tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},color:["#2491F7","#7460EF","#26DAD2","#79E079","#7A64F3","#FFDC53","#9a64fb"],legend:{data:["邮件营销","联盟广告","视频广告","直接访问","搜索引擎"]},toolbox:{feature:{saveAsImage:{show:!1}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[],axisTick:{show:!0},axisLine:{lineStyle:{color:"#DDDDDD"}},axisLabel:{textStyle:{color:"#666666"}},nameTextStyle:{color:"#666666"},splitLine:{color:"#666666"}}],yAxis:[{type:"value",axisLabel:{formatter:"{value} 个",textStyle:{color:"#666666",baseline:"bottom"}},nameTextStyle:{color:"#666666"},nameLocation:"end",nameGap:20,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#DDDDDD",type:"dashed"}}}],series:[]},De=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(oe,"TASK_STATUS","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(le,"ALARM_TYPE","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ce,"TRIG_MODE","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ue,"TRIG_MODE_TEXT","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(_e,"DATA_SOURCE","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(de,"CHECK_STATUS","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(pe,"CHECK_STATUS_CN","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(me,"dataSourceTypes","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Ee,"dataSourceFilter","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(he,"periodType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Te,"operatorSelect","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ge,"operatorSelect1","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(fe,"alarmDateFilter","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ye,"taskStatusFilter","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Re,"formItemLayout","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ve,"halfFormItemLayout","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Ce,"tailFormItemLayout","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Ae,"rowFormItemLayout","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Oe,"lineAreaChartOptions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/index.js")),a("MJ9B")),be=a("W95b"),ke=a("hPfy"),Se={getTopRecord:function(e){return be.a.post(ke.a.GET_TOP_RECORD,e)},getAlarmSum:function(e){return be.a.post(ke.a.GET_ALARM_SUM,e)},getAlarmTrend:function(e){return be.a.post(ke.a.GET_ALARM_TREND,e)},getUsage:function(e){return be.a.post(ke.a.GET_DASHBOARD_USAGE,e)}},Le=Se,we=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Se,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/dashBoard.js"),{getTopRecord:function(e){return function(t){t({type:De.a.CHANGE_LOADING}),Le.getTopRecord(e).then(function(e){1===e.code&&t({type:De.a.GET_TOP_RECORD,payload:e.data}),t({type:De.a.CHANGE_LOADING})})}},getAlarmSum:function(e){return function(t){Le.getAlarmSum(e).then(function(e){1===e.code&&t({type:De.a.GET_ALARM_SUM,payload:e.data})})}},getAlarmTrend:function(e){return function(t){Le.getAlarmTrend(e).then(function(e){1===e.code&&t({type:De.a.GET_ALARM_TREND,payload:e.data})})}},getUsage:function(e){return function(t){Le.getUsage(e).then(function(e){1===e.code&&t({type:De.a.GET_USAGE,payload:e.data})})}}}),xe=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(we,"dashBoardActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/dashBoard/index.js"),a("ProS"));a("75ce"),a("AH3D"),a("Ynxi");var He=function(e){return{dashBoard:e.dashBoard}},Pe=function(e){return{getTopRecord:function(t){e(we.getTopRecord(t))},getAlarmSum:function(t){e(we.getAlarmSum(t))},getUsage:function(t){e(we.getUsage(t))}}},Ne=Object(A.b)(He,Pe)(s=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={currentDate:"1"},n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},n.alarmTitle=function(){var e;return(e=n).__alarmTitle__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getUsage(),this.props.getAlarmSum(),this.props.getTopRecord({date:7}),Le.getAlarmTrend().then(function(t){1===t.code&&e.initLineChart(t.data)})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"__alarmTitle__REACT_HOT_LOADER__",value:function(e){switch(e){case"1":return"今天";case"30":return"最近30天";default:return"最近7天"}}},{key:"jumpToTaskQuery",value:function(e){var t=new ne.a,a=ne()(ne()(t).subtract(e-1,"days").format("YYYY-MM-DD"));C.g.push({pathname:"/dq/taskQuery",query:{startTime:a.valueOf(),endTime:t.valueOf(),statusFilter:[oe.FAIL,oe.UNPASS].join(",")}})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this.state.currentDate;return[{title:"排名",dataIndex:"rank",key:"rank",render:function(e,t,a){return l.a.createElement("div",{className:"rank-number"},a+1)},width:"10%"},{title:"类型",dataIndex:"dataSourceName",key:"dataSourceName",width:"40%"},{title:"表名",dataIndex:"tableName",key:"tableName",render:function(e,t){return l.a.createElement(C.c,{to:"/dq/taskQuery?tb="+e+"&source="+t.dataSourceType},e)},width:"35%"},{title:"告警数",dataIndex:"countByDate",key:"countByDate",filters:fe,filteredValue:[e],filterMultiple:!1,render:function(e){return l.a.createElement("span",{style:{color:"#EF5350"}},e)},width:"15%"}]}},{key:"initLineChart",value:function(e){var t=xe.init(document.getElementById("alarm-trend")),a=M()({},Oe),n=te()(e).map(function(e){return ne()(e).format("YYYY-MM-DD")}),r=$()(e);a.title.text="",a.tooltip.axisPointer.label.formatter="{value}",a.legend.data=["告警数"],a.xAxis[0].axisLabel.formatter="{value}",a.xAxis[0].data=e&&n?n:[],a.grid={left:"3%",right:"4%",bottom:"8%",containLabel:!0},a.yAxis[0].axisLabel.formatter="{value}",a.yAxis[0].minInterval=1,a.series=[{name:"告警数",symbol:"none",type:"line",data:r}],t.setOption(a),this.setState({lineChart:t})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=t.countByDate[0]||"7";this.props.getTopRecord({date:n}),this.setState({currentDate:n})}},{key:"render",value:function(){var e=this.props.dashBoard,t=e.topRecords,a=(e.alarmTrend,e.alarmSum),n=e.usage,r=e.loading,i=this.state.currentDate,s=l.a.createElement(C.c,{to:"/dq/taskQuery"},"查看更多"),o={marginTop:20};return l.a.createElement(W.a,{style:{margin:20}},l.a.createElement(X.a,{span:12,style:{paddingRight:10}},l.a.createElement(W.a,{className:"m-card shadow m-card-small"},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,title:"告警汇总",extra:s},l.a.createElement(W.a,{className:"m-count"},l.a.createElement(X.a,{span:8},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"今日告警数"),l.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,1),className:"m-count-content font-red"},a.countToday))),l.a.createElement(X.a,{span:8},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"最近7天告警数"),l.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,7),className:"m-count-content font-red"},a.countWeek))),l.a.createElement(X.a,{span:8},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"最近30天告警数"),l.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,30),className:"m-count-content font-red"},a.countMonth)))))),l.a.createElement(W.a,{style:o,className:"m-card shadow m-card-small"},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,title:"告警趋势(最近30天)"},l.a.createElement(re.a,{onResize:this.resize},l.a.createElement("article",{id:"alarm-trend",style:{width:"100%",height:"317px"}})))),l.a.createElement(W.a,{style:o,className:"m-card shadow m-card-small"},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,title:"使用情况"},l.a.createElement(W.a,{className:"m-count"},l.a.createElement(X.a,{span:6},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"已配置表数"),l.a.createElement("span",{className:"m-count-content font-black"},n.tableCount))),l.a.createElement(X.a,{span:6},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"已配置规则数"),l.a.createElement("span",{className:"m-count-content font-black"},n.ruleCount))),l.a.createElement(X.a,{span:6},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"昨日新增表数"),l.a.createElement("span",{className:"m-count-content font-black"},n.lastTableCount))),l.a.createElement(X.a,{span:6},l.a.createElement("section",{className:"m-count-section",style:{width:100}},l.a.createElement("span",{className:"m-count-title"},"昨日新增规则数"),l.a.createElement("span",{className:"m-count-content font-black"},n.lastRuleCount))))))),l.a.createElement(X.a,{span:12,style:{paddingLeft:10}},l.a.createElement(W.a,{className:"m-card shadow m-card-small"},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,title:this.alarmTitle(i)+"告警TOP20"},l.a.createElement(q.a,{rowKey:"monitorId",className:"m-table trend-table",columns:this.initColumns(),loading:r,pagination:!1,dataSource:t,onChange:this.onTableChange})))))}}]),t}(o.Component))||s,Ie=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(He,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dashboard/index.js"),__REACT_HOT_LOADER__.register(Pe,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dashboard/index.js"),__REACT_HOT_LOADER__.register(Ne,"DashBoard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dashboard/index.js")),a("TCqc")),je=a("zbcj"),Ue=a.n(je)()(["GET_USER","UPDATE_USER","GET_NOT_PROJECT_USERS","GET_PROJECT_USERS","GET_USER_LIST"],{prefix:"user/"}),Me=Ue,Fe=Me;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ue,"userActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/userActions.js"),__REACT_HOT_LOADER__.register(Me,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/userActions.js"));function Qe(){return function(e){Ie.a.getLoginedUser().then(function(t){if(1===t.code)return e({type:Fe.GET_USER,data:t.data})})}}function Ve(e){return{type:Fe.UPDATE_USER,data:e}}function Ge(e){return function(t){Ie.a.getUserList(e).then(function(e){1===e.code&&t({type:Fe.GET_USER_LIST,data:e.data})})}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Qe,"getUser","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/user.js"),__REACT_HOT_LOADER__.register(Ve,"updateUser","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/user.js"),__REACT_HOT_LOADER__.register(Ge,"getUserList","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/user.js"));var ze,qe=a("oYF1"),Ye={getDataSources:function(e){return be.a.post(ke.a.GET_DATA_SOURCES,e)},testDSConnection:function(e){return be.a.post(ke.a.CHECK_CONNECTION,e)},addDataSource:function(e){return be.a.post(ke.a.ADD_DATA_SOURCES,e)},updateDataSource:function(e){return be.a.post(ke.a.UPDATE_DATA_SOURCES,e)},deleteDataSource:function(e){return be.a.post(ke.a.DELETE_DATA_SOURCES,e)},getDataSourcesType:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_TYPE,e)},getDataSourcesList:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_LIST,e)},getDataSourcesTable:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_TABLE,e)},getDataSourcesColumn:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_COLUMN,e)},getDataSourcesPart:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_PART,e)},getDataSourcesPreview:function(e){return be.a.post(ke.a.GET_DATA_SOURCES_PREVIEW,e)}},Ke=Ye,Be=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ye,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/dataSource.js"),{getDataSources:function(e){return function(t){t({type:qe.a.CHANGE_LOADING}),Ke.getDataSources(e).then(function(e){1===e.code&&t({type:qe.a.GET_DATA_SOURCES,payload:e.data}),t({type:qe.a.CHANGE_LOADING})})}},getDataSourcesType:function(e){return function(t){Ke.getDataSourcesType(e).then(function(e){1===e.code&&t({type:qe.a.GET_DATA_SOURCES_TYPE,payload:e.data})})}},getDataSourcesList:function(e){return function(t){Ke.getDataSourcesList(e).then(function(e){1===e.code&&t({type:qe.a.GET_DATA_SOURCES_LIST,payload:e.data})})}},getDataSourcesTable:function(e){return function(t){t({type:qe.a.CHANGE_GETTABLE_LOADING}),Ke.getDataSourcesTable(e).then(function(e){1===e.code?t({type:qe.a.GET_DATA_SOURCES_TABLE,payload:e.data}):t({type:qe.a.GET_DATA_SOURCES_TABLE,payload:[]}),t({type:qe.a.CHANGE_GETTABLE_LOADING})})}},resetDataSourcesTable:function(){return function(e){e({type:qe.a.RESET_DATA_SOURCES_TABLE})}},getDataSourcesColumn:function(e){return function(t){Ke.getDataSourcesColumn(e).then(function(e){1===e.code&&t({type:qe.a.GET_DATA_SOURCES_COLUMN,payload:e.data})})}},getDataSourcesPart:function(e){return function(t){Ke.getDataSourcesPart(e).then(function(e){1===e.code&&t({type:qe.a.GET_DATA_SOURCES_PART,payload:e.data?e.data:{}})})}},resetDataSourcesPart:function(){return function(e){e({type:qe.a.RESET_DATA_SOURCES_PART})}},getDataSourcesPreview:function(e){return function(t){Ke.getDataSourcesPreview(e).then(function(e){if(1===e.code){var a=e.data,n=a.columnList,r=a.dataList;e.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),t({type:qe.a.GET_DATA_SOURCES_PREVIEW,payload:e.data})}})}}}),We=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Be,"dataSourceActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/dataSource/index.js"),a("F2FU")),Je={getUserList:function(){return be.a.post(ke.a.DQ_GET_USER_LIST)},getAllDict:function(){return be.a.post(ke.a.DQ_GET_ALL_DICT)}},Xe=Je,Ze=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Je,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/common.js"),{getUserList:function(e){return function(t){Xe.getUserList(e).then(function(e){1===e.code&&t({type:We.a.GET_USER_LIST,payload:e.data})})}},getAllDict:function(e){return function(t){Xe.getAllDict(e).then(function(e){1===e.code&&t({type:We.a.GET_ALL_DICT,payload:e.data})})}}}),$e=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ze,"commonActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/common.js"),a("TmhF")),et={children:N.a.node},tt={children:[]},at=Object(A.b)()(ze=function(e){function t(){return h()(this,t),y()(this,(t.__proto__||m()(t)).apply(this,arguments))}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e(Qe()),e(Object($e.a)(j.k)),e(Ze.getUserList()),e(Ze.getAllDict()),e(Be.getDataSourcesType())}},{key:"render",value:function(){var e=this.props.children;return l.a.createElement("div",{className:"main header-fixed"},l.a.createElement(G,null),l.a.createElement("div",{className:"container"},e||l.a.createElement(Ne,null)))}}]),t}(o.Component))||ze;at.propTypes=et,at.defaultProps=tt;var nt=at,rt=nt,it=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(et,"propType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register(tt,"defaultPro","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register(at,"Main","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register(nt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/index.js")),a("pJsf"),a("g4D/")),st=a.n(it),ot=(a("fwXI"),a("CC+v")),lt=a.n(ot),ct=(a("93XW"),a("d1El")),ut=a.n(ct),_t=(a("FGdI"),a("Pbn2")),dt=a.n(_t),pt=(a("GBD3"),a("wXtC")),mt=a.n(pt),Et=(a("Z8Mf"),a("j7zX")),ht=a.n(Et),Tt=(a("ek7I"),a("FAat")),gt=a.n(Tt),ft=(a("cUip"),a("iJl9")),yt=a.n(ft),Rt=a("WaWy"),vt=a("LvDl"),Ct=a("btJW");function At(e){switch(e.value){case!0:return l.a.createElement("span",null,"通过");case!1:return l.a.createElement(ut.a,{title:"未通过"},l.a.createElement(dt.a,{type:"close-circle-o",style:{fontSize:16,color:"#f00"}}));default:return l.a.createElement("span",null,"--")}}function Ot(e){switch(e.value){case oe.WAIT_RUN:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"等待运行",style:{background:"#d9d9d9"}})," 等待运行");case oe.RUNNING:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"运行中",style:{background:"#2491F7"}})," 运行中");case oe.FAIL:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"运行失败",style:{background:"#EF5350"}})," 运行失败");case oe.PASS:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"校验通过",style:{background:"#00A755"}})," 校验通过");case oe.UNPASS:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"校验未通过",style:{background:"#F5A623"}})," 校验未通过");default:return l.a.createElement("span",{style:e.style},"--")}}function Dt(e){switch(e.value){case de.INITIAL:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"等待运行",style:{background:"#d9d9d9"}})," 等待运行");case de.RUNNING:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"运行中",style:{background:"#2491F7"}})," 运行中");case de.SUCCESS:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"运行成功",style:{background:"#00A755"}})," 运行成功");case de.FAIL:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"运行失败",style:{background:"#EF5350"}})," 运行失败");case de.PASS:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"校验通过",style:{background:"#00A755"}})," 校验通过");case de.UNPASS:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"校验未通过",style:{background:"#F5A623"}})," 校验未通过");case de.EXPIRED:return l.a.createElement("span",{style:e.style},l.a.createElement(Ct.a,{title:"校验结果失效",style:{background:"#F5A623"}})," 校验结果失效");default:return l.a.createElement("span",{style:e.style},"--")}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(At,"DetailCheckStatus","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/components/display/index.js"),__REACT_HOT_LOADER__.register(Ot,"TaskStatus","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/components/display/index.js"),__REACT_HOT_LOADER__.register(Dt,"DataCheckStatus","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/components/display/index.js"));var bt={getTaskList:function(e){return be.a.post(ke.a.GET_TASK_LIST,e)},getTaskDetail:function(e){return be.a.post(ke.a.GET_TASK_DETAIL,e)},getTaskTableReport:function(e){return be.a.post(ke.a.GET_TABLE_REPORT,e)},getTaskAlarmNum:function(e){return be.a.post(ke.a.GET_TASK_ALARM_NUM,e)}},kt=bt,St=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(bt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/taskQuery.js"),a("ProS"));a("75ce"),a("AH3D"),a("Ynxi"),a("laiN");var Lt=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.initRulesColumns=function(){return a.__initRulesColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onCheckReport=function(){return a.__onCheckReport__REACT_HOT_LOADER__.apply(a,arguments)},a.state={lineChart:"",visible:!1,taskDetail:[],currentRecord:{},showSnapshot:!1},a}return v()(t,e),g()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props.data,n=e.data;Object(vt.isEmpty)(n)||a===n||kt.getTaskDetail({recordId:n.id,monitorId:n.monitorId}).then(function(e){1===e.code&&t.setState({taskDetail:e.data,visible:!1})})}},{key:"isSnapshotChange",value:function(e){this.setState({showSnapshot:e.target.checked})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"__initRulesColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(e,t){var a=t.isSnapshot?" (已删除)":"";return{children:(t.isCustomizeSql?t.customizeSql:e)+a,props:{colSpan:t.isCustomizeSql?3:1}}},width:"100px"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(e,t){return{children:t.functionName,props:{colSpan:t.isCustomizeSql?0:1}}},width:"100px"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(e,t){return{children:e,props:{colSpan:t.isCustomizeSql?0:1}}},width:"100px"},{title:"校验方法",dataIndex:"verifyTypeValue",key:"verifyTypeValue",width:"10%"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return l.a.createElement(At,{value:e})},width:"8%"},{title:"统计值",dataIndex:"statistic",key:"statistic",width:"8%"},{title:"阈值",dataIndex:"threshold",key:"threshold",render:function(e,t){return t.isPercentage?t.operator+"  "+e+"  %":t.operator+"  "+e},width:"8%"},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"12%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"12%",render:function(e){return ne()(e).format("YYYY-MM-DD HH:mm")}},{title:"操作",width:"8%",render:function(t,a){return l.a.createElement("a",{onClick:e.onCheckReport.bind(e,a)},"查看趋势")}}]}},{key:"__onCheckReport__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({currentRecord:e}),kt.getTaskAlarmNum({ruleId:e.id,monitorId:e.monitorId}).then(function(e){1===e.code&&(t.setState({visible:!0}),t.initLineChart(e.data))})}},{key:"initLineChart",value:function(e){var t=this.state.currentRecord,a=St.init(document.getElementById("TaskTrend")),n=Object(vt.cloneDeep)(Oe),r=te()(e).map(function(e){return ne()(e).format("YYYY-MM-DD HH:mm")}),i=$()(e);n.title.text="",n.tooltip.axisPointer.label.formatter="{value}",n.legend.data=["统计值"],n.xAxis[0].axisTick={show:!1,alignWithLabel:!0},n.xAxis[0].boundaryGap=["5%","5%"],n.xAxis[0].axisLabel.formatter=function(e,t){return ne()(e).format("YYYY-MM-DD HH:mm")},n.xAxis[0].data=e&&r?r:[],n.yAxis[0].axisLabel.formatter="{value}",n.yAxis[0].minInterval=1,n.series=[{name:"统计值",type:"line",smooth:!0,symbolSize:8,data:i}],Object(vt.isEmpty)(e)||(n.series[0].markLine="in"===t.operator?void 0:{silent:!0,itemStyle:{normal:{label:{formatter:function(){return"阈值"}}}},data:[{yAxis:+t.threshold}]}),a.setOption(n),this.setState({lineChart:a})}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.currentRecord,n=e.taskDetail,r=e.showSnapshot,i=n?n.filter(function(e){return!!r||0==e.isSnapshot}):[],s=Object(vt.isEmpty)(a)?"":"指标最近波动图（"+a.columnName+" -- "+a.functionName+"）";return a&&a.isCustomizeSql&&(s="指标最近波动图"),l.a.createElement("div",{style:{padding:10}},l.a.createElement(st.a,{value:r,style:{marginBottom:"10px"},onChange:this.isSnapshotChange.bind(this)},"查看历史规则"),l.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:this.initRulesColumns(),pagination:!1,dataSource:i,style:{marginBottom:15},scroll:{y:250}}),t&&l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:s},l.a.createElement(re.a,{onResize:this.resize},l.a.createElement("article",{id:"TaskTrend",style:{width:"100%",height:"300px"}}))))}}]),t}(o.Component),wt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Lt,"TaskDetailPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/taskDetailPane.js"),a("m1cH")),xt=a.n(wt),Ht=a("ProS");a("75ce"),a("AH3D"),a("Ynxi");var Pt,Nt,It=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.loadReports=function(){return a.__loadReports__REACT_HOT_LOADER__.apply(a,arguments)},a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.getSeries=function(){return a.__getSeries__REACT_HOT_LOADER__.apply(a,arguments)},a.initTableInfoColumns=function(){return a.__initTableInfoColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.initTableReportColumns=function(){return a.__initTableReportColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.init30TimesInfo=function(){return a.__init30TimesInfo__REACT_HOT_LOADER__.apply(a,arguments)},a.init30TimesTableReport=function(){return a.__init30TimesTableReport__REACT_HOT_LOADER__.apply(a,arguments)},a.state={lineChart:"",tableReport:{}},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props.data;this.loadReports({recordId:e.id,tableId:e.tableId})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;Object(vt.isEmpty)(a)||t===a||this.loadReports({recordId:a.id,tableId:a.tableId})}},{key:"__loadReports__REACT_HOT_LOADER__",value:function(e){var t=this;kt.getTaskTableReport(e).then(function(e){1===e.code&&(t.setState({tableReport:e.data}),t.initLineChart(e.data.usage))})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"initLineChart",value:function(e){var t=Ht.init(document.getElementById("TableReportTrend")),a=Object(vt.cloneDeep)(Oe),n=e.map(function(e){return ne()(e.executeTime).format("YYYY-MM-DD HH:mm")}),r=[{key:"dayCountRecord",name:"记录数"},{key:"dayCountTrigger",name:"总告警数"}];a.grid={left:20,right:20,containLabel:!0},a.title.text="",a.tooltip.axisPointer.label.formatter="{value}",a.xAxis[0].axisTick={show:!1,alignWithLabel:!0},a.xAxis[0].boundaryGap=["5%","5%"],a.xAxis[0].axisLabel.formatter=function(e,t){return ne()(e).format("MM-DD HH:mm")},a.xAxis[0].data=e&&n?n:[],a.yAxis[0].axisLabel.formatter="{value}",a.yAxis[0].minInterval=1,a.legend.data=r.map(function(e){return e.name}),a.series=this.getSeries(e,r),t.setOption(a),this.setState({lineChart:t})}},{key:"__getSeries__REACT_HOT_LOADER__",value:function(e,t){var a=[];return e.length&&t.forEach(function(t){a.push({name:t.name,type:"line",smooth:!0,symbolSize:8,data:e.map(function(e){return e[t.key]})})}),a}},{key:"__initTableInfoColumns__REACT_HOT_LOADER__",value:function(){return[{title:"表名",dataIndex:"tableName",key:"tableName",width:"40%"},{title:"总分区数量",dataIndex:"partitionNum",key:"partitionNum",width:"20%"},{title:"类型",dataIndex:"dataSourceType",key:"dataSourceType",width:"40%"}]}},{key:"__initTableReportColumns__REACT_HOT_LOADER__",value:function(){return[{title:"记录数",dataIndex:"countData",key:"countData",width:"50%"},{title:"报警数",dataIndex:"countTrigger",key:"countTrigger",width:"50%"}]}},{key:"__init30TimesInfo__REACT_HOT_LOADER__",value:function(){return[{title:"记录数平均波动率",dataIndex:"standardDeviation",key:"standardDeviation"},{title:"平均记录数",dataIndex:"avgRecord",key:"avgRecord"},{title:"日平均告警数",dataIndex:"avgTrigger",key:"avgTrigger"},{title:"平均告警率",dataIndex:"alarmRate",key:"alarmRate",render:function(e){return e&&e.toFixed?e.toFixed(2):e}}]}},{key:"__init30TimesTableReport__REACT_HOT_LOADER__",value:function(){var e=this.props.data,t=[{title:"执行时间",dataIndex:"executeTime",key:"executeTime",render:function(e){return ne()(e).format("YYYY-MM-DD HH:mm:ss")},width:"40%"},{title:"记录数",dataIndex:"dayCountRecord",key:"dayCountRecord",width:"20%"},{title:"总告警数",dataIndex:"dayCountTrigger",key:"dayCountTrigger",width:"20%"}];return e.dataSourceType!==_e.HIVE&&e.dataSourceType!==_e.MAXCOMPUTE||t.splice(1,0,{title:"分区",dataIndex:"partition",key:"partition",width:"20%"}),t}},{key:"render",value:function(){var e=this.state.tableReport,t=Object(vt.isEmpty)(e)?[]:[e],a=e.usage?[].concat(xt()(e.usage)).reverse():[],n=l.a.createElement("div",null,"表级统计",l.a.createElement("span",{style:{fontSize:12,color:"#999"}},"（执行时间：",ne()(e.executeTime).format("YYYY-MM-DD HH:mm:ss"),"）"));return l.a.createElement("div",{style:{padding:20}},l.a.createElement(q.a,{rowKey:"tableName",className:"m-table txt-center-table",columns:this.initTableInfoColumns(),pagination:!1,dataSource:t}),l.a.createElement(W.a,{style:{padding:"20px 0"},gutter:16},l.a.createElement(X.a,{span:12},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:n},l.a.createElement(q.a,{rowKey:"tableName",className:"m-table txt-center-table",columns:this.initTableReportColumns(),pagination:!1,dataSource:t}))),l.a.createElement(X.a,{span:12},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次综合报告"},l.a.createElement(q.a,{rowKey:"id",className:"m-table txt-center-table",columns:this.init30TimesInfo(),pagination:!1,dataSource:t})))),l.a.createElement(W.a,{gutter:16},l.a.createElement(X.a,{span:12},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次表级统计"},l.a.createElement(q.a,{rowKey:"id",className:"m-table txt-center-table",columns:this.init30TimesTableReport(),pagination:!1,dataSource:a,scroll:{y:245}}))),l.a.createElement(X.a,{span:12},l.a.createElement(K.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次表数据波动图",style:{width:"100%"}},l.a.createElement(re.a,{onResize:this.resize},l.a.createElement("article",{id:"TableReportTrend",style:{width:"100%",height:"280px"}}))))))}}]),t}(o.Component),jt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(It,"TaskTablePane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/taskTablePane.js"),a("j2qn")),Ut={getTaskList:function(e){return function(t){t({type:jt.a.CHANGE_LOADING}),kt.getTaskList(e).then(function(e){1===e.code&&t({type:jt.a.GET_TASK_LIST,payload:e.data}),t({type:jt.a.CHANGE_LOADING})})}},getTaskDetail:function(e){return function(t){kt.getTaskDetail(e).then(function(e){1===e.code&&t({type:jt.a.GET_TASK_DETAIL,payload:e.data})})}},getTaskTableReport:function(e){return function(t){kt.getTaskTableReport(e).then(function(e){1===e.code&&t({type:jt.a.GET_TASK_TABLE_REPORT,payload:e.data})})}},getTaskAlarmNum:function(e){return function(t){kt.getTaskAlarmNum(e).then(function(e){1===e.code&&t({type:jt.a.GET_TASK_ALARM_NUM,payload:e.data})})}}},Mt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ut,"taskQueryActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/taskQuery/index.js"),yt.a.Search),Ft=gt.a.Option,Qt=ht.a.TabPane,Vt=mt.a.RangePicker,Gt=function(e){return{taskQuery:e.taskQuery,dataSource:e.dataSource,common:e.common}},zt=function(e){return{getTaskList:function(t){e(Ut.getTaskList(t))},getDataSourcesList:function(t){e(Be.getDataSourcesList(t))}}},qt=Object(A.b)(Gt,zt)(Pt=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={params:{currentPage:1,pageSize:20,fuzzyName:I.a.getParameterByName("tb")||void 0,configureId:void 0,dataSourceId:void 0,dataSourceType:I.a.getParameterByName("source")||void 0,subscribe:void 0,executeStartTime:I.a.getParameterByName("startTime")||void 0,executeEndTime:I.a.getParameterByName("endTime")||void 0,bizTime:0,statusFilter:I.a.getParameterByName("statusFilter")||""},tabKey:"1",showSlidePane:!1,currentTask:{},visibleList:[]},n.renderLogInfo=function(){var e;return(e=n).__renderLogInfo__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onExecuteTimeChange=function(){var e;return(e=n).__onExecuteTimeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribeChange=function(){var e;return(e=n).__onSubscribeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableSearch=function(){var e;return(e=n).__onTableSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.openSlidePane=function(){var e;return(e=n).__openSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.closeSlidePane=function(){var e;return(e=n).__closeSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.onTabChange=function(){var e;return(e=n).__onTabChange__REACT_HOT_LOADER__.apply(e,arguments)},n.disabledDate=function(){var e;return(e=n).__disabledDate__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.props.getTaskList(this.state.params),this.props.getDataSourcesList()}},{key:"__renderLogInfo__REACT_HOT_LOADER__",value:function(e,t){var a=this.state.visibleList,n="",r="close-circle-o";if(e===oe.FAIL)n=l.a.createElement("a",{className:"tooltip_content_a",onClick:this.showDetailLogInfo.bind(this,t.id,t.tableName,t.logInfo)},t.logInfo||"空");else{if(e!==oe.UNPASS)return null;n=l.a.createElement("span",{className:"tooltip_content_a"},t.logInfo||"空"," ",l.a.createElement("a",{onClick:this.openSlidePane.bind(this,t)},"查看详情")),r="exclamation-circle-o"}return l.a.createElement(ut.a,{placement:"right",visible:a.indexOf(t.id)>-1,onVisibleChange:this.tooltipChange.bind(this,t.id),title:n,overlayStyle:{wordBreak:"break-word"}},l.a.createElement(dt.a,{className:"font-14",type:r}))}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this,t=this.state,a=(t.visibleList,t.params);return[{title:"表",dataIndex:"tableName",key:"tableName",render:function(t,a){return l.a.createElement("a",{onClick:e.openSlidePane.bind(e,a)},t)},width:"15%"},{title:"分区",dataIndex:"partationValue",key:"partationValue",render:function(e,t){return e||"--"},width:"15%"},{title:"状态",width:"10%",dataIndex:"status",key:"status",render:function(t,a){return l.a.createElement("div",null,l.a.createElement(Ot,{style:{display:"inline-block",width:"80px"},value:t}),e.renderLogInfo(t,a))},filters:ye,filteredValue:a.statusFilter?a.statusFilter.split(","):[]},{title:"规则异常数",dataIndex:"alarmSum",key:"alarmSum",width:"8%",sorter:!0,render:function(e){return null==e?"-":e}},{title:"数据源",dataIndex:"sourceTypeValue",key:"sourceTypeValue",render:function(e,t){return e?e+" / "+t.sourceName:"--"},width:"15%"},{title:"触发方式",dataIndex:"trigMode",key:"trigMode",width:"80px",render:function(e){return ue[e]},filters:[{text:ue[ce.LOOP],value:ce.LOOP},{text:ue[ce.HAND],value:ce.HAND}],filterMultiple:!1},{title:"配置人",dataIndex:"configureUserName",key:"configureUserName",width:"150px"},{title:"执行时间",dataIndex:"executeTime",key:"executeTime",render:function(e){return e?ne()(e).format("YYYY-MM-DD HH:mm:ss"):"--"},width:"12%",sorter:!0}]}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=a.field,r=a.order,i=M()({},this.state.params,{currentPage:e.current,statusFilter:t.status&&t.status.length>0?t.status.join(","):void 0,alarmSort:void 0,trigMode:t.trigMode&&t.trigMode.length>0?t.trigMode.join(","):void 0,executeTimeSort:void 0});n?i["alarmSum"===n?"alarmSort":"executeTimeSort"]="descend"===r?"desc":"asc":i.alarmSort=i.executeTimeSort=void 0,this.props.getTaskList(i),this.setState({params:i})}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Ft,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,dataSourceType:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return l.a.createElement(Ft,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,dataSourceId:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Ft,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,configureId:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__onExecuteTimeChange__REACT_HOT_LOADER__",value:function(e,t){var a=M()({},this.state.params,{currentPage:1,executeStartTime:e&&e[0]?e[0].valueOf():null,executeEndTime:e&&e[1]?e[1].valueOf():null});this.props.getTaskList(a),this.setState({params:a})}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,subscribe:!!e.target.checked||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__onTableSearch__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,fuzzyName:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"showDetailLogInfo",value:function(e,t,a){this.tooltipChange(e,!1),lt.a.error({width:"70%",title:"表: "+t,content:l.a.createElement("pre",{style:{wordBreak:"break-word",whiteSpace:"pre-wrap"}},a)})}},{key:"tooltipChange",value:function(e,t){var a=this.state.visibleList;t?this.setState({visibleList:a.concat(e)}):this.setState({visibleList:a.filter(function(t){return e!=t})})}},{key:"__openSlidePane__REACT_HOT_LOADER__",value:function(e){this.setState({showSlidePane:!0,currentTask:e})}},{key:"__closeSlidePane__REACT_HOT_LOADER__",value:function(){this.setState({showSlidePane:!1,currentTask:{},tabKey:"1"})}},{key:"__onTabChange__REACT_HOT_LOADER__",value:function(e){this.setState({tabKey:e})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()>Date.now()}},{key:"render",value:function(){var e=this.props,t=e.dataSource,a=e.taskQuery,n=e.common,r=t.sourceType,i=t.sourceList,s=n.userList,o=a.loading,c=a.taskList,u=this.state,_=u.params,d=u.showSlidePane,p=u.tabKey,m=u.currentTask,E=_.executeStartTime,h=_.executeEndTime,T={current:_.currentPage,pageSize:_.pageSize,total:c.totalCount},g=void 0;E&&h&&(g=[ne()(parseInt(E)),ne()(parseInt(h))]);var f=l.a.createElement("div",{className:"flex font-12"},l.a.createElement(Mt,{placeholder:"输入表名搜索",onSearch:this.onTableSearch,defaultValue:_.fuzzyName,style:{width:200,margin:"10px 0"}}),l.a.createElement("div",{className:"m-l-8"},"类型：",l.a.createElement(gt.a,{allowClear:!0,style:{width:150},value:_.dataSourceType,placeholder:"选择数据源类型",onChange:this.onSourceChange},this.renderSourceType(r))),l.a.createElement("div",{className:"m-l-8"},"数据源：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源",onChange:this.onUserSourceChange},this.renderUserSource(i))),l.a.createElement("div",{className:"m-l-8"},"执行时间：",l.a.createElement(Vt,{defaultValue:g,format:"YYYY-MM-DD",placeholder:["开始日期","结束日期"],style:{width:200,verticalAlign:"middle",marginTop:"-1px"},disabledDate:this.disabledDate,onChange:this.onExecuteTimeChange})),l.a.createElement("div",{className:"m-8"},"配置人：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},placeholder:"选择配置人",optionFilterProp:"name",onChange:this.onUserChange},this.renderUserList(s))),l.a.createElement("div",{className:"m-l-8"},l.a.createElement(st.a,{onChange:this.onSubscribeChange},"我订阅的表")));return l.a.createElement("div",{className:"task-dashboard"},l.a.createElement("h1",{className:"box-title"},"任务查询 ",l.a.createElement("span",{style:{fontSize:"12px",color:"rgb(153, 153, 153)"}},"告警总数: ",c.data&&c.data[0]?c.data[0].allAlarmSum:0)),l.a.createElement("div",{className:"box-2 m-card shadow"},l.a.createElement(K.a,{title:f,noHovering:!0,bordered:!1},l.a.createElement(q.a,{rowClassName:function(e,t){return m&&m.id==e.id?"row-select":""},rowKey:"id",className:"m-table",columns:this.initColumns(),loading:o,pagination:T,dataSource:c.data,onChange:this.onTableChange}),l.a.createElement(Rt.a,{onClose:this.closeSlidePane,visible:d,style:{right:"0",width:"80%",minHeight:"600px",height:"100%"}},l.a.createElement("div",{className:"m-tabs"},l.a.createElement(ht.a,{animated:!1,activeKey:p,onChange:this.onTabChange},l.a.createElement(Qt,{tab:"监控报告",key:"1"},l.a.createElement(Lt,{data:m})),l.a.createElement(Qt,{tab:"表级报告",key:"2"},l.a.createElement(It,{data:m}))))))))}}]),t}(o.Component))||Pt,Yt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Mt,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Ft,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Qt,"TabPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Vt,"RangePicker","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Gt,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(zt,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(qt,"TaskQuery","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/taskQuery/index.js")),a("MaXC"),a("4IMT")),Kt=a.n(Yt),Bt=(a("tL+A"),a("QpBz")),Wt=a.n(Bt),Jt=(a("b+Mx"),a("5Dct")),Xt=a.n(Jt),Zt=(a("eOfH"),a("h0/l")),$t=a.n(Zt),ea=(a("nTym"),a("qu0K")),ta=a.n(ea),aa=a("gDS+"),na=a.n(aa),ra={getMonitorLists:function(e){return be.a.post(ke.a.GET_MONITOR_LIST,e)},getRuleFunction:function(e){return be.a.post(ke.a.GET_RULE_FUNCTION,e)},getTableColumn:function(e){return be.a.post(ke.a.GET_MONITOR_TABLE_COLUMN,e)},getMonitorRule:function(e){return be.a.post(ke.a.GET_MONITOR_RULE,e)},saveMonitorRule:function(e){return be.a.post(ke.a.SAVE_MONITOR_RULE,e)},deleteMonitorRule:function(e){return be.a.post(ke.a.DELETE_MONITOR_RULE,e)},addMonitor:function(e){return be.a.post(ke.a.ADD_MONITOR,e)},updateMonitor:function(e){return be.a.post(ke.a.UPDATE_MONITOR,e)},subscribeTable:function(e){return be.a.post(ke.a.SUBSCRIBE_TABLE,e)},unSubscribeTable:function(e){return be.a.post(ke.a.UNSUBSCRIBE_TABLE,e)},checkSubscribe:function(e){return be.a.post(ke.a.CHECK_SUBSCRIBE,e)},changeMonitorStatus:function(e){return be.a.post(ke.a.CHANGE_MONITOR_STATUS,e)},executeMonitor:function(e){return be.a.post(ke.a.EXECUTE_MONITOR,e)},getMonitorDetail:function(e){return be.a.post(ke.a.GET_MONITOR_DETAIL,e)},getRemoteTrigger:function(e){return be.a.post(ke.a.GET_REMOTE_TRIGGER,e)},addRemoteTrigger:function(e){return be.a.post(ke.a.ADD_REMOTE_TRIGGER,e)},delRemoteTrigger:function(e){return be.a.post(ke.a.DEL_REMOTE_TRIGGER,e)},checkMonitor:function(e){return be.a.post(ke.a.CHECK_MONITOR,e)},updateTaskParams:function(e){return be.a.post(ke.a.UPDATE_TASK_PARAMS,e)}},ia=ra,sa=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(ra,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/ruleConfig.js"),ta.a.Item),oa=gt.a.Option,la={beginDate:ne()().format("YYYY-MM-DD"),endDate:ne()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},ca=function(e){return{common:e.common}},ua=Object(A.b)(ca)(Nt=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.initState=function(){return a.__initState__REACT_HOT_LOADER__.apply(a,arguments)},a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.renderPeriodType=function(){return a.__renderPeriodType__REACT_HOT_LOADER__.apply(a,arguments)},a.onPeriodTypeChange=function(){return a.__onPeriodTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSendTypeList=function(){return a.__renderSendTypeList__REACT_HOT_LOADER__.apply(a,arguments)},a.onSendTypeChange=function(){return a.__onSendTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onWebHookChange=function(){return a.__onWebHookChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onBeginDateChange=function(){return a.__onBeginDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onEndDateChange=function(){return a.__onEndDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.onNotifyUserChange=function(){return a.__onNotifyUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.cancel=function(){return a.__cancel__REACT_HOT_LOADER__.apply(a,arguments)},a.checkTime=function(){return a.__checkTime__REACT_HOT_LOADER__.apply(a,arguments)},a.checkDate=function(){return a.__checkDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={scheduleConfObj:la,params:{monitorId:void 0,sendTypes:[],notifyUser:[],periodType:void 0,scheduleConf:void 0,webhook:void 0}},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.initState(this.props.data)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;t.monitorId!=a.monitorId&&this.initState(a)}},{key:"__initState__REACT_HOT_LOADER__",value:function(e){e.scheduleConf&&this.setState({scheduleConfObj:JSON.parse(e.scheduleConf),params:{monitorId:e.monitorId,sendTypes:e.sendTypes,webhook:e.webhook,notifyUser:e.notifyUser.map(function(e){return e.id}),periodType:e.periodType,scheduleConf:e.scheduleConf}})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(e){var t=M()({},la,{periodType:e});this.setState({scheduleConfObj:t,params:M()({},this.state.params,{periodType:e,scheduleConf:na()(t)})})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(oa,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){this.resetScheduleConf(e)}},{key:"__renderSendTypeList__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return l.a.createElement(st.a,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSendTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("notifyUser");0===e.length&&0===a.length&&t.setFieldsValue({notifyUser:[]}),this.setState({params:M()({},this.state.params,{sendTypes:e})})}},{key:"__onWebHookChange__REACT_HOT_LOADER__",value:function(e){this.setState({params:M()({},this.state.params,{webhook:e.target.value})})}},{key:"__onBeginDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("beginDate",t)}},{key:"__onEndDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("endDate",t)}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(oa,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__onNotifyUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("sendTypes");0===e.length&&0===a.length&&t.setFieldsValue({sendTypes:[]}),this.setState({params:M()({},this.state.params,{notifyUser:e})})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t){var a=this.state,n=a.scheduleConfObj,r=a.params,i={};i[e]=t;var s=M()({},n,i);this.setState({scheduleConfObj:s,params:M()({},r,{scheduleConf:na()(s)})})}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common.allDict,r=a.getFieldDecorator,i=this.state.scheduleConfObj,s=(n.periodType&&n.periodType,function(t){for(var a=[],n=0;n<=23;n++)a.push(l.a.createElement(oa,{key:n,value:""+n},n<10?"0"+n:n));return l.a.createElement(gt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)}),o=function(t){for(var a=[],n=0;n<=59;n++)a.push(l.a.createElement(oa,{key:n,value:""+n},n<10?"0"+n:n));return l.a.createElement(gt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(i.periodType){case"1":return l.a.createElement("div",null,l.a.createElement(sa,M()({},Re,{label:"开始时间"}),r("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.beginHour})(s("beginHour")),l.a.createElement("span",{className:"m-8"},"时"),r("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.beginMin})(o("beginMin")),l.a.createElement("span",{className:"m-8"},"分")),l.a.createElement(sa,M()({},Re,{label:"间隔时间"}),r("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:i.gapHour?i.gapHour:""})(function(){for(var t=[],a=1;a<=23;a++)t.push(l.a.createElement(oa,{key:a,value:""+a},a,"小时"));return l.a.createElement(gt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),l.a.createElement(sa,M()({},Re,{label:"结束时间"}),r("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.endHour})(s("endHour")),l.a.createElement("span",{className:"m-8"},"时"),r("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.endMin})(o("endMin")),l.a.createElement("span",{className:"m-8"},"分")));case"2":return l.a.createElement(sa,M()({},Re,{label:"起调周期"}),r("hour",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分"));case"3":return l.a.createElement("div",null,l.a.createElement(sa,M()({},Re,{label:"选择时间"}),r("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:i.weekDay?i.weekDay:[]})(l.a.createElement(gt.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},l.a.createElement(oa,{key:1,value:"1"},"星期一"),l.a.createElement(oa,{key:2,value:"2"},"星期二"),l.a.createElement(oa,{key:3,value:"3"},"星期三"),l.a.createElement(oa,{key:4,value:"4"},"星期四"),l.a.createElement(oa,{key:5,value:"5"},"星期五"),l.a.createElement(oa,{key:6,value:"6"},"星期六"),l.a.createElement(oa,{key:7,value:"7"},"星期天")))),l.a.createElement(sa,M()({},Re,{label:"起调周期"}),r("hour1",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min1",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分")));case"4":return l.a.createElement("div",null,l.a.createElement(sa,M()({},Re,{label:"选择时间"}),r("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:i.day?i.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(l.a.createElement(oa,{key:a,value:""+a},"每月"+a+"号"));return l.a.createElement(gt.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),l.a.createElement(sa,M()({},Re,{label:"起调周期"}),r("hour2",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min2",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分")))}}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.data;t.resetFields(),this.initState(a),this.props.closeModal(!1)}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginHour"),i=n.getFieldValue("beginMin"),s=n.getFieldValue("endHour"),o=n.getFieldValue("endMin");60*parseInt(r)+parseInt(i)>=60*parseInt(s)+parseInt(o)?a("开始时间不能晚于结束时间"):n.setFieldsValue({beginHour:r,beginMin:i,endHour:s,endMin:o}),a()}},{key:"__checkDate__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginDate"),i=n.getFieldValue("endDate");r&&i?r.valueOf()>i.valueOf()?a("生效日期的开始时间不能晚于结束时间"):n.setFieldsValue({beginDate:r,endDate:i}):a(),a()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.form,a=this.state.params;t.validateFields(function(t,n){t&&t.endDate&&Wt.a.error(t.endDate.errors[0].message),t||ia.updateMonitor(a).then(function(t){1===t.code&&(Wt.a.success("更新成功！"),e.props.closeModal(!0))})})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.visible,r=t.getFieldDecorator,i=a.allDict,s=a.userList,o=this.state,c=o.scheduleConfObj,u=o.params,_=u.notifyUser,d=u.sendTypes,p=u.webhook,m=i.periodType?i.periodType:[],E=i.notifyType?i.notifyType:[],h=d?d.map(function(e){return e.toString()}):[],T=h.indexOf(le.DINGDING)>-1;return l.a.createElement(lt.a,{title:"编辑调度属性",wrapClassName:"editExecuteModal",maskClosable:!1,visible:n,width:"50%",okText:"保存",cancelText:"取消",onOk:this.save,onCancel:this.cancel},l.a.createElement(ta.a,null,l.a.createElement(sa,M()({},Re,{label:"调度周期"}),r("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+c.periodType})(l.a.createElement(gt.a,{onChange:this.onPeriodTypeChange},this.renderPeriodType(m)))),5!=c.periodType&&l.a.createElement(sa,M()({},Re,{label:"生效日期"}),r("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:ne()(c.beginDate)})(l.a.createElement(mt.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),l.a.createElement("span",{className:"m-8"},"到"),r("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:ne()(c.endDate)})(l.a.createElement(mt.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),l.a.createElement(sa,M()({},Re,{label:"告警方式"}),r("sendTypes",{rules:[{required:_.length,message:"选择告警方式"}],initialValue:h})(l.a.createElement(st.a.Group,{onChange:this.onSendTypeChange},this.renderSendTypeList(E)))),T&&l.a.createElement(sa,M()({},Re,{label:"webhook"}),r("webhook",{rules:[{required:!0,message:"webhook不能为空"}],initialValue:p||""})(l.a.createElement(yt.a,{onChange:this.onWebHookChange}))),l.a.createElement(sa,M()({},Re,{label:"告警接收人"}),r("notifyUser",{rules:[{required:d.length,message:"选择告警接收人"}],initialValue:_.map(function(e){return e.toString()})})(l.a.createElement(gt.a,{allowClear:!0,mode:"multiple",onChange:this.onNotifyUserChange},this.renderUserList(s))))))}}]),t}(o.Component))||Nt;ua=ta.a.create()(ua);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(sa,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(oa,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(la,"initialSchedule","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(ca,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(ua,"ExecuteForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"));var _a,da=a("tgFt"),pa={getMonitorLists:function(e){return function(t){return t({type:da.a.CHANGE_LOADING}),ia.getMonitorLists(e).then(function(e){if(t({type:da.a.CHANGE_LOADING}),1===e.code)return t({type:da.a.GET_MONITOR_LIST,payload:e.data}),e})}},getRuleFunction:function(e){return function(t){ia.getRuleFunction(e).then(function(e){1===e.code&&t({type:da.a.GET_RULE_FUNCTION,payload:e.data})})}},getTableColumn:function(e){return function(t){ia.getTableColumn(e).then(function(e){1===e.code&&t({type:da.a.GET_MONITOR_TABLE_COLUMN,payload:e.data})})}},addMonitor:function(e){return function(t){ia.addMonitor(e).then(function(e){1===e.code&&Wt.a.success("添加成功！")})}},updateMonitor:function(e){return function(t){ia.updateMonitor(e).then(function(e){1===e.code&&Wt.a.success("更新成功！")})}},getMonitorRule:function(e){return function(t){ia.getMonitorRule(e).then(function(e){1===e.code&&t({type:da.a.GET_MONITOR_RULE,payload:e.data})})}},changeMonitorStatus:function(e){return function(t){ia.changeMonitorStatus(e).then(function(e){1===e.code&&Wt.a.success("操作成功！")})}},getMonitorDetail:function(e){return function(t){ia.getMonitorDetail(e).then(function(e){1===e.code&&t({type:da.a.GET_MONITOR_DETAIL,payload:e.data})})}},getRemoteTrigger:function(e){return function(t){ia.getRemoteTrigger(e).then(function(e){1===e.code&&t({type:da.a.GET_REMOTE_TRIGGER,payload:e.data})})}}},ma=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(pa,"ruleConfigActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/ruleConfig/index.js"),a("pKDC")),Ea=a("pAlz"),ha=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={changeVal:""},n.onChange=function(){var e;return(e=n).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onOk=function(){var e;return(e=n).__onOk__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"__onChange__REACT_HOT_LOADER__",value:function(e,t){this.setState({changeVal:t})}},{key:"__onOk__REACT_HOT_LOADER__",value:function(){var e=this.state.changeVal||this.props.value;this.props.onOk(e)}},{key:"render",value:function(){var e=this.props,t=e.value,a=e.visible,n=e.title,r=e.key,i=e.onCancel;return l.a.createElement(lt.a,{key:r,visible:a,title:n,onOk:this.onOk,onCancel:i,bodyStyle:{height:400,padding:0}},l.a.createElement(ma.a,{options:Ea.b,value:t,onChange:this.onChange,sync:!0}))}}]),t}(o.Component),Ta=ha,ga=Ta,fa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ha,"EnvModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/envModal.js"),__REACT_HOT_LOADER__.register(Ta,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/envModal.js")),ta.a.Item),ya=gt.a.Option,Ra=yt.a.TextArea,va=function(e){return{ruleConfig:e.ruleConfig,common:e.common}},Ca=function(e){return{getRuleFunction:function(t){e(pa.getRuleFunction(t))},getTableColumn:function(t){e(pa.getTableColumn(t))},getMonitorDetail:function(t){e(pa.getMonitorDetail(t))},changeMonitorStatus:function(t){e(pa.changeMonitorStatus(t))}}},Aa=Object(A.b)(va,Ca)(_a=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.initData=function(){return a.__initData__REACT_HOT_LOADER__.apply(a,arguments)},a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.changeRuleParams=function(){return a.__changeRuleParams__REACT_HOT_LOADER__.apply(a,arguments)},a.onColumnNameChange=function(){return a.__onColumnNameChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onFunctionChange=function(){return a.__onFunctionChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onVerifyTypeChange=function(){return a.__onVerifyTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderEditTD=function(){return a.__renderEditTD__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTD=function(){return a.__renderTD__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRule=function(){return a.__addNewRule__REACT_HOT_LOADER__.apply(a,arguments)},a.onMonitorIdChange=function(){return a.__onMonitorIdChange__REACT_HOT_LOADER__.apply(a,arguments)},a.executeMonitor=function(){return a.__executeMonitor__REACT_HOT_LOADER__.apply(a,arguments)},a.changeMonitorStatus=function(){return a.__changeMonitorStatus__REACT_HOT_LOADER__.apply(a,arguments)},a.updateEnvParams=function(){return a.__updateEnvParams__REACT_HOT_LOADER__.apply(a,arguments)},a.openExecuteModal=function(){return a.__openExecuteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.closeExecuteModal=function(){return a.__closeExecuteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.state={enumFields:["columnName","functionId","thresholdEnum"],SQLFields:["customizeSql","verifyType","operator","threshold"],columnFields:["columnName","functionId","verifyType","operator","threshold"],rules:[],currentRule:{},functionList:[],monitorId:void 0,havePart:!1,showExecuteModal:!1,visibleEnvModal:!1},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.props.getRuleFunction()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;if(!Object(vt.isEmpty)(a)&&t.tableId!==a.tableId){var n=a.monitorPartVOS[0].monitorId;this.initData(n,a),this.setState({monitorId:n,havePart:!1,currentRule:{},functionList:[]}),7!==a.dataSourceType&&10!==a.dataSourceType||this.setState({havePart:!0})}}},{key:"__initData__REACT_HOT_LOADER__",value:function(e,t){var a=this;this.props.getMonitorDetail({monitorId:e}),ia.getMonitorRule({monitorId:e}).then(function(e){1===e.code&&a.setState({rules:e.data})}),this.props.getTableColumn({sourceId:t.sourceId,tableName:t.tableName})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(t,a){return e.renderColumns(t,a,"columnName")},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(t,a){return e.renderColumns(t,a,"functionId")},width:"15%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(t,a){return e.renderColumns(t,a,"filter")},width:"25%"},{title:"校验方法",dataIndex:"verifyType",key:"verifyType",render:function(t,a){return e.renderColumns(t,a,"verifyType")},width:"15%"},{title:"阈值配置（不符合阈值条件时触发告警）",dataIndex:"threshold",key:"threshold",render:function(t,a){return e.renderColumns(t,a,"threshold")},width:"20%"},{title:"操作",width:"10%",render:function(t,a){var n=a.editable;return l.a.createElement("div",null,n?l.a.createElement("span",null,l.a.createElement("a",{className:"m-r-8",onClick:function(){return e.save(a.id)}},"保存"),l.a.createElement("a",{onClick:function(){return e.cancel(a.id)}},"取消")):l.a.createElement("span",null,l.a.createElement("a",{className:"m-r-8",onClick:function(){return e.edit(a.id)}},"编辑"),l.a.createElement($t.a,{title:"确定要删除吗？",onConfirm:function(){return e.delete(a.id)}},l.a.createElement("a",null,"删除"))))}}]}},{key:"renderColumns",value:function(e,t,a){var n={children:l.a.createElement(ta.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}};if(t.isCustomizeSql)switch(a){case"columnName":n.props.colSpan=3;break;case"functionId":case"filter":n.props.colSpan=0}return n}},{key:"__changeRuleParams__REACT_HOT_LOADER__",value:function(e,t){var a={};a[e]=t.target?t.target.value:t,this.setState({currentRule:M()({},this.state.currentRule,a)})}},{key:"__onColumnNameChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.ruleConfig,r=n.tableColumn,i=n.monitorFunction,s=this.state.currentRule,o=i[r.filter(function(t){return t.key===e})[0].type],l={};l["functionId@"+s.id]=void 0,a.setFieldsValue(l),this.setState({functionList:o,currentRule:M()({},s,{columnName:e,functionId:void 0})})}},{key:"__onFunctionChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state,n=a.functionList,r=a.currentRule,i=n.filter(function(t){return t.id==e})[0].isPercent,s=n.filter(function(t){return t.id==e})[0].nameZc,o="枚举值"===s,l=M()({},this.state.currentRule,{functionId:e,functionName:s,verifyType:o?"1":void 0,operator:o?"in":void 0,isPercentage:i,percentType:1===i?"limit":"free"}),c={};c["verifyType@"+r.id]=o?"1":void 0,c["operator@"+r.id]=void 0,t.setFieldsValue(c),this.setState({currentRule:l})}},{key:"__onVerifyTypeChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.currentRule,{verifyType:e});"limit"!==t.percentType&&(t.isPercentage=1==e?0:1),this.setState({currentRule:t})}},{key:"__renderEditTD__REACT_HOT_LOADER__",value:function(e,t,a){var n,r=this.props,i=r.form,s=r.common,o=r.ruleConfig,c=i.getFieldDecorator,u=o.tableColumn,_=s.allDict.verifyType,d=this.state,p=d.currentRule,m=d.functionList,E="字符串最大长度"===(n=p.functionName)||"字符串最小长度"===n?ge:Te;switch(a){case"columnName":return t.isCustomizeSql?l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td cell-center"}),c("customizeSql@"+t.id,{rules:[{required:!0,message:"自定义SQL不可为空"}],initialValue:t.customizeSql})(t.isCustomizeSql?l.a.createElement(Ra,{style:{resize:"vertical"},autosize:{minRows:3,maxRows:8},placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}):l.a.createElement(yt.a,{placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}))):l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td cell-center"}),c("columnName@"+t.id,{rules:[{required:!0,message:"字段不可为空"}],initialValue:t.columnName})(l.a.createElement(gt.a,{showSearch:!0,onChange:this.onColumnNameChange,disabled:t.isTable||1==t.level},u.map(function(e){return l.a.createElement(ya,{key:e.key,value:e.key},e.key)}))));case"functionId":return l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td cell-center"}),c("functionId@"+t.id,{rules:[{required:!0,message:"统计函数不可为空"}],initialValue:"edit"===t.editStatus?t.functionName:t.functionId})(l.a.createElement(gt.a,{onChange:this.onFunctionChange},m.map(function(e){return l.a.createElement(ya,{key:e.id,value:e.id.toString()},e.nameZc)}))));case"filter":return l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td cell-center"}),c("filter@"+t.id,{rules:[],initialValue:t.filter})(l.a.createElement(yt.a,{placeholder:'"and"开头的条件语句，如and col = "val"',onChange:this.changeRuleParams.bind(this,"filter")})));case"verifyType":return l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td cell-center"}),c("verifyType@"+t.id,{rules:[{required:!0,message:"校验方法不可为空"}],initialValue:t.verifyType?t.verifyType.toString():void 0})(l.a.createElement(gt.a,{onChange:this.onVerifyTypeChange},_.map(function(e){return l.a.createElement(ya,{key:e.value,value:e.value.toString()},e.name)}))));case"threshold":return"in"===p.operator?l.a.createElement(fa,M()({},Ae,{className:"rule-edit-td"}),c("thresholdEnum@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.threshold})(l.a.createElement(yt.a,{placeholder:"枚举格式为(value1,value2,.....)",onChange:this.changeRuleParams.bind(this,"threshold")}))):l.a.createElement("div",{className:"cell-center-box"},l.a.createElement(fa,{className:"cell-multiple-center"},c("operator@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.operator})(l.a.createElement(gt.a,{style:{width:65},onChange:this.changeRuleParams.bind(this,"operator")},E.map(function(e){return l.a.createElement(ya,{key:e.value,value:e.value},e.text)})))),l.a.createElement(fa,{className:"cell-multiple-center"},c("threshold@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.threshold})(l.a.createElement(Xt.a,{style:{width:65},onChange:this.changeRuleParams.bind(this,"threshold")}))),1===p.isPercentage&&l.a.createElement("span",{style:{height:32,lineHeight:"32px"}},"%"))}}},{key:"__renderTD__REACT_HOT_LOADER__",value:function(e,t,a){switch(a){case"columnName":return t.isCustomizeSql?t.customizeSql:e;case"functionId":return t.functionName;case"verifyType":return t.verifyTypeValue;case"threshold":var n=t.operator+"  "+e;return t.isPercentage?n+" %":n;default:return e}}},{key:"edit",value:function(e){var t=this.state,a=t.currentRule,n=t.rules,r=this.props.ruleConfig,i=r.monitorFunction,s=r.tableColumn,o=[],l=[].concat(xt()(n)),c=l.filter(function(t){return e===t.id})[0];if(Object(vt.isEmpty)(a)||("edit"===a.editStatus?(delete a.editable,delete a.editStatus):l.shift()),c){if(c.editable=!0,c.editStatus="edit",!c.isCustomizeSql)if(c.isTable||1==c.level)o=i.all.filter(function(e){return 1===e.level});else o=i[s.filter(function(e){return e.key===c.columnName})[0].type];this.setState({currentRule:c,rules:l,functionList:o})}}},{key:"cancel",value:function(e){var t=[].concat(xt()(this.state.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);"edit"===a.editStatus?(delete a.editable,delete a.editStatus):t.splice(n,1),this.setState({currentRule:{},rules:t})}},{key:"delete",value:function(e){var t=this,a=this.state.monitorId;[].concat(xt()(this.state.rules)).filter(function(t){return e===t.id})[0]&&ia.deleteMonitorRule({ruleIds:[e],monitorId:a}).then(function(e){1===e.code&&(Wt.a.success("删除成功"),ia.getMonitorRule({monitorId:a}).then(function(e){1===e.code&&(t.setState({rules:e.data}),Object(vt.isNull)(e.data)&&t.props.refresh())}))})}},{key:"save",value:function(e){var t=this,a=this.state,n=a.currentRule,r=a.enumFields,i=a.SQLFields,s=a.columnFields,o=a.monitorId,l=n.isCustomizeSql?i:s;"in"===n.operator&&(l=r),this.props.form.validateFields(l,{force:!0},function(e,a){e||("new"===n.editStatus&&(n.monitorId=o,delete n.id),delete n.isTable,delete n.editable,delete n.editStatus,delete n.percentType,ia.saveMonitorRule(M()({},n)).then(function(e){1===e.code&&(Wt.a.success("保存成功"),ia.getMonitorRule({monitorId:o}).then(function(e){1===e.code&&t.setState({rules:e.data,currentRule:{}})}))}))})}},{key:"__addNewRule__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.data,r=t.ruleConfig,i=this.state,s=i.currentRule,o=i.rules,l=o?[].concat(xt()(o)):[];Object(vt.isEmpty)(s)||("edit"===s.editStatus?(delete s.editable,delete s.editStatus):(l.shift(),a.resetFields(),this.setState({currentRule:{},functionList:[]})));var c={id:0,editStatus:"new",editable:!0,filter:"",verifyType:void 0,operator:void 0,threshold:void 0};switch(e){case"column":c.isCustomizeSql=0,c.columnName=void 0,c.functionId=void 0;break;case"SQL":c.isCustomizeSql=1,c.customizeSql=void 0;break;case"table":c.isTable=!0,c.isCustomizeSql=0,c.columnName=n.tableName,c.functionId=void 0,this.setState({functionList:r.monitorFunction.all.filter(function(e){return 1===e.level})})}l.unshift(c),this.setState({currentRule:c,rules:l})}},{key:"__onMonitorIdChange__REACT_HOT_LOADER__",value:function(e){var t=this,a=e;this.props.getMonitorDetail({monitorId:a}),ia.getMonitorRule({monitorId:a}).then(function(e){1===e.code&&t.setState({rules:e.data})}),this.setState({monitorId:a,currentRule:{}})}},{key:"__executeMonitor__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.data;ia.executeMonitor({monitorId:e}).then(function(e){1===e.code?(Wt.a.success("操作成功，稍后可在任务查询中查看详情"),t.props.closeSlidePane()):Wt.a.error("执行失败")})}},{key:"__changeMonitorStatus__REACT_HOT_LOADER__",value:function(e){var t=this;ia.changeMonitorStatus({monitorId:e}).then(function(a){1===a.code&&(Wt.a.success("操作成功"),t.props.getMonitorDetail({monitorId:e}))})}},{key:"__updateEnvParams__REACT_HOT_LOADER__",value:function(e){var t=this;if(e){var a=this.state.monitorId;ia.updateTaskParams({monitorId:a,taskParams:e}).then(function(e){1===e.code&&(Wt.a.success("修改环境参数成功"),t.setState({visibleEnvModal:!1}),t.props.getMonitorDetail({monitorId:a}))})}else Wt.a.error("环境参数为空！")}},{key:"__openExecuteModal__REACT_HOT_LOADER__",value:function(){this.setState({showExecuteModal:!0})}},{key:"__closeExecuteModal__REACT_HOT_LOADER__",value:function(e){var t=this.state.monitorId;e&&this.props.getMonitorDetail({monitorId:t}),this.setState({showExecuteModal:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.ruleConfig.monitorDetail,r=this.state,i=r.rules,s=r.monitorId,o=r.havePart,c=r.showExecuteModal,u=r.visibleEnvModal,_=i?i.filter(function(e){return 0==e.isSnapshot||"new"==e.editStatus}):[],d=a.monitorPartVOS?a.monitorPartVOS:[];return l.a.createElement("div",{className:"rule-manage"},l.a.createElement(W.a,null,l.a.createElement(X.a,{span:12,className:"txt-left"},o&&l.a.createElement("div",null,"分区：",l.a.createElement(gt.a,{style:{width:150},value:s?s.toString():void 0,onChange:this.onMonitorIdChange},d.map(function(e){return l.a.createElement(ya,{key:e.monitorId,value:e.monitorId.toString()},e.partValue?e.partValue:"全表")})))),l.a.createElement(X.a,{span:12,className:"txt-right"},l.a.createElement(Kt.a,{type:"primary",onClick:this.executeMonitor.bind(this,s)},"立即执行"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.openExecuteModal},"编辑调度属性"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.changeMonitorStatus.bind(this,s)},n.isClosed?"开启检测":"关闭检测"),n&&n.sourceType===_e.HIVE&&l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:function(){e.setState({visibleEnvModal:!0})}},"环境参数"))),l.a.createElement("div",{className:"monitor-info-table"},l.a.createElement("table",{width:"100%",cellPadding:"0",cellSpacing:"0"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",null,"执行周期"),l.a.createElement("td",{className:"width-3"},n.periodTypeName),l.a.createElement("th",null,"告警方式"),l.a.createElement("td",{className:"width-3"},n.sendTypeNames)),l.a.createElement("tr",null,l.a.createElement("th",null,"执行时间"),l.a.createElement("td",{className:"width-3"},n.executeTime),l.a.createElement("th",null,"接收人"),l.a.createElement("td",{className:"width-3"},n.notifyUser?n.notifyUser.map(function(e){return e.name}).join("，"):""))))),l.a.createElement("div",{className:"txt-right"},l.a.createElement(Kt.a,{type:"primary",onClick:this.addNewRule.bind(this,"table")},"添加表级规则"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.addNewRule.bind(this,"column")},"添加字段级规则"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.addNewRule.bind(this,"SQL")},"添加自定义SQL")),l.a.createElement(q.a,{rowKey:"id",className:"m-table rule-edit-table",style:{padding:"20px 0"},pagination:!1,dataSource:_,columns:this.initColumns(),scroll:{y:361}}),l.a.createElement(ua,{data:n,visible:c,closeModal:this.closeExecuteModal}),l.a.createElement(ga,{key:"ruleConfigEnvModal",title:"配置环境参数",visible:u,onCancel:function(){return e.setState({visibleEnvModal:!1})},value:n.taskParams,onOk:this.updateEnvParams}))}}]),t}(o.Component))||_a;Aa=ta.a.create()(Aa);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(fa,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(ya,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(Ra,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(va,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(Ca,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(Aa,"RuleEditPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"));var Oa,Da=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={},n.copy=function(){var e;return(e=n).__copy__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentWillUnmount",value:function(){this.removeFake()}},{key:"__copy__REACT_HOT_LOADER__",value:function(e){var t=this;this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style.left="-9999px";var a=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=a+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=e,document.body.appendChild(this.fakeElem),this.fakeElem.select(),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand("copy")}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){e?Wt.a.success("复制成功"):Wt.a.error("不支持")}},{key:"render",value:function(){var e=this.props.value;return l.a.createElement(ut.a,{placement:"right",overlayClassName:"copy-area",overlayStyle:{cursor:"pointer"},title:l.a.createElement("span",{onClick:this.copy.bind(this,e)},"复制")},e)}}]),t}(o.Component),ba=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Da,"ToolTipCopy","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/components/tooltipCopy/index.js"),gt.a.Option),ka=yt.a.TextArea,Sa=ta.a.Item,La=APP_CONF&&APP_CONF.API_SERVER?APP_CONF.API_SERVER:"",wa=function(e){return{ruleConfig:e.ruleConfig}},xa=function(e){return{getRemoteTrigger:function(t){e(pa.getRemoteTrigger(t))},getMonitorRule:function(t){e(pa.getMonitorRule(t))}}},Ha=Object(A.b)(wa,xa)(Oa=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.initTriggerColumns=function(){return a.__initTriggerColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.editTrigger=function(){return a.__editTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.deleteTrigger=function(){return a.__deleteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.initRulesColumns=function(){return a.__initRulesColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onMonitorIdChange=function(){return a.__onMonitorIdChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onRemarkChange=function(){return a.__onRemarkChange__REACT_HOT_LOADER__.apply(a,arguments)},a.newRemoteTrigger=function(){return a.__newRemoteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.showRemoteModal=function(){return a.__showRemoteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.closeRemoteModal=function(){return a.__closeRemoteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.saveRemoteTrigger=function(){return a.__saveRemoteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.state={visible:!1,havePart:!1,selectedIds:[],remark:void 0,monitorId:void 0},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props.data,t=e.monitorPartVOS[0].monitorId;this.props.getRemoteTrigger({tableId:e.tableId});var a={monitorId:t};e.dataSourceType!==_e.HIVE&&e.dataSourceType!==_e.MAXCOMPUTE||(a.havePart=!0),this.setState(a)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;if(!Object(vt.isEmpty)(a)&&t.tableId!==a.tableId){var n=a.monitorPartVOS[0].monitorId;this.props.getRemoteTrigger({tableId:a.tableId}),this.setState({monitorId:n,havePart:!1,remark:void 0,selectedIds:[]}),a.dataSourceType!==_e.HIVE&&a.dataSourceType!==_e.MAXCOMPUTE||this.setState({havePart:!0})}}},{key:"__initTriggerColumns__REACT_HOT_LOADER__",value:function(){var e=this,t=[{title:"触发规则数",dataIndex:"ruleNumber",key:"ruleNumber",width:"120px"},{title:"触发接口",dataIndex:"url",key:"url",width:"23%",render:function(e){return l.a.createElement(Da,{value:""+La+e})}},{title:"请求方式",dataIndex:"method",key:"method",width:"8%",render:function(e){return"POST"}},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"12%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"12%",render:function(e){return ne()(e).format("YYYY-MM-DD HH:mm")}},{title:"备注",dataIndex:"remark",key:"remark",width:"15%"},{title:"操作",width:"10%",render:function(t,a){return l.a.createElement("div",null,l.a.createElement("a",{className:"m-r-8",onClick:function(){return e.editTrigger(a)}},"编辑"),l.a.createElement($t.a,{title:"确定要删除吗？",onConfirm:function(){return e.deleteTrigger(a.id)}},l.a.createElement("a",null,"删除")))}}];return this.state.havePart&&t.splice(0,0,{title:"分区",dataIndex:"partitionValue",key:"partitionValue",width:"12%"}),t}},{key:"__editTrigger__REACT_HOT_LOADER__",value:function(e){this.showRemoteModal(),this.props.getMonitorRule({monitorId:e.monitorId}),this.setState({monitorId:e.monitorId,chooseRule:e,selectedIds:e.ruleIds,remark:e.remark})}},{key:"__deleteTrigger__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.props.data;ia.delRemoteTrigger({remoteId:e}).then(function(e){1===e.code&&(Wt.a.success("删除成功！"),t.props.getRemoteTrigger({tableId:a.tableId}))})}},{key:"__initRulesColumns__REACT_HOT_LOADER__",value:function(){return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(e,t){return{children:t.isCustomizeSql?t.customizeSql:e,props:{colSpan:t.isCustomizeSql?3:1}}},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(e,t){return{children:t.functionName,props:{colSpan:t.isCustomizeSql?0:1}}},width:"13%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(e,t){return{children:e,props:{colSpan:t.isCustomizeSql?0:1}}},width:"20%"},{title:"校验方法",dataIndex:"verifyTypeValue",key:"verifyTypeValue",width:"12%"},{title:"阈值配置",dataIndex:"threshold",key:"threshold",render:function(e,t){var a=t.operator+"  "+e;return t.isPercentage?a+" %":a},width:"12%"},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"14%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"14%",render:function(e){return ne()(e).format("YYYY-MM-DD HH:mm")}}]}},{key:"__onMonitorIdChange__REACT_HOT_LOADER__",value:function(e){var t=e;this.props.getMonitorRule({monitorId:t}),this.setState({monitorId:t,selectedIds:[],remark:void 0})}},{key:"__onRemarkChange__REACT_HOT_LOADER__",value:function(e){this.setState({remark:e.target.value})}},{key:"__newRemoteTrigger__REACT_HOT_LOADER__",value:function(){var e=this.state.monitorId;this.props.getMonitorRule({monitorId:e}),this.showRemoteModal()}},{key:"__showRemoteModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!0})}},{key:"__closeRemoteModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!1,selectedIds:[],chooseRule:{}}),this.props.form.resetFields()}},{key:"__saveRemoteTrigger__REACT_HOT_LOADER__",value:function(){var e=this,t=this.state,a=t.selectedIds,n=t.monitorId,r=t.remark,i=t.chooseRule,s=void 0===i?{}:i,o=this.props,l=o.data,c=o.form,u=o.getRemoteTrigger;a.length?c.validateFields(function(t,i){t||ia.addRemoteTrigger({remoteId:s.id,monitorId:n,ruleIds:a,remark:r}).then(function(t){1===t.code&&(e.setState({chooseRule:{},selectedIds:[],remark:null}),Wt.a.success("操作成功！"),e.closeRemoteModal(),u({tableId:l.tableId}))})}):Wt.a.error("请选择一个监控规则！")}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.ruleConfig,r=t.form.getFieldDecorator,i=n.triggerList,s=n.monitorRules,o=this.state,c=o.monitorId,u=o.havePart,_=o.visible,d=o.selectedIds,p=o.remark,m=a.monitorPartVOS?a.monitorPartVOS:[],E={selectedRowKeys:d,onChange:function(t){e.setState({selectedIds:t})}};return l.a.createElement("div",{className:"trigger-box"},l.a.createElement("div",{style:{overflow:"hidden",padding:"0px 10px 10px 0px"}},l.a.createElement(Kt.a,{type:"primary",onClick:this.newRemoteTrigger,style:{float:"right"}},"新增远程触发")),i.length>0&&l.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:this.initTriggerColumns(),pagination:!1,dataSource:i,scroll:{y:300}}),l.a.createElement("h2",null,"什么是远程触发？"),l.a.createElement("p",null,"您可以在自建的大数据平台或公有云平台上通过接口调用的形式,触发本系统中的数据质量校验任务执行。"),l.a.createElement("p",null,"典型的场景：您自建的大数据平台上对某张表进行ETL任务处理，需要在ETL任务处理前， 对此表的数据质量进行校验，校验通过后再启动后续的计算任务 （防止错误数据流入下一个计算环节，同时可以节约计算资源）。"),l.a.createElement("p",{style:{marginTop:10}},"配置的流程如下："),l.a.createElement("p",null,"1、在本平台配置表的数据质量检测任务，并在本页面开启远程触发"),l.a.createElement("p",null,"2、在您自建的大数据平台上，新建一个脚本任务，并编写调用的代码，详细的使用教程请参考",l.a.createElement("a",null,"《帮助文档》"),"；"),l.a.createElement("p",null,"3、在您自建的大数据平台上，将数据处理任务作为脚本任务的下游任务；"),l.a.createElement(lt.a,{title:"配置远程调用",wrapClassName:"remoteTriggerModal",width:"85%",visible:_,maskClosable:!1,okText:"生成远程调用API",cancelText:"取消",onOk:this.saveRemoteTrigger,onCancel:this.closeRemoteModal},u&&l.a.createElement("div",null,"分区：",l.a.createElement(gt.a,{style:{width:150},value:c?c.toString():void 0,onChange:this.onMonitorIdChange},m.map(function(e){return l.a.createElement(ba,{key:e.monitorId,value:e.monitorId.toString()},e.partValue?e.partValue:"全表")}))),l.a.createElement(q.a,{rowKey:"id",className:"m-table select-all-table",style:{padding:"16px 0"},pagination:!1,rowSelection:E,dataSource:s,columns:this.initRulesColumns()}),l.a.createElement(ta.a,null,l.a.createElement(Sa,M()({},Ae,{style:{marginBottom:0}}),r("remark",{rules:[{max:100,message:"备注不能超过100个字符"}],initialValue:p})(l.a.createElement(ka,{placeholder:"备注信息",className:"trigger-remarks",autosize:{minRows:3,maxRows:6},onChange:this.onRemarkChange}))))))}}]),t}(o.Component))||Oa;Ha=ta.a.create()(Ha);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ba,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(ka,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(Sa,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(La,"API_SERVER","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(wa,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(xa,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(Ha,"RemoteTriggerPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js")),a("SXSo");var Pa,Na,Ia=yt.a.Search,ja=gt.a.Option,Ua=ht.a.TabPane,Ma=function(e){return{ruleConfig:e.ruleConfig,dataSource:e.dataSource,common:e.common}},Fa=function(e){return{getMonitorLists:function(t){return e(pa.getMonitorLists(t))},getDataSourcesList:function(t){e(Be.getDataSourcesList(t))}}},Qa=Object(A.b)(Ma,Fa)(Pa=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={params:{pageIndex:1,pageSize:20,tableName:I.a.getParameterByName("tableName")||void 0,modifyUserId:void 0,sourceType:void 0,dataSourceId:void 0,isSubscribe:void 0,periodType:void 0},tabKey:"1",showSlidePane:!1,currentMonitor:{}},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribe=function(){var e;return(e=n).__onSubscribe__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderPeriodType=function(){var e;return(e=n).__renderPeriodType__REACT_HOT_LOADER__.apply(e,arguments)},n.onPeriodTypeChange=function(){var e;return(e=n).__onPeriodTypeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onDateChange=function(){var e;return(e=n).__onDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribeChange=function(){var e;return(e=n).__onSubscribeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.handleSearch=function(){var e;return(e=n).__handleSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.openSlidePane=function(){var e;return(e=n).__openSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.closeSlidePane=function(){var e;return(e=n).__closeSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.refresh=function(){var e;return(e=n).__refresh__REACT_HOT_LOADER__.apply(e,arguments)},n.onTabChange=function(){var e;return(e=n).__onTabChange__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getDataSourcesList(),this.props.getMonitorLists(this.state.params).then(function(t){if(t&&t.data&&t.data.data){var a=t.data.data.filter(function(e){return e.tableId==I.a.getParameterByName("tableId")});a&&a.length>0&&e.openSlidePane(a[0])}e.props.router.replace("/dq/rule")})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"表",dataIndex:"tableName",key:"tableName",render:function(t,a){return l.a.createElement("a",{onClick:e.openSlidePane.bind(e,a)},t)}},{title:"类型",dataIndex:"sourceTypeName",key:"sourceTypeName",render:function(e,t){return e?e+" / "+t.dataName:"--"}},{title:"执行周期",dataIndex:"periodTypeName",key:"periodTypeName"},{title:"最近30天告警数",dataIndex:"recentNotifyNum",key:"recentNotifyNum",sorter:!0},{title:"远程触发",dataIndex:"isRemoteTrigger",key:"isRemoteTrigger",render:function(e){return e?"已开启":""}},{title:"最近修改人",dataIndex:"modifyUser",key:"modifyUser"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return e?ne()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"操作",width:"10%",render:function(t,a){return l.a.createElement("span",null,l.a.createElement("a",{onClick:e.onSubscribe.bind(e,a)},a.isSubscribe?"取消订阅":"订阅"))}}]}},{key:"__onSubscribe__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.params;e.isSubscribe?ia.unSubscribeTable({tableId:e.tableId}).then(function(e){1===e.code&&(Wt.a.success("取消订阅成功"),t.props.getMonitorLists(a))}):ia.subscribeTable({tableId:e.tableId}).then(function(e){1===e.code&&(Wt.a.success("订阅成功"),t.props.getMonitorLists(a))})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=M()({},this.state.params,{pageIndex:e.current,sort:a.columnKey?"descend"===a.order?"desc":"asc":void 0});this.setState({params:n}),this.props.getMonitorLists(n)}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(ja,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,sourceType:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return l.a.createElement(ja,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,dataSourceId:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(ja,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,periodType:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(ja,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,lastModifyUserId:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__onDateChange__REACT_HOT_LOADER__",value:function(e,t){var a=M()({},this.state.params,{pageIndex:1,executeTime:e?e.valueOf():void 0});this.props.getMonitorLists(a),this.setState({params:a})}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,isSubscribe:e.target.checked?1:void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__handleSearch__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{pageIndex:1,tableName:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__openSlidePane__REACT_HOT_LOADER__",value:function(e){this.setState({showSlidePane:!0,currentMonitor:e})}},{key:"__closeSlidePane__REACT_HOT_LOADER__",value:function(){this.setState({showSlidePane:!1,currentMonitor:{},tabKey:"1"})}},{key:"__refresh__REACT_HOT_LOADER__",value:function(){this.closeSlidePane(),this.props.getMonitorLists(this.state.params)}},{key:"__onTabChange__REACT_HOT_LOADER__",value:function(e){this.setState({tabKey:e})}},{key:"render",value:function(){var e=this.props.ruleConfig,t=e.monitorList,a=e.loading,n=this.props.dataSource,r=n.sourceType,i=n.sourceList,s=this.props.common,o=s.userList,c=s.allDict,u=this.state,_=u.params,d=u.showSlidePane,p=u.currentMonitor,m=u.tabKey,E={current:_.pageIndex,pageSize:_.pageSize,total:t?t.totalCount:0},h=c.periodType?c.periodType:[],T=l.a.createElement("div",{className:"flex font-12"},l.a.createElement(Ia,{placeholder:"输入表名搜索",onSearch:this.handleSearch,defaultValue:_.tableName,style:{width:200,margin:"10px 0"}}),l.a.createElement("div",{className:"m-l-8"},"类型：",l.a.createElement(gt.a,{allowClear:!0,style:{width:150},placeholder:"选择数据源类型",onChange:this.onSourceChange},this.renderSourceType(r))),l.a.createElement("div",{className:"m-l-8"},"数据源：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源",onChange:this.onUserSourceChange},this.renderUserSource(i))),l.a.createElement("div",{className:"m-l-8"},"执行周期：",l.a.createElement(gt.a,{allowClear:!0,style:{width:150},placeholder:"选择执行周期",onChange:this.onPeriodTypeChange},this.renderPeriodType(h))),l.a.createElement("div",{className:"m-8"},"最近修改人：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"name",placeholder:"选择最近修改人",onChange:this.onUserChange},this.renderUserList(o))),l.a.createElement("div",{className:"m-l-8"},l.a.createElement(st.a,{onChange:this.onSubscribeChange},"我订阅的表"))),g=l.a.createElement(Kt.a,{type:"primary",style:{margin:"10px 0"}},l.a.createElement(C.c,{to:"/dq/rule/add"},"新建监控规则"));return l.a.createElement("div",{className:"rule-dashboard"},l.a.createElement("h1",{className:"box-title"},"监控规则"),l.a.createElement("div",{className:"box-2 m-card shadow"},l.a.createElement(K.a,{title:T,extra:g,noHovering:!0,bordered:!1},l.a.createElement(q.a,{rowClassName:function(e,t){return p&&p.tableId==e.tableId?"row-select":""},rowKey:"tableId",className:"m-table",columns:this.initColumns(),loading:a,pagination:E,dataSource:t.data,onChange:this.onTableChange}),l.a.createElement(Rt.a,{onClose:this.closeSlidePane,visible:d,className:"slide-pane-box",style:{right:"0px",width:"80%",height:"100%",minHeight:"650px"}},l.a.createElement("div",{className:"m-tabs"},l.a.createElement(ht.a,{animated:!1,activeKey:m,onChange:this.onTabChange},l.a.createElement(Ua,{tab:"规则管理",key:"1"},l.a.createElement(Aa,{data:p,closeSlidePane:this.closeSlidePane,refresh:this.refresh})),l.a.createElement(Ua,{tab:"远程触发",key:"2"},l.a.createElement(Ha,{data:p,closeSlidePane:this.closeSlidePane}))))))))}}]),t}(o.Component))||Pa,Va=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ia,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(ja,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Ua,"TabPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Ma,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Fa,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Qa,"RuleConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js")),a("PzEo"),a("+vAN")),Ga=a.n(Va),za=(a("Hjg5"),a("rmht")),qa=a.n(za),Ya=a("iEKX"),Ka=ta.a.Item,Ba=gt.a.Option,Wa=qa.a.TreeNode,Ja=function(e){return{dataSource:e.dataSource}},Xa=function(e){return{getDataSourcesList:function(t){e(Be.getDataSourcesList(t))},getDataSourcesTable:function(t){e(Be.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(Be.resetDataSourcesTable())},getDataSourcesPart:function(t){e(Be.getDataSourcesPart(t))},resetDataSourcesPart:function(){e(Be.resetDataSourcesPart())}}},Za=Object(A.b)(Ja,Xa)(Na=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.renderSourceType=function(){return a.__renderSourceType__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSourceTable=function(){return a.__renderSourceTable__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.havePartition=function(){return a.__havePartition__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourceTypeChange=function(){return a.__onSourceTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onTableChange=function(){return a.__onTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.handleInputPartChange=function(){return a.__handleInputPartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.partHintText=function(){return a.__partHintText__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onSubscribeChange=function(){return a.__onSubscribeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderColumnPart=function(){return a.__renderColumnPart__REACT_HOT_LOADER__.apply(a,arguments)},a.onPartitionTypeChange=function(){return a.__onPartitionTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{},loading:!1},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.props.getDataSourcesList()}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return l.a.createElement(Ba,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__renderSourceTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Ba,{key:e,value:e},e)})}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(vt.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?l.a.createElement(Wa,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e)):l.a.createElement(Wa,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__havePartition__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.dataSource.sourceList.forEach(function(a){a.id==e&&t.props.changeHavePart(7===a.type||10===a.type)})}},{key:"checkMonitor",value:function(){var e=this,t=this.props,a=t.editParams,n=t.havePart,r={tableName:a.tableName,dataSourceId:a.dataSourceId,partition:n?a.partition:void 0};return this.setState({loading:!0}),ia.checkMonitor(r).then(function(t){if(e.setState({loading:!1}),t&&t.data)return t.data;if(1!=t.code)throw new Error(t.message);return null})}},{key:"__onSourceTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=(t.editParams,{dataSourceId:e,rules:[],partition:void 0});this.havePartition(e),this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:e}),a.setFieldsValue({sourceTable:void 0}),n&&(this.props.resetDataSourcesPart(),a.setFieldsValue({partition:void 0,partitionInput:"column=${sys.recentPart}"})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams(r)}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams,i={tableName:e,rules:[],partition:void 0};n&&(this.props.resetDataSourcesPart(),a.setFieldsValue({partition:void 0,partitionInput:"column=${sys.recentPart}"}),this.props.getDataSourcesPart({sourceId:r.dataSourceId,table:e})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams(i)}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams,a=t.dataSourceId,n=t.tableName,r=t.partition,i=this.state.showPreview;a&&n?(i||Ke.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!i})):Wt.a.error("未选择数据源或表")}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({partition:n})}},{key:"__handleInputPartChange__REACT_HOT_LOADER__",value:function(e){var t=e.target.value?e.target.value:void 0;this.props.changeParams({partition:t})}},{key:"__partHintText__REACT_HOT_LOADER__",value:function(){return l.a.createElement("p",{className:"font-14"},"支持填写系统参数，格式为：column=${sys.recentPart}，column为分区字段名，需要您根据情况修改，${sys.recentPart}为系统参数，系统每次执行时会对最新的1个分区的数据做校验")}},{key:"jumpToEditRule",value:function(e,t){this.modal&&this.modal.destroy(),C.g.push({pathname:"/dq/rule",query:{tableName:e.tableName,tableId:e.tableId}})}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.currentStep,n=t.navToStep;t.form.validateFields({force:!0},function(t,r){t||e.checkMonitor().then(function(t){if(t){var r=lt.a.warning({title:"该规则配置已存在",content:l.a.createElement("span",null,"该规则配置已存在，您可以直接前往",l.a.createElement("a",{onClick:e.jumpToEditRule.bind(e,t)}," 编辑"))});e.modal=r}else n(a+1)})})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){if(e)return e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return l.a.createElement(Ya.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.sourcePreview&&this.state.sourcePreview.columnList;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=e.target.checked?1:0;this.props.changeParams({isSubscribe:t})}},{key:"__renderColumnPart__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.editParams,a=e.form,n=e.dataSource,r=e.useInput,i=t.partition,s=n.sourcePart,o=a.getFieldDecorator;return r?l.a.createElement(Ka,M()({},Re,{label:"输入分区",extra:this.partHintText()}),o("partitionInput",{rules:[],initialValue:i||"column=${sys.recentPart}"})(l.a.createElement(yt.a,{style:{width:"85%",marginRight:15},placeholder:"手动输入分区的格式为：分区字段=分区值，如column=${sys.recentPart}",onChange:this.handleInputPartChange})),l.a.createElement("a",{onClick:this.onPartitionTypeChange},"选择已有分区")):l.a.createElement(Ka,M()({},Re,{label:"选择分区"}),o("partition",{rules:[],initialValue:i})(l.a.createElement(qa.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",style:{width:"85%",marginRight:15},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(s))),l.a.createElement("a",{onClick:this.onPartitionTypeChange},"手动输入"))}},{key:"__onPartitionTypeChange__REACT_HOT_LOADER__",value:function(){var e=this.props.useInput;this.props.changeParams({partition:void 0}),this.props.changeUseInput(!e)}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.editParams,n=e.dataSource,r=e.havePart,i=t.getFieldDecorator,s=a.dataSourceId,o=a.tableName,c=n.sourceList,u=n.sourceTable,_=n.tableLoading,d=this.state,p=d.showPreview,m=d.sourcePreview,E=d.loading;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement(ta.a,null,l.a.createElement(Ka,M()({},Re,{label:"选择数据源"}),i("sourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:s?s.toString():s})(l.a.createElement(gt.a,{showSearch:!0,optionFilterProp:"title",style:{width:"85%",marginRight:15},onChange:this.onSourceTypeChange,disabled:_},this.renderSourceType(c)))),l.a.createElement(Ka,M()({},Re,{label:"选择数据表"}),i("sourceTable",{rules:[{required:!0,message:"请选择数据表"}],initialValue:o})(l.a.createElement(gt.a,{mode:"combobox",showSearch:!0,style:{width:"85%",marginRight:15},onChange:this.onTableChange},this.renderSourceTable(u))),o&&l.a.createElement(st.a,{checked:!0,onChange:this.onSubscribeChange},"订阅")),r&&this.renderColumnPart(),l.a.createElement("div",{className:"txt-center font-14"},l.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",l.a.createElement(dt.a,{type:"down",style:{marginLeft:5}}))),p&&l.a.createElement(q.a,{rowKey:"key",className:"m-table m-cells preview-table",columns:this.previewTableColumns(m.columnList),dataSource:m.dataList,pagination:!1,scroll:{x:this.getScroll()}}))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,null,l.a.createElement(C.c,{to:"/dq/rule"},"取消")),l.a.createElement(Kt.a,{loading:E,className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(o.Component))||Na;Za=ta.a.create()(Za);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ka,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Ba,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Wa,"TreeNode","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Ja,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Xa,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Za,"StepOne","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"));var $a,en=ta.a.Item,tn=gt.a.Option,an=yt.a.TextArea,nn=function(e){return{ruleConfig:e.ruleConfig,common:e.common}},rn=function(e){return{getRuleFunction:function(t){e(pa.getRuleFunction(t))},getTableColumn:function(t){e(pa.getTableColumn(t))}}},sn=Object(A.b)(nn,rn)($a=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.changeRuleParams=function(){return a.__changeRuleParams__REACT_HOT_LOADER__.apply(a,arguments)},a.onColumnNameChange=function(){return a.__onColumnNameChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onFunctionChange=function(){return a.__onFunctionChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onVerifyTypeChange=function(){return a.__onVerifyTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderEditTD=function(){return a.__renderEditTD__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTD=function(){return a.__renderTD__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRuleWrap=function(){return a.__addNewRuleWrap__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRule=function(){return a.__addNewRule__REACT_HOT_LOADER__.apply(a,arguments)},a.state={currentRule:{},functionList:[],enumFields:["columnName","functionId","thresholdEnum"],SQLFields:["customizeSql","verifyType","operator","threshold"],columnFields:["columnName","functionId","verifyType","operator","threshold"]},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props.editParams;this.props.getRuleFunction(),this.props.getTableColumn({sourceId:e.dataSourceId,tableName:e.tableName})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep,n=this.state.currentRule;Object(vt.isEmpty)(n)?a(t-1):(this.cancel(n.id),a(t-1))}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep,n=e.editParams,r=this.state.currentRule;n.rules.length?Object(vt.isEmpty)(r)?a(t+1):this.save(r.id,function(){a(t+1)}):Wt.a.error("请添加监控规则")}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段/数据表",dataIndex:"columnName",key:"columnName",render:function(t,a){return e.renderColumns(t,a,"columnName")},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(t,a){return e.renderColumns(t,a,"functionId")},width:"15%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(t,a){return e.renderColumns(t,a,"filter")},width:"25%"},{title:"校验方法",dataIndex:"verifyType",key:"verifyType",render:function(t,a){return e.renderColumns(t,a,"verifyType")},width:"15%"},{title:"阈值配置（不符合阈值条件时触发告警）",dataIndex:"threshold",key:"threshold",render:function(t,a){return e.renderColumns(t,a,"threshold")},width:"20%"},{title:"操作",width:"10%",render:function(t,a){var n=a.editable;return l.a.createElement("div",null,n?l.a.createElement("span",null,l.a.createElement("a",{className:"m-r-8",onClick:function(){return e.save(a.id)}},"保存"),l.a.createElement("a",{onClick:function(){return e.cancel(a.id)}},"取消")):l.a.createElement("span",null,l.a.createElement("a",{className:"m-r-8",onClick:function(){return e.edit(a.id)}},"编辑"),l.a.createElement($t.a,{title:"确定要删除吗？",onConfirm:function(){return e.delete(a.id)}},l.a.createElement("a",null,"删除"))))}}]}},{key:"renderColumns",value:function(e,t,a){var n={children:l.a.createElement(ta.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}};if(t.isCustomizeSql)switch(a){case"columnName":n.props.colSpan=3;break;case"functionId":case"filter":n.props.colSpan=0}return n}},{key:"__changeRuleParams__REACT_HOT_LOADER__",value:function(e,t){var a={};a[e]=t.target?t.target.value:t,this.setState({currentRule:M()({},this.state.currentRule,a)})}},{key:"__onColumnNameChange__REACT_HOT_LOADER__",value:function(e){var t=this.state.currentRule,a=this.props,n=a.form,r=a.ruleConfig,i=r.tableColumn,s=r.monitorFunction[i.filter(function(t){return t.key===e})[0].type],o={};o["functionId@"+t.id]=void 0,n.setFieldsValue(o),this.setState({functionList:s,currentRule:M()({},t,{columnName:e,functionId:void 0})})}},{key:"__onFunctionChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state,n=a.functionList,r=a.currentRule,i=n.filter(function(t){return t.id==e})[0].isPercent,s=n.filter(function(t){return t.id==e})[0].nameZc,o="枚举值"===s,l=M()({},this.state.currentRule,{functionId:e,functionName:s,verifyType:o?"1":void 0,operator:o?"in":void 0,isPercentage:i,percentType:1===i?"limit":"free"}),c={};c["verifyType@"+r.id]=o?"1":void 0,c["operator@"+r.id]=void 0,t.setFieldsValue(c),this.setState({currentRule:l})}},{key:"__onVerifyTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.common.allDict.verifyType,a=M()({},this.state.currentRule,{verifyType:e,verifyTypeValue:t.filter(function(t){return t.value==e})[0].name});"limit"!==a.percentType&&(a.isPercentage=1==e?0:1),this.setState({currentRule:a})}},{key:"__renderEditTD__REACT_HOT_LOADER__",value:function(e,t,a){var n,r=this.props,i=r.form,s=r.common,o=r.ruleConfig,c=i.getFieldDecorator,u=o.tableColumn,_=s.allDict.verifyType,d=this.state,p=d.currentRule,m=d.functionList,E="字符串最大长度"===(n=p.functionName)||"字符串最小长度"===n?ge:Te;switch(a){case"columnName":return t.isCustomizeSql?l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("customizeSql@"+t.id,{rules:[{required:!0,message:"自定义SQL不可为空"}],initialValue:t.customizeSql})(t.isCustomizeSql?l.a.createElement(an,{style:{resize:"vertical"},autosize:{minRows:3,maxRows:8},placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}):l.a.createElement(yt.a,{placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql"),disabled:"edit"===t.editStatus}))):l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("columnName@"+t.id,{rules:[{required:!0,message:"字段不可为空"}],initialValue:t.columnName})(l.a.createElement(gt.a,{showSearch:!0,onChange:this.onColumnNameChange,disabled:t.isTable},u.map(function(e){return l.a.createElement(tn,{key:e.key,value:e.key},e.key)}))));case"functionId":return l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("functionId@"+t.id,{rules:[{required:!0,message:"统计函数不可为空"}],initialValue:t.functionId})(l.a.createElement(gt.a,{onChange:this.onFunctionChange},m.map(function(e){return l.a.createElement(tn,{key:e.id,value:e.id.toString()},e.nameZc)}))));case"filter":return l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("filter@"+t.id,{rules:[],initialValue:t.filter})(l.a.createElement(yt.a,{placeholder:'以"and"开头的条件语句，例：and colA = "value"',onChange:this.changeRuleParams.bind(this,"filter")})));case"verifyType":return l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("verifyType@"+t.id,{rules:[{required:!0,message:"校验方法不可为空"}],initialValue:t.verifyType})(l.a.createElement(gt.a,{onChange:this.onVerifyTypeChange,disabled:"in"===p.operator},_.map(function(e){return l.a.createElement(tn,{key:e.value,value:e.value.toString()},e.name)}))));case"threshold":return"in"===p.operator?l.a.createElement(en,M()({},Ae,{className:"rule-edit-td cell-center"}),c("thresholdEnum@"+t.id,{rules:[{required:!0,message:"范围不可为空"}],initialValue:t.threshold})(l.a.createElement(yt.a,{placeholder:"枚举格式为(value1,value2,.....)",onChange:this.changeRuleParams.bind(this,"threshold")}))):l.a.createElement("div",{className:"cell-center-box"},l.a.createElement(en,{className:"cell-multiple-center"},c("operator@"+t.id,{rules:[{required:!0,message:"设置不可为空"}],initialValue:t.operator})(l.a.createElement(gt.a,{style:{width:80},onChange:this.changeRuleParams.bind(this,"operator")},E.map(function(e){return l.a.createElement(tn,{key:e.value,value:e.value},e.text)})))),l.a.createElement(en,{className:"cell-multiple-center"},c("threshold@"+t.id,{rules:[{required:!0,message:"阈值不可为空"}],initialValue:t.threshold})(l.a.createElement(Xt.a,{style:{width:80,marginRight:10},onChange:this.changeRuleParams.bind(this,"threshold")}))),1===p.isPercentage&&l.a.createElement("span",{style:{height:32,lineHeight:"32px"}},"%"))}}},{key:"__renderTD__REACT_HOT_LOADER__",value:function(e,t,a){switch(a){case"columnName":return t.isCustomizeSql?t.customizeSql:e;case"functionId":return t.functionName;case"verifyType":return t.verifyTypeValue;case"threshold":var n=(t.operator?t.operator:"")+"  "+e;return t.isPercentage?n+" %":n;default:return e}}},{key:"edit",value:function(e){var t=this.state.currentRule,a=this.props.ruleConfig,n=a.monitorFunction,r=a.tableColumn,i=[],s=[].concat(xt()(this.props.editParams.rules)),o=s.filter(function(t){return e===t.id})[0];if(!Object(vt.isEmpty)(t)){var l=s.filter(function(e){return t.id===e.id})[0];"edit"===l.editStatus?(delete l.editable,delete l.editStatus):s.shift()}if(o){if(o.editable=!0,o.editStatus="edit",!o.isCustomizeSql)if(o.isTable)i=n.all.filter(function(e){return 1===e.level});else i=n[r.filter(function(e){return e.key===o.columnName})[0].type];this.setState({currentRule:o,functionList:i}),this.props.changeParams({rules:s})}}},{key:"cancel",value:function(e){var t=[].concat(xt()(this.props.editParams.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);"edit"===a.editStatus?(delete a.editable,delete a.editStatus):t.splice(n,1),this.setState({currentRule:{}}),this.props.changeParams({rules:t})}},{key:"delete",value:function(e){var t=[].concat(xt()(this.props.editParams.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);a&&(t.splice(n,1),this.props.changeParams({rules:t}))}},{key:"checkRepeat",value:function(){for(var e=this.state.currentRule,t=[].concat(xt()(this.props.editParams.rules)),a=["columnName","filter","functionId","verifyType","customizeSql","operator"],n=!0,r=0;r<t.length;r++){var i=t[r],s=!1;if(i.id!=e.id){for(var o=0;o<a.length;o++){var l=a[o];if(e[l]!=i[l]){s=!0;break}}if(!s){n=!1;break}}}return n}},{key:"save",value:function(e,t){var a=this,n=this.state,r=n.currentRule,i=n.enumFields,s=n.SQLFields,o=n.columnFields,l=[].concat(xt()(this.props.editParams.rules)),c=l.filter(function(t){return e===t.id})[0],u=l.indexOf(c);r.isCustomizeSql;r.operator,this.checkRepeat()?this.props.form.validateFields(null,{force:!0},function(e,n){e||(delete r.editStatus,delete r.editable,l[u]=r,a.setState({currentRule:{}},function(){t&&t()}),a.props.changeParams({rules:l}))}):Wt.a.error("规则不能重复！")}},{key:"__addNewRuleWrap__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.currentRule;Object(vt.isEmpty)(a)?this.addNewRule(e):this.save(a.id,function(){t.addNewRule(e)})}},{key:"__addNewRule__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.editParams,r=t.ruleConfig.monitorFunction,i=this.state.currentRule,s=[].concat(xt()(n.rules));Object(vt.isEmpty)(i)||("edit"===i.editStatus?(delete i.editable,delete i.editStatus):(s.shift(),a.resetFields(),this.setState({currentRule:{},functionList:[]})));var o={id:s[0]?s[0].id+1:1,editStatus:"new",editable:!0,filter:"",verifyType:void 0,operator:void 0,threshold:void 0};switch(e){case"column":o.isCustomizeSql=!1,o.columnName=void 0,o.functionId=void 0;break;case"SQL":o.isCustomizeSql=!0,o.customizeSql=void 0;break;case"table":o.isTable=!0,o.isCustomizeSql=!1,o.columnName=n.tableName,o.functionId=void 0,this.setState({functionList:r.all.filter(function(e){return 1===e.level})})}s.unshift(o),this.setState({currentRule:o}),this.props.changeParams({rules:s})}},{key:"render",value:function(){var e=this.props.editParams.rules;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement("div",{className:"rule-action"},l.a.createElement(Kt.a,{type:"primary",onClick:this.addNewRuleWrap.bind(this,"table")},"添加表级规则"),l.a.createElement(Kt.a,{type:"primary",className:"m-l-8",onClick:this.addNewRuleWrap.bind(this,"column")},"添加字段级规则"),l.a.createElement(Kt.a,{type:"primary",className:"m-l-8",onClick:this.addNewRuleWrap.bind(this,"SQL")},"添加自定义SQL")),l.a.createElement(q.a,{rowKey:"id",className:"m-table rule-edit-table",style:{margin:"0 20px"},columns:this.initColumns(),pagination:!1,dataSource:e,onChange:this.onTableChange})),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,{onClick:this.prev},"上一步"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(o.Component))||$a;sn=ta.a.create()(sn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(en,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(tn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(an,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(nn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(rn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(sn,"StepTwo","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"));var on,ln=ta.a.Item,cn=gt.a.Option,un={beginDate:ne()().format("YYYY-MM-DD"),endDate:ne()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},_n=function(e){return{common:e.common}},dn=function(e){return{addMonitor:function(t){e(pa.addMonitor(t))}}},pn=Object(A.b)(_n,dn)(on=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.initState=function(){return a.__initState__REACT_HOT_LOADER__.apply(a,arguments)},a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.renderPeriodType=function(){return a.__renderPeriodType__REACT_HOT_LOADER__.apply(a,arguments)},a.onPeriodTypeChange=function(){return a.__onPeriodTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSendTypeList=function(){return a.__renderSendTypeList__REACT_HOT_LOADER__.apply(a,arguments)},a.onSendTypeChange=function(){return a.__onSendTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.onNotifyUserChange=function(){return a.__onNotifyUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.onBeginDateChange=function(){return a.__onBeginDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onEndDateChange=function(){return a.__onEndDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onWebHookChange=function(){return a.__onWebHookChange__REACT_HOT_LOADER__.apply(a,arguments)},a.checkTime=function(){return a.__checkTime__REACT_HOT_LOADER__.apply(a,arguments)},a.checkDate=function(){return a.__checkDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={scheduleConfObj:un},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.initState()}},{key:"__initState__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.scheduleConf;e&&this.setState({scheduleConfObj:JSON.parse(e)})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(e){var t=M()({},un,{periodType:e});this.setState({scheduleConfObj:t}),this.props.changeParams({scheduleConf:na()(t)})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(cn,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){this.resetScheduleConf(e)}},{key:"__renderSendTypeList__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return l.a.createElement(st.a,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSendTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("notifyUser");0===e.length&&0===a.length&&t.setFieldsValue({notifyUser:[]}),this.props.changeParams({sendTypes:e})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(cn,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__onNotifyUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("sendTypes");0===e.length&&0===a.length&&t.setFieldsValue({sendTypes:[]}),this.props.changeParams({notifyUser:e})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t){var a=this.state.scheduleConfObj,n={};n[e]=t;var r=M()({},a,n);this.setState({scheduleConfObj:r}),this.props.changeParams({scheduleConf:na()(r)})}},{key:"__onBeginDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("beginDate",t)}},{key:"__onEndDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("endDate",t)}},{key:"__onWebHookChange__REACT_HOT_LOADER__",value:function(e){this.props.changeParams({webhook:e.target.value})}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common.allDict,r=a.getFieldDecorator,i=this.state.scheduleConfObj,s=(n.periodType&&n.periodType,function(t){for(var a=[],n=0;n<=23;n++)a.push(l.a.createElement(cn,{key:n,value:""+n},n<10?"0"+n:n));return l.a.createElement(gt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,t)},a)}),o=function(t){for(var a=[],n=0;n<=59;n++)a.push(l.a.createElement(cn,{key:n,value:""+n},n<10?"0"+n:n));return l.a.createElement(gt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(i.periodType){case"1":return l.a.createElement("div",null,l.a.createElement(ln,M()({},ve,{label:"开始时间"}),r("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.beginHour})(s("beginHour")),l.a.createElement("span",{className:"m-8"},"时"),r("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.beginMin})(o("beginMin")),l.a.createElement("span",{className:"m-8"},"分")),l.a.createElement(ln,M()({},ve,{label:"间隔时间"}),r("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:i.gapHour?i.gapHour:""})(function(){for(var t=[],a=1;a<=23;a++)t.push(l.a.createElement(cn,{key:a,value:""+a},a,"小时"));return l.a.createElement(gt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),l.a.createElement(ln,M()({},ve,{label:"结束时间"}),r("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.endHour})(s("endHour")),l.a.createElement("span",{className:"m-8"},"时"),r("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+i.endMin})(o("endMin")),l.a.createElement("span",{className:"m-8"},"分")));case"2":return l.a.createElement(ln,M()({},ve,{label:"起调时间"}),r("hour",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分"));case"3":return l.a.createElement("div",null,l.a.createElement(ln,M()({},ve,{label:"选择时间"}),r("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:i.weekDay?i.weekDay:[]})(l.a.createElement(gt.a,{mode:"multiple",style:{width:428},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},l.a.createElement(cn,{key:1,value:"1"},"星期一"),l.a.createElement(cn,{key:2,value:"2"},"星期二"),l.a.createElement(cn,{key:3,value:"3"},"星期三"),l.a.createElement(cn,{key:4,value:"4"},"星期四"),l.a.createElement(cn,{key:5,value:"5"},"星期五"),l.a.createElement(cn,{key:6,value:"6"},"星期六"),l.a.createElement(cn,{key:7,value:"7"},"星期天")))),l.a.createElement(ln,M()({},ve,{label:"起调时间"}),r("hour1",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min1",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分")));case"4":return l.a.createElement("div",null,l.a.createElement(ln,M()({},ve,{label:"选择时间"}),r("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:i.day?i.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(l.a.createElement(cn,{key:a,value:""+a},"每月"+a+"号"));return l.a.createElement(gt.a,{mode:"multiple",style:{width:428},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),l.a.createElement(ln,M()({},ve,{label:"起调时间"}),r("hour2",{rules:[{required:!0}],initialValue:""+i.hour})(s("hour")),l.a.createElement("span",{className:"m-8"},"时"),r("min2",{rules:[{required:!0}],initialValue:""+i.min})(o("min")),l.a.createElement("span",{className:"m-8"},"分")))}}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginHour"),i=n.getFieldValue("beginMin"),s=n.getFieldValue("endHour"),o=n.getFieldValue("endMin");60*parseInt(r)+parseInt(i)>=60*parseInt(s)+parseInt(o)?a("开始时间不能晚于结束时间"):n.setFieldsValue({beginHour:r,beginMin:i,endHour:s,endMin:o}),a()}},{key:"__checkDate__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginDate"),i=n.getFieldValue("endDate");r&&i?r.valueOf()>i.valueOf()?a("生效日期的开始时间不能晚于结束时间"):n.setFieldsValue({beginDate:r,endDate:i}):a(),a()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.form,n=t.editParams,r=t.havePart;a.validateFields(function(t,a){t&&t.endDate&&Wt.a.error(t.endDate.errors[0].message),t||(n.rules.forEach(function(e){delete e.id,delete e.isTable,delete e.percentType,delete e.functionName,delete e.verifyTypeValue}),r||(n.partition=void 0),e.props.addMonitor(M()({},n)),setTimeout(function(){C.g.push("/dq/rule")},1e3))})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.editParams,r=t.getFieldDecorator,i=a.allDict,s=a.userList,o=n.notifyUser,c=n.sendTypes,u=n.webhook,_=this.state.scheduleConfObj,d=i.periodType?i.periodType:[],p=i.notifyType?i.notifyType:[],m=c?c.map(function(e){return e.toString()}):[],E=m.indexOf(le.DINGDING)>-1;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement(ta.a,null,l.a.createElement(ln,M()({},ve,{label:"调度周期"}),r("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+_.periodType})(l.a.createElement(gt.a,{onChange:this.onPeriodTypeChange},this.renderPeriodType(d)))),5!=_.periodType&&l.a.createElement(ln,M()({},ve,{label:"生效日期"}),r("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:ne()(_.beginDate)})(l.a.createElement(mt.a,{style:{width:200},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),l.a.createElement("span",{className:"m-8"},"到"),r("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:ne()(_.endDate)})(l.a.createElement(mt.a,{style:{width:200},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),l.a.createElement(ln,M()({},ve,{label:"告警方式"}),r("sendTypes",{rules:[{required:o.length,message:"选择告警方式"}],initialValue:m})(l.a.createElement(st.a.Group,{onChange:this.onSendTypeChange},this.renderSendTypeList(p)))),E&&l.a.createElement(ln,M()({},ve,{label:"webhook"}),r("webhook",{rules:[{required:!0,message:"webhook不能为空"}],initialValue:u||""})(l.a.createElement(yt.a,{onChange:this.onWebHookChange}))),l.a.createElement(ln,M()({},ve,{label:"告警接收人"}),r("notifyUser",{rules:[{required:c.length,message:"选择告警接收人"}],initialValue:o.map(function(e){return e.toString()})})(l.a.createElement(gt.a,{allowClear:!0,mode:"multiple",onChange:this.onNotifyUserChange},this.renderUserList(s)))))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,{onClick:this.prev},"上一步"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.save},"新建")))}}]),t}(o.Component))||on;pn=ta.a.create()(pn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ln,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(cn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(un,"initialSchedule","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(_n,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(dn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(pn,"StepThree","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"));var mn,En,hn=a("ER3F"),Tn=Ga.a.Step,gn=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={current:0,editParams:{dataSourceId:void 0,tableName:void 0,partition:"column=${sys.recentPart}",isSubscribe:1,scheduleConf:"",sendTypes:[],webhook:"",notifyUser:[],rules:[]},havePart:!1,useInput:!0},n.changeParams=function(){var e;return(e=n).__changeParams__REACT_HOT_LOADER__.apply(e,arguments)},n.changeHavePart=function(){var e;return(e=n).__changeHavePart__REACT_HOT_LOADER__.apply(e,arguments)},n.changeUseInput=function(){var e;return(e=n).__changeUseInput__REACT_HOT_LOADER__.apply(e,arguments)},n.navToStep=function(){var e;return(e=n).__navToStep__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"__changeParams__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.editParams,e);this.setState({editParams:t})}},{key:"__changeHavePart__REACT_HOT_LOADER__",value:function(e){this.setState({havePart:e})}},{key:"__changeUseInput__REACT_HOT_LOADER__",value:function(e){this.setState({useInput:e})}},{key:"__navToStep__REACT_HOT_LOADER__",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.editParams,n=e.havePart,r=e.useInput,i=[{title:"监控对象",content:l.a.createElement(Za,{currentStep:t,navToStep:this.navToStep,havePart:n,useInput:r,editParams:a,changeParams:this.changeParams,changeHavePart:this.changeHavePart,changeUseInput:this.changeUseInput})},{title:"监控规则",content:l.a.createElement(sn,{currentStep:t,navToStep:this.navToStep,editParams:a,changeParams:this.changeParams})},{title:"调度属性",content:l.a.createElement(pn,{currentStep:t,havePart:n,navToStep:this.navToStep,editParams:a,changeParams:this.changeParams})}];return l.a.createElement("div",{className:"box-1 rule-edit"},l.a.createElement("h1",{className:"box-title"},l.a.createElement(hn.a,null),l.a.createElement("span",{className:"m-l-8"},"新建质量监控")),l.a.createElement("div",{className:"steps-container"},l.a.createElement(Ga.a,{current:t},i.map(function(e){return l.a.createElement(Tn,{key:e.title,title:e.title})})),i[t].content))}}]),t}(o.Component),fn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Tn,"Step","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/index.js"),__REACT_HOT_LOADER__.register(gn,"RuleConfigEdit","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/ruleConfig/edit/index.js")),a("G851"),a("ZvzK")),yn=a.n(fn),Rn=(a("PFYH"),a("Jv8k")),vn=a.n(Rn),Cn=a("YXul"),An={getLists:function(e){return be.a.post(ke.a.GET_CHECK_LIST,e)},getCheckDetail:function(e){return be.a.post(ke.a.GET_CHECK_DETAIL,e)},addCheck:function(e){return be.a.post(ke.a.ADD_CHECK,e)},updateCheck:function(e){return be.a.post(ke.a.UPDATE_CHECK,e)},deleteCheck:function(e){return be.a.post(ke.a.DELETE_CHECK,e)},getCheckReport:function(e){return be.a.post(ke.a.GET_CHECK_REPORT,e)},getCheckReportTable:function(e){return be.a.post(ke.a.GET_CHECK_REPORT_TABLE,e)},updateTaskParams:function(e){return be.a.post(ke.a.UPDATE_CHECK_ENV_PARAMS,e)}},On=An,Dn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(An,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/api/dataCheck.js"),{getLists:function(e){return function(t){t({type:Cn.a.CHANGE_LOADING}),On.getLists(e).then(function(e){1===e.code&&t({type:Cn.a.GET_LIST,payload:e.data}),t({type:Cn.a.CHANGE_LOADING})})}},getCheckDetail:function(e){return function(t){On.getCheckDetail(e).then(function(e){1===e.code&&t({type:Cn.a.GET_CHECK_DETAIL,payload:e.data})})}},getSourcePart:function(e,t){return function(a){Ke.getDataSourcesPart(e).then(function(e){1===e.code&&a({type:Cn.a.GET_SOURCE_PART,payload:{data:e.data?e.data:[],type:t}})})}},resetSourcePart:function(e){return function(t){t({type:Cn.a.RESET_SOURCE_PART,payload:e})}},changeParams:function(e){return function(t){t({type:Cn.a.CHANGE_PARAMS,payload:e})}},addCheck:function(e){return function(t){On.addCheck(e).then(function(e){1===e.code&&Wt.a.success("操作成功",2)})}},updateCheck:function(e){return function(t){On.updateCheck(e).then(function(e){1===e.code&&Wt.a.success("操作成功",2)})}},deleteCheck:function(e){return function(t){On.deleteCheck(e).then(function(e){1===e.code&&Wt.a.success("删除成功",2)})}}}),bn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Dn,"dataCheckActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/dataCheck/index.js"),a("WyGn"),yt.a.Search),kn=gt.a.Option,Sn=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource,common:e.common}},Ln=function(e){return{getLists:function(t){e(Dn.getLists(t))},getDataSourcesList:function(t){e(Be.getDataSourcesList(t))}}},wn=Object(A.b)(Sn,Ln)(mn=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={params:{currentPage:1,pageSize:20,tableName:void 0,lastModifyUserId:void 0,executeTime:void 0,visibleEnvModal:!1,selectedRecord:""}},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.enableCheckReport=function(){var e;return(e=n).__enableCheckReport__REACT_HOT_LOADER__.apply(e,arguments)},n.deleteDataCheck=function(){var e;return(e=n).__deleteDataCheck__REACT_HOT_LOADER__.apply(e,arguments)},n.updateEnvParams=function(){var e;return(e=n).__updateEnvParams__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderCheckStatus=function(){var e;return(e=n).__renderCheckStatus__REACT_HOT_LOADER__.apply(e,arguments)},n.onCheckStatusChange=function(){var e;return(e=n).__onCheckStatusChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onDateChange=function(){var e;return(e=n).__onDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableSearch=function(){var e;return(e=n).__onTableSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.disabledDate=function(){var e;return(e=n).__disabledDate__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.props.getDataSourcesList(),this.props.getLists(this.state.params)}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"左侧表",dataIndex:"originTableName",key:"originTableName",width:"11%"},{title:"分区",dataIndex:"originPartition",key:"originPartition",width:"11%",render:function(e,t){return e||"--"}},{title:"右侧表",dataIndex:"targetTableName",key:"targetTableName",width:"11%"},{title:"分区",dataIndex:"targetPartition",key:"targetPartition",width:"11%",render:function(e,t){return e||"--"}},{title:"类型",dataIndex:"sourceTypeName",key:"sourceTypeName",width:"11%",render:function(e,t){return e||"--"}},{title:l.a.createElement("span",null,"校验结果",l.a.createElement(ut.a,{placement:"bottom",overlayClassName:"m-tooltip",title:l.a.createElement("div",null,l.a.createElement("p",null,"以下条件同时满足计为校验通过："),l.a.createElement("p",null,"1、逻辑主键匹配，但数据不匹配=0"),l.a.createElement("p",null,"2、max（左表数据在右表未找到，右表数据在左表未找到）<（右表记录数*记录数差异比例配置）"))},l.a.createElement(dt.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"status",key:"status",width:"10%",render:function(e,t){return 3==e?l.a.createElement("span",null,l.a.createElement(Dt,{style:{flexBasis:"60%"},value:e})," ",l.a.createElement(ut.a,{placement:"right",title:t.report,overlayClassName:"m-tooltip"},l.a.createElement(dt.a,{className:"font-14",type:"info-circle-o"}))):l.a.createElement(Dt,{value:e})}},{title:l.a.createElement("div",null,"差异总数",l.a.createElement(ut.a,{placement:"bottom",overlayClassName:"m-tooltip",title:"差异总数 = 逻辑主键匹配但数据不匹配 + 左表数据在右表未找到 + 右表数据在左表未找到"},l.a.createElement(dt.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"diverseNum",key:"diverseNum",width:"8%"},{title:l.a.createElement("div",null,"差异比例",l.a.createElement(ut.a,{placement:"bottom",overlayClassName:"m-tooltip",title:"统计左右2表的记录数最大值，统计整体匹配条数，整体匹配条数/记录数最大值为匹配率，差异比例=1-匹配率"},l.a.createElement(dt.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"diverseRatio",key:"diverseRatio",width:"8%",render:function(e){return e?e+" %":e}},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"11%"},{title:"执行时间",dataIndex:"executeTimeFormat",key:"executeTimeFormat",render:function(e,t){return e||"--"},width:"11%"},{title:"操作",width:"8%",render:function(t,a){var n=l.a.createElement(vn.a,null,e.enableCheckReport(a.status)&&l.a.createElement(vn.a.Item,null,l.a.createElement(C.c,{to:"dq/dataCheck/report/"+a.id},"查看报告")),l.a.createElement(vn.a.Item,null,l.a.createElement(C.c,{to:"dq/dataCheck/edit/"+a.verifyId},"再次运行")),a.dataSourceType===_e.HIVE&&l.a.createElement(vn.a.Item,null,l.a.createElement("a",{onClick:function(){e.setState({selectedRecord:a,visibleEnvModal:!0})}},"环境参数")));return l.a.createElement(yn.a,{overlay:n,trigger:["click"]},l.a.createElement(Kt.a,null,"操作",l.a.createElement(dt.a,{type:"down"})))}}]}},{key:"__enableCheckReport__REACT_HOT_LOADER__",value:function(e){return e===de.SUCCESS||e===de.PASS||e===de.UNPASS||e===de.EXPIRED}},{key:"__deleteDataCheck__REACT_HOT_LOADER__",value:function(e){var t=this;On.deleteCheck({verifyRecordId:e}).then(function(e){1===e.code&&(Wt.a.success("删除成功！"),t.props.getLists(t.state.params))})}},{key:"__updateEnvParams__REACT_HOT_LOADER__",value:function(e){var t=this;if(e){var a=this.state.selectedRecord;On.updateTaskParams({verifyId:a.verifyId,taskParams:e}).then(function(e){1===e.code&&(Wt.a.success("修改环境参数成功"),t.setState({visibleEnvModal:!1,selectedRecord:""}),t.props.getLists(t.state.params))})}else Wt.a.error("环境参数为空！")}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=M()({},this.state.params,{currentPage:e.current});this.props.getLists(n),this.setState({params:n})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return l.a.createElement(kn,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,dataSourceId:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__renderCheckStatus__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(kn,{key:e.value,value:e.value,title:e.text},e.text)})}},{key:"__onCheckStatusChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,status:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(kn,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,lastModifyUserId:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__onDateChange__REACT_HOT_LOADER__",value:function(e,t){var a=M()({},this.state.params,{currentPage:1,executeTime:e?e.valueOf():void 0});this.props.getLists(a),this.setState({params:a})}},{key:"__onTableSearch__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{currentPage:1,tableName:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()>Date.now()}},{key:"render",value:function(){var e=this,t=this.props,a=t.dataCheck,n=t.dataSource,r=t.common.userList,i=n.sourceList,s=a.lists,o=a.loading,c=this.state,u=c.params,_=c.visibleEnvModal,d=c.selectedRecord,p={current:u.currentPage,pageSize:u.pageSize,total:s.totalCount},m=l.a.createElement("div",{className:"flex font-12"},l.a.createElement(bn,{placeholder:"输入表名搜索",onSearch:this.onTableSearch,style:{width:200,margin:"10px 0"}}),l.a.createElement("div",{className:"m-l-8"},"数据源：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源类型",onChange:this.onUserSourceChange},this.renderUserSource(i))),l.a.createElement("div",{className:"m-l-8"},"校验结果：",l.a.createElement(gt.a,{allowClear:!0,style:{width:150},placeholder:"选择校验结果",onChange:this.onCheckStatusChange},this.renderCheckStatus(pe))),l.a.createElement("div",{className:"m-l-8"},"最近修改人：",l.a.createElement(gt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"name",placeholder:"选择最近修改人",onChange:this.onUserChange},this.renderUserList(r))),l.a.createElement("div",{className:"m-l-8"},"执行时间：",l.a.createElement(mt.a,{format:"YYYY-MM-DD",style:{width:150},placeholder:"选择日期",onChange:this.onDateChange,disabledDate:this.disabledDate}))),E=l.a.createElement(Kt.a,{type:"primary",style:{margin:"10px 0"}},l.a.createElement(C.c,{to:"/dq/dataCheck/add"},"新建逐行校验"));return l.a.createElement("div",{className:"check-dashboard"},l.a.createElement("h1",{className:"box-title"},"逐行校验"),l.a.createElement("div",{className:"box-2 m-card shadow"},l.a.createElement(K.a,{title:m,extra:E,noHovering:!0,bordered:!1},l.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),loading:o,pagination:p,dataSource:s.data,onChange:this.onTableChange}))),l.a.createElement(ga,{key:"ruleConfigEnvModal",title:"配置环境参数",visible:_,onCancel:function(){return e.setState({visibleEnvModal:!1})},value:d&&d.taskParams,onOk:this.updateEnvParams}))}}]),t}(o.Component))||mn,xn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(bn,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(kn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(Sn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(Ln,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(wn,"DataCheck","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/dashboard/index.js")),ta.a.Item),Hn=gt.a.Option,Pn=qa.a.TreeNode,Nn=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource}},In=function(e){return{getDataSourcesList:function(t){e(Be.getDataSourcesList(t))},getDataSourcesTable:function(t){e(Be.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(Be.resetDataSourcesTable())},getSourcePart:function(t,a){e(Dn.getSourcePart(t,a))},resetSourcePart:function(t){e(Dn.resetSourcePart(t))}}},jn=Object(A.b)(Nn,In)(En=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.renderSourceType=function(){return a.__renderSourceType__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSourceTable=function(){return a.__renderSourceTable__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.havePartition=function(){return a.__havePartition__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourceTypeChange=function(){return a.__onSourceTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onOriginTableChange=function(){return a.__onOriginTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{}},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){"new"===this.props.editStatus&&this.props.getDataSourcesList()}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return l.a.createElement(Hn,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__renderSourceTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Hn,{key:e,value:e},e)})}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(vt.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?l.a.createElement(Pn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e)):l.a.createElement(Pn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__havePartition__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.dataSource.sourceList.forEach(function(a){a.id==e&&t.props.changeHavePart(7===a.type||10===a.type)})}},{key:"__onSourceTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=(t.editParams,{dataSourceId:e});this.havePartition(e),this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:e}),a.setFieldsValue({originTable:void 0}),n&&(this.props.resetSourcePart("origin"),a.setFieldsValue({originPartition:void 0})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({origin:r,target:r,mappedPK:{}})}},{key:"__onOriginTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams.origin.dataSourceId,i={dataSourceId:r,table:e};n&&(this.props.resetSourcePart("origin"),a.setFieldsValue({originPartition:void 0}),this.props.getSourcePart({sourceId:r,table:e},"origin")),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({origin:i,mappedPK:{}})}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams.origin,a=t.dataSourceId,n=t.table,r=t.partition,i=this.state.showPreview;a&&n?(i||Ke.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!i})):Wt.a.error("未选择数据源或数据表")}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.editParams.origin,r=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({origin:M()({},n,{partition:r})})}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep;e.form.validateFields({force:!0},function(e,n){e||a(t+1)})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return l.a.createElement(Ya.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.sourcePreview&&this.state.sourcePreview.columnList;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"render",value:function(){var e=this.props,t=e.editStatus,a=e.editParams,n=e.form,r=e.dataSource,i=e.dataCheck,s=e.havePart,o=i.originPart,c=n.getFieldDecorator,u=r.sourceList,_=r.sourceTable,d=r.tableLoading,p=a.origin,m=p.dataSourceId,E=p.table,h=p.partition,T=this.state,g=T.sourcePreview,f=T.showPreview;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement(ta.a,null,l.a.createElement(xn,M()({},Re,{label:"选择数据源"}),c("sourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:m?m.toString():void 0})(l.a.createElement(gt.a,{showSearch:!0,optionFilterProp:"title",style:{width:"85%",marginRight:15},onChange:this.onSourceTypeChange,disabled:"edit"===t||d},this.renderSourceType(u))),l.a.createElement(C.c,{to:"/dq/dataSource"},"添加数据源")),l.a.createElement(xn,M()({},Re,{label:"选择左侧表"}),c("originTable",{rules:[{required:!0,message:"请选择左侧表"}],initialValue:E})(l.a.createElement(gt.a,{showSearch:!0,style:{width:"85%"},onChange:this.onOriginTableChange,disabled:"edit"===t},this.renderSourceTable(_)))),(s||h)&&l.a.createElement(xn,M()({},Re,{label:"选择分区"}),c("originPartition",{rules:[],initialValue:h})(l.a.createElement(qa.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",disabled:"edit"===t,style:{width:"85%"},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(o)))),l.a.createElement("div",{className:"txt-center font-14"},l.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",l.a.createElement(dt.a,{type:"down",style:{marginLeft:5}}))),f&&l.a.createElement(q.a,{rowKey:"key",className:"m-table m-cells",columns:this.previewTableColumns(g.columnList),dataSource:g.dataList,pagination:!1,scroll:{x:this.getScroll()}}))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,null,l.a.createElement(C.c,{to:"/dq/dataCheck"},"取消")),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(o.Component))||En;jn=ta.a.create()(jn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(xn,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Hn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Pn,"TreeNode","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Nn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(In,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(jn,"StepOne","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"));var Un,Mn=ta.a.Item,Fn=gt.a.Option,Qn=qa.a.TreeNode,Vn=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource}},Gn=function(e){return{getSourcePart:function(t,a){e(Dn.getSourcePart(t,a))},resetSourcePart:function(t){e(Dn.resetSourcePart(t))}}},zn=Object(A.b)(Vn,Gn)(Un=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.renderTargetTable=function(){return a.__renderTargetTable__REACT_HOT_LOADER__.apply(a,arguments)},a.onTargetTableChange=function(){return a.__onTargetTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{}},a}return v()(t,e),g()(t,[{key:"__renderTargetTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Fn,{key:e,value:e},e)})}},{key:"__onTargetTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams.target.dataSourceId,i={dataSourceId:r,table:e};n&&(this.props.resetSourcePart("target"),a.setFieldsValue({targetPartition:void 0}),this.props.getSourcePart({sourceId:r,table:e},"target")),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({target:i,mappedPK:{}})}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams.target,a=t.dataSourceId,n=t.table,r=t.partition,i=this.state.showPreview;n?(i||Ke.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!i})):Wt.a.error("未选择数据表")}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(vt.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?l.a.createElement(Qn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e.children)):l.a.createElement(Qn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.editParams.target,r=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({target:M()({},n,{partition:r})})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep;e.form.validateFields({force:!0},function(e,n){e||a(t+1)})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:80,render:function(e){return l.a.createElement(Ya.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.editStatus,n=e.editParams,r=e.dataSource,i=e.dataCheck,s=e.havePart,o=i.targetPart,c=r.sourceTable,u=t.getFieldDecorator,_=n.target,d=_.table,p=_.partition,m=this.state,E=m.sourcePreview,h=m.showPreview;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement(ta.a,null,l.a.createElement(Mn,M()({},Re,{label:"选择右侧表"}),u("table",{rules:[{required:!0,message:"请选择右侧表"}],initialValue:d})(l.a.createElement(gt.a,{showSearch:!0,style:{width:"85%"},onChange:this.onTargetTableChange,disabled:"edit"===a},this.renderTargetTable(c)))),(s||p)&&l.a.createElement(Mn,M()({},Re,{label:"选择分区"}),u("targetPartition",{rules:[],initialValue:p})(l.a.createElement(qa.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",disabled:"edit"===a,style:{width:"85%",marginRight:15},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(o)))),l.a.createElement("div",{className:"txt-center font-14"},l.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",l.a.createElement(dt.a,{type:"down",style:{marginLeft:5}}))),h&&l.a.createElement(q.a,{rowKey:"key",className:"m-table m-cells",columns:this.previewTableColumns(E.columnList),dataSource:E.dataList,pagination:!1,scroll:{x:1e3}}))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,{onClick:this.prev},"上一步"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(o.Component))||Un;zn=ta.a.create()(zn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Mn,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Fn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Qn,"TreeNode","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Vn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Gn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(zn,"StepTwo","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"));var qn,Yn=a("sk9p"),Kn=a.n(Yn),Bn=a("oF3Q"),Wn=a.n(Bn),Jn=a("FyfS"),Xn=a.n(Jn),Zn=a("2fsI"),$n=a("u+gO"),er=function(e){return{addLinkedKeys:function(t){e({type:$n.a.ADD_LINKED_KEYS,payload:t})},delLinkedKeys:function(t){e({type:$n.a.DEL_LINKED_KEYS,payload:t})},setEditMap:function(t){e({type:$n.a.SET_EDIT_MAP,payload:t})},setRowMap:function(t){e({type:$n.a.SET_ROW_MAP,payload:t})},setNameMap:function(t){e({type:$n.a.SET_NAME_MAP,payload:t})},resetLinkedKeys:function(){e({type:$n.a.RESET_LINKED_KEYS})}}},tr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(er,"keyMapActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/actions/dataCheck/keyMapActions.js"),ta.a.Item),ar=function(e){return{keymap:e.keymap}},nr=Object(A.b)(ar,er)(qn=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.getColumnData=function(){return a.__getColumnData__REACT_HOT_LOADER__.apply(a,arguments)},a.setEditKeymapData=function(){return a.__setEditKeymapData__REACT_HOT_LOADER__.apply(a,arguments)},a.setSettingTableFields=function(){return a.__setSettingTableFields__REACT_HOT_LOADER__.apply(a,arguments)},a.setKeymapCheckData=function(){return a.__setKeymapCheckData__REACT_HOT_LOADER__.apply(a,arguments)},a.initDiverseSetting=function(){return a.__initDiverseSetting__REACT_HOT_LOADER__.apply(a,arguments)},a.initDiverseData=function(){return a.__initDiverseData__REACT_HOT_LOADER__.apply(a,arguments)},a.getSettingItem=function(){return a.__getSettingItem__REACT_HOT_LOADER__.apply(a,arguments)},a.keymapTableColumn=function(){return a.__keymapTableColumn__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.setRowMap=function(){return a.__setRowMap__REACT_HOT_LOADER__.apply(a,arguments)},a.setNameMap=function(){return a.__setNameMap__REACT_HOT_LOADER__.apply(a,arguments)},a.state={selectedSetting:[],selectedSource:[],selectedTarget:[],h:40,W:0,H:0,originColumn:[],targetColumn:[],rowMap:!1,nameMap:!1},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.initDiverseData(),this.$canvas=Object(Zn.b)(this.canvas),this.$activeLine=Object(Zn.b)("#activeLine"),this.listenResize(),this.getColumnData(),this.setEditKeymapData(),this.setKeymapCheckData(),this.setSettingTableFields(),this.drawSvg()}},{key:"componentWillReceiveProps",value:function(e){var t=e.keymap,a=this.props.keymap;if(t.source.length!=a.source.length){var n=this.props.editParams,r=n.origin,i=n.target;this.props.changeParams({origin:M()({},r,{column:t.source}),target:M()({},i,{column:t.target})})}}},{key:"componentDidUpdate",value:function(){this.$canvas.selectAll(".dl, .dr, .lines").remove(),this.drawSvg()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1),this.props.resetLinkedKeys()}},{key:"listenResize",value:function(){window.addEventListener("resize",this.resize,!1)}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.setState({W:this.getCanvasW(),H:this.getCanvasH()})}},{key:"__getColumnData__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams,a=t.origin,n=t.target;Ke.getDataSourcesColumn({sourceId:a.dataSourceId,tableName:a.table}).then(function(t){1===t.code&&(e.setState({originColumn:t.data}),e.resize())}),Ke.getDataSourcesColumn({sourceId:n.dataSourceId,tableName:n.table}).then(function(t){1===t.code&&(e.setState({targetColumn:t.data}),e.resize())})}},{key:"__setEditKeymapData__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams,t=e.origin,a=e.target;t.column&&a.column&&this.props.setEditMap({source:t.column,target:a.column})}},{key:"__setSettingTableFields__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.setting,t=this.props.form;if(!Object(vt.isEmpty)(e)){var a=[],n={};te()(e).forEach(function(t){e[t]&&(a.push(t),"matchCase"!=t&&"matchNull"!=t&&(n[t]=e[t]))}),t.setFieldsValue(n),this.setState({selectedSetting:a})}}},{key:"__setKeymapCheckData__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.mappedPK;if(!Object(vt.isEmpty)(e)){var t=[],a=[],n=!0,r=!1,i=void 0;try{for(var s,o=Xn()(Wn()(e));!(n=(s=o.next()).done);n=!0){var l=Kn()(s.value,2),c=l[0],u=l[1];t.push(c),a.push(u)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}this.setState({selectedSource:t,selectedTarget:a})}}},{key:"drawSvg",value:function(){this.renderDags(),this.renderLines(),this.bindEvents()}},{key:"renderDags",value:function(){var e=this.state,t=e.h,a=e.W,n=e.originColumn,r=e.targetColumn;this.$canvas.append("g").attr("class","dl").selectAll("g").data(n).enter().append("g").attr("class","col-dag-l").append("circle").attr("class","dag-circle").attr("cx",function(e,t){return 15}).attr("cy",function(e,a){return t*(a+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7"),this.$canvas.append("g").attr("class","dr").selectAll("g").data(r).enter().append("g").attr("class","col-dag-r").append("circle").attr("class","dag-circle").attr("cx",function(e,t){return a-15}).attr("cy",function(e,a){return t*(a+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7")}},{key:"renderLines",value:function(){var e=this.state,t=e.h,a=e.W,n=this.props.keymap,r=n.source,i=n.target,s=Object(Zn.c)(".col-dag-l"),o=Object(Zn.c)(".col-dag-r"),l=[];r.forEach(function(e,n){s.each(function(r,s){var c=void 0,u=void 0,_=void 0,d=void 0;r.key===e&&(c=15,u=(s+1.5)*t,o.each(function(r,s){r.key===i[n]&&(_=a-15,d=(s+1.5)*t,l.push({s:{x:c,y:u},e:{x:_,y:d},dl:e,dr:i[n]}))}))})});var c=this.$canvas.append("g").attr("class","lines").selectAll("g").data(l).enter().append("g").attr("class","mapline");c.append("line").attr("x1",function(e){return e.s.x}).attr("y1",function(e){return e.s.y}).attr("x2",function(e){return e.e.x}).attr("y2",function(e){return e.e.y}).attr("stroke","#2491F7").attr("stroke-width",2).attr("marker-end","url(#arrow)"),c.append("rect").attr("x",function(e){return e.s.x}).attr("y",function(e){return e.s.y>e.e.y?e.s.y-15:e.s.y-10}).attr("width",function(e){return Math.pow(Math.pow(e.e.x-e.s.x,2)+Math.pow(e.e.y-e.s.y,2),.5)}).attr("transform",function(e){return"rotate(\n                            "+180/(Math.PI/Math.atan((e.e.y-e.s.y)/(e.e.x-e.s.x)))+"\n                        )"}).attr("transform-origin",function(e){var t=e.s.y>e.e.y?15:10;return e.s.x+" "+(e.s.y-t)}).attr("height",function(e){return e.s.y>e.e.y?"20px":"15px"}).attr("fill","transparent")}},{key:"bindEvents",value:function(){var e=this,t=this.state,a=t.h,n=t.W,r=t.selectedSource,i=t.selectedTarget,s=this.$activeLine,o=Object(Zn.c)(".col-dag-l"),l=Object(Zn.c)(".col-dag-r"),c=!1,u=void 0,_=void 0;o.on("mousedown",function(e,t,n){u=e,c=!0;var r=(t+1.5)*a;s.attr("x1",15).attr("y1",r).attr("x2",15).attr("y2",r)}),this.$canvas.on("mousemove",function(){if(c){var t=Object(Zn.a)(e.$canvas.node());s.attr("x2",t[0]).attr("y2",t[1])}}).on("mouseup",function(){if(c){var t=Object(Zn.a)(e.$canvas.node()),r=Kn()(t,2),i=r[0],s=r[1];if(i<n-30)e.resetActiveLine();else{var o=Math.floor(s/a)-1;l.each(function(e,t){t===o&&(_=e)})}}u&&_&&(e.props.addLinkedKeys({source:u.key,target:_.key}),e.resetActiveLine()),c=!1}),this.$canvas.selectAll(".mapline").on("mouseover",function(e,t,a){Object(Zn.b)(a[t]).select("line").attr("stroke-width",4).attr("stroke","#2491F7")}).on("mouseout",function(e,t,a){Object(Zn.b)(a[t]).select("line").attr("stroke-width",2).attr("stroke","#2491F7")}).on("click",function(t,a,n){e.props.delLinkedKeys({source:t.dl,target:t.dr});var s=[].concat(xt()(r)),o=[].concat(xt()(i)),l={};s=s.filter(function(e){return e!==t.dl}),o=o.filter(function(e){return e!==t.dr}),e.setState({selectedSource:s,selectedTarget:o}),s.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})})}},{key:"resetActiveLine",value:function(){this.$activeLine.attr("x1",-10).attr("y1",-10).attr("x2",-10).attr("y2",-10)}},{key:"__initDiverseSetting__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"差异特征",dataIndex:"setting",key:"setting",render:function(t,a){return e.getSettingItem(t)},width:"95%"}]}},{key:"__initDiverseData__REACT_HOT_LOADER__",value:function(){return[{id:1,setting:"diverseNum"},{id:2,setting:"diverseRatio"},{id:3,setting:"diverseAbsolute"},{id:4,setting:"decimalRetain"},{id:5,setting:"matchCase"},{id:6,setting:"matchNull"}]}},{key:"__getSettingItem__REACT_HOT_LOADER__",value:function(e){var t=this.props.form.getFieldDecorator,a=this.props.editParams.setting;switch(e){case"diverseNum":return l.a.createElement(tr,{style:{marginBottom:0}},"记录数差异，对比左右表的总记录数，差距小于",t("diverseNum",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseNum})(l.a.createElement(Xt.a,{size:"default",min:1,step:1})),"%时候，计为成功匹配");case"diverseRatio":return l.a.createElement(tr,{style:{marginBottom:0}},"数值差异百分比，对比左右表的数值型数据时，差距百分比小于",t("diverseRatio",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseRatio})(l.a.createElement(Xt.a,{size:"default",min:1,step:1})),"%时候，计为成功匹配");case"diverseAbsolute":return l.a.createElement(tr,{style:{marginBottom:0}},"数值差异绝对值，对比左右表的数值型数据时，差距绝对值小于",t("diverseAbsolute",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseAbsolute})(l.a.createElement(Xt.a,{size:"default",min:1,step:1})),"时候，计为成功匹配");case"decimalRetain":return l.a.createElement(tr,{style:{marginBottom:0}},"数值对比忽略小数点，忽略小数点后",t("decimalRetain",{rules:[{required:!0,message:"不能为空"}],initialValue:a.decimalRetain})(l.a.createElement(Xt.a,{size:"default",min:1,step:1,precision:0})),"位");case"matchCase":return l.a.createElement("p",null,"字符不区分大小写，对比左右表的字符串型数据时，不区分大小写");case"matchNull":return l.a.createElement("p",null,"空值与NULL等价，对比左右表的数据时，认为空值与NULL值是相等的")}}},{key:"getCanvasW",value:function(){return document.querySelector(".keymap-svg").getBoundingClientRect().width}},{key:"getCanvasH",value:function(){var e=document.querySelectorAll(".keymap-table")[0].getBoundingClientRect().height,t=document.querySelectorAll(".keymap-table")[1].getBoundingClientRect().height;return e>t?e:t}},{key:"__keymapTableColumn__REACT_HOT_LOADER__",value:function(e){return[{title:"left"===e?"左侧表字段":"右侧表字段",dataIndex:"key",key:"key",width:"45%"},{title:"类型",dataIndex:"type",key:"type",width:"40%"}]}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.form,n=t.editParams,r=t.keymap,i=t.currentStep,s=this.state.selectedSetting;r.source.length?Object(vt.isEmpty)(n.mappedPK)?Wt.a.error("请选择逻辑主键"):(te()(a.getFieldsValue()).forEach(function(e){s.indexOf(e)<0&&a.resetFields([e])}),a.validateFields(s,function(t,a){t?Wt.a.error("请填写已选中的差异设置"):(te()(a).forEach(function(e){"matchCase"!==e&&"matchNull"!==e||(a[e]=!0)}),e.props.changeParams({setting:a}),e.props.navToStep(i+1))})):Wt.a.error("请连接要比对的字段")}},{key:"__setRowMap__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.rowMap,a=e.nameMap,n=e.originColumn,r=e.targetColumn;t?(this.props.resetLinkedKeys(),this.setState({selectedSource:[],selectedTarget:[]}),this.props.changeParams({mappedPK:{}})):this.props.setRowMap({sourceKeyCol:n.map(function(e){return e.key}),targetKeyCol:r.map(function(e){return e.key})}),this.setState({rowMap:!t,nameMap:a?!a:a})}},{key:"__setNameMap__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.nameMap,a=e.rowMap,n=e.originColumn,r=e.targetColumn,i=this.props.editParams;i.origin,i.target;t?(this.props.resetLinkedKeys(),this.setState({selectedSource:[],selectedTarget:[]}),this.props.changeParams({mappedPK:{}})):this.props.setNameMap({sourceKeyCol:n.map(function(e){return e.key}),targetKeyCol:r.map(function(e){return e.key})}),this.setState({nameMap:!t,rowMap:a?!a:a})}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedSetting,n=t.selectedSource,r=t.selectedTarget,i=(t.h,t.W,t.H),s=t.originColumn,o=t.targetColumn,c=t.nameMap,u=t.rowMap,_=this.props.keymap,d=_.source,p=_.target,m={selectedRowKeys:n,getCheckboxProps:function(e){return{disabled:!d.includes(e.key)}},onSelect:function(t,a,i){var s=[].concat(xt()(n)),o=[].concat(xt()(r)),l={};a?(s.push(t.key),o.push(p[d.indexOf(t.key)])):(s.splice(s.indexOf(t.key),1),o.splice(o.indexOf(t.key),1)),e.setState({selectedSource:s,selectedTarget:o}),s.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})}},E={selectedRowKeys:r,getCheckboxProps:function(e){return{disabled:!p.includes(e.key)}},onSelect:function(t,a,i){var s=[].concat(xt()(n)),o=[].concat(xt()(r)),l={};a?(o.push(t.key),s.push(d[p.indexOf(t.key)])):(o.splice(o.indexOf(t.key),1),s.splice(s.indexOf(t.key),1)),e.setState({selectedSource:s,selectedTarget:o}),s.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})}},h={selectedRowKeys:a,onChange:function(t){e.setState({selectedSetting:t})}};return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement("p",{className:"keymap-title"},"提示：您要配置来源表与目标表的字段映射关系，通过连线将待同步的字段左右相连，也可以通过同行映射、同名映射批量完成映射,同时，您需要添加主键"),l.a.createElement(W.a,{className:"keymap-content"},l.a.createElement(X.a,{span:3},l.a.createElement("div",{className:"keymap-action"},l.a.createElement(Kt.a,{type:u?"primary":"default",onClick:this.setRowMap},u?"取消同行映射":"同行映射"),l.a.createElement("br",null),l.a.createElement(Kt.a,{type:c?"primary":"default",onClick:this.setNameMap},c?"取消同名映射":"同名映射"))),l.a.createElement(X.a,{span:6},l.a.createElement(q.a,{className:"keymap-table m-table table-select-text-key",rowKey:function(e){return e.key},columns:this.keymapTableColumn("left"),dataSource:s,rowSelection:m,pagination:!1})),l.a.createElement(X.a,{span:8,className:"canvas-content"},l.a.createElement("svg",{ref:function(t){return e.canvas=t},width:"100%",height:i,className:"keymap-svg"},l.a.createElement("defs",null,l.a.createElement("marker",{id:"arrow",markerUnits:"strokeWidth",markerWidth:"12",markerHeight:"12",viewBox:"0 0 12 12",refX:"6",refY:"6",orient:"auto"},l.a.createElement("path",{d:"M2,3 L9,6 L2,9 L2,3",style:{fill:"#2491F7"}}))),l.a.createElement("g",null,l.a.createElement("line",{id:"activeLine",x1:"-10",y1:"-10",x2:"-10",y2:"-10",stroke:"#2491F7",strokeWidth:"2",markerEnd:"url(#arrow)"})))),l.a.createElement(X.a,{span:6},l.a.createElement(q.a,{className:"keymap-table m-table table-select-text-key",rowKey:function(e){return e.key},columns:this.keymapTableColumn("right"),dataSource:o,rowSelection:E,pagination:!1}))),l.a.createElement(W.a,{className:"keymap-content"},l.a.createElement(X.a,{offset:2,span:20},l.a.createElement(q.a,{className:"m-table setting-table",showHeader:!1,rowKey:function(e){return e.setting},columns:this.initDiverseSetting(),dataSource:this.initDiverseData(),rowSelection:h,pagination:!1})))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,{onClick:this.prev},"上一步"),l.a.createElement(Kt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(o.Component))||qn;nr=ta.a.create()(nr);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(tr,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js"),__REACT_HOT_LOADER__.register(ar,"mapState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js"),__REACT_HOT_LOADER__.register(nr,"StepThree","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js")),a("mxgt");var rr,ir=a("4ZwL"),sr=a.n(ir),or=(a("7kJ1"),a("qPIi")),lr=a.n(or),cr=ta.a.Item,ur=lr.a.Group,_r=gt.a.Option,dr={beginDate:ne()().format("YYYY-MM-DD"),hour:0,min:0,endDate:ne()().add(100,"years").format("YYYY-MM-DD"),periodType:"2"},pr=function(e){return{common:e.common}},mr=Object(A.b)(pr)(rr=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.onExecuteTypeChange=function(){return a.__onExecuteTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformChange=function(){return a.__onInformChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformTypeChange=function(){return a.__onInformTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onWebHookChange=function(){return a.__onWebHookChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformUserChange=function(){return a.__onInformUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSendTypeList=function(){return a.__renderSendTypeList__REACT_HOT_LOADER__.apply(a,arguments)},a.disabledDate=function(){return a.__disabledDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={isInform:!1,scheduleConfObj:dr},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props.editParams,t=e.scheduleConf,a=e.notifyVO,n=this.state.scheduleConfObj;t?this.setState({scheduleConfObj:JSON.parse(t)}):this.props.changeParams({scheduleConf:na()(n)}),a&&this.setState({isInform:!0})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(){var e=dr;this.setState({scheduleConfObj:e}),this.props.changeParams({scheduleConf:na()(e)})}},{key:"__onExecuteTypeChange__REACT_HOT_LOADER__",value:function(e){0===e.target.value&&this.resetScheduleConf(),this.props.changeParams({executeType:e.target.value})}},{key:"__onInformChange__REACT_HOT_LOADER__",value:function(e){this.setState({isInform:e.target.checked}),e.target.checked||this.props.changeParams({notifyVO:null})}},{key:"__onInformTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.editParams.notifyVO;this.props.changeParams({notifyVO:M()({},t,{sendTypes:e})})}},{key:"__onWebHookChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.editParams.notifyVO;this.props.changeParams({notifyVO:M()({},t,{webhook:e.target.value})})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.state.scheduleConfObj,r={};r[e]=a,this.setState({scheduleConfObj:M()({},n,r)}),this.props.changeParams({scheduleConf:na()(M()({},n,r))})}},{key:"__onInformUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.editParams.notifyVO;this.props.changeParams({notifyVO:M()({},t,{receivers:e})})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(_r,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__renderSendTypeList__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return l.a.createElement(st.a,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()<ne()().startOf("day").valueOf()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.editParams;t.validateFields({force:!0},function(e,t){e&&(e.beginDate||e.hour||e.min)&&Wt.a.error("执行时间不能为空"),e||(a.id?On.updateCheck(a).then(function(e){1===e.code&&(Wt.a.success("操作成功"),setTimeout(function(){C.g.push("/dq/dataCheck")},1e3))}):On.addCheck(a).then(function(e){1===e.code&&(Wt.a.success("操作成功"),setTimeout(function(){C.g.push("/dq/dataCheck")},1e3))}))})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.editParams,r=e.editStatus,i=a.userList,s=a.allDict,o=t.getFieldDecorator,c=n.executeType,u=n.notifyVO,_=this.state,d=_.isInform,p=_.scheduleConfObj,m=u?u.sendTypes:void 0,E=u?u.receivers:void 0,h=u?u.webhook:void 0,T=s.notifyType?s.notifyType:[],g=(m?m.map(function(e){return e.toString()}):[]).indexOf(le.DINGDING)>-1;return l.a.createElement("div",null,l.a.createElement("div",{className:"steps-content"},l.a.createElement(ta.a,null,l.a.createElement(cr,M()({},Re,{label:"执行时间"}),o("executeType",{rules:[{required:!0,message:"不能为空"}],initialValue:c})(l.a.createElement(ur,{onChange:this.onExecuteTypeChange},l.a.createElement(lr.a,{value:0},"立即执行"),l.a.createElement(lr.a,{value:1},"定时执行")))),1===c&&l.a.createElement(W.a,{style:{marginBottom:24}},l.a.createElement(X.a,{span:12,offset:6},o("beginDate",{rules:[{required:!0}],initialValue:ne()(p.beginDate)})(l.a.createElement(mt.a,{format:"YYYY-MM-DD",placeholder:"开始时间",style:{width:150,marginRight:15},disabledDate:this.disabledDate,onChange:this.changeScheduleConfTime.bind(this,"beginDate")})),o("hour",{rules:[{required:!0}],initialValue:ne()(p.hour,"HH")})(l.a.createElement(sr.a,{format:"HH",placeholder:"小时",style:{marginRight:15},onChange:this.changeScheduleConfTime.bind(this,"hour")})),o("min",{rules:[{required:!0}],initialValue:ne()(p.min,"mm")})(l.a.createElement(sr.a,{format:"mm",placeholder:"分钟",onChange:this.changeScheduleConfTime.bind(this,"min")})))),l.a.createElement(cr,M()({},Re,{label:"通知设置"}),l.a.createElement(st.a,{value:d,onChange:this.onInformChange},"执行完成后发送通知")),!0===d&&l.a.createElement("div",null,l.a.createElement(cr,M()({},Re,{label:"通知方式"}),o("sendTypes",{rules:[{required:!0,message:"选择通知方式"}],initialValue:m?m.map(function(e){return e.toString()}):[]})(l.a.createElement(st.a.Group,{onChange:this.onInformTypeChange},this.renderSendTypeList(T)))),g&&l.a.createElement(cr,M()({},Re,{label:"webhook"}),o("webhook",{rules:[{required:!0,message:"webhook不能为空"}],initialValue:h||""})(l.a.createElement(yt.a,{onChange:this.onWebHookChange}))),l.a.createElement(cr,M()({},Re,{label:"通知接收人"}),o("receivers",{rules:[{required:!0,message:"选择接收人"}],initialValue:E?E.map(function(e){return e.toString()}):[]})(l.a.createElement(gt.a,{allowClear:!0,mode:"multiple",onChange:this.onInformUserChange},this.renderUserList(i))))))),l.a.createElement("div",{className:"steps-action"},l.a.createElement(Kt.a,{onClick:this.prev},"上一步"),l.a.createElement(Kt.a,{type:"primary",className:"m-l-8",onClick:this.save},"edit"===r?"保存":"新建")))}}]),t}(o.Component))||rr;mr=ta.a.create()(mr);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(cr,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(ur,"RadioGroup","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(_r,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(dr,"initialSchedule","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(pr,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(mr,"StepFour","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"));var Er,hr,Tr=Ga.a.Step,gr=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={current:0,editParams:{origin:{},target:{},mappedPK:{},executeType:0,setting:{},scheduleConf:void 0,notifyVO:null},editStatus:"new",havePart:!1},n.changeParams=function(){var e;return(e=n).__changeParams__REACT_HOT_LOADER__.apply(e,arguments)},n.changeHavePart=function(){var e;return(e=n).__changeHavePart__REACT_HOT_LOADER__.apply(e,arguments)},n.navToStep=function(){var e;return(e=n).__navToStep__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.routeParams.verifyId,a=this.state.editParams;t&&(this.setState({editStatus:"edit"}),On.getCheckDetail({verifyId:t}).then(function(t){if(1===t.code){var n=t.data;e.setState({editParams:M()({},a,{id:n.id,origin:n.origin,target:n.target,setting:n.setting,mappedPK:n.mappedPK,notifyVO:n.notifyVO,executeType:n.executeType,scheduleConf:n.scheduleConf})})}}))}},{key:"__changeParams__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.editParams,e);this.setState({editParams:t})}},{key:"__changeHavePart__REACT_HOT_LOADER__",value:function(e){this.setState({havePart:e})}},{key:"__navToStep__REACT_HOT_LOADER__",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.editParams,n=e.editStatus,r=e.havePart,i=[{title:"选择左侧表",content:l.a.createElement(jn,{currentStep:t,navToStep:this.navToStep,havePart:r,editParams:a,editStatus:n,changeParams:this.changeParams,changeHavePart:this.changeHavePart})},{title:"选择右侧表",content:l.a.createElement(zn,{currentStep:t,navToStep:this.navToStep,havePart:r,editParams:a,editStatus:n,changeParams:this.changeParams})},{title:"选择字段",content:l.a.createElement(nr,{currentStep:t,navToStep:this.navToStep,editParams:a,editStatus:n,changeParams:this.changeParams})},{title:"执行配置",content:l.a.createElement(mr,{currentStep:t,navToStep:this.navToStep,editParams:a,editStatus:n,changeParams:this.changeParams})}];return l.a.createElement("div",{className:"box-1 check-setting"},l.a.createElement("h1",{className:"box-title"},l.a.createElement(hn.a,null),l.a.createElement("span",{className:"m-l-8"},"new"===n?"新建逐行校验":"编辑逐行校验")),l.a.createElement("div",{className:"steps-container"},l.a.createElement(Ga.a,{current:t},i.map(function(e){return l.a.createElement(Tr,{key:e.title,title:e.title})})),i[t].content))}}]),t}(o.Component),fr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Tr,"Step","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/index.js"),__REACT_HOT_LOADER__.register(gr,"DataCheckEdit","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/edit/index.js")),function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||m()(t)).call(this,e));return a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onTableChange=function(){return a.__onTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.handleDownload=function(){return a.__handleDownload__REACT_HOT_LOADER__.apply(a,arguments)},a.state={params:{currentPage:1,pageSize:20,verifyRecordId:a.props.routeParams.verifyRecordId},tableData:{},reportData:{}},a}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.params,a=t.verifyRecordId;On.getCheckReport({verifyRecordId:a}).then(function(t){1===t.code&&e.setState({reportData:t.data})}),On.getCheckReportTable(t).then(function(t){1===t.code&&e.setState({tableData:t.data})})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(e){return e.length&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return l.a.createElement(Ya.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.tableData.attachment;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this,r=M()({},this.state.params,{currentPage:e.current});On.getCheckReportTable(r).then(function(e){1===e.code&&n.setState({params:r,tableData:e.data})})}},{key:"__handleDownload__REACT_HOT_LOADER__",value:function(){var e=this.state.params,t="verifyRecordId="+e.verifyRecordId+"&currentPage="+e.currentPage+"&pageSize="+e.pageSize;window.open("/api/dq/export/verify/doExport?"+t)}},{key:"render",value:function(){var e=this.state,t=e.params,a=e.tableData,n=e.reportData,r=n.verifyVO,i=n.lAll,s=n.rAll,o=n.mapSuccess,c=n.mapFailure,u=n.rightUnfound,_=n.leftUnfound,d=n.dataSourceEN,p={current:t.currentPage,pageSize:t.pageSize,total:a.totalCount},m="/api/dq/export/verify/doExport?"+("verifyRecordId="+t.verifyRecordId+"&currentPage="+t.currentPage+"&pageSize="+t.pageSize);return l.a.createElement("div",{className:"box-1"},l.a.createElement("h1",{className:"box-title"},l.a.createElement(hn.a,null),l.a.createElement("span",{className:"m-l-8"},"查看报告")),l.a.createElement("div",{className:"report-content"},l.a.createElement("h3",null,"整体校验"),l.a.createElement("table",{className:"report-table"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"左侧表"),l.a.createElement("th",null,"右侧表")),l.a.createElement("tr",null,l.a.createElement("th",null,"表名"),l.a.createElement("td",null,r?r.originTableName:""),l.a.createElement("td",null,r?r.targetTableName:"")),l.a.createElement("tr",null,l.a.createElement("th",null,"分区名"),l.a.createElement("td",null,r?r.originPartition:" -- "),l.a.createElement("td",null,r?r.targetPartition:" -- ")),l.a.createElement("tr",null,l.a.createElement("th",null,"类型"),l.a.createElement("td",null,d),l.a.createElement("td",null,d)),l.a.createElement("tr",null,l.a.createElement("th",null,"总记录数"),l.a.createElement("td",null,i),l.a.createElement("td",null,s))))),l.a.createElement("div",{className:"report-content"},l.a.createElement("h3",null,"未匹配数据报告"),l.a.createElement("table",{className:"report-table"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",null,"匹配成功"),l.a.createElement("td",{className:"width-30"},o),l.a.createElement("th",null,"左表数据在右表未找到"),l.a.createElement("td",{className:"width-30"},u)),l.a.createElement("tr",null,l.a.createElement("th",null,"逻辑主键匹配，但数据不匹配"),l.a.createElement("td",{className:"width-30"},c),l.a.createElement("th",null,"右表数据在左表未找到"),l.a.createElement("td",{className:"width-30"},_))))),l.a.createElement("div",{className:"report-content"},l.a.createElement("h3",{className:"flex",style:{justifyContent:"space-between"}},"具体差异",l.a.createElement("a",{href:m,download:!0},l.a.createElement(dt.a,{type:"download",style:{fontSize:16,marginRight:25,cursor:"pointer"}}))),l.a.createElement(q.a,{className:"m-cells m-table",scroll:{x:this.getScroll()},pagination:p,dataSource:a.data?a.data:[],columns:this.initColumns(a.attachment?a.attachment:[]),onChange:this.onTableChange})))}}]),t}(o.Component)),yr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(fr,"DataCheckReport","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataCheck/report/index.js"),a("FL+A")),Rr=l.a.createElement("div",null,"where 条件即针对源头数据筛选条件，根据指定的 column、table、where 条件拼接 SQL 进行数据抽取，暂时不支持limit关键字过滤。利用 where 条件可进行全量同步和增量同步，具体说明如下：",l.a.createElement("br",null),l.a.createElement("ul",null,l.a.createElement("li",null,"1）全量同步：第一次做数据导入时通常为全量导入，可不用设置 where 条件。"),l.a.createElement("li",null,"2）增量同步：增量导入在实际业务场景中，往往会选择当天的数据进行同步，通常需要编写 where 条件语句，请先确认表中描述增量字段（时间戳）为哪一个。如tableA增量的字段为create_time，则填写create_time > 您需要的日期，如果需要日期动态变化，请参考帮助文档。"))),vr=l.a.createElement("ul",null,l.a.createElement("li",null,"MySQL：支持数值型切分键"),l.a.createElement("li",null,"Oracle：支持数值型、字符串类型切分键")),Cr=l.a.createElement("div",null,"user/hive/warehouse/projectName.db/",l.a.createElement("br",null),"tableName 是RD-OS默认的HDFS文件组织方式，projectName为项目名， 其中每个tableName是HDFS内的一个目录，储存着一张表的数据。 如果此表的数据存储在当前项目空间内，只需修改tableName即可， 否则需要根据HDFS的存储位置填写。"),Ar=l.a.createElement("div",null,"设置作业速率上限，则数据同步作业的总速率将尽可能按照这个上限进行同步， 需根据实际硬件配置调整，默认为1"),Or=l.a.createElement("ul",null,l.a.createElement("li",null," 1.作业速率上限=作业并发数单作业的传输速率，当作业速率上限已定，选择的并发数越高则单并发的速率越低，同时所占用的内存会越高，这可以根据你的业务需求选择设定的值"),l.a.createElement("li",null,"2.作业并发数下拉框选择对象，取决作业速率上限。作业速率上限选择值nMB/s，作业并发数最大能选择n")),Dr=l.a.createElement("div",null,"表示脏数据的最大容忍条数，如果您配置0， 则表示严格不允许脏数据存在；如果不填则代表容忍脏数据"),br=l.a.createElement("div",null,"高可用模式下的填写规则：",l.a.createElement("ul",null,l.a.createElement("li",null,"1、分别要填写：nameservice名称、 namenode名称（多个以逗号分隔）、proxy.provider参数；"),l.a.createElement("li",null,"2、所有参数以JSON格式填写；"),l.a.createElement("li",null,"3、格式为：",l.a.createElement("br",null),'"dfs.nameservices": "nameservice名称", "dfs.ha.namenodes.nameservice名称": "namenode名称，以逗号分隔", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.client.failover.proxy.provider.',l.a.createElement("br",null),'nameservice名称": "org.apache.hadoop.',l.a.createElement("br",null),"hdfs.server.namenode.ha.",l.a.createElement("br",null),'ConfiguredFailoverProxyProvider"'),l.a.createElement("li",null,"4、详细参数含义请参考《帮助文档》或",l.a.createElement("a",{href:"http://hadoop.apache.org/docs/r2.7.4/hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html",target:"blank"},"Hadoop官方文档")))),kr=l.a.createElement("div",null,"JDBC URL配置参考：",l.a.createElement("ul",null,l.a.createElement("li",null,"MySQL: jdbc:mysql://host:port/batch?useCursorFetch=true"),l.a.createElement("li",null,"Oracle: jdbc:oracle:thin:@host:port:ORCL"),l.a.createElement("li",null,"Hive: jdbc:hive2://host:port/projectName"))),Sr=l.a.createElement("div",null,"HBase配置说明：",l.a.createElement("ul",null,l.a.createElement("li",null,'1、Zookeeper 集群的地址，多个地址间用逗号分割。例 如：" IP1:Port, IP2:Port, IP3:Port/子目录".默认是 localhost,是给伪分布式用的。要修改才能在完全分布式的情况下使用。如果在hbase-env.sh设置了HBASEMANAGESZK， 这些ZooKeeper节点就会和HBase一起启动'),l.a.createElement("li",null,"2、Port: ZooKeeper的zoo.conf中的配置。客户端连接的端口， 默认2181"),l.a.createElement("li",null,"3、子目录：HBase在ZooKeeper中配置的子目录"))),Lr=l.a.createElement("div",null,l.a.createElement("p",null,"保存到默认位置，您可以在“数据管理-脏数据管理”中查看，表名：defaultName（生命周期：30天）")),wr=l.a.createElement("div",null,l.a.createElement("p",null,"任务执行结束后统计错误记录占比，当比例过高时，将此任务实例置为失败")),xr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Rr,"dataFilterDoc","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(vr,"switchKey","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Cr,"hdfsPath","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Ar,"jobSpeedLimit","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Or,"jobConcurrence","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Dr,"errorCount","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(br,"hdfsConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(kr,"rdbConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Sr,"hBaseConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Lr,"recordDirtyData","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(wr,"errorPercentConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/docs.js")),function(e){function t(){return h()(this,t),y()(this,(t.__proto__||m()(t)).apply(this,arguments))}return v()(t,e),g()(t,[{key:"render",value:function(){var e=this.props.doc;return l.a.createElement(ut.a,{key:e,title:n[e]},l.a.createElement(dt.a,M()({className:"help-doc"},this.props.style,{type:"question-circle-o"})))}}]),t}(l.a.Component)),Hr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(xr,"HelpDoc","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/helpDoc/index.js"),ta.a.Item),Pr=gt.a.Option,Nr='{\n    "defaultFS": "",\n    "hadoopConfig": {\n        "dfs.nameservices": "defaultDfs", \n        "dfs.ha.namenodes.defaultDfs": "namenode1", \n        "dfs.namenode.rpc-address.defaultDfs.namenode1": "", \n        "dfs.client.failover.proxy.provider.defaultDfs": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider" \n    }\n}',Ir=function(e){return{dataSource:e.dataSource}},jr=function(e){return{getDataSourcesType:function(t){e(Be.getDataSourcesType(t))}}},Ur=Object(A.b)(Ir,jr)(Er=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={sourceType:void 0,hasHdfsConfig:!1,hadoopConfig:"defaultDfs"},n.onOk=function(){var e;return(e=n).__onOk__REACT_HOT_LOADER__.apply(e,arguments)},n.testConnection=function(){var e;return(e=n).__testConnection__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},n.sourceChange=function(){var e;return(e=n).__sourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.enableHdfsConfig=function(){var e;return(e=n).__enableHdfsConfig__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.sourceData,a=e.sourceData;a&&a!==t&&(7===a.type?this.setState({sourceType:a.type||1,hasHdfsConfig:!0}):this.setState({sourceType:a.type||1}))}},{key:"__onOk__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.editDataSource,n=t.form;n.validateFields(function(e,t){e||(t.dataJson.jdbcUrl&&(t.dataJson.jdbcUrl=I.a.trim(t.dataJson.jdbcUrl)),t.dataJson.defaultFS&&(t.dataJson.defaultFS=I.a.trim(t.dataJson.defaultFS)),a(t,n))})}},{key:"__testConnection__REACT_HOT_LOADER__",value:function(){var e=this.state.sourceType,t=this.props.form,a=void 0;e===_e.MAXCOMPUTE&&(a=["type","dataName","dataJson.project","dataJson.endPoint","dataJson.accessKey","dataJson.accessId"]),t.validateFields(a,function(e,t){e||Ke.testDSConnection(t).then(function(e){e.data?Wt.a.success("数据源连接正常！"):Wt.a.error("数据库连接失败！")})})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.handCancel;t.resetFields(),a()}},{key:"__sourceChange__REACT_HOT_LOADER__",value:function(e){this.setState({sourceType:parseInt(e)}),this.props.form.resetFields()}},{key:"__enableHdfsConfig__REACT_HOT_LOADER__",value:function(e){this.setState({hasHdfsConfig:!e.target.value})}},{key:"renderDynamic",value:function(){var e=this.state,t=e.hasHdfsConfig,a=e.sourceType,n=this.props,r=n.form,i=n.sourceData,s=r.getFieldDecorator,o=i.dataJson||{};switch(a){case _e.HIVE:return l.a.createElement("div",null,l.a.createElement(Hr,M()({},Re,{label:"JDBC URL",hasFeedback:!0}),s("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:o.jdbcUrl||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"用户名"}),s("dataJson.username",{rules:[],initialValue:o.username||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"密码"}),s("dataJson.password",{rules:[],initialValue:""})(l.a.createElement(yt.a,{type:"password"}))),l.a.createElement(Hr,M()({},Re,{label:"defaultFS",hasFeedback:!0}),s("dataJson.defaultFS",{rules:[{required:!0,message:"defaultFS不可为空！"}],initialValue:o.defaultFS||""})(l.a.createElement(yt.a,{placeholder:"hdfs://host:port"}))),l.a.createElement(Hr,Ce,s("hasHdfsConfig",{initialValue:!1})(l.a.createElement(st.a,{checked:t,onChange:this.enableHdfsConfig},"高可用配置"))),l.a.createElement(Hr,M()({},Re,{label:"高可用配置",style:{display:t?"block":"none"}}),s("dataJson.hadoopConfig",{rules:[],initialValue:o.hadoopConfig||""})(l.a.createElement(yt.a,{type:"textarea",rows:5,placeholder:Nr})),l.a.createElement(xr,{doc:"hdfsConfig"}),l.a.createElement(yr.a,{style:{position:"absolute",right:"-20px",bottom:"0px"},copyText:Nr})));case _e.MAXCOMPUTE:return l.a.createElement("div",null,l.a.createElement(Hr,M()({},Re,{label:"AccessId",hasFeedback:!0}),s("dataJson.accessId",{rules:[{required:!0,message:"access ID不可为空！"}],initialValue:o.accessId||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"AccessKey",hasFeedback:!0}),s("dataJson.accessKey",{rules:[{required:!0,message:"access Key不可为空！"}],initialValue:o.accessKey||""})(l.a.createElement(yt.a,{type:"password",autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"Project Name",hasFeedback:!0}),s("dataJson.project",{rules:[{required:!0,message:"Project Name不可为空！"}],initialValue:o.project||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"End Point",hasFeedback:!0}),s("dataJson.endPoint",{rules:[{required:!0,message:"End Point不可为空！"}],initialValue:o.endPoint||""})(l.a.createElement(yt.a,{autoComplete:"off"}))));case _e.MYSQL:case _e.ORACLE:case _e.SQLSERVER:return l.a.createElement("div",null,l.a.createElement(Hr,M()({},Re,{label:"JDBC URL",hasFeedback:!0}),s("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:o.jdbcUrl||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"用户名",hasFeedback:!0}),s("dataJson.username",{rules:[{required:!0,message:"用户名不可为空！"}],initialValue:o.username||""})(l.a.createElement(yt.a,{autoComplete:"off"}))),l.a.createElement(Hr,M()({},Re,{label:"密码",hasFeedback:!0}),s("dataJson.password",{rules:[{required:!0,message:"密码不可为空！"}],initialValue:""})(l.a.createElement(yt.a,{type:"password"}))))}}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return l.a.createElement(Pr,{key:e.value,value:e.value.toString()},e.name)})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.title,r=e.sourceData,i=e.status,s=e.dataSource,o=(this.state.hasHdfsConfig,a.getFieldDecorator);return l.a.createElement(lt.a,{title:n,maskClosable:!1,wrapClassName:"vertical-center-modal",visible:t,onCancel:this.cancel,footer:!1},l.a.createElement(ta.a,null,l.a.createElement(Hr,M()({},Re,{label:"数据源类型",hasFeedback:!0}),o("type",{rules:[{required:!0,message:"数据源类型不可为空！"}],initialValue:r.type?r.type.toString():"1"})(l.a.createElement(gt.a,{onChange:this.sourceChange,disabled:"edit"===i},this.renderSourceType(s.sourceType)))),l.a.createElement(Hr,M()({},Re,{label:"数据源名称",hasFeedback:!0}),o("dataName",{rules:[{required:!0,message:"数据源名称不可为空！"},{max:128,message:"数据源名称不得超过128个字符！"},{pattern:/^[A-Za-z0-9_]+$/,message:"名称只能由字母与数字、下划线组成"}],initialValue:r.dataName||""})(l.a.createElement(yt.a,{autoComplete:"off",disabled:"edit"===i}))),l.a.createElement(Hr,M()({},Re,{label:"数据源描述",hasFeedback:!0}),o("dataDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:r.dataDesc||""})(l.a.createElement(yt.a,{type:"textarea",rows:4}))),this.renderDynamic(),l.a.createElement(Hr,Ce,l.a.createElement(Kt.a,{icon:"sync",type:"primary","data-target":"test",onClick:this.testConnection,style:{marginRight:"10px"}},"测试连通性"),l.a.createElement(Kt.a,{type:"primary",style:{marginRight:"10px"},onClick:this.onOk},"确定"),l.a.createElement(Kt.a,{onClick:this.cancel},"取消"))))}}]),t}(o.Component))||Er,Mr=ta.a.create()(Ur),Fr=Mr,Qr=Fr,Vr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Hr,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Pr,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Nr,"hdfsConf","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Ir,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(jr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Ur,"DataSourceModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Mr,"DataSourceFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Fr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/editModal.js")),yt.a.Search),Gr=function(e){return{dataSource:e.dataSource}},zr=function(e){return{getDataSources:function(t){e(Be.getDataSources(t))}}},qr=Object(A.b)(Gr,zr)(hr=function(e){function t(){var e,a,n,r;h()(this,t);for(var i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(s))),n.state={visible:!1,title:"新增数据源",status:"add",source:{},params:{currentPage:1,pageSize:20,name:void 0,type:void 0,active:void 0}},n.searchDataSources=function(){var e;return(e=n).__searchDataSources__REACT_HOT_LOADER__.apply(e,arguments)},n.editDataSource=function(){var e;return(e=n).__editDataSource__REACT_HOT_LOADER__.apply(e,arguments)},n.remove=function(){var e;return(e=n).__remove__REACT_HOT_LOADER__.apply(e,arguments)},n.handleTableChange=function(){var e;return(e=n).__handleTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.initEdit=function(){var e;return(e=n).__initEdit__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){this.props.getDataSources(this.state.params)}},{key:"__searchDataSources__REACT_HOT_LOADER__",value:function(e){var t=M()({},this.state.params,{name:e||void 0,currentPage:1});this.setState({params:t}),this.props.getDataSources(t)}},{key:"__editDataSource__REACT_HOT_LOADER__",value:function(e,t){var a=this,n=this.state,r=n.title,i=n.status,s=n.source,o=n.params;"edit"===i?Ke.updateDataSource(M()({},s,e)).then(function(e){1===e.code&&(t.resetFields(),a.setState({visible:!1}),Wt.a.success(r+"成功！"),a.props.getDataSources(o))}):Ke.addDataSource(e).then(function(e){1===e.code&&(t.resetFields(),a.setState({visible:!1}),Wt.a.success(r+"成功！"),a.props.getDataSources(o))})}},{key:"__remove__REACT_HOT_LOADER__",value:function(e){var t=this;1!==e.active?Ke.deleteDataSource({sourceId:e.id}).then(function(e){1===e.code&&(Wt.a.success("移除数据源成功！"),t.props.getDataSources(t.state.params))}):Wt.a.info("此数据源已在任务中被引用，无法删除!")}},{key:"__handleTableChange__REACT_HOT_LOADER__",value:function(e,t){var a=t.active,n=t.type,r=M()({},this.state.params,{currentPage:e.current,active:a?a[0]:void 0,type:n?n[0]:void 0});this.setState({params:r}),this.props.getDataSources(r)}},{key:"__initEdit__REACT_HOT_LOADER__",value:function(e){this.setState({visible:!0,title:"编辑数据源",status:"edit",source:e})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"数据源名称",dataIndex:"dataName",key:"dataName",width:"18%",render:function(e){return l.a.createElement("div",{className:"ellipsis-td",title:e},e)}},{title:"类型",dataIndex:"type",key:"type",filters:Ee,filterMultiple:!1,width:"10%",render:function(e,t){return t.sourceTypeValue}},{title:"描述信息",dataIndex:"dataDesc",key:"dataDesc",width:"22%"},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"15%"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return ne()(e).format("YYYY-MM-DD HH:mm:ss")},width:"15%"},{title:"应用状态",dataIndex:"active",key:"active",filters:[{text:"未使用",value:0},{text:"使用中",value:1}],filterMultiple:!1,render:function(e){return 1===e?"使用中":"未使用"},width:"10%"},{title:"操作",width:"10%",render:function(t,a){return l.a.createElement("span",null,l.a.createElement("a",{onClick:function(){e.initEdit(a)}},"编辑"),l.a.createElement("span",{className:"ant-divider"}),l.a.createElement($t.a,{title:"确定删除此数据源？",okText:"确定",cancelText:"取消",onConfirm:function(){e.remove(a)}},l.a.createElement("a",null,"删除")))}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.title,r=t.status,i=t.source,s=t.params,o=this.props.dataSource,c=o.sourceQuery,u=o.loading,_={current:s.currentPage,pageSize:s.pageSize,total:c.totalCount},d=l.a.createElement(Vr,{placeholder:"数据源名称",style:{width:200,margin:"10px 0"},onSearch:this.searchDataSources}),p=l.a.createElement(Kt.a,{type:"primary",style:{margin:"10px 0"},className:"right",onClick:function(){e.setState({visible:!0,source:{},status:"add",title:"添加数据源"})}},"新增数据源");return l.a.createElement("div",{className:"source-page"},l.a.createElement("h1",{className:"box-title"},"数据源管理"),l.a.createElement("div",{className:"box-2 m-card shadow"},l.a.createElement(K.a,{noHovering:!0,bordered:!1,title:d,extra:p},l.a.createElement(q.a,{rowKey:"id",loading:u,className:"m-table fixed-table",pagination:_,columns:this.initColumns(),dataSource:c.data,onChange:this.handleTableChange}))),l.a.createElement(Qr,{title:n,status:r,visible:a,sourceData:i,editDataSource:this.editDataSource,handCancel:function(){e.setState({visible:!1,source:{}})}}))}}]),t}(o.Component))||hr,Yr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Vr,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(Gr,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(zr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(qr,"DataSource","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/views/dataSource/index.js")),l.a.createElement(C.d,{path:"/",component:O.a},l.a.createElement(C.b,{component:rt}),l.a.createElement(C.d,{path:"/message",component:D.a},l.a.createElement(C.b,{component:b.a}),l.a.createElement(C.d,{path:"list",component:b.a}),l.a.createElement(C.d,{path:"detail/:msgId",component:k.a})),l.a.createElement(C.d,{path:"/admin",component:S.a},l.a.createElement(C.b,{component:L.a}),l.a.createElement(C.d,{path:"user",component:L.a}),l.a.createElement(C.d,{path:"role",component:w.a}),l.a.createElement(C.d,{path:"role/add",component:x.a}),l.a.createElement(C.d,{path:"role/edit/:roleId",component:H.a})),l.a.createElement(C.d,{path:"/dq",component:rt},l.a.createElement(C.b,{component:Ne}),l.a.createElement(C.d,{path:"overview",component:Ne}),l.a.createElement(C.d,{path:"taskQuery",component:qt}),l.a.createElement(C.d,{path:"rule",component:Qa}),l.a.createElement(C.d,{path:"rule/add",component:gn}),l.a.createElement(C.d,{path:"rule/edit/:id",component:gn}),l.a.createElement(C.d,{path:"dataCheck",component:wn}),l.a.createElement(C.d,{path:"dataCheck/add",component:gr}),l.a.createElement(C.d,{path:"dataCheck/edit/:verifyId",component:gr}),l.a.createElement(C.d,{path:"dataCheck/report/:verifyRecordId",component:fr}),l.a.createElement(C.d,{path:"dataSource",component:qr})))),Kr=Yr,Br=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Yr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/routers.js"),function(e){function t(){return h()(this,t),y()(this,(t.__proto__||m()(t)).apply(this,arguments))}return v()(t,e),g()(t,[{key:"render",value:function(){var e=this.props,t=e.store,a=e.history;return l.a.createElement(A.a,{store:t},l.a.createElement(C.e,{routes:Kr,history:a,key:Math.random()}))}}]),t}(l.a.Component)),Wr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Br,"Root","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/root.js"),function(e){var t=a("swku").default,n=Object(d.a)(t,"hash"),r=n.store,i=n.history;u.a.render(l.a.createElement(_.AppContainer,null,l.a.createElement(e,{store:r,history:i})),document.getElementById("app"))});Wr(Br);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Wr,"render","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/app.js")},kH9T:function(e,t,a){},oYF1:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["CHANGE_LOADING","GET_DATA_SOURCES","GET_DATA_SOURCES_TYPE","GET_DATA_SOURCES_LIST","CHANGE_GETTABLE_LOADING","GET_DATA_SOURCES_TABLE","RESET_DATA_SOURCES_TABLE","GET_DATA_SOURCES_COLUMN","GET_DATA_SOURCES_PART","RESET_DATA_SOURCES_PART","GET_DATA_SOURCES_PREVIEW"],{prefix:"dataSource/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dataSourceActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/dataSourceActionType.js")},swku:function(e,t,a){"use strict";a.r(t);var n=a("fvjX"),r=a("L3Ur"),i=a("6EK8"),s=a("+JEa"),o=a("MJ9B"),l=a("LvDl"),c={loading:!1,topRecords:[],alarmTrend:[],alarmSum:{},usage:{}};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1],a=t.type,n=t.payload;switch(a){case o.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),i=r.loading;return r.loading=!i,r;case o.a.GET_TOP_RECORD:var s=Object(l.cloneDeep)(e);s.topRecords;return s.topRecords=n,s;case o.a.GET_ALARM_SUM:var u=Object(l.cloneDeep)(e);u.alarmSum;return u.alarmSum=n,u;case o.a.GET_ALARM_TREND:var _=Object(l.cloneDeep)(e);_.alarmTrend;return _.alarmTrend=n,_;case o.a.GET_USAGE:var d=Object(l.cloneDeep)(e);d.usage;return d.usage=n,d;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dashBoard/index.js"),__REACT_HOT_LOADER__.register(u,"dashBoard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dashBoard/index.js"));var _=a("j2qn"),d={loading:!1,taskList:[],taskDetail:[],tableReport:{},alarmNum:[]};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1],a=t.type,n=t.payload;switch(a){case _.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),i=r.loading;return r.loading=!i,r;case _.a.GET_TASK_LIST:var s=Object(l.cloneDeep)(e);s.taskList;return s.taskList=n,s;case _.a.GET_TASK_DETAIL:var o=Object(l.cloneDeep)(e);o.taskDetail;return o.taskDetail=n,o;case _.a.GET_TASK_TABLE_REPORT:var c=Object(l.cloneDeep)(e);c.tableReport;return c.tableReport=n,c;case _.a.GET_TASK_ALARM_NUM:var u=Object(l.cloneDeep)(e);u.alarmNum;return u.alarmNum=n,u;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/taskQuery/index.js"),__REACT_HOT_LOADER__.register(p,"taskQuery","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/taskQuery/index.js"));var m=a("YXul"),E={loading:!1,lists:[],checkReport:{},originPart:[],targetPart:[],reportTable:{}};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments[1],a=t.type,n=t.payload;switch(a){case m.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),i=r.loading;return r.loading=!i,r;case m.a.GET_LIST:var s=Object(l.cloneDeep)(e);s.lists;return s.lists=n,s;case m.a.GET_SOURCE_PART:var o=Object(l.cloneDeep)(e);o.originPart,o.targetPart;return"origin"===n.type?o.originPart=n.data:o.targetPart=n.data,o;case m.a.RESET_SOURCE_PART:var c=Object(l.cloneDeep)(e);c.originPart,c.targetPart;return"origin"===n?c.originPart=[]:c.targetPart=[],c;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(E,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataCheck/index.js"),__REACT_HOT_LOADER__.register(h,"dataCheck","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataCheck/index.js"));var T=a("oYF1"),g={loading:!1,tableLoading:!1,sourceQuery:[],sourceType:[],sourceList:[],sourceTable:[],sourceColumn:[],sourcePart:[],sourcePreview:{}};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments[1],a=t.type,n=t.payload;switch(a){case T.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),i=r.loading;return r.loading=!i,r;case T.a.CHANGE_GETTABLE_LOADING:var s=Object(l.cloneDeep)(e),o=s.tableLoading;return s.tableLoading=!o,s;case T.a.GET_DATA_SOURCES:var c=Object(l.cloneDeep)(e);c.sourceQuery;return c.sourceQuery=n,c;case T.a.GET_DATA_SOURCES_TYPE:var u=Object(l.cloneDeep)(e);u.sourceType;return u.sourceType=n,u;case T.a.GET_DATA_SOURCES_LIST:var _=Object(l.cloneDeep)(e);_.sourceList;return _.sourceList=n,_;case T.a.GET_DATA_SOURCES_TABLE:var d=Object(l.cloneDeep)(e);d.sourceTable;return d.sourceTable=n,d;case T.a.RESET_DATA_SOURCES_TABLE:var p=Object(l.cloneDeep)(e);p.sourceTable;return p.sourceTable=[],p;case T.a.GET_DATA_SOURCES_COLUMN:var m=Object(l.cloneDeep)(e);m.sourceColumn;return m.sourceColumn=n,m;case T.a.GET_DATA_SOURCES_PART:var E=Object(l.cloneDeep)(e);E.sourcePart;return E.sourcePart=n,E;case T.a.RESET_DATA_SOURCES_PART:var h=Object(l.cloneDeep)(e);h.sourcePart;return h.sourcePart=[],h;case T.a.GET_DATA_SOURCES_PREVIEW:var f=Object(l.cloneDeep)(e);f.sourcePreview;return f.sourcePreview=n,f;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataSource/index.js"),__REACT_HOT_LOADER__.register(f,"dataSource","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataSource/index.js"));var y=a("tgFt"),R={loading:!1,monitorList:[],monitorFunction:[],tableColumn:[],monitorRules:[],monitorDetail:{},triggerList:[]};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments[1],a=t.type,n=t.payload;switch(a){case y.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),i=r.loading;return r.loading=!i,r;case y.a.GET_MONITOR_LIST:var s=Object(l.cloneDeep)(e);s.monitorList;return s.monitorList=n,s;case y.a.GET_MONITOR_TABLE_COLUMN:var o=Object(l.cloneDeep)(e);o.tableColumn;return o.tableColumn=n,o;case y.a.GET_RULE_FUNCTION:var c=Object(l.cloneDeep)(e);c.monitorFunction;return c.monitorFunction=n,c;case y.a.GET_MONITOR_RULE:var u=Object(l.cloneDeep)(e);u.monitorRules;return u.monitorRules=n,u;case y.a.GET_MONITOR_DETAIL:var _=Object(l.cloneDeep)(e);_.monitorDetail;return _.monitorDetail=n,_;case y.a.GET_REMOTE_TRIGGER:var d=Object(l.cloneDeep)(e);d.triggerList;return d.triggerList=n,d;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(R,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/ruleConfig/index.js"),__REACT_HOT_LOADER__.register(v,"ruleConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/ruleConfig/index.js"));var C=a("m1cH"),A=a.n(C),O=a("u+gO"),D={source:[],target:[]};function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments[1];switch(t.type){case O.a.ADD_LINKED_KEYS:var a=t.payload,n=Object(l.cloneDeep)(e),r=n.source,i=n.target,s=function(e,t){return e.indexOf(t)>-1};return s(r,a.source)?e:s(i,a.target)?e:(n.source=[].concat(A()(n.source),[a.source]),n.target=[].concat(A()(n.target),[a.target]),n);case O.a.DEL_LINKED_KEYS:var o=t.payload,c=Object(l.cloneDeep)(e),u=c.source,_=c.target;return u.splice(u.indexOf(o.source),1),_.splice(_.indexOf(o.target),1),c.source=u,c.target=_,c;case O.a.SET_EDIT_MAP:var d=t.payload,p=Object(l.cloneDeep)(e);return p.source=d.source,p.target=d.target,p;case O.a.SET_ROW_MAP:var m=t.payload,E=m.sourceKeyCol,h=m.targetKeyCol,T=[],g=[];return E.forEach(function(e,t){h[t]&&(T.push(e),g.push(h[t]))}),{source:T,target:g};case O.a.SET_NAME_MAP:var f=t.payload,y=f.sourceKeyCol,R=f.targetKeyCol,v=[],C=[];return y.forEach(function(e,t){R.indexOf(e)>-1&&(v.push(e),C.push(e))}),{source:v,target:C};case O.a.RESET_LINKED_KEYS:return{source:[],target:[]};default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(D,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataCheck/keymap.js"),__REACT_HOT_LOADER__.register(b,"keymap","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/dataCheck/keymap.js"));var k=a("F2FU"),S={userList:[],allDict:{}};function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments[1],a=t.type,n=t.payload;switch(a){case k.a.GET_USER_LIST:var r=Object(l.cloneDeep)(e);r.userList;return r.userList=n,r;case k.a.GET_ALL_DICT:var i=Object(l.cloneDeep)(e);i.allDict;return i.allDict=n,i;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(S,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/common.js"),__REACT_HOT_LOADER__.register(L,"dataCheck","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/modules/common.js"));var w=Object(n.c)({routing:r.routerReducer,user:i.a,app:s.a,apps:s.b,dashBoard:u,taskQuery:p,dataCheck:h,dataSource:f,ruleConfig:v,common:L,keymap:b}),x=w;t.default=x,"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(w,"rootReducer","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/index.js"),__REACT_HOT_LOADER__.register(x,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/reducers/index.js"))},"t/36":function(e,t,a){},tgFt:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["CHANGE_LOADING","GET_MONITOR_LIST","GET_RULE_FUNCTION","GET_MONITOR_TABLE_COLUMN","CHANGE_PARAMS","GET_MONITOR_RULE","GET_MONITOR_DETAIL","GET_REMOTE_TRIGGER"],{prefix:"ruleConfig/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"ruleConfigActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/ruleConfigActionType.js")},"u+gO":function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a("zbcj"),r=a.n(n)()(["ADD_LINKED_KEYS","DEL_LINKED_KEYS","SET_EDIT_MAP","SET_ROW_MAP","SET_NAME_MAP","RESET_LINKED_KEYS","EDIT_KEYMAP_TARGET","REMOVE_KEYMAP"],{prefix:"dataSource/keyMap/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"keyMapActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataQuality/consts/keyMapActionType.js")},zXZS:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a("Yz+Y"),r=a.n(n),i=a("iCc5"),s=a.n(i),o=a("V7oC"),l=a.n(o),c=a("FYw3"),u=a.n(c),_=a("mRg0"),d=a.n(_),p=a("sbe7"),m=function(e){function t(){var e,a,n,i;s()(this,t);for(var o=arguments.length,l=Array(o),c=0;c<o;c++)l[c]=arguments[c];return a=n=u()(this,(e=t.__proto__||r()(t)).call.apply(e,[this].concat(l))),n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},i=a,u()(n,i)}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1)}},{key:"__resize__REACT_HOT_LOADER__",value:function(){var e=this.props.onResize;e&&e()}},{key:"render",value:function(){return this.props.children}}]),t}(p.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(m,"Resize","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/resize/index.js")}},[["j7hF",59,62,61,63,64,69,60]]]);