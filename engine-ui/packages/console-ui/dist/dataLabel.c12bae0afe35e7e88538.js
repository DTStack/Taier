(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"0o9m":function(e,t,a){var n=a("ProS");a("hNWo"),a("RlCK"),a("XpcN");var i=a("kDyi"),r=a("bLfw");n.registerProcessor(i),r.registerSubTypeDefaulter("legend",function(){return"plain"})},"2NsA":function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a("dtw8"),i=(a("1ZXz"),a("TdMD")),r=a.n(i),o=a("fvjX"),l=a("L3Ur");function s(e,t){var a=function(e){return Object(o.e)(e,Object(o.a)(r.a))}(e),i=t&&"hash"===t?n.g:n.f;return{store:a,history:Object(l.syncHistoryWithStore)(i,a)}}},"2XEC":function(e,t,a){"use strict";a.r(t);var n=a("fvjX"),i=a("L3Ur"),r=a("6EK8"),o=a("+JEa"),l=a("5NcA"),s=a("LvDl"),c={loading:!1,sourceQuery:[],sourceType:[],sourceList:[],tagSourceList:[],sourceTable:[],sourceColumn:[],sourcePart:[],sourcePreview:{}};var u=a("UEq8"),d={userList:[],menuList:[],periodType:[],notifyType:[]};var p=a("H6kJ"),m={loading:!1,ruleTagList:[],registeredTagList:[],identifyColumn:[]};var h=a("2skF"),g={apiCatalogue:[],apiList:[],api:{},apiCallInfo:{}};var f=a("EgI3"),y={apiList:{applyingList:[],appliedList:[]}};var E=a("jaNl"),v={apiList:[]};var S=a("vFmn"),C={approvalList:[]};var T=Object(n.c)({routing:i.routerReducer,user:r.a,app:o.a,apps:o.b,tagConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments[1],a=t.type,n=t.payload;switch(a){case p.a.CHANGE_LOADING:var i=Object(s.cloneDeep)(e),r=i.loading;return i.loading=!r,i;case p.a.GET_RULE_TAG_LIST:var o=Object(s.cloneDeep)(e);return o.ruleTagList,o.ruleTagList=n,o;case p.a.GET_REGISTERED_TAG_LIST:var l=Object(s.cloneDeep)(e);return l.registeredTagList,l.registeredTagList=n,l;case p.a.GET_ALL_IDENTIFY_COLUMN:var c=Object(s.cloneDeep)(e);return c.identifyColumn,c.identifyColumn=n,c;default:return e}},dataSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1],a=t.type,n=t.payload;switch(a){case l.a.CHANGE_LOADING:var i=Object(s.cloneDeep)(e),r=i.loading;return i.loading=!r,i;case l.a.GET_DATA_SOURCES:var o=Object(s.cloneDeep)(e);return o.sourceQuery,o.sourceQuery=n,o;case l.a.GET_DATA_SOURCES_TYPE:var u=Object(s.cloneDeep)(e);return u.sourceType,u.sourceType=n,u;case l.a.GET_DATA_SOURCES_LIST:var d=Object(s.cloneDeep)(e);return d.sourceList,d.sourceList=n,d;case l.a.GET_TAG_DATA_SOURCES_LIST:var p=Object(s.cloneDeep)(e);return p.tagSourceList,p.tagSourceList=n,p;case l.a.GET_DATA_SOURCES_TABLE:var m=Object(s.cloneDeep)(e);return m.sourceTable,m.sourceTable=n,m;case l.a.RESET_DATA_SOURCES_TABLE:var h=Object(s.cloneDeep)(e);return h.sourceTable,h.sourceTable=[],h;case l.a.GET_DATA_SOURCES_COLUMN:var g=Object(s.cloneDeep)(e);return g.sourceColumn,g.sourceColumn=n,g;case l.a.RESET_DATA_SOURCES_COLUMN:var f=Object(s.cloneDeep)(e);return f.sourceColumn,f.sourceColumn=[],f;case l.a.GET_DATA_SOURCES_PREVIEW:var y=Object(s.cloneDeep)(e);return y.sourcePreview,y.sourcePreview=n,y;default:return e}},common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1],a=t.type,n=t.payload;switch(a){case u.a.GET_USER_LIST:var i=Object(s.cloneDeep)(e);return i.userList,i.userList=n,i;case u.a.GET_ALL_MENU_LIST:var r=Object(s.cloneDeep)(e);return r.menuList,r.menuList=n,r;case u.a.GET_PERIOD_TYPE:var o=Object(s.cloneDeep)(e);return o.periodType,o.periodType=n,o;case u.a.GET_NOTIFY_TYPE:var l=Object(s.cloneDeep)(e);return l.notifyType,l.notifyType=n,l;default:return e}},apiMarket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments[1],a=t.type,n=t.payload;switch(a){case h.a.GET_CATALOGUE:var i=Object(s.cloneDeep)(e);return i.apiCatalogue=n,i;case h.a.GET_API_MARKET_LIST:var r=Object(s.cloneDeep)(e);return r.apiList=n,r;case h.a.GET_MARKET_API_DETAIL:var o=Object(s.cloneDeep)(e);return o.api[n.apiId]=n,o;case h.a.GET_API_EXT_INFO:var l=Object(s.cloneDeep)(e);return l.apiCallInfo[n.apiId]=n,l;default:return e}},mine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments[1],a=t.type,n=t.payload;switch(a){case f.a.GET_APPLYING_LIST:var i=Object(s.cloneDeep)(e);return i.apiList.applyingList=n,i;case f.a.GET_APPLYED_LIST:var r=Object(s.cloneDeep)(e);return r.apiList.appliedList=n,r;default:return e}},apiManage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments[1],a=t.type,n=t.payload;switch(a){case E.a.GET_ALL_API_LIST:var i=Object(s.cloneDeep)(e);return i.apiList=n,i;default:return e}},approval:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments[1],a=t.type,n=t.payload;switch(a){case S.a.GET_ALL_APPLY_LIST:var i=Object(s.cloneDeep)(e);return i.approvalList=n,i;default:return e}}});t.default=T},"2skF":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["GET_CATALOGUE","GET_API_MARKET_LIST","GET_MARKET_API_DETAIL","GET_API_EXT_INFO"],{prefix:"apiMarket/"})},"3J6H":function(e,t,a){},"5NcA":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["CHANGE_LOADING","GET_DATA_SOURCES","GET_DATA_SOURCES_TYPE","GET_DATA_SOURCES_LIST","GET_TAG_DATA_SOURCES_LIST","GET_DATA_SOURCES_TABLE","RESET_DATA_SOURCES_TABLE","GET_DATA_SOURCES_COLUMN","RESET_DATA_SOURCES_COLUMN","GET_DATA_SOURCES_PREVIEW"],{prefix:"dataSource/"})},"6EK8":function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a("QbLZ"),i=a.n(n),r=(a("LvDl"),a("CMun")),o={id:0,dtuicUserId:0,userName:"未登录",isRoot:!1};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1];switch(t.type){case r.a.GET_USER:return t.data;case r.a.UPDATE_USER:return null!==t.data?i()({},e,t.data):e;default:return e}}},"95Qq":function(e,t,a){},EMQV:function(e,t,a){},EgI3:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["GET_APPLYING_LIST","GET_APPLYED_LIST"],{prefix:"mine/"})},FdzR:function(e,t,a){},H6kJ:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["CHANGE_LOADING","GET_RULE_TAG_LIST","GET_REGISTERED_TAG_LIST","GET_ALL_IDENTIFY_COLUMN"],{prefix:"tagConfig/"})},KnRw:function(e,t,a){var n={"./af":"/Tvm","./af.js":"/Tvm","./ar":"yRKQ","./ar-dz":"2Mgn","./ar-dz.js":"2Mgn","./ar-kw":"SyK9","./ar-kw.js":"SyK9","./ar-ly":"Km2t","./ar-ly.js":"Km2t","./ar-ma":"k+3Q","./ar-ma.js":"k+3Q","./ar-sa":"dbzX","./ar-sa.js":"dbzX","./ar-tn":"E7L0","./ar-tn.js":"E7L0","./ar.js":"yRKQ","./az":"marO","./az.js":"marO","./be":"c9Cq","./be.js":"c9Cq","./bg":"Rxhz","./bg.js":"Rxhz","./bm":"Zf0k","./bm.js":"Zf0k","./bn":"qbSa","./bn.js":"qbSa","./bo":"aPmz","./bo.js":"aPmz","./br":"V/F2","./br.js":"V/F2","./bs":"CToL","./bs.js":"CToL","./ca":"GuxH","./ca.js":"GuxH","./cs":"qrel","./cs.js":"qrel","./cv":"wv9F","./cv.js":"wv9F","./cy":"7JVd","./cy.js":"7JVd","./da":"PtRy","./da.js":"PtRy","./de":"xhqU","./de-at":"bJtj","./de-at.js":"bJtj","./de-ch":"fRjz","./de-ch.js":"fRjz","./de.js":"xhqU","./dv":"tEna","./dv.js":"tEna","./el":"vE8+","./el.js":"vE8+","./en-au":"aGvD","./en-au.js":"aGvD","./en-ca":"TyIU","./en-ca.js":"TyIU","./en-gb":"xbvL","./en-gb.js":"xbvL","./en-ie":"8wpQ","./en-ie.js":"8wpQ","./en-nz":"mRnY","./en-nz.js":"mRnY","./eo":"nEfC","./eo.js":"nEfC","./es":"QqXE","./es-do":"OH6n","./es-do.js":"OH6n","./es-us":"VqXm","./es-us.js":"VqXm","./es.js":"QqXE","./et":"/BjE","./et.js":"/BjE","./eu":"lS/Y","./eu.js":"lS/Y","./fa":"Xl2a","./fa.js":"Xl2a","./fi":"pKmA","./fi.js":"pKmA","./fo":"1sIW","./fo.js":"1sIW","./fr":"t+gs","./fr-ca":"ApVP","./fr-ca.js":"ApVP","./fr-ch":"mR/r","./fr-ch.js":"mR/r","./fr.js":"t+gs","./fy":"zrXP","./fy.js":"zrXP","./gd":"7WNt","./gd.js":"7WNt","./gl":"EkHg","./gl.js":"EkHg","./gom-latn":"IlNN","./gom-latn.js":"IlNN","./gu":"SIlg","./gu.js":"SIlg","./he":"RWgf","./he.js":"RWgf","./hi":"fVgC","./hi.js":"fVgC","./hr":"QeL5","./hr.js":"QeL5","./hu":"UGq4","./hu.js":"UGq4","./hy-am":"powx","./hy-am.js":"powx","./id":"+gpe","./id.js":"+gpe","./is":"3azS","./is.js":"3azS","./it":"T/vC","./it.js":"T/vC","./ja":"n/+T","./ja.js":"n/+T","./jv":"pOn/","./jv.js":"pOn/","./ka":"5BLU","./ka.js":"5BLU","./kk":"i4p7","./kk.js":"i4p7","./km":"Rdvl","./km.js":"Rdvl","./kn":"x+k7","./kn.js":"x+k7","./ko":"+Fhz","./ko.js":"+Fhz","./ky":"dDLa","./ky.js":"dDLa","./lb":"Gudj","./lb.js":"Gudj","./lo":"VShb","./lo.js":"VShb","./lt":"5eMR","./lt.js":"5eMR","./lv":"JdG9","./lv.js":"JdG9","./me":"VVnP","./me.js":"VVnP","./mi":"oQ6b","./mi.js":"oQ6b","./mk":"tXUT","./mk.js":"tXUT","./ml":"uPxb","./ml.js":"uPxb","./mr":"b8N1","./mr.js":"b8N1","./ms":"Wnnz","./ms-my":"b+tO","./ms-my.js":"b+tO","./ms.js":"Wnnz","./mt":"V6YG","./mt.js":"V6YG","./my":"rt8X","./my.js":"rt8X","./nb":"xyXD","./nb.js":"xyXD","./ne":"4vTz","./ne.js":"4vTz","./nl":"6QMr","./nl-be":"LMGY","./nl-be.js":"LMGY","./nl.js":"6QMr","./nn":"Qsvx","./nn.js":"Qsvx","./pa-in":"oA7N","./pa-in.js":"oA7N","./pl":"C/jI","./pl.js":"C/jI","./pt":"V7OV","./pt-br":"b3iz","./pt-br.js":"b3iz","./pt.js":"V7OV","./ro":"TwjK","./ro.js":"TwjK","./ru":"YJSy","./ru.js":"YJSy","./sd":"4xdR","./sd.js":"4xdR","./se":"j5S3","./se.js":"j5S3","./si":"Am5L","./si.js":"Am5L","./sk":"sSmc","./sk.js":"sSmc","./sl":"9iY4","./sl.js":"9iY4","./sq":"cnMZ","./sq.js":"cnMZ","./sr":"ss7R","./sr-cyrl":"tGLK","./sr-cyrl.js":"tGLK","./sr.js":"ss7R","./ss":"mYhl","./ss.js":"mYhl","./sv":"IGtO","./sv.js":"IGtO","./sw":"p49z","./sw.js":"p49z","./ta":"VVil","./ta.js":"VVil","./te":"YQaq","./te.js":"YQaq","./tet":"2u18","./tet.js":"2u18","./th":"gJLt","./th.js":"gJLt","./tl-ph":"ogwM","./tl-ph.js":"ogwM","./tlh":"0bHV","./tlh.js":"0bHV","./tr":"BYDG","./tr.js":"BYDG","./tzl":"IUMd","./tzl.js":"IUMd","./tzm":"94jC","./tzm-latn":"Mgge","./tzm-latn.js":"Mgge","./tzm.js":"94jC","./uk":"NrFT","./uk.js":"NrFT","./ur":"U58I","./ur.js":"U58I","./uz":"orAx","./uz-latn":"jCvl","./uz-latn.js":"jCvl","./uz.js":"orAx","./vi":"t2dB","./vi.js":"t2dB","./x-pseudo":"XFnJ","./x-pseudo.js":"XFnJ","./yo":"qKGQ","./yo.js":"qKGQ","./zh-cn":"3O3J","./zh-cn.js":"3O3J","./zh-hk":"Fu0X","./zh-hk.js":"Fu0X","./zh-tw":"2Pdx","./zh-tw.js":"2Pdx"};function i(e){var t=r(e);return a(t)}function r(e){var t=n[e];if(!(t+1)){var a=new Error('Cannot find module "'+e+'".');throw a.code="MODULE_NOT_FOUND",a}return t}i.keys=function(){return Object.keys(n)},i.resolve=r,e.exports=i,i.id="KnRw"},RlCK:function(e,t,a){var n=a("ProS"),i=a("bYtY");function r(e,t,a){var n,r={},o="toggleSelected"===e;return a.eachComponent("legend",function(a){o&&null!=n?a[n?"select":"unSelect"](t.name):(a[e](t.name),n=a.isSelected(t.name));var l=a.getData();i.each(l,function(e){var t=e.get("name");if("\n"!==t&&""!==t){var n=a.isSelected(t);r.hasOwnProperty(t)?r[t]=r[t]&&n:r[t]=n}})}),{name:t.name,selected:r}}n.registerAction("legendToggleSelect","legendselectchanged",i.curry(r,"toggleSelected")),n.registerAction("legendSelect","legendselected",i.curry(r,"select")),n.registerAction("legendUnSelect","legendunselected",i.curry(r,"unSelect"))},THQc:function(e,t,a){},TmhF:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("udPp");function i(e){return{type:n.a.UPDATE_APP,data:e}}},UEq8:function(e,t,a){"use strict";var n=a("zbcj"),i=a.n(n)()(["GET_USER_LIST","GET_ALL_MENU_LIST","GET_PERIOD_TYPE","GET_NOTIFY_TYPE"],{prefix:"common/"});t.a=i},WaWy:function(e,t,a){"use strict";a("FGdI");var n=a("Pbn2"),i=a.n(n),r=a("Yz+Y"),o=a.n(r),l=a("iCc5"),s=a.n(l),c=a("V7oC"),u=a.n(c),d=a("FYw3"),p=a.n(d),m=a("mRg0"),h=a.n(m),g=a("17x9"),f=a.n(g),y=a("LvDl"),E=a("sbe7"),v=a.n(E),S=(a("THQc"),f.a.oneOfType([f.a.string,f.a.number])),C={children:f.a.node,left:S,width:S,visible:f.a.bool},T=function(e){function t(e){return s()(this,t),p()(this,(t.__proto__||o()(t)).call(this,e))}return h()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.visible,n=e.style,r=e.className,o=e.onClose,l="slide-pane",s={top:0,transform:a?"translate3d(0%, 0, 0)":"translate3d(150%, 0, 0)"};return r&&(l=l+" "+r),n&&(s=Object(y.assign)(s,n)),v.a.createElement("div",{className:l,style:s},v.a.createElement("div",{className:"slide-pane-conent"},t),v.a.createElement("span",{className:"slide-pane-toggle",onClick:o},v.a.createElement(i.a,{type:"double-right"})))}}]),t}(E.Component);T.propTypes=C,t.a=T},XpcN:function(e,t,a){a("Tghj").__DEV__;var n=a("ProS"),i=a("bYtY"),r=a("oVpE").createSymbol,o=a("IwbS"),l=a("eRkO").makeBackground,s=a("+TT/"),c=i.curry,u=i.each,d=o.Group,p=n.extendComponentView({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new d),this._backgroundEl},getContentGroup:function(){return this._contentGroup},render:function(e,t,a){if(this.resetInner(),e.get("show",!0)){var n=e.get("align");n&&"auto"!==n||(n="right"===e.get("left")&&"vertical"===e.get("orient")?"right":"left"),this.renderInner(n,e,t,a);var r=e.getBoxLayoutParams(),o={width:a.getWidth(),height:a.getHeight()},c=e.get("padding"),u=s.getLayoutRect(r,o,c),d=this.layoutInner(e,n,u),p=s.getLayoutRect(i.defaults({width:d.width,height:d.height},r),o,c);this.group.attr("position",[p.x-d.x,p.y-d.y]),this.group.add(this._backgroundEl=l(d,e))}},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl)},renderInner:function(e,t,a,n){var r=this.getContentGroup(),o=i.createHashMap(),l=t.get("selectedMode");u(t.getData(),function(i,s){var u=i.get("name");if(this.newlineDisabled||""!==u&&"\n"!==u){var p=a.getSeriesByName(u)[0];if(!o.get(u))if(p){var f=p.getData(),y=f.getVisual("color");"function"==typeof y&&(y=y(p.getDataParams(0)));var E=f.getVisual("legendSymbol")||"roundRect",v=f.getVisual("symbol");this._createItem(u,s,i,t,E,v,e,y,l).on("click",c(m,u,n)).on("mouseover",c(h,p,null,n)).on("mouseout",c(g,p,null,n)),o.set(u,!0)}else a.eachRawSeries(function(a){if(!o.get(u)&&a.legendDataProvider){var r=a.legendDataProvider(),d=r.indexOfName(u);if(d<0)return;var p=r.getItemVisual(d,"color");this._createItem(u,s,i,t,"roundRect",null,e,p,l).on("click",c(m,u,n)).on("mouseover",c(h,a,u,n)).on("mouseout",c(g,a,u,n)),o.set(u,!0)}},this)}else r.add(new d({newline:!0}))},this)},_createItem:function(e,t,a,n,l,s,c,u,p){var m=n.get("itemWidth"),h=n.get("itemHeight"),g=n.get("inactiveColor"),f=n.isSelected(e),y=new d,E=a.getModel("textStyle"),v=a.get("icon"),S=a.getModel("tooltip"),C=S.parentModel;if(l=v||l,y.add(r(l,0,0,m,h,f?u:g,!0)),!v&&s&&(s!==l||"none"==s)){var T=.8*h;"none"===s&&(s="circle"),y.add(r(s,(m-T)/2,(h-T)/2,T,T,f?u:g))}var b="left"===c?m+5:-5,k=c,I=n.get("formatter"),A=e;"string"==typeof I&&I?A=I.replace("{name}",null!=e?e:""):"function"==typeof I&&(A=I(e)),y.add(new o.Text({style:o.setTextStyle({},E,{text:A,x:b,y:h/2,textFill:f?E.getTextColor():g,textAlign:k,textVerticalAlign:"middle"})}));var _=new o.Rect({shape:y.getBoundingRect(),invisible:!0,tooltip:S.get("show")?i.extend({content:e,formatter:C.get("formatter",!0)||function(){return e},formatterParams:{componentType:"legend",legendIndex:n.componentIndex,name:e,$vars:["name"]}},S.option):null});return y.add(_),y.eachChild(function(e){e.silent=!0}),_.silent=!p,this.getContentGroup().add(y),o.setHoverStyle(y),y.__legendDataIndex=t,y},layoutInner:function(e,t,a){var n=this.getContentGroup();s.box(e.get("orient"),n,e.get("itemGap"),a.width,a.height);var i=n.getBoundingRect();return n.attr("position",[-i.x,-i.y]),this.group.getBoundingRect()}});function m(e,t){t.dispatchAction({type:"legendToggleSelect",name:e})}function h(e,t,a){var n=a.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||e.get("legendHoverLink")&&a.dispatchAction({type:"highlight",seriesName:e.name,name:t})}function g(e,t,a){var n=a.getZr().storage.getDisplayList()[0];n&&n.useHoverLayer||e.get("legendHoverLink")&&a.dispatchAction({type:"downplay",seriesName:e.name,name:t})}e.exports=p},cC79:function(e,t,a){"use strict";a.r(t);var n={};a.d(n,"dataFilterDoc",function(){return ki}),a.d(n,"switchKey",function(){return Ii}),a.d(n,"hdfsPath",function(){return Ai}),a.d(n,"jobSpeedLimit",function(){return _i}),a.d(n,"jobConcurrence",function(){return Di}),a.d(n,"errorCount",function(){return Ni}),a.d(n,"hdfsConfig",function(){return xi}),a.d(n,"rdbConfig",function(){return Li}),a.d(n,"hBaseConfig",function(){return wi}),a.d(n,"recordDirtyData",function(){return Pi}),a.d(n,"errorPercentConfig",function(){return Oi});var i,r=a("sbe7"),o=a.n(r),l=a("i8i4"),s=a.n(l),c=a("0cfB"),u=a("2NsA"),d=a("Yz+Y"),p=a.n(d),m=a("iCc5"),h=a.n(m),g=a("V7oC"),f=a.n(g),y=a("FYw3"),E=a.n(y),v=a("mRg0"),S=a.n(v),C=a("dtw8"),T=a("/MKj"),b=(a("3J6H"),a("EMQV"),a("FdzR"),a("95Qq"),a("hhe7"),a("XLg0")),k=a("2BCK"),I=a("vFRS"),A=a("NX2S"),_=a("UopC"),D=a("X9CO"),N=a("dVc0"),x=a("2Ul7"),L=a("AVFO"),w=a("17x9"),P=a.n(w),O=a("PVY6"),R=a("QbLZ"),M=a.n(R),j=a("pLPX"),G=Object(T.b)(function(e){return{user:e.user,apps:e.apps,routing:e.routing,app:e.app,common:e.common}})(i=function(e){function t(e){h()(this,t);var a=E()(this,(t.__proto__||p()(t)).call(this,e));return a.state={},a}return S()(t,e),f()(t,[{key:"render",value:function(){var e=this.props.common,t="/dataLabel.html#",a=[{id:"dl/market",name:"标签市场",link:t+"/dl/market",enable:e.menuList.indexOf("tag_market_menu")>-1},{id:"dl/mine",name:"我的标签",link:t+"/dl/mine",enable:e.menuList.indexOf("tag_mytag_menu")>-1},{id:"dl/tagConfig",name:"标签配置",link:t+"/dl/tagConfig",enable:e.menuList.indexOf("tag_config_menu")>-1},{id:"dl/approval",name:"审批授权",link:t+"/dl/approval",enable:e.menuList.indexOf("tag_authorized_menu")>-1},{id:"dl/manage",name:"服务管理",link:t+"/dl/manage",enable:e.menuList.indexOf("tag_service_menu")>-1},{id:"dl/dataSource",name:"数据源管理",link:t+"/dl/dataSource",enable:e.menuList.indexOf("datasource_menu")>-1}],n=o.a.createElement("span",null,o.a.createElement("img",{style:{height:"36px",width:"36px",marginTop:"5px"},alt:"logo",src:"/public/dataLabel/img/logo.svg"}),o.a.createElement("span",{style:{fontSize:"14px",color:"#ffffff",position:"absolute",left:"80px",top:0}},"DTinsight.Tag"));return o.a.createElement(j.c,M()({logo:n,menuItems:a},this.props))}}]),t}(r.Component))||i,U=(a("mN36"),a("N9UN")),V=a.n(U),F=(a("zmYW"),a("DtFj")),q=a.n(F),z=(a("fwXI"),a("CC+v")),Y=a.n(z),H=(a("ek7I"),a("FAat")),B=a.n(H),K=(a("cUip"),a("iJl9")),Q=a.n(K),J=(a("nTym"),a("qu0K")),X=a.n(J),W=a("2skF"),Z=a("gDS+"),$=a.n(Z),ee=(a("bZMm"),a("wFDc")),te=a("5012"),ae=(a("pjuD"),a("rR1Q")),ne=a.n(ae),ie=a("4d7F"),re=a.n(ie),oe=(a("tL+A"),a("QpBz")),le=a.n(oe),se=a("7Qib"),ce=a("OZjc"),ue={DL_ROLE_QUERY:O.d+"/role/pageQuery",DL_ROLE_UPDATE:O.d+"/role/addOrUpdateRole",DL_ROLE_DELETE:O.d+"/role/deleteRole",DL_ROLE_PERMISSION_TREE:O.d+"/permission/tree",DL_ROLE_PERMISSION:O.d+"/permission/getPermissionIdsByRoleId",DL_GET_USER_BY_ID:O.d+"/user/getUserById",DL_GET_USER_PAGES:O.d+"/user/pageQuery",DL_GET_USER_NOT_IN_PROJECT:O.d+"/user/listNotIn",DL_USER_ROLE_ADD:O.d+"/roleUser/addRoleUser",DL_USER_ROLE_DELETE:O.d+"/roleUser/remove",DL_USER_ROLE_UPDATE:O.d+"/roleUser/updateUserRole",MASSAGE_QUERY:O.d+"/notify/pageQuery",GET_MASSAGE_BY_ID:O.d+"/notify/getOne",MASSAGE_MARK_AS_READ:O.d+"/notify/tabRead",MASSAGE_MARK_AS_ALL_READ:O.d+"/notify/allRead",MASSAGE_DELETE:O.d+"/notify/delete",DL_GET_USER_LIST:O.d+"/user/list",GET_ALL_MENU_LIST:O.d+"/user/showMenuList",GET_PERIOD_TYPE:O.d+"/tag/listPeriodType",GET_NOTIFY_TYPE:O.d+"/tag/listNotifyType",QUERY_REGISTERED_TAG:O.d+"/tag/registerQuery",ADD_REGISTER_TAG:O.d+"/tag/registerAdd",QUERY_RULE_TAG:O.d+"/tag/customQuery",ADD_RULE_TAG:O.d+"/tag/customAdd",UPDATE_TAG_SQL_INFO:O.d+"/tag/computeInfoUpdate",GET_TAG_CONDITION:O.d+"/tag/listCustomCondition",EDIT_TAG_CONDITION:O.d+"/tag/editCustomCondition",DELETE_TAG_CONDITION:O.d+"/tag/deleteCustomCondition",UPDATE_TAG_BASE_INFO:O.d+"/tag/baseInfoUpdate",DELETE_TAG:O.d+"/tag/deleteTag",GET_RULE_TAG_RETAIL:O.d+"/tag/getOne",QUERY_TAG_LOG:O.d+"/tag/logPageQuery",PUBLISH_CHECK:O.d+"/tag/publishCheck",PUBLISH_TAG:O.d+"/tag/publishTag",QUERY_IDENTIFY_COLUMN:O.d+"/identify/pageQuery",GET_ALL_IDENTIFY_COLUMN:O.d+"/identify/identities",ADD_IDENTIFY_COLUMN:O.d+"/identify/add",UPDATE_IDENTIFY_COLUMN:O.d+"/identify/update",DELETE_IDENTIFY_COLUMN:O.d+"/identify/delete",GET_DATA_SOURCES:O.d+"/dataSource/pageQuery",CHECK_CONNECTION:O.d+"/dataSource/checkConnection",ADD_DATA_SOURCE:O.d+"/dataSource/addSource",UPDATE_DATA_SOURCE:O.d+"/dataSource/updateSource",DELETE_DATA_SOURCE:O.d+"/dataSource/deleteSource",GET_DATA_SOURCE_BY_ID:O.d+"/dataSource/getBySourceId",GET_DATA_SOURCES_LIST:O.d+"/dataSource/list",GET_TAG_DATA_SOURCES_LIST:O.d+"/dataSource/listTargetSource",GET_DATA_SOURCES_TYPE:O.d+"/dataSource/getTypes",GET_DATA_SOURCES_TABLE:O.d+"/dataSource/tablelist",GET_DATA_SOURCES_COLUMN:O.d+"/dataSource/tablecolumn",GET_COMPUTE_SOURCE:O.d+"/dataSource/listComputeSource",GET_DATA_SOURCES_PREVIEW:O.d+"/dataSource/preview",GET_API_FAIL_RANK:O.d+"/apis/listApiCallFailRateTopNForNormal",GET_API_FAIL_RANK_ADMIN:O.d+"/apis/listApiCallFailRateTopNForManager",GET_API_CALL_INFO:O.d+"/apis/getApiCallInfoForNormal",GET_USER_API_CALL_RANK:O.d+"/apis/listApiCallNumTopN",GET_USER_API_SUB_INFO:O.d+"/apply/getApiSubscribe",GET_MARKET_API_CALL_RANK:O.d+"/apis/listUserCallTopN",GET_API_CALL_ERROR_INFO_ADMIN:O.d+"/log/getApiCallErrorInfoForManager",GET_MARKET_API_APPLY_INFO:O.d+"/apply/getApplyCount",HANDLE_APPLY:O.d+"/apply/handleApply",GET_ALL_APPLY_LIST:O.d+"/apply/allApplyList",GET_ALL_API_LIST:O.d+"/tag/manageQuery",GET_DATASOURCE_BASE_INFO:O.d+"/dataSource/listDataSourceBaseInfo",DELETE_API:O.d+"/apis/deleteApi",UPDATE_API:O.d+"/apis/updateApiStatus",GET_API_CALL_RANK:O.d+"/apis/getApiCallUserRankList",GET_API_BUY_STATE:O.d+"/apply/getApiApplyList",DELETE_CATAGORY:O.d+"/catalogue/deleteCatalogue",ADD_CATAGORY:O.d+"/catalogue/addCatalogue",UPDATE_CATAGORY:O.d+"/catalogue/updateCatalogue",NEW_API:O.d+"/apis/createApi",CHANGE_API:O.d+"/apis/updateApi",GET_TABLE_BY_DATASOURCE:O.d+"/dataSource/tablelist",GET_TABLE_COLUMNS_DETAIL:O.d+"/dataSource/tablecolumn",GET_TABLE_PREVIEW_DATA:O.d+"/dataSource/preview",GET_API_DETAIL_INFO:O.d+"/apis/getApiInfo",GET_APPLY_LIST:O.d+"/apply/userApplyList",UPDATE_APPLY_STATUS:O.d+"/apply/updateApplyStatusForNormal",UPDATE_APPLY_STATUS_ADMIN:O.d+"/apply/updateApplyStatusForManager",GET_USER_API_CALL_INFO:O.d+"/apis/getApiCallInfoForNormal",GET_USER_API_CALL_INFO_ADMIN:O.d+"/apis/getApiCallInfoForManager",GET_API_CALL_ERROR_INFO:O.d+"/log/getApiCallErrorInfoForNormal",GET_API_CALL_ERROR_LOG:O.d+"/log/queryApiCallLogForNormal",GET_API_CALL_ERROR_LOG_ADMIN:O.d+"/log/queryApiCallLogForManager",GET_API_CALL_URL:O.d+"/apis/getApiCallUrl",GET_API_CREATOR_INFO:O.d+"/apis/getApiCreatorInfo",GET_CATALOGUE:O.d+"/catalogue/getCatalogue",GET_API_MARKET_LIST:O.d+"/tag/marketQuery",GET_MARKET_API_DETAIL:O.d+"/apis/getApiDetail",GET_API_EXT_INFO:O.d+"/apis/getApiExtInfoForNormal",GET_API_EXT_INFO_ADMIN:O.d+"/apis/getApiExtInfoForManager",APPLY_API:O.d+"/apply/apiApply",GET_MARKET_TOP_CALL_FUNC:O.d+"/apis/listApiCallNumTopNForManager"},de=APP_CONF.UIC_URL||"",pe=APP_CONF.UIC_DOMAIN||"",me={logout:function(){var e=this;Ee.post(ue.APP_LOGOUT).then(function(t){1===t.code&&e.openLogin()})},openLogin:function(){ce.a.clear(),se.a.deleteCookie("dt_user_id",pe,"/"),se.a.deleteCookie("dt_token",pe,"/"),se.a.deleteCookie("dt_tenant_id",pe,"/"),se.a.deleteCookie("dt_tenant_name",pe,"/"),se.a.deleteCookie("dt_username",pe,"/"),se.a.deleteCookie("dt_is_tenant_admin",pe,"/"),se.a.deleteCookie("dt_is_tenant_creator",pe,"/"),se.a.deleteCookie("project_id",pe,"/"),window.location.href=de+"/#/login"},getLoginedUser:function(){return Ee.post(ue.DL_GET_USER_BY_ID)},getUserList:function(){return Ee.post(ue.DL_GET_USER_LIST)}};function he(e){switch(e.status){case 402:case 200:return e;case 302:le.a.info("登录超时, 请重新登录！");default:return e}}function ge(e){switch(e.code){case 1:return e;case 0:return me.openLogin(),re.a.reject(e);case 3:return ne.a.error({message:"权限通知",description:e.message}),re.a.reject(e);case 16:hashHistory.push("/");default:return e.message&&ne.a.error({message:"异常",description:e.message}),e}}var fe,ye,Ee=new(function(){function e(){h()(this,e)}return f()(e,[{key:"get",value:function(e,t){var a=t?this.build(e,t):e;return this.request(a,{method:"GET"})}},{key:"post",value:function(e,t){var a={method:"POST"};return t&&(a.body=$()(t)),this.request(e,a)}},{key:"postAsFormData",value:function(e,t){var a={method:"POST"};return t&&(a.body=this.buildFormData(t)),this.request(e,a)}},{key:"postForm",value:function(e,t){var a={method:"POST"};return t&&(a.body=new FormData(t)),this.request(e,a)}},{key:"request",value:function(e,t){return ee.a.show(),t.credentials="same-origin",fetch(e,t).then(he).then(function(e){return setTimeout(function(){ee.a.hide()},300),e.json()}).then(ge).catch(function(e){return ee.a.hide(),Object(te.h)("请求异常","服务器可能出了点问题, 请稍后再试！"),e})}},{key:"defaultHeader",value:function(){return{Accept:"*/*","Content-Type":"application/json"}}},{key:"build",value:function(e,t){var a=[];if(t)for(var n in t)n&&a.push(n+"="+encodeURIComponent(t[n]));return e+"?"+a.join("&")}},{key:"buildFormData",value:function(e){if(e){var t=new FormData;for(var a in e)a&&t.append(a,e[a]);return t}}}]),e}()),ve={getCatalogue:function(e){return Ee.post(ue.GET_CATALOGUE,e)},listByCondition:function(e){return Ee.post(ue.GET_API_MARKET_LIST,e)},getApiDetail:function(e){return Ee.post(ue.GET_MARKET_API_DETAIL,e)},apiApply:function(e){return Ee.post(ue.APPLY_API,e)},getApiExtInfoForNormal:function(e){return Ee.post(ue.GET_API_EXT_INFO,e)},getApiExtInfoForManager:function(e){return Ee.post(ue.GET_API_EXT_INFO_ADMIN,e)}},Se=function(e){return function(t){ve.getCatalogue({pid:e,lvNum:10}).then(function(e){1===e.code&&t({type:W.a.GET_CATALOGUE,payload:e.data})})}},Ce=function(e){return function(t){return ve.listByCondition(e).then(function(e){if(1===e.code)return t({type:W.a.GET_API_MARKET_LIST,payload:e.data.data}),e})}},Te=function(e){return function(t){return ve.getApiDetail(e).then(function(e){if(1===e.code)return t({type:W.a.GET_MARKET_API_DETAIL,payload:e.data}),e})}},be=function(e){var t="getApiExtInfoForNormal";return e.useAdmin&&(t="getApiExtInfoForManager"),function(a){return ve[t](e).then(function(e){if(1===e.code)return a({type:W.a.GET_API_EXT_INFO,payload:e.data}),e})}},ke=function(e){return function(t){return ve.apiApply(e).then(function(e){if(1===e.code)return e})}},Ie=(a("MaXC"),a("4IMT")),Ae=a.n(Ie),_e={MYSQL:1,ORACLE:2,SQLSERVER:3,HDFS:6,HIVE:7,HBASE:8,FTP:9,MAXCOMPUTE:10},De={1:"注册标签",2:"规则标签"},Ne={0:"新建",1:"等待运行",2:"更新中",3:"更新完成",4:"更新失败",5:"禁用"},xe={0:"未发布",1:"已发布"},Le={0:"启用",1:"禁用"},we={"-1":"nothing",0:"inhand",1:"success",2:"notPass",3:"stop",4:"disabled"},Pe={0:"notApproved",1:"pass",2:"rejected",3:"stop",4:"disabled"},Oe={0:"success",1:"stop"},Re=[{text:"MySQL",value:1},{text:"Oracle",value:2},{text:"SQLServer",value:3},{text:"Spark",value:7},{text:"MaxCompute",value:10}],Me={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},je={wrapperCol:{xs:{span:24,offset:0},sm:{span:14,offset:6}}},Ge={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:10}}},Ue={labelCol:{span:0},wrapperCol:{span:24}},Ve={tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},color:["#2491F7","#7460EF","#26DAD2","#79E079","#7A64F3","#FFDC53","#9a64fb"],legend:{data:["邮件营销","联盟广告","视频广告","直接访问","搜索引擎"]},toolbox:{feature:{saveAsImage:{show:!1}}},grid:{left:"3%",right:"4%",bottom:"30",top:40,containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[],axisTick:{show:!0},axisLine:{lineStyle:{color:"#DDDDDD"}},axisLabel:{textStyle:{color:"#666666"}},nameTextStyle:{color:"#666666"},splitLine:{color:"#666666"}}],yAxis:[{nameGap:25,type:"value",name:"调用次数",axisLabel:{textStyle:{color:"#666666",baseline:"bottom"}},nameTextStyle:{color:"#666666"},nameLocation:"end",axisLine:{show:!1},axisTick:{show:!1},splitLine:!1,minInterval:1},{nameGap:25,type:"value",name:"失败率 (%)",axisLabel:{textStyle:{color:"#666666",baseline:"bottom"}},nameTextStyle:{color:"#666666"},nameLocation:"end",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#DDDDDD",type:"dashed"}},max:100}],series:[]},Fe=X.a.Item,qe=Q.a.TextArea,ze=Object(T.b)(null,function(e){return{apiApply:function(t,a){return e(ke({apiId:t,applyContent:a}))},getApiExtInfo:function(t){e(be({tagId:t}))}}})(fe=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={loading:!1},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"handleOk",value:function(){var e=this;this.props.form.validateFields(function(t,a){t||(e.setState({loading:!0}),e.props.apiApply(e.props.apiId,a.applyMsg).then(function(t){e.setState({loading:!1}),e.props.getMarketApi&&e.props.getMarketApi(),t&&(le.a.success("操作成功"),e.props.successCallBack())}))})}},{key:"handleCancel",value:function(){this.props.form.resetFields(),this.props.cancelCallback()}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement("div",null,o.a.createElement(Y.a,{title:"申请API",visible:this.props.show,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),footer:[o.a.createElement(Ae.a,{key:"back",size:"large",onClick:this.handleCancel.bind(this)},"取消"),o.a.createElement(Ae.a,{key:"submit",type:"primary",size:"large",loading:this.state.loading,onClick:this.handleOk.bind(this)},"提交")]},o.a.createElement(X.a,null,o.a.createElement(Fe,M()({label:"标签名称"},Me),o.a.createElement("p",null,this.props.name)),o.a.createElement(Fe,M()({label:"标签描述"},Me),o.a.createElement("p",null,this.props.desc)),o.a.createElement(Fe,M()({label:"申请说明",hasFeedback:!0,required:!0},Me),e("applyMsg",{rules:[{required:!0,message:"请输入申请信息"},{max:200,message:"最大字符不能超过200"}]})(o.a.createElement(qe,{placeholder:"请输入申请信息",autosize:{minRows:4,maxRows:8}}))))))}}]),t}(r.Component))||fe,Ye=X.a.create()(ze),He=(X.a.Item,Q.a.TextArea,B.a.Option),Be=Q.a.Search,Ke=void 0,Qe=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},function(e){return{getCatalogue:function(t){e(Se(t))},getApiMarketList:function(t){return e(Ce(t))}}})(ye=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={searchValue:"",pageIndex:1,loading:!0,applyBox:!1,apply:{apiId:"",tagName:"",tagDesc:""},type1:void 0,type2:void 0,apiName:"",pageSize:20,total:0,sorter:{}},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,sorter:a},function(){n.getMarketApi()})},n.openDetail=function(e){window.open("dataLabel.html#/dl/market/detail/"+e+"?isHideBack=true")},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getMarketApi",value:function(){var e=this;this.setState({loading:!0});this.props.getApiMarketList({name:this.state.searchValue,pid:this.state.type1||-1,cid:this.state.type2||-1,currentPage:this.state.pageIndex,pageSize:this.state.pageSize,orderBy:{updateTime:"gmt_modified"}[this.state.sorter.columnKey],sort:{ascend:"asc",descend:"desc"}[this.state.sorter.order]}).then(function(t){e.setState({loading:!1,total:t.data.totalCount})}).catch(function(t){e.setState({loading:!1})})}},{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.getMarketApi()}},{key:"renderSourceType",value:function(e,t){function a(e){return!e||e.length<1?null:e.map(function(e){return o.a.createElement(He,{key:e.id},e.name)})}var n=[],i=this.props.apiMarket.apiCatalogue;if(t){if(!i)return null;for(var r=0;r<i.length;r++)n.push({id:i[r].id,name:i[r].catalogueName});return a(n)}if(!i)return null;for(var l=void 0,s=0;s<i.length;s++)if(i[s].id==e){l=i[s].childCatalogue;break}if(!l)return null;for(var c=0;c<l.length;c++)l[c].api||n.push({id:l[c].id,name:l[c].catalogueName});return a(n)}},{key:"onSourceChange",value:function(e){var t=this;this.setState({type1:e,type2:void 0},function(){t.getMarketApi()})}},{key:"onUserSourceChange",value:function(e){var t=this;this.setState({type2:e},function(){t.getMarketApi()})}},{key:"handleSearch",value:function(e){var t=this;this.setState({searchValue:e,pageIndex:1},function(){t.getMarketApi()})}},{key:"getDealType",value:function(e){return{complete:"查看使用情况",nothing:"申请",applying:"查看审批进度"}[e||"nothing"]}},{key:"doApply",value:function(e){this.setState({applyBox:!0,apply:{name:e.name,apiId:e.apiId,tagDesc:e.tagDesc}})}},{key:"initColumns",value:function(){var e=this;return[{title:"标签名称",dataIndex:"name",key:"name",width:"20%",render:function(e,t){return o.a.createElement(C.c,{to:"/dl/market/detail/"+t.apiId},e)}},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:"15%"},{title:"昨日调用次数",dataIndex:"totalYd",key:"totalYd",width:"15%"},{title:"更新时间",dataIndex:"gmtModified",key:"gmtModified",width:"20%",render:function(e){return se.a.formatDateTime(e)},sorter:!0},{title:"操作",dataIndex:"applyStatus",width:"15%",render:function(t,a){switch(t){case 0:return o.a.createElement(C.c,{to:"/dl/mine?apiId="+a.id},"查看审批进度");case 1:case 3:case 4:return o.a.createElement(C.c,{to:"/dl/mine/approved?apiId="+a.id},"查看使用情况");case-1:case 2:return o.a.createElement("a",{onClick:e.doApply.bind(e,a)},"申请");default:return""}}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:this.state.pageSize,total:this.state.total}}},{key:"getCardTitle",value:function(){return o.a.createElement("div",{className:"flex font-12"},o.a.createElement(Be,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),o.a.createElement("div",{className:"m-l-8"},"标签分类：",o.a.createElement(B.a,{placeholder:"选择标签分类",value:this.state.type1,allowClear:!0,onChange:this.onSourceChange.bind(this),style:{width:120}},this.renderSourceType(0,!0))),o.a.createElement("div",{className:"m-l-8"},"二级分类：",o.a.createElement(B.a,{placeholder:"选择二级分类",value:this.state.type2,allowClear:!0,onChange:this.onUserSourceChange.bind(this),style:{width:150}},this.renderSourceType(this.state.type1,!1))))}},{key:"jumpToMine",value:function(){Ke.destroy(),this.props.router.push("/dl/mine")}},{key:"showApplySuccessModal",value:function(){Ke=Y.a.success({title:"申请提交成功",content:o.a.createElement("span",null,"您可以在 ",o.a.createElement("a",{onClick:this.jumpToMine.bind(this)},"我的标签")," 中查看审批进度"),okText:"确定"})}},{key:"handleOk",value:function(){this.setState({applyBox:!1}),this.showApplySuccessModal()}},{key:"handleCancel",value:function(){this.setState({applyBox:!1})}},{key:"render",value:function(){var e=this.props,t=(e.children,e.apiMarket);return o.a.createElement("div",{className:"api-market"},o.a.createElement(Ye,{show:this.state.applyBox,successCallBack:this.handleOk.bind(this),cancelCallback:this.handleCancel.bind(this),apiId:this.state.apply.apiId,name:this.state.apply.name,desc:this.state.apply.tagDesc,getMarketApi:this.getMarketApi.bind(this)}),o.a.createElement("div",{className:"m-card box-1"},o.a.createElement(V.a,{noHovering:!0,title:this.getCardTitle()},o.a.createElement(q.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:t.apiList||[],onChange:this.onTableChange}))))}}]),t}(r.Component))||ye,Je=a("zbcj"),Xe=a.n(Je)()(["GET_USER","UPDATE_USER","GET_NOT_PROJECT_USERS","GET_PROJECT_USERS","GET_USER_LIST"],{prefix:"user/"});var We,Ze=a("5NcA"),$e={getDataSources:function(e){return Ee.post(ue.GET_DATA_SOURCES,e)},testDSConnection:function(e){return Ee.post(ue.CHECK_CONNECTION,e)},addDataSource:function(e){return Ee.post(ue.ADD_DATA_SOURCE,e)},updateDataSource:function(e){return Ee.post(ue.UPDATE_DATA_SOURCE,e)},deleteDataSource:function(e){return Ee.post(ue.DELETE_DATA_SOURCE,e)},getDataSourcesType:function(e){return Ee.post(ue.GET_DATA_SOURCES_TYPE,e)},getDataSourcesList:function(e){return Ee.post(ue.GET_DATA_SOURCES_LIST,e)},getTagDataSourcesList:function(e){return Ee.post(ue.GET_TAG_DATA_SOURCES_LIST,e)},getDataSourcesTable:function(e){return Ee.post(ue.GET_DATA_SOURCES_TABLE,e)},getDataSourcesColumn:function(e){return Ee.post(ue.GET_DATA_SOURCES_COLUMN,e)},getDataSourcesPreview:function(e){return Ee.post(ue.GET_DATA_SOURCES_PREVIEW,e)}},et=function(e){return function(t){t({type:Ze.a.CHANGE_LOADING}),$e.getDataSources(e).then(function(e){1===e.code&&t({type:Ze.a.GET_DATA_SOURCES,payload:e.data}),t({type:Ze.a.CHANGE_LOADING})})}},tt=function(e){return function(t){$e.getDataSourcesType(e).then(function(e){1===e.code&&t({type:Ze.a.GET_DATA_SOURCES_TYPE,payload:e.data})})}},at=function(e){return function(t){$e.getDataSourcesList(e).then(function(e){1===e.code&&t({type:Ze.a.GET_DATA_SOURCES_LIST,payload:e.data})})}},nt=function(e){return function(t){$e.getTagDataSourcesList(e).then(function(e){1===e.code&&t({type:Ze.a.GET_TAG_DATA_SOURCES_LIST,payload:e.data})})}},it=function(e){return function(t){$e.getDataSourcesTable(e).then(function(e){1===e.code?t({type:Ze.a.GET_DATA_SOURCES_TABLE,payload:e.data}):t({type:Ze.a.GET_DATA_SOURCES_TABLE,payload:[]})})}},rt=function(){return function(e){e({type:Ze.a.RESET_DATA_SOURCES_TABLE})}},ot=function(e){return function(t){$e.getDataSourcesColumn(e).then(function(e){1===e.code&&t({type:Ze.a.GET_DATA_SOURCES_COLUMN,payload:e.data})})}},lt=function(){return function(e){e({type:Ze.a.RESET_DATA_SOURCES_COLUMN})}},st=function(e){return function(t){$e.getDataSourcesPreview(e).then(function(e){if(1===e.code){var a=e.data,n=a.columnList,i=a.dataList;e.data.dataList=i.map(function(e,t){var a={};return e.forEach(function(e,i){a.key=t,a[n[i]]=e}),a}),t({type:Ze.a.GET_DATA_SOURCES_PREVIEW,payload:e.data})}})}},ct=a("UEq8"),ut=function(){return Ee.post(ue.DL_GET_USER_LIST)},dt=function(){return Ee.post(ue.GET_ALL_MENU_LIST)},pt=function(){return Ee.post(ue.GET_PERIOD_TYPE)},mt=function(){return Ee.post(ue.GET_NOTIFY_TYPE)},ht=function(e){return function(t){ut(e).then(function(e){1===e.code&&t({type:ct.a.GET_USER_LIST,payload:e.data})})}},gt=function(e){return function(t){dt(e).then(function(e){1===e.code&&t({type:ct.a.GET_ALL_MENU_LIST,payload:e.data})})}},ft=function(e){return function(t){pt(e).then(function(e){1===e.code&&t({type:ct.a.GET_PERIOD_TYPE,payload:e.data})})}},yt=function(e){return function(t){mt(e).then(function(e){1===e.code&&t({type:ct.a.GET_NOTIFY_TYPE,payload:e.data})})}},Et=a("TmhF"),vt={children:P.a.node},St=Object(T.b)()(We=function(e){function t(){return h()(this,t),E()(this,(t.__proto__||p()(t)).apply(this,arguments))}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e(function(e){me.getLoginedUser().then(function(t){if(1===t.code)return e({type:Xe.GET_USER,data:t.data})})}),e(Object(Et.a)(O.j)),e(ht()),e(gt()),e(ft()),e(yt()),e(tt())}},{key:"render",value:function(){var e=this.props.children;return o.a.createElement("div",{className:"main"},o.a.createElement(G,null),o.a.createElement("div",{className:"container"},e||o.a.createElement(Qe,null)))}}]),t}(r.Component))||We;St.propTypes=vt,St.defaultProps={children:[]};var Ct=St,Tt=(a("Z8Mf"),a("j7zX")),bt=a.n(Tt),kt=a("EgI3"),It={getApplyList:function(e){return Ee.post(ue.GET_APPLY_LIST,e)},updateApplyStatusForNormal:function(e){return Ee.post(ue.UPDATE_APPLY_STATUS,e)},updateApplyStatusForManager:function(e){return Ee.post(ue.UPDATE_APPLY_STATUS_ADMIN,e)},getApiCallInfoForNormal:function(e){return Ee.post(ue.GET_API_CALL_INFO,e)},getApiCallInfoForManager:function(e){return Ee.post(ue.GET_USER_API_CALL_INFO_ADMIN,e)},getApiCallErrorInfoForNormal:function(e){return Ee.post(ue.GET_API_CALL_ERROR_INFO,e)},getApiCallErrorInfoForManager:function(e){return Ee.post(ue.GET_API_CALL_ERROR_INFO_ADMIN,e)},getApiCallUrl:function(e){return Ee.post(ue.GET_API_CALL_URL,e)},queryApiCallLogForNormal:function(e){return Ee.post(ue.GET_API_CALL_ERROR_LOG,e)},queryApiCallLogForManager:function(e){return Ee.post(ue.GET_API_CALL_ERROR_LOG_ADMIN,e)},getApiCreatorInfo:function(e){return Ee.post(ue.GET_API_CREATOR_INFO,e)}},At=function(e){return(e=e||{}).status=[0],function(t){return It.getApplyList(e).then(function(e){1===e.code&&t({type:kt.a.GET_APPLYING_LIST,payload:e.data})})}},_t=function(e){return(e=e||{}).status&&0!==e.status.length||(e.status=[1,2,3,4]),function(t){return It.getApplyList(e).then(function(e){if(1===e.code)return t({type:kt.a.GET_APPLYED_LIST,payload:e.data}),e})}},Dt=function(e){var t="updateApplyStatusForNormal";return e.useAdmin&&(t="updateApplyStatusForManager"),function(a){return It[t](e).then(function(e){if(1===e.code)return e})}},Nt=function(e){var t="getApiCallInfoForNormal";return e.useAdmin&&(t="getApiCallInfoForManager"),function(a){return It[t](e).then(function(e){if(1===e.code)return e})}},xt=function(e){return function(t){return It.getApiCallErrorInfoForNormal(e).then(function(e){if(1===e.code)return e})}},Lt=function(e){return function(t){return It.getApiCallUrl(e).then(function(e){if(1===e.code)return e})}},wt=function(e){var t="queryApiCallLogForNormal";return e.useAdmin&&(t="queryApiCallLogForManager"),function(a){return It[t](e).then(function(e){if(1===e.code)return e})}},Pt=function(e){return function(t){return It.getApiCreatorInfo(e).then(function(e){if(1===e.code)return e})}},Ot=a("WaWy"),Rt=Q.a.TextArea,Mt=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"render",value:function(){this.props.showRecord&&this.props.showRecord.replyTime;return o.a.createElement(Ot.a,{visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"300px"},onClose:this.props.closeSlidePane},o.a.createElement("h1",{className:"box-title approved-card-pane-title"},"审批情况"),o.a.createElement("div",{style:{paddingLeft:30,marginBottom:30}},o.a.createElement("p",{className:"before-title-pane textarea-p","data-title":"申请说明："},o.a.createElement(Rt,{disabled:!0,value:this.props.showRecord&&this.props.showRecord.applyContent,style:{width:200,color:"#999",fontSize:14},rows:4})),o.a.createElement("p",{style:{paddingLeft:70}},se.a.formatDateTime(this.props.showRecord&&this.props.showRecord.applyTime)),this.props.isApproved?o.a.createElement("div",null,o.a.createElement("p",{className:"before-title-pane textarea-p","data-title":"审批说明："},o.a.createElement(Rt,{disabled:!0,value:this.props.showRecord&&this.props.showRecord.replyContent,style:{width:200,color:"#999",fontSize:14},rows:4})),o.a.createElement("p",{style:{paddingLeft:70}},se.a.formatDateTime(this.props.showRecord&&this.props.showRecord.replyTime))):null))}}]),t}(r.Component),jt={applyTime:"gmt_modified"},Gt={ascend:"asc",descend:"desc"},Ut=(Q.a.TextArea,Q.a.Search),Vt=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageIndex:1,slidePaneShow:!1,sortedInfo:{},loading:!1,showRecord:{},apiName:void 0},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,sortedInfo:a},function(){n.getApplyingList()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getApplyingList",value:function(e){var t=this;this.setState({loading:!0}),this.props.getApplyingList(this.state.pageIndex,jt[this.state.sortedInfo.columnKey],Gt[this.state.sortedInfo.order],this.state.apiName).then(function(){t.setState({loading:!1}),e&&e()})}},{key:"componentDidMount",value:function(){var e=this;this.getApplyingList(function(){e.openCard(e.props.apiId)})}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId!=e.apiId&&e.apiId&&this.openCard(e.apiId)}},{key:"openCard",value:function(e){var t=this.getSource();if(t)for(var a in t){var n=t[a];if(e==n.apiId){this.openApprovedState(n);break}}}},{key:"openApprovedState",value:function(e){this.setState({slidePaneShow:!0,showRecord:e||{}})}},{key:"initColumns",value:function(){var e=this;this.state.sortedInfo;return[{title:"标签名称",dataIndex:"apiName",key:"apiName",width:"20%",render:function(t,a){return o.a.createElement("a",{onClick:e.openApprovedState.bind(e,a)},t)}},{title:"描述",dataIndex:"apiDesc",key:"apiDesc",width:"30%"},{title:"申请说明",dataIndex:"applyContent",key:"applyContent",width:"30%"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime",width:"20%",sorter:!0,render:function(e){return se.a.formatDateTime(e)}}]}},{key:"getSource",value:function(){return this.props.mine.apiList.applyingList.data}},{key:"getTotal",value:function(){return this.props.mine.apiList.applyingList&&this.props.mine.apiList.applyingList.totalCount||0}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.getTotal()}}},{key:"closeSlidePane",value:function(){this.setState({slidePaneShow:!1,showRecord:{}})}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getApplyingList()})}},{key:"render",value:function(){var e=this;return o.a.createElement(V.a,{noHovering:!0,bordered:!1},o.a.createElement(Mt,M()({},this.props,{slidePaneShow:this.state.slidePaneShow,showRecord:this.state.showRecord,closeSlidePane:this.closeSlidePane.bind(this)})),o.a.createElement("div",{className:"flex font-12"},o.a.createElement(Ut,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"10px"},onSearch:this.handleApiSearch.bind(this)})),o.a.createElement(q.a,{rowKey:"id",rowClassName:function(t,a){return e.state.showRecord.apiId==t.apiId?"row-select":""},className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))}}]),t}(r.Component),Ft=(Q.a.TextArea,function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={phone:"",dtuicUserId:"",email:""},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getApiCreatorInfo()}},{key:"componentWillReceiveProps",value:function(e){this.props.showRecord&&this.props.showRecord.apiId!==e.showRecord.apiId&&e.slidePaneShow&&this.getApiCreatorInfo(e.showRecord.apiId)}},{key:"getApiCreatorInfo",value:function(e){var t=this;(e=e||this.props.showRecord.apiId)&&this.props.getApiCreatorInfo(e).then(function(e){e&&t.setState({phone:e.data.phoneNumber,dtuicUserId:e.data.userName,email:e.data.email})})}},{key:"render",value:function(){return o.a.createElement(Ot.a,{visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"300px"},onClose:this.props.closeSlidePane},o.a.createElement("h1",{className:"box-title approved-card-pane-title"},"详情"),o.a.createElement("div",{style:{paddingLeft:30,paddingTop:20}},o.a.createElement("p",null,"管理员已取消此接口的授权，您可以联系管理员咨询详细情况，管理员信息"),o.a.createElement("p",{style:{marginTop:20}},"用户名：",this.state.dtuicUserId),o.a.createElement("p",null,"手机号码：",this.state.phone),o.a.createElement("p",null,"邮箱：",this.state.email)))}}]),t}(r.Component)),qt=(a("7kJ1"),a("qPIi")),zt=a.n(qt),Yt=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={callUrl:""},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getApiCallUrl",value:function(e){var t=this;e=e||this.props.showRecord.apiId,this.props.getApiCallUrl(e).then(function(e){e&&t.setState({callUrl:e.data})})}},{key:"componentDidMount",value:function(){this.getApiCallUrl()}},{key:"componentWillReceiveProps",value:function(e){e.showRecord&&this.props.showRecord.apiId!=e.showRecord.apiId&&e.slidePaneShow&&this.getApiCallUrl(e.showRecord.apiId)}},{key:"render",value:function(){var e="/dl/market/detail/"+this.props.showRecord.apiId;return o.a.createElement("div",{style:{paddingLeft:30}},o.a.createElement("p",{style:{lineHeight:"30px"}},"调用URL：",this.state.callUrl),o.a.createElement(C.c,{to:e},"在标签市场中查看"))}}]),t}(r.Component),Ht=(a("hr7U"),a("9xET")),Bt=a.n(Ht),Kt=(a("fv9D"),a("ZPTe")),Qt=a.n(Kt),Jt=a("zXZS"),Xt=a("LvDl"),Wt=a("ProS");a("75ce"),a("0o9m"),a("AH3D"),a("Ynxi");var Zt,$t,ea=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={apiId:"",data:{}},n.resize=function(){n.state.lineChart&&n.state.lineChart.resize()},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getInfo",value:function(){var e=this;this.state.apiId&&this.props.getApiCallInfo(this.state.apiId,this.props.dateType).then(function(t){t&&e.setState({data:t.data},function(){e.initLineChart()})})}},{key:"componentDidMount",value:function(){this.setState({apiId:this.props.showRecord&&this.props.showRecord.apiId}),this.getInfo()}},{key:"componentWillReceiveProps",value:function(e){var t=this;(e.showRecord&&this.state.apiId!==e.showRecord.apiId||this.props.dateType!==e.dateType)&&this.setState({apiId:e.showRecord.apiId},function(){e.slidePaneShow&&t.getInfo()})}},{key:"initLineChart",value:function(){if(this.state.data&&this.state.data.infoList){for(var e=this.state.data.infoList,t=[],a=[],n=[],i=0;i<e.length;i++)if(t.push(e[i].callCount),a.push(e[i].failRate),this.props.dateType)switch(this.props.dateType){case"1":n.push(se.a.formatHours(e[i].time));break;case"7":n.push(se.a.formatDateHours(e[i].time));break;case"30":n.push(se.a.formatDate(e[i].time))}var r=Wt.init(document.getElementById("MyApiDetailState")),o=Object(Xt.cloneDeep)(Ve);o.grid.right="40px",o.tooltip.formatter=function(e){for(var t=e[0].name,a=0,n=e.length;a<n;a++){var i="次";"失败率"==e[a].seriesName&&(i="%"),t+='<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e[a].color+'"></span>'+e[a].seriesName+" : "+e[a].value+i}return t},o.series=[{symbol:"none",name:"调用次数",data:t,type:"line",smooth:!0,itemStyle:{normal:{color:"#1C86EE"}}},{symbol:"none",name:"失败率",data:a,type:"line",smooth:!0,yAxisIndex:1,itemStyle:{normal:{color:"#EE0000"}}}],o.xAxis[0].data=n,r.setOption(o),this.setState({lineChart:r})}}},{key:"getDateText",value:function(){switch(this.props.dateType){case"1":return"24小时";case"7":return"7天";case"30":return"30天";default:return""}}},{key:"render",value:function(){return o.a.createElement("div",{style:{paddingLeft:30}},o.a.createElement(Bt.a,{gutter:130,className:"m-count padding-l20 height-101"},o.a.createElement(Qt.a,{span:8},o.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},o.a.createElement("span",{className:"m-count-title text-left"},"最近",this.getDateText(),"累计调用"),o.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.data&&this.state.data.callCount||0,o.a.createElement("span",{style:{fontSize:12}},"次")))),o.a.createElement(Qt.a,{span:6},o.a.createElement("section",{className:"m-count-section margin-t20",style:{width:100}},o.a.createElement("span",{className:"m-count-title text-left"},"最近",this.getDateText(),"失败率"),o.a.createElement("span",{className:"m-count-content font-red text-left"},this.state.data&&this.state.data.failRate||0,o.a.createElement("span",{style:{fontSize:12}},"%")))),o.a.createElement(Qt.a,{span:8},o.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},o.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),o.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.data&&this.state.data.totalCount||"---")))),o.a.createElement(Jt.a,{onResize:this.resize},o.a.createElement("article",{id:"MyApiDetailState",style:{width:"100%",height:"300px"}})))}}]),t}(r.Component),ta={1:"禁用",2:"未认证",3:"参数错误",4:"超时",5:"超出限制",6:"其他"},aa=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={error:{},data:[],loading:!1,pageIndex:1,total:0,filter:{}},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t},function(){n.getErrorInfo()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getErrorInfo()}},{key:"getErrorInfo",value:function(e){var t=this;(e=e||this.props.showRecord.apiId)&&(this.props.getApiCallErrorInfo(e).then(function(e){if(e){for(var a={},n=0;n<e.data.recordInfoList.length;n++){var i=e.data.recordInfoList[n],r=ta[i.type];r&&(a[r]={percent:i.rate,count:i.callNum})}t.setState({error:a})}}),this.props.queryApiCallLog(e,this.state.pageIndex,this.state.filter.bizType&&this.state.filter.bizType[0]).then(function(e){e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"componentWillReceiveProps",value:function(e){this.props.showRecord&&this.props.showRecord.apiId!==e.showRecord.apiId&&e.slidePaneShow&&this.getErrorInfo(e.showRecord.apiId)}},{key:"initColumns",value:function(){var e=this;return[{title:"调用时间",dataIndex:"invokeTime",key:"invokeTime",render:function(e){return se.a.formatDateTime(e)}},{title:"错误类型",dataIndex:"bizType",key:"bizType",render:function(e){return ta[e]},filters:[{text:"参数错误",value:"3"},{text:"禁用",value:"1"},{text:"未认证",value:"2"},{text:"超时",value:"4"},{text:"超出限制",value:"5"},{text:"其他",value:"6"}],filterMultiple:!1},{title:"错误日志",dataIndex:"content",key:"content",width:"50%"},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return o.a.createElement("a",{onClick:e.lookAllErrorText.bind(e,a.content)},"查看全部")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:5,total:this.state.total}}},{key:"getSource",value:function(){return this.state.data}},{key:"lookAllErrorText",value:function(e){Y.a.info({title:"错误日志",content:o.a.createElement("div",null,o.a.createElement("p",null,e)),onOk:function(){}})}},{key:"getErrorPercent",value:function(e){return this.state.error[e]&&this.state.error[e].percent||0}},{key:"getErrorCount",value:function(e){return this.state.error[e]&&this.state.error[e].count||0}},{key:"render",value:function(){return o.a.createElement("div",{style:{paddingLeft:20}},o.a.createElement("p",{style:{lineHeight:"30px",paddingLeft:"20px"},className:"child-span-padding-r20"},o.a.createElement("span",null,"参数错误: ",this.getErrorPercent("参数错误"),"% (",this.getErrorCount("参数错误"),"次)"),o.a.createElement("span",null,"禁用: ",this.getErrorPercent("禁用"),"% (",this.getErrorCount("禁用"),"次)"),o.a.createElement("span",null,"未认证: ",this.getErrorPercent("未认证"),"% (",this.getErrorCount("未认证"),"次)"),o.a.createElement("span",null,"超时: ",this.getErrorPercent("超时"),"% (",this.getErrorCount("超时"),"次)"),o.a.createElement("span",null,"超出限制: ",this.getErrorPercent("超出限制"),"% (",this.getErrorCount("超出限制"),"次)"),o.a.createElement("span",null,"其他: ",this.getErrorPercent("其他"),"% (",this.getErrorCount("其他"),"次)")),o.a.createElement(q.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))}}]),t}(r.Component),na=zt.a.Button,ia=zt.a.Group,ra=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={approvedText:"同意",applyText:"申请调用此接口，请批准",nowView:"callState",callStateDate:"1",errorLogDate:"7"},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"callback",value:function(e){this.setState({nowView:e})}},{key:"chooseCallStateDate",value:function(e){this.setState({callStateDate:e.target.value})}},{key:"chooseErrorLogDate",value:function(e){this.setState({errorLogDate:e.target.value})}},{key:"getDateTypeView",value:function(){switch(this.state.nowView){case"callState":return o.a.createElement("div",{className:"m-radio-group",key:"callStateDate",style:{marginTop:4,marginRight:28}},o.a.createElement(ia,{name:"callStateDate",defaultValue:this.state.callStateDate,className:"no-bd nobackground",onChange:this.chooseCallStateDate.bind(this)},o.a.createElement(na,{value:"1"},"最近24小时"),o.a.createElement(na,{value:"7"},"最近7天"),o.a.createElement(na,{value:"30"},"最近30天")));case"errorLog":return o.a.createElement("div",{className:"m-radio-group",key:"errorLogDate",style:{marginTop:4,marginRight:28}},o.a.createElement(ia,{name:"errorLogDate",defaultValue:this.state.errorLogDate,className:"no-bd nobackground",onChange:this.chooseErrorLogDate.bind(this)},o.a.createElement(na,{value:"7"},"最近7天")));default:return null}}},{key:"render",value:function(){var e=3==this.props.showRecord.status||1==this.props.showRecord.apiStatus?null:o.a.createElement(bt.a.TabPane,{tab:"调用方式",key:"callMethod"},o.a.createElement(Yt,this.props));return o.a.createElement(Ot.a,{className:"m-tabs tabs-filter-show",visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"350px"},onClose:this.props.closeSlidePane},o.a.createElement(bt.a,{activeKey:this.state.nowView,onChange:this.callback.bind(this),tabBarExtraContent:this.getDateTypeView()},o.a.createElement(bt.a.TabPane,{tab:"调用情况",key:"callState"},o.a.createElement(ea,M()({},this.props,{dateType:this.state.callStateDate}))),o.a.createElement(bt.a.TabPane,{tab:"错误日志",key:"errorLog"},o.a.createElement(aa,M()({},this.props,{dateType:this.state.errorLogDate}))),e))}}]),t}(r.Component),oa=Y.a.confirm,la=Q.a.Search,sa={0:"inhand",1:"success",2:"notPass",3:"stop",4:"disabled"},ca={applyTime:"gmt_create"},ua={ascend:"asc",descend:"desc"},da=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageIndex:1,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,slidePaneShowSuccess:!1,loading:!1,sortedInfo:{},filterInfo:{},showRecord:{},apiName:void 0},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,sortedInfo:a,filterInfo:t},function(){n.getAppliedList()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getAppliedList",value:function(){var e=this;this.setState({loading:!0});var t=this.state,a=t.filterInfo,n=t.sortedInfo,i=t.pageIndex,r=t.apiName;this.props.getAppliedList(i,ca[n.columnKey],ua[n.order],a.status,r).then(function(t){if(e.props.apiId&&t)for(var a in t.data.data){var n=t.data.data[a];if(e.props.apiId==n.apiId){e.apiClick(n);break}}e.setState({loading:!1})})}},{key:"componentDidMount",value:function(){this.getAppliedList()}},{key:"componentWillReceiveProps",value:function(e){if(this.props.apiId!=e.apiId&&e.apiId){var t=this.getSource();if(t)for(var a in t.data){var n=t.data[a];if(e.apiId==n.apiId){this.dealClick(n);break}}}}},{key:"closeSlidePane",value:function(){this.setState({slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,slidePaneShowSuccess:!1,showRecord:{}})}},{key:"apiClick",value:function(e){var t=this["state"+sa[e.status]];t&&t.call(this,e)}},{key:"statesuccess",value:function(e){this.setState({slidePaneShowSuccess:!0,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statenotPass",value:function(e){this.setState({slidePaneShowSuccess:!1,slidePaneShowNoApproved:!0,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statestop",value:function(e){this.setState({slidePaneShowSuccess:!0,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statedisabled",value:function(e){this.setState({slidePaneShowSuccess:!1,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!0,showRecord:e||{}})}},{key:"dealClick",value:function(e){var t=this["deal"+sa[e.status]];t&&t.call(this,e)}},{key:"dealsuccess",value:function(e){var t=this;oa({title:"确认停止",content:"确认停止接口？",onOk:function(){t.props.updateApplyStatus(e.id,3).then(function(e){e&&le.a.success("停止成功"),t.getAppliedList()})},onCancel:function(){}})}},{key:"dealstop",value:function(e){var t=this;oa({title:"确认开启",content:"确认开启接口？",onOk:function(){t.props.updateApplyStatus(e.id,1).then(function(e){e&&le.a.success("开启成功"),t.getAppliedList()})},onCancel:function(){}})}},{key:"dealnotPass",value:function(e){this.props.router.push("/dl/market")}},{key:"initColumns",value:function(){var e=this;return[{title:"标签名称",dataIndex:"apiName",key:"apiName",render:function(t,a){if(a.apiDeleted)return o.a.createElement("a",{className:"disable-all",onClick:e.apiClick.bind(e,a)},t+"(已删除)");var n=1==a.apiStatus,i=n?"(全平台禁用)":"";return o.a.createElement("a",{className:n?"disable-all":"",onClick:e.apiClick.bind(e,a)},t+i)}},{title:"授权状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",{className:"state-"+sa[e]},{success:"已通过",disabled:"取消授权",stop:"停用",notPass:"已拒绝"}[sa[e]])},filters:[{text:"已通过",value:"1"},{text:"已拒绝",value:"2"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}]},{title:"描述",dataIndex:"apiDesc",key:"apiDesc",width:300},{title:"最近24小时调用(次)",dataIndex:"recentCallNum",key:"recentCallNum"},{title:"最近24小时失败率",dataIndex:"recentFailRate",key:"recentFailRate",render:function(e){return e+"%"}},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",sorter:!0,render:function(e){return se.a.formatDateTime(e)}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a){var n={success:"停用",disabled:"",stop:"启用",notPass:"再次申请"};return n[sa[a.status]]?o.a.createElement("a",{onClick:e.dealClick.bind(e,a)},n[sa[a.status]]):null}}]}},{key:"getSource",value:function(){return this.props.mine.apiList.appliedList.data||[]}},{key:"getTotal",value:function(){return this.props.mine.apiList.appliedList&&this.props.mine.apiList.appliedList.totalCount||0}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.getTotal()}}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getAppliedList()})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(V.a,{noHovering:!0,bordered:!1},o.a.createElement(Mt,M()({},this.props,{isApproved:!0,showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowNoApproved,closeSlidePane:this.closeSlidePane.bind(this)})),o.a.createElement(Ft,M()({},this.props,{showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowDisabled,closeSlidePane:this.closeSlidePane.bind(this)})),o.a.createElement(ra,M()({style:{right:"0px"}},this.props,{showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowSuccess,closeSlidePane:this.closeSlidePane.bind(this)})),o.a.createElement("div",{className:"flex font-12"},o.a.createElement(la,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"10px"},onSearch:this.handleApiSearch.bind(this)})),o.a.createElement(q.a,{rowClassName:function(t,a){return e.state.showRecord.apiId==t.apiId?"row-select":""},rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange})))}}]),t}(r.Component),pa=Object(T.b)(function(e){var t=e.user;return{mine:e.mine,user:t}},function(e){return{getApplyingList:function(t,a,n,i){return e(At({currentPage:t,pageSize:20,orderBy:a,sort:n,apiName:i}))},getAppliedList:function(t,a,n,i,r){return e(_t({currentPage:t,pageSize:20,orderBy:a,sort:n,status:i,apiName:r}))},updateApplyStatus:function(t,a){return e(Dt({applyId:t,status:a}))},getApiCallInfo:function(t,a){return e(Nt({apiId:t,time:a}))},getApiCallErrorInfo:function(t){return e(xt({apiId:t}))},getApiCallUrl:function(t){return e(Lt({apiId:t}))},queryApiCallLog:function(t,a,n){return e(wt({apiId:t,currentPage:a,bizType:n,pageSize:5}))},getApiCreatorInfo:function(t){return e(Pt({apiId:t}))}}})(Zt=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={nowView:"notApproved",pageIndex:1},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"handleClick",value:function(e){this.setState({nowView:e}),"approved"==e?this.props.router.replace("/dl/mine/approved"):this.props.router.replace("/dl/mine")}},{key:"componentWillMount",value:function(){var e=this.props.router.params.view;e&&this.setState({nowView:e})}},{key:"getCardView",value:function(){return this.state.nowView&&"notApproved"==this.state.nowView?o.a.createElement(Vt,this.props):o.a.createElement(da,this.props)}},{key:"render",value:function(){this.props.children;return o.a.createElement("div",{style:{height:"100%",overflowX:"hidden"}},o.a.createElement("div",{className:"box-1 m-card shadow m-tabs"},o.a.createElement(bt.a,{animated:!1,defaultActiveKey:this.state.nowView,onChange:this.handleClick.bind(this),style:{height:"auto",overflow:"inherit"}},o.a.createElement(bt.a.TabPane,{tab:"未审批",key:"notApproved"},o.a.createElement(Vt,M()({apiId:this.props.location.query&&this.props.location.query.apiId},this.props))),o.a.createElement(bt.a.TabPane,{tab:"已审批",key:"approved"},o.a.createElement(da,M()({apiId:this.props.location.query&&this.props.location.query.apiId},this.props))))))}}]),t}(r.Component))||Zt,ma=a("jaNl"),ha=function(e){return Ee.post(ue.GET_ALL_API_LIST,e)},ga=function(e){return Ee.post(ue.GET_DATASOURCE_BASE_INFO,e)},fa=function(e){return Ee.post(ue.DELETE_API,e)},ya=function(e){return Ee.post(ue.UPDATE_API,e)},Ea=function(e){return Ee.post(ue.GET_API_CALL_RANK,e)},va=function(e){return Ee.post(ue.GET_API_BUY_STATE,e)},Sa=function(e){return Ee.post(ue.UPDATE_CATAGORY,e)},Ca=function(e){return Ee.post(ue.ADD_CATAGORY,e)},Ta=function(e){return Ee.post(ue.DELETE_CATAGORY,e)},ba=function(e){return Ee.post(ue.GET_API_DETAIL_INFO,e)},ka=function(e){return Ee.post(ue.GET_API_CALL_ERROR_INFO_ADMIN,e)},Ia=function(e){return function(t){return ha(e).then(function(e){if(1===e.code)return t({type:ma.a.GET_ALL_API_LIST,payload:e.data.data}),e})}},Aa=function(e){return function(t){return ga(e).then(function(e){if(1===e.code)return e})}},_a=function(e){return function(t){return fa(e).then(function(e){if(1===e.code)return e})}},Da=function(e){return function(t){return ya({apiId:e,apiStatus:0}).then(function(e){if(1===e.code)return e})}},Na=function(e){return function(t){return ya({apiId:e,apiStatus:1}).then(function(e){if(1===e.code)return e})}},xa=function(e){return function(t){return Ea(e).then(function(e){if(1===e.code)return e})}},La=function(e){return function(t){return va(e).then(function(e){if(1===e.code)return e})}},wa=function(e){return function(t){return Sa(e).then(function(e){if(1===e.code)return e})}},Pa=function(e){return function(t){return Ta(e).then(function(e){if(1===e.code)return e})}},Oa=function(e){return function(t){return Ca(e).then(function(e){if(1===e.code)return e})}},Ra=function(e){return function(t){return ka(e).then(function(e){if(1===e.code)return e})}};var Ma,ja,Ga,Ua=Q.a.Search,Va=B.a.Option,Fa=Y.a.confirm,qa=Object(T.b)(function(e){return{user:e.user,apiMarket:e.apiMarket,apiManage:e.apiManage,dataSource:e.dataSource}},function(e){return{getCatalogue:function(t){e(Se(t))},getAllApiList:function(t){return e(Ia(t))},getDataSourceList:function(t){return e(Aa({type:t}))},deleteApi:function(t){return e(_a({apiIds:[t]}))},openApi:function(t){return e(Da(t))},closeApi:function(t){return e(Na(t))},getDataSourcesType:function(){return e(tt())}}})($t=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageSize:20,pageIndex:1,type1:void 0,type2:void 0,total:0,dataSourceType:void 0,dataSource:void 0,searchName:null,filter:{},sortedInfo:{},changeMan:null,loading:!1},n.onSourceChange=function(e){n.setState({type1:e,type2:void 0},function(){n.getAllApi()})},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t,sortedInfo:a},function(){n.getAllApi()})},n.dataSourceTypeChange=function(e){n.setState({dataSourceType:e,dataSource:void 0},function(){n.getDataSource(),n.getAllApi()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.getAllApi(),this.getDataSource(null),this.props.getDataSourcesType()}},{key:"exchangeSourceType",value:function(){var e=[],t={},a=this.props.dataSource.sourceType;for(var n in a){var i=a[n];t[i.value]=i.name,e.push({text:i.name,value:i.value})}return{typeList:e,typeDic:t}}},{key:"getAllApi",value:function(){var e=this,t={};t.name=this.state.searchName,t.pid=this.state.type1,t.cid=this.state.type2,t.dataSourceType=this.state.dataSourceType&&parseInt(this.state.dataSourceType),t.dataSourceId=this.state.dataSource&&parseInt(this.state.dataSource),t.modifyUserId=this.state.changeMan,t.orderBy={gmtModified:"gmt_modified"}[this.state.sortedInfo.columnKey],t.sort={ascend:"asc",descend:"desc"}[this.state.sortedInfo.order],t.currentPage=this.state.pageIndex,t.pageSize=this.state.pageSize,this.setState({loading:!0}),this.props.getAllApiList(t).then(function(t){e.setState({loading:!1}),t&&e.setState({total:t.data.totalCount})})}},{key:"renderSourceType",value:function(e,t){function a(e){return!e||e.length<1?null:e.map(function(e){return o.a.createElement(Va,{key:e.id},e.name)})}var n=[],i=this.props.apiMarket.apiCatalogue;if(t){if(!i)return null;for(var r=0;r<i.length;r++)n.push({id:i[r].id,name:i[r].catalogueName});return a(n)}if(!i)return null;for(var l=void 0,s=0;s<i.length;s++)if(i[s].id==e){l=i[s].childCatalogue;break}if(!l)return null;for(var c=0;c<l.length;c++)l[c].api||n.push({id:l[c].id,name:l[c].catalogueName});return a(n)}},{key:"onUserSourceChange",value:function(e){var t=this;this.setState({type2:e},function(){t.getAllApi()})}},{key:"handleSearch",value:function(e){var t=this;this.setState({searchName:e||void 0,pageIndex:1},function(){t.getAllApi()})}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.state.total}}},{key:"openDetail",value:function(e){this.props.router.push("/dl/manage/detail/"+e)}},{key:"initColumns",value:function(){var e=this;return[{width:"10%",title:"标签名称",dataIndex:"name",key:"name",render:function(t,a){return o.a.createElement("a",{onClick:e.openDetail.bind(e,a.apiId)},t)}},{width:100,title:"类型",dataIndex:"type",key:"type",render:function(e,t){return De[e]}},{width:"10%",title:"描述",dataIndex:"tagDesc",key:"tagDesc"},{width:"10%",title:"数据源",dataIndex:"dataSourceType",key:"dataSourceType",render:function(e,t){return function(e){switch(e){case _e.MYSQL:return"MySQL";case _e.ORACLE:return"Oracle";case _e.SQLSERVER:return"SQLServer";case _e.HDFS:return"HDFS";case _e.HIVE:return"Hive";case _e.HBASE:return"HBase";case _e.FTP:return"FTP";case _e.MAXCOMPUTE:return"MaxCompute";default:return"其他"}}(t.dataSourceType)+" / "+t.dataSourceName}},{width:"10%",title:"最近24小时调用",dataIndex:"total1d",key:"total1d"},{width:"8%",title:"累计调用",dataIndex:"invokeTotal",key:"invokeTotal"},{width:"10%",title:"最近修改人",dataIndex:"modifyUser",key:"modifyUser"},{width:"10%",title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",sorter:!0,render:function(e){return se.a.formatDateTime(e)}},{width:"10%",title:"创建人",dataIndex:"createUser",key:"createUser"},{width:100,title:"启用状态",dataIndex:"apiStatus",key:"apiStatus",render:function(e,t){return Le[e]}},{width:120,title:"操作",dataIndex:"deal",key:"deal",render:function(t,a){return 0==a.apiStatus?o.a.createElement("a",{onClick:e.closeApi.bind(e,a.apiId)},"禁用"):o.a.createElement("div",null,o.a.createElement("a",{onClick:e.openApi.bind(e,a.apiId)},"开启"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.editApi.bind(e,a.id)},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.deleteApi.bind(e,a.apiId)},"删除"))}}]}},{key:"getSource",value:function(){return this.props.apiManage.apiList}},{key:"editApi",value:function(e){this.props.router.push("/dl/manage/editApi/"+e)}},{key:"openApi",value:function(e){var t=this;Fa({title:"确认开启?",content:"确认开启标签",onOk:function(){t.setState({loading:!0}),t.props.openApi(e).then(function(e){t.setState({loading:!1}),le.a.success("开启成功"),e&&t.getAllApi()})},onCancel:function(){}})}},{key:"closeApi",value:function(e){var t=this;Fa({title:"确认禁用?",content:"确认禁用标签",onOk:function(){t.setState({loading:!0}),t.props.closeApi(e).then(function(e){t.setState({loading:!1}),le.a.success("禁用成功"),e&&t.getAllApi()})},onCancel:function(){}})}},{key:"deleteApi",value:function(e){var t=this;Fa({title:"确认删除?",content:"确认删除标签",onOk:function(){t.setState({loading:!0}),t.props.deleteApi(e).then(function(e){t.setState({loading:!1}),1===e.code&&(le.a.success("删除成功"),t.getAllApi())})},onCancel:function(){}})}},{key:"gerDataSourceView",value:function(){var e=this.state.dataSourceList;return e?e.map(function(e,t){return o.a.createElement(Va,{key:e.id},e.name)}):null}},{key:"getDataSource",value:function(){var e=this;this.props.getDataSourceList(this.state.dataSourceType).then(function(t){if(t){var a=t.data;e.setState({dataSourceList:a})}})}},{key:"getDataSourceTypeView",value:function(){var e=this.exchangeSourceType(),t=e.typeList;e.typeDic;return!t||t.length<1?null:t.map(function(e){return o.a.createElement(Va,{key:e.value},e.text)})}},{key:"dataSourceChange",value:function(e){var t=this;this.setState({dataSource:e},function(){t.getAllApi()})}},{key:"changeManCheck",value:function(e){var t=this,a=null;e.target.checked&&(a=this.props.user.id),this.setState({changeMan:a},function(){t.getAllApi()})}},{key:"openApiType",value:function(){this.props.router.push("/dl/manage/apiType")}},{key:"newApi",value:function(){this.props.router.push("/dl/manage/newApi")}},{key:"render",value:function(){this.props.children;var e=o.a.createElement("div",{className:"flex font-12"},o.a.createElement(Ua,{placeholder:"输入标签名称搜索",style:{width:200,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),o.a.createElement("div",{className:"m-l-8"},"标签分类：",o.a.createElement(B.a,{allowClear:!0,value:this.state.type1,style:{width:150},onChange:this.onSourceChange},this.renderSourceType(0,!0))),o.a.createElement("div",{className:"m-l-8"},"类型：",o.a.createElement(B.a,{allowClear:!0,value:this.state.dataSourceType,style:{width:150},onChange:this.dataSourceTypeChange},this.getDataSourceTypeView()))),t=o.a.createElement("div",{style:{paddingTop:"10px"}},o.a.createElement(Ae.a,{onClick:this.openApiType.bind(this),style:{marginRight:"8px"},type:"primary"},"类目管理"));return o.a.createElement("div",{className:"api-management"},o.a.createElement("div",{style:{marginTop:"20px"},className:"margin-0-20 m-card box-2"},o.a.createElement(V.a,{noHovering:!0,title:e,extra:t},o.a.createElement(q.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))))}}]),t}(r.Component))||$t,za=a("vFmn"),Ya=function(e){return Ee.post(ue.GET_ALL_APPLY_LIST,e)},Ha=function(e){return Ee.post(ue.HANDLE_APPLY,e)},Ba=function(e){return function(t){return Ya(e).then(function(e){if(1===e.code)return t({type:za.a.GET_ALL_APPLY_LIST,payload:e.data.data}),e})}},Ka=function(e){return function(t){return Ha(e).then(function(e){if(1===e.code)return e})}},Qa=Q.a.TextArea,Ja=Q.a.Search,Xa=X.a.Item,Wa={applyTime:"gmt_modified"},Za={ascend:"asc",descend:"desc"},$a=Object(T.b)(function(e){var t=e.user;return{approval:e.approval,apiManage:e.apiManage,user:t}},function(e){return{approvalList:function(t){return e(Ba(t))},handleApply:function(t){return e(Ka(t))}}})(Ma=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageIndex:1,spVisible:!1,msgVisible:!1,data:[],sorter:{},filter:{status:null},userName:"",applyContent:"",replyContent:"",apiName:void 0,spApplyMsg:{},total:0},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t,sorter:a},function(){n.getApprovalList()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=this.props.router.location.query&&this.props.router.location.query.status,a=[];t&&a.push(t.toString()),this.setState({filter:{status:a&&a.length>0?a:null}},function(){e.getApprovalList()})}},{key:"getApprovalList",value:function(){var e=this;this.props.approvalList({userName:this.state.userName,status:this.state.filter.status&&this.state.filter.status[0],currentPage:this.state.pageIndex,pageSize:20,sort:Za[this.state.sorter.order],orderBy:Wa[this.state.sorter.columnKey],apiName:this.state.apiName}).then(function(t){t&&e.setState({total:t.data.totalCount})})}},{key:"handleSearch",value:function(e){var t=this;this.setState({userName:e,pageIndex:1},function(){t.getApprovalList()})}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getApprovalList()})}},{key:"onSourceChange",value:function(){}},{key:"handleCancel",value:function(){this.setState({spVisible:!1,msgVisible:!1})}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.state.total}}},{key:"getDealType",value:function(e){return{notApproved:"立即审批",pass:"查看详情",rejected:"查看详情",stop:"查看详情",disabled:"查看详情"}[e||"nothing"]}},{key:"deal",value:function(e){var t=this["deal"+Pe[e.status]];t&&t.call(this,e)}},{key:"dealrejected",value:function(e){this.lookDetail(e)}},{key:"dealstop",value:function(e){this.lookDetail(e)}},{key:"dealdisabled",value:function(e){this.lookDetail(e)}},{key:"dealpass",value:function(e){this.lookDetail(e)}},{key:"dealnotApproved",value:function(e){this.spShow(e)}},{key:"getSource",value:function(){return this.props.approval.approvalList}},{key:"initColumns",value:function(){var e=this;return[{title:"申请人",dataIndex:"applyUserName",key:"applyUserName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",{className:"state-"+Pe[e]},{notApproved:"未审批",pass:"已通过",rejected:"已拒绝",stop:"停用",disabled:"取消授权"}[Pe[e]])},filterMultiple:!1,filters:[{text:"未审批",value:"0"},{text:"已通过",value:"1"},{text:"已拒绝",value:"2"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}],filteredValue:this.state.filter.status||null},{title:"申请标签",dataIndex:"apiName",key:"apiName"},{title:"申请说明",dataIndex:"applyContent",key:"applyContent",width:"250px"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime",sorter:!0,render:function(e){return se.a.formatDateTime(e)}},{title:"操作",dataIndex:"deal",render:function(t,a){return o.a.createElement("a",{onClick:e.deal.bind(e,a)},e.getDealType(Pe[a.status]))}}]}},{key:"renderSourceType",value:function(){return null}},{key:"getCardTitle",value:function(){return o.a.createElement("div",{className:"flex font-12"},o.a.createElement(Ja,{placeholder:"输入用户名称搜索",style:{width:150,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),o.a.createElement(Ja,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"30px"},onSearch:this.handleApiSearch.bind(this)}))}},{key:"sp",value:function(e){var t=this;this.props.form.validateFields(function(a,n){if(!a){var i=t.state.spApplyMsg.id,r=n.APIGroup;t.props.handleApply({applyId:i,isPassed:e,approvalContent:r}).then(function(e){t.setState({spVisible:!1}),e&&(le.a.success("审批成功"),t.getApprovalList())})}})}},{key:"spShow",value:function(e){this.props.form.resetFields(),this.setState({spVisible:!0,spApplyMsg:e})}},{key:"lookDetail",value:function(e){this.setState({msgVisible:!0,applyContent:e.applyContent,replyContent:e.replyContent})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement("div",{className:"api-approval"},o.a.createElement("h1",{className:"box-title"},"审批授权"),o.a.createElement("div",{className:"margin-0-20 m-card"},o.a.createElement(V.a,{noHovering:!0,title:this.getCardTitle(),className:"shadow"},o.a.createElement(q.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:!1,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))),o.a.createElement(Y.a,{title:"审批授权",visible:this.state.spVisible,onCancel:this.handleCancel.bind(this),footer:o.a.createElement("div",null,o.a.createElement(Ae.a,{type:"danger",onClick:this.sp.bind(this,!1)},"拒绝"),o.a.createElement(Ae.a,{type:"primary",onClick:this.sp.bind(this,!0)},"同意"))},o.a.createElement(X.a,null,o.a.createElement(Xa,M()({},Me,{label:"申请说明"}),o.a.createElement(Qa,{disabled:!0,value:this.state.spApplyMsg.applyContent})),o.a.createElement(Xa,M()({},Me,{label:"审批说明"}),e("APIGroup",{rules:[{required:!0,message:"请填写审批说明"},{max:200,message:"最大字数不能超过200"}]})(o.a.createElement(Qa,null))))),o.a.createElement(Y.a,{title:"审批详情",visible:this.state.msgVisible,footer:o.a.createElement(Ae.a,{type:"primary",onClick:this.handleCancel.bind(this)},"关闭"),onCancel:this.handleCancel.bind(this)},o.a.createElement(X.a,null,o.a.createElement(Xa,M()({},Me,{label:"申请说明"}),o.a.createElement(Qa,{disabled:!0,value:this.state.applyContent})),o.a.createElement(Xa,M()({},Me,{label:"审批说明"}),o.a.createElement(Qa,{disabled:!0,value:this.state.replyContent})))))}}]),t}(r.Component))||Ma,en=X.a.create()($a),tn=a("m1cH"),an=a.n(tn),nn=(a("G851"),a("ZvzK")),rn=a.n(nn),on=(a("FGdI"),a("Pbn2")),ln=a.n(on),sn=(a("eOfH"),a("h0/l")),cn=a.n(sn),un=(a("PFYH"),a("Jv8k")),dn=a.n(un),pn=(a("bd+v"),a("LB4q")),mn=a.n(pn),hn=a("H6kJ"),gn={queryRegisteredTag:function(e){return Ee.post(ue.QUERY_REGISTERED_TAG,e)},addRegisterTag:function(e){return Ee.post(ue.ADD_REGISTER_TAG,e)},queryRuleTag:function(e){return Ee.post(ue.QUERY_RULE_TAG,e)},addRuleTag:function(e){return Ee.post(ue.ADD_RULE_TAG,e)},updateTagSqlInfo:function(e){return Ee.post(ue.UPDATE_TAG_SQL_INFO,e)},getTagCondition:function(e){return Ee.post(ue.GET_TAG_CONDITION,e)},editTagCondition:function(e){return Ee.post(ue.EDIT_TAG_CONDITION,e)},deleteTagCondition:function(e){return Ee.post(ue.DELETE_TAG_CONDITION,e)},getComputeSource:function(e){return Ee.post(ue.GET_COMPUTE_SOURCE,e)},queryTagLogInfo:function(e){return Ee.post(ue.QUERY_TAG_LOG,e)},updateTagBaseInfo:function(e){return Ee.post(ue.UPDATE_TAG_BASE_INFO,e)},deleteTag:function(e){return Ee.post(ue.DELETE_TAG,e)},checkPublish:function(e){return Ee.post(ue.PUBLISH_CHECK,e)},publishTag:function(e){return Ee.post(ue.PUBLISH_TAG,e)},getRuleTagDetail:function(e){return Ee.post(ue.GET_RULE_TAG_RETAIL,e)},getAllIdentifyColumn:function(e){return Ee.post(ue.GET_ALL_IDENTIFY_COLUMN,e)},queryIdentifyColumn:function(e){return Ee.post(ue.QUERY_IDENTIFY_COLUMN,e)},addIdentifyColumn:function(e){return Ee.post(ue.ADD_IDENTIFY_COLUMN,e)},updateIdentifyColumn:function(e){return Ee.post(ue.UPDATE_IDENTIFY_COLUMN,e)},deleteIdentifyColumn:function(e){return Ee.post(ue.DELETE_IDENTIFY_COLUMN,e)}},fn=function(e){return function(t){gn.getAllIdentifyColumn(e).then(function(e){1===e.code&&t({type:hn.a.GET_ALL_IDENTIFY_COLUMN,payload:e.data})})}},yn=B.a.Option,En=X.a.Item,vn=Q.a.TextArea,Sn=Object(T.b)(function(e){return{tagConfig:e.tagConfig,dataSource:e.dataSource,apiMarket:e.apiMarket}},function(e){return{getTagDataSourcesList:function(t){e(nt(t))},getAllIdentifyColumn:function(t){e(fn(t))},getDataSourcesTable:function(t){e(it(t))},resetDataSourcesTable:function(){e(rt())},getDataSourcesColumn:function(t){e(ot(t))},resetDataSourcesColumn:function(){e(lt())}}})(ja=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={},n.initCatagoryOption=function(e){return e.some(function(e){return!0===e.api})?[]:e.map(function(e){return{value:e.id,label:e.catalogueName,children:n.initCatagoryOption(e.childCatalogue)}})},n.onSourceChange=function(e){n.props.form.setFieldsValue({originTable:void 0,originColumn:void 0,identityColumn:void 0}),n.props.resetDataSourcesTable(),n.props.resetDataSourcesColumn(),n.props.getDataSourcesTable({sourceId:e})},n.onSourceTableChange=function(e){var t=n.props.form;t.setFieldsValue({originColumn:void 0,identityColumn:void 0}),n.props.resetDataSourcesColumn(),n.props.getDataSourcesColumn({sourceId:t.getFieldValue("dataSourceId"),tableName:e})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.getTagDataSourcesList(),this.props.getAllIdentifyColumn()}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.visible,n=e.editData,i=e.apiMarket,r=e.dataSource,l=e.tagConfig,s=t.getFieldDecorator,c=i.apiCatalogue,u=l.identifyColumn,d=r.tagSourceList,p=r.sourceTable,m=r.sourceColumn,h="已发布"===xe[n.publishStatus],g=(n.name?"编辑":"新建")+De[n.type];return o.a.createElement(Y.a,{title:g,wrapClassName:"ruleTagModal",width:"50%",visible:a,maskClosable:!1,okText:"保存",cancelText:"取消",onOk:this.props.saveTag.bind(this,t),onCancel:this.props.cancel.bind(this,t)},o.a.createElement(X.a,null,o.a.createElement(En,M()({},Me,{label:"标签名称"}),s("name",{rules:[{required:!0,message:"标签名称不可为空"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:n.name})(o.a.createElement(Q.a,{disabled:h}))),o.a.createElement(En,M()({},Me,{label:"标签描述"}),s("tagDesc",{rules:[{max:200,message:"描述字符不能超过200"}],initialValue:n.tagDesc})(o.a.createElement(vn,{placeholder:"标签描述",autosize:{minRows:2,maxRows:6}}))),o.a.createElement(En,M()({},Me,{label:"标签类目"}),s("catalogueId",{rules:[{required:!0,message:"标签类目不可为空"}],initialValue:n.catalogueId})(o.a.createElement(mn.a,{showSearch:!0,popupClassName:"noheight",options:this.initCatagoryOption(c),placeholder:"请选择分组"}))),o.a.createElement(En,M()({},Me,{label:"值域"}),s("tagRange",{rules:[{required:!0,message:"值域不可为空"},{max:200,message:"请控制在200个字符以内！"}],initialValue:n.tagRange})(o.a.createElement(vn,{placeholder:"值域",autosize:{minRows:2,maxRows:6}}))),o.a.createElement(En,M()({},Me,{label:"目标数据库"}),s("dataSourceId",{rules:[{required:!0,message:"目标数据库不可为空"}],initialValue:n.dataSourceId?n.dataSourceId.toString():void 0})(o.a.createElement(B.a,{showSearch:!0,optionFilterProp:"title",placeholder:"选择目标数据库",disabled:h,onChange:this.onSourceChange},d.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(yn,{key:e.id,value:e.id.toString(),title:t},t)})))),"注册标签"===De[n.type]?o.a.createElement("div",null,o.a.createElement(En,M()({},Me,{label:"来源表"}),s("originTable",{rules:[{required:!0,message:"请选择来源表"}],initialValue:n.originTable})(o.a.createElement(B.a,{showSearch:!0,placeholder:"选择来源表",disabled:h,onChange:this.onSourceTableChange},p.map(function(e){return o.a.createElement(yn,{key:e,value:e},e)})))),o.a.createElement(En,M()({},Me,{label:"来源列"}),s("originColumn",{rules:[{required:!0,message:"请选择来源列"}],initialValue:n.originColumn})(o.a.createElement(B.a,{showSearch:!0,disabled:h,placeholder:"选择来源列"},m.map(function(e){return o.a.createElement(yn,{key:e.key,value:e.key},e.key)})))),o.a.createElement(En,M()({},Me,{label:"识别列ID"}),s("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"}],initialValue:n.identityColumn})(o.a.createElement(B.a,{showSearch:!0,disabled:h,placeholder:"选择识别列ID"},m.map(function(e){return o.a.createElement(yn,{key:e.key,value:e.key},e.key)}))))):o.a.createElement("div",null,o.a.createElement(En,M()({},Me,{label:"来源表"}),s("originTable",{rules:[{required:!0,message:"来源表不可为空"},{max:64,message:"请控制在64个字符以内！"}],initialValue:n.originTable})(o.a.createElement(Q.a,{disabled:h}))),o.a.createElement(En,M()({},Me,{label:"识别列ID"}),s("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"},{max:64,message:"请控制在64个字符以内！"}],initialValue:n.identityColumn})(o.a.createElement(Q.a,{disabled:h})))),o.a.createElement(En,M()({},Me,{label:"识别列类型"}),s("identityId",{rules:[{required:!0,message:"识别列类型不可为空"}],initialValue:n.identityId?n.identityId.toString():void 0})(o.a.createElement(B.a,{showSearch:!0,optionFilterProp:"title",placeholder:"选择识别列类型",disabled:h},u.map(function(e){return o.a.createElement(yn,{key:e.id,value:e.id.toString(),title:e.name},e.name)}))))))}}]),t}(r.Component))||ja;Sn=X.a.create()(Sn);var Cn,Tn,bn=Q.a.Search,kn=B.a.Option,In=Object(T.b)(function(e){return{apiMarket:e.apiMarket}},function(e){return{getDataSourcesTable:function(t){e(it(t))},getDataSourcesColumn:function(t){e(ot(t))}}})(Ga=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={visible:!1,loading:!1,queryParams:{currentPage:1,pageSize:20},tagList:{},editData:{},catalogue2Data:[]},n.getTagListData=function(e){n.setState({loading:!0}),("rule"===n.props.tagType?gn.queryRuleTag:gn.queryRegisteredTag)(e).then(function(e){1===e.code&&n.setState({loading:!1,tagList:e.data})})},n.initRuleTagTable=function(){return[{title:"标签名称",dataIndex:"name",key:"name",width:"10%"},{title:"标签描述",dataIndex:"tagDesc",key:"tagDesc",width:"12%"},{title:"标签类目",dataIndex:"catalogueName",key:"catalogueName",width:"10%"},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:100},{title:"目标数据库",dataIndex:"dataSourceName",key:"dataSourceName",width:"8%"},{title:"来源表",dataIndex:"originTable",key:"originTable",width:"8%"},{title:"识别列ID",dataIndex:"identityColumn",key:"identityColumn",width:100},{title:"识别列类型",dataIndex:"identityName",key:"identityName",width:"8%"},{title:"更新日期",dataIndex:"gmtModified",key:"gmtModified",width:"10%",render:function(e){return e?se.a.formatDateTime(e):"--"}},{title:"状态",dataIndex:"status",key:"status",width:100,render:function(e){return Ne[e]}},{title:"发布状态",dataIndex:"publishStatus",key:"publishStatus",width:90,render:function(e){return xe[e]}},{title:"操作",width:90,render:function(e,t){var a=o.a.createElement(dn.a,null,"更新中"!=Ne[t.status]&&o.a.createElement(dn.a.Item,{key:"edit"},o.a.createElement("a",{onClick:n.editBaseInfo.bind(n,t)},"编辑")),"更新中"!=Ne[t.status]&&"未发布"===xe[t.publishStatus]&&o.a.createElement(dn.a.Item,{key:"edit2"},o.a.createElement(C.c,{to:"/dl/tagConfig/ruleTagEdit/"+t.id},"配置计算逻辑")),"更新完成"==Ne[t.status]&&"未发布"===xe[t.publishStatus]&&o.a.createElement(dn.a.Item,{key:"pub"},o.a.createElement("a",{onClick:n.checkPublish.bind(n,t.id)},"发布")),o.a.createElement(dn.a.Item,{key:"log"},o.a.createElement(C.c,{to:"/dl/tagConfig/tagLog/"+t.id},"查看更新历史")),o.a.createElement(dn.a.Item,{key:"del"},o.a.createElement(cn.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:n.removeTag.bind(n,t.id)},o.a.createElement("a",null,"删除"))));return o.a.createElement("span",{id:"tag_"+t.id},o.a.createElement(rn.a,{getPopupContainer:function(){return document.getElementById("tag_"+t.id)},overlay:a,trigger:["click"]},o.a.createElement(Ae.a,null,"操作",o.a.createElement(ln.a,{type:"down"}))))}}]},n.initRegisterTagTable=function(){return[{title:"标签名称",dataIndex:"name",key:"name",width:"10%"},{title:"标签描述",dataIndex:"tagDesc",key:"tagDesc",width:"10%"},{title:"标签类目",dataIndex:"catalogueName",key:"catalogueName",width:"8%"},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:120},{title:"目标数据库",dataIndex:"dataSourceName",key:"dataSourceName",width:"8%"},{title:"识别列ID",dataIndex:"identityColumn",key:"identityColumn",width:"8%"},{title:"识别列类型",dataIndex:"identityName",key:"identityName",width:"8%"},{title:"来源表",dataIndex:"originTable",key:"originTable",width:"8%"},{title:"来源列",dataIndex:"originColumn",key:"originColumn",width:"8%"},{title:"状态",dataIndex:"status",key:"status",width:100,render:function(e){return Ne[e]}},{title:"发布状态",dataIndex:"publishStatus",key:"publishStatus",width:90,render:function(e){return xe[e]}},{title:"操作",width:110,render:function(e,t){var a=o.a.createElement(dn.a,null,o.a.createElement(dn.a.Item,{key:"1"},o.a.createElement(C.c,{to:"/dl/manage/newApi/"+t.id},"发布")),o.a.createElement(dn.a.Item,{key:"2"},o.a.createElement(cn.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:n.removeTag.bind(n,t.id)},o.a.createElement("a",null,"删除")))),i="tag_"+t.id;return o.a.createElement("div",null,o.a.createElement("a",{onClick:function(){n.editBaseInfo(t)}},"编辑"),o.a.createElement("span",{className:"ant-divider",id:i}),"已发布"==xe[t.publishStatus]?o.a.createElement(cn.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:n.removeTag.bind(n,t.id)},o.a.createElement("a",null,"删除")):o.a.createElement(rn.a,{getPopupContainer:function(){return document.getElementById(i)},overlay:a,trigger:["click"]},o.a.createElement("a",{className:"ant-dropdown-link"},"更多 ",o.a.createElement(ln.a,{type:"down"}))))}}]},n.checkPublish=function(e){gn.checkPublish({tagId:e}).then(function(t){1===t.code&&t.data&&C.g.push("/dl/manage/newApi/"+e)})},n.addTag=function(e){n.openModal(),n.setState({editData:{type:"rule"===n.props.tagType?2:1}})},n.editBaseInfo=function(e){var t=M()({},e,{catalogueId:n.getCatalogueArray(e.catalogueId)});n.openModal(),n.setState({editData:t}),"register"===n.props.tagType&&"未发布"===xe[t.publishStatus]&&(n.props.getDataSourcesTable({sourceId:t.dataSourceId}),n.props.getDataSourcesColumn({sourceId:t.dataSourceId,tableName:t.originTable}))},n.removeTag=function(e){var t=n.state.queryParams;e&&gn.deleteTag({tagId:e}).then(function(e){1===e.code&&(le.a.success("删除成功！"),n.getTagListData(t))})},n.cancel=function(e){n.closeModal(),e.resetFields()},n.openModal=function(){n.setState({visible:!0})},n.closeModal=function(){n.setState({visible:!1})},n.saveTag=function(e){var t=n.state,a=t.queryParams,i=t.editData;e.validateFields(function(t,r){var o=void 0,l=void 0,s=void 0;t||(r.catalogueId=[].concat(an()(r.catalogueId)).pop(),i.id?(o=gn.updateTagBaseInfo,l=M()({},r,{id:i.id}),s="更新成功"):(o="rule"===n.props.tagType?gn.addRuleTag:gn.addRegisterTag,l=r,s="新增成功"),o(l).then(function(t){1===t.code&&(le.a.success(s),n.closeModal(),e.resetFields(),n.getTagListData(a),n.setState({editData:{}}))}))})},n.onFirstCatalogueChange=function(e){var t=M()({},n.state.queryParams,{currentPage:1,pid:e||void 0});e?n.getSecondCatalogue(e):n.setState({catalogue2Data:[]}),n.getTagListData(t),n.setState({queryParams:t})},n.getSecondCatalogue=function(e){var t=n.props.apiMarket.apiCatalogue.filter(function(t){return t.id==e})[0].childCatalogue;t=t.some(function(e){return e.api})?[]:t,n.setState({catalogue2Data:t})},n.onSecondCatalogueChange=function(e){var t=M()({},n.state.queryParams,{currentPage:1,cid:e||void 0});n.getTagListData(t),n.setState({queryParams:t})},n.onTagNameSearch=function(e){var t=M()({},n.state.queryParams,{currentPage:1,name:e||void 0});n.getTagListData(t),n.setState({queryParams:t})},n.getCatalogueArray=function(e){var t=[];return function a(n){for(var i=0;i<n.length;i++){if(n[i].api)return;if(n[i].id===e)return t.push(n[i].id),n[i].id;if(a(n[i].childCatalogue))return t.push(n[i].id),n[i].id}}(n.props.apiMarket.apiCatalogue),t.reverse()},n.onTableChange=function(e,t,a){var i=M()({},n.state.queryParams,{currentPage:e.current});n.getTagListData(i),n.setState({queryParams:i})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getTagListData(this.state.queryParams)}},{key:"render",value:function(){var e=this.props.apiMarket.apiCatalogue,t=this.state,a=t.queryParams,n=t.visible,i=t.loading,r=t.tagList,l=t.editData,s=t.catalogue2Data,c="rule"===this.props.tagType?this.initRuleTagTable:this.initRegisterTagTable,u=o.a.createElement("div",{className:"flex font-12"},o.a.createElement(bn,{placeholder:"标签名称",onSearch:this.onTagNameSearch,style:{width:200,margin:"10px 0"}}),o.a.createElement("div",{className:"m-l-8"},"标签分类：",o.a.createElement(B.a,{allowClear:!0,showSearch:!0,style:{width:150},placeholder:"选择标签分类",optionFilterProp:"title",onChange:this.onFirstCatalogueChange},e.map(function(e){return o.a.createElement(kn,{key:e.id,value:e.id.toString(),title:e.catalogueName},e.catalogueName)}))),o.a.createElement("div",{className:"m-l-8"},"二级分类：",o.a.createElement(B.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择二级分类",onChange:this.onSecondCatalogueChange},s.map(function(e){return o.a.createElement(kn,{key:e.id,value:e.id.toString(),title:e.catalogueName},e.catalogueName)})))),d=o.a.createElement("div",null,o.a.createElement(C.c,{to:"dl/tagConfig/identify"},o.a.createElement(Ae.a,{type:"primary",style:{margin:10}},"识别列配置")),o.a.createElement(Ae.a,{type:"primary",onClick:this.addTag},"新建标签")),p={current:a.currentPage,pageSize:a.pageSize,total:r.totalCount};return o.a.createElement(V.a,{title:u,extra:d,noHovering:!0,bordered:!1},o.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:c(),loading:i,pagination:p,dataSource:r.data,onChange:this.onTableChange}),o.a.createElement(Sn,{visible:n,editData:l,saveTag:this.saveTag,cancel:this.cancel}))}}]),t}(r.Component))||Ga,An=(a("sEhC"),bt.a.TabPane),_n=Object(T.b)()(Cn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={},n.showInfo=function(){Y.a.info({title:"注册标签与新建标签的区别",maskClosable:!0,width:"40%",content:o.a.createElement("div",null,o.a.createElement("p",null,"注册标签：您已有计算好的标签结果，不需要配置标签计算逻辑，注册标签后即可提供标签服务"),o.a.createElement("p",null,"使用流程：点击“注册标签”->配置标签服务的信息->发布"),o.a.createElement("p",{style:{marginTop:10}},"新建标签：您只有原始数据，需要通过加工原始数据来形成标签"),o.a.createElement("p",null,"使用流程：点击“新建标签”->配置标签计算逻辑->配置标签服务信息->发布"))})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Se(0))}},{key:"render",value:function(){return o.a.createElement("div",{className:"box-1 m-card shadow m-tabs"},o.a.createElement(bt.a,{animated:!1,defaultActiveKey:"1",style:{height:"auto"}},o.a.createElement(An,{tab:"规则标签",key:"1"},o.a.createElement(In,{tagType:"rule"})),o.a.createElement(An,{tab:"注册标签",key:"2"},o.a.createElement(In,{tagType:"register"}))),o.a.createElement("div",{className:"diff-tooltip"},o.a.createElement("a",{onClick:this.showInfo},"注册与新建有什么区别？")))}}]),t}(r.Component))||Cn,Dn=(a("pJsf"),a("g4D/")),Nn=a.n(Dn),xn=(a("GBD3"),a("wXtC")),Ln=a.n(xn),wn=a("wd/R"),Pn=a.n(wn),On=a("ER3F"),Rn=B.a.Option,Mn=X.a.Item,jn=Q.a.TextArea,Gn={beginDate:Pn()().format("YYYY-MM-DD"),endDate:Pn()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},Un={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:10}}},Vn=Object(T.b)(function(e){return{common:e.common,dataSource:e.dataSource}},function(e){return{getDataSourcesList:function(t){e(at(t))},getDataSourcesTable:function(t){e(it(t))},resetDataSourcesTable:function(){e(rt())}}})(Tn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={tagId:n.props.routeParams.id,currentData:{},curCondition:{},conditionList:[],computeList:[],scheduleConfObj:Gn,notifyVO:{sendTypes:[],receivers:[]}},n.getTagDetailInfo=function(){gn.getRuleTagDetail({tagId:n.state.tagId}).then(function(e){1===e.code&&(n.setState({currentData:e.data,conditionList:e.data.conditions}),e.data.scheduleConf&&n.setState({scheduleConfObj:JSON.parse(e.data.scheduleConf)}),e.data.notifyVO&&n.setState({notifyVO:e.data.notifyVO}))})},n.getComputeSourceData=function(){gn.getComputeSource().then(function(e){1===e.code&&n.setState({computeList:e.data})})},n.initColumns=function(){return[{title:"数据源",dataIndex:"dataSourceId",key:"dataSourceId",width:"25%",render:function(e,t){return n.renderColumns(e,t,"dataSourceId")}},{title:"表名",dataIndex:"tableName",key:"tableName",width:"25%",render:function(e,t){return n.renderColumns(e,t,"tableName")}},{title:"过滤条件",dataIndex:"sqlCondition",key:"sqlCondition",width:"40%",render:function(e,t){return n.renderColumns(e,t,"sqlCondition")}},{title:"操作",width:"10%",render:function(e,t){return o.a.createElement("div",null,t.editable?o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:n.saveCondition.bind(n,t.id)},"保存"),o.a.createElement("a",{onClick:n.cancelEdit.bind(n,t.id)},"取消")):o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:n.editCondition.bind(n,t.id)},"编辑"),o.a.createElement(cn.a,{title:"确定要删除吗？",onConfirm:n.deleteCondition.bind(n,t.id)},o.a.createElement("a",null,"删除"))))}}]},n.renderEditTD=function(e,t,a){var i=n.props,r=i.form,l=i.dataSource,s=r.getFieldDecorator,c=l.sourceList,u=l.sourceTable;switch(a){case"dataSourceId":return o.a.createElement(Mn,M()({},Ue,{className:"edit-td"}),s("dataSourceId",{rules:[{required:!0,message:"数据源不可为空"}],initialValue:t.dataSourceId.toString()})(o.a.createElement(B.a,{showSearch:!0,optionFilterProp:"title",onChange:n.onDataSourceChange},c.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(Rn,{key:e.id,value:e.id.toString(),title:t},t)}))));case"tableName":return o.a.createElement(Mn,M()({},Ue,{className:"edit-td"}),s("tableName",{rules:[{required:!0,message:"数据表不可为空"}],initialValue:t.tableName})(o.a.createElement(B.a,{showSearch:!0},u.map(function(e){return o.a.createElement(Rn,{key:e,value:e},e)}))));case"sqlCondition":return o.a.createElement(Mn,M()({},Ue,{className:"edit-td"}),s("sqlCondition",{rules:[],initialValue:t.sqlCondition})(o.a.createElement(Q.a,{placeholder:"sql过滤条件"})))}},n.renderTD=function(e,t,a){switch(a){case"dataSourceId":return t.dataSourceName+"（"+t.sourceTypeValue+"）";default:return e}},n.onDataSourceChange=function(e){var t=n.props.form;n.props.resetDataSourcesTable(),n.props.getDataSourcesTable({sourceId:e}),t.setFieldsValue({tableName:void 0})},n.addNewCondition=function(){var e=n.props.form,t=n.state,a=t.tagId,i=t.conditionList,r=t.curCondition,o=[].concat(an()(i));Object(Xt.isEmpty)(r)||("edit"===r.editStatus?(delete r.editable,delete r.editStatus):(o.shift(),e.resetFields()));var l={id:o[0]?o[0].id+1:1,editStatus:"new",editable:!0,tagId:a,dataSourceId:"",tableName:"",sqlCondition:""};o.unshift(l),n.setState({curCondition:l,conditionList:o})},n.onPeriodTypeChange=function(e){var t=M()({},Gn,{periodType:e});n.setState({scheduleConfObj:t})},n.onSendTypesChange=function(e){var t=n.props.form,a=n.state.notifyVO,i=t.getFieldValue("receivers");0===e.length&&0===i.length&&t.setFieldsValue({receivers:[]}),n.setState({notifyVO:M()({},a,{sendTypes:e})})},n.onReceiversChange=function(e){var t=n.props.form,a=n.state.notifyVO,i=t.getFieldValue("sendTypes");0===e.length&&0===i.length&&t.setFieldsValue({sendTypes:[]}),n.setState({notifyVO:M()({},a,{receivers:e})})},n.changeScheduleConfTime=function(e,t){var a=n.state.scheduleConfObj,i={};i[e]=t,n.setState({scheduleConfObj:M()({},a,i)})},n.onBeginDateChange=function(e,t){n.changeScheduleConfTime("beginDate",t)},n.onEndDateChange=function(e,t){n.changeScheduleConfTime("endDate",t)},n.checkTime=function(e,t,a){var i=n.props.form,r=i.getFieldValue("beginHour"),o=i.getFieldValue("beginMin"),l=i.getFieldValue("endHour"),s=i.getFieldValue("endMin");60*parseInt(r)+parseInt(o)>=60*parseInt(l)+parseInt(s)?a("开始时间不能晚于结束时间"):i.setFieldsValue({beginHour:r,beginMin:o,endHour:l,endMin:s}),a()},n.checkDate=function(e,t,a){var i=n.props.form,r=i.getFieldValue("beginDate"),o=i.getFieldValue("endDate");r&&o?r.valueOf()>o.valueOf()?a("生效日期的开始时间不能晚于结束时间"):i.setFieldsValue({beginDate:r,endDate:o}):a(),a()},n.saveRuleTag=function(){var e=n.props.form,t=n.state,a=t.tagId,i=t.curCondition,r=t.conditionList,o=t.scheduleConfObj,l=t.notifyVO;Object(Xt.isEmpty)(i)?r.length<1?le.a.error("请添加基本信息"):e.validateFields(function(e,t){e&&e.endDate&&le.a.error(e.endDate.errors[0].message),e||(r.forEach(function(e,t){"new"===e.editStatus&&delete e.id}),gn.updateTagSqlInfo({id:a,conditions:r,notifyVO:l,scheduleConf:$()(o),sqlText:t.sqlText,computeSourceId:t.computeSourceId}).then(function(e){1===e.code&&(le.a.success("保存成功"),C.g.push("/dl/tagConfig"))}))}):le.a.error("基本信息未保存")},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getTagDetailInfo(),this.getComputeSourceData(),this.props.getDataSourcesList()}},{key:"renderColumns",value:function(e,t,a){return{children:o.a.createElement(X.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}}}},{key:"editCondition",value:function(e){var t=this.state,a=t.curCondition,n=t.conditionList,i=[].concat(an()(n)),r=i.filter(function(t){return e===t.id})[0];Object(Xt.isEmpty)(a)||("edit"===a.editStatus?(delete a.editable,delete a.editStatus):i.shift()),r&&(r.editable=!0,r.editStatus="edit",this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:r.dataSourceId}),this.setState({curCondition:r,conditionList:i}))}},{key:"cancelEdit",value:function(e){var t=this.state.conditionList,a=[].concat(an()(t)),n=a.filter(function(t){return e===t.id})[0];"edit"===n.editStatus?(delete n.editable,delete n.editStatus):a.splice(a.indexOf(n),1),this.setState({curCondition:{},conditionList:a})}},{key:"deleteCondition",value:function(e){var t=[].concat(an()(this.state.conditionList)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);a&&(t.splice(n,1),this.setState({conditionList:t}))}},{key:"saveCondition",value:function(e){var t=this,a=this.props,n=a.form,i=a.dataSource.sourceList,r=this.state,o=(r.tagId,r.curCondition),l=r.conditionList,s=[].concat(an()(l)),c=s.filter(function(t){return e===t.id})[0],u=s.indexOf(c);n.validateFields(["dataSourceId","tableName","sqlCondition"],function(e,a){if(!e){delete o.editable;var n=[].concat(an()(i)).filter(function(e){return e.id==a.dataSourceId})[0];s[u]=M()({},o,a,{dataSourceName:n.dataName,sourceTypeValue:n.sourceTypeValue}),t.setState({curCondition:{},conditionList:s})}})}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common,i=a.getFieldDecorator,r=(n.periodType,n.notifyType,this.state.scheduleConfObj),l=function(t){for(var a=[],n=0;n<=23;n++)a.push(o.a.createElement(Rn,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(B.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)},s=function(t){for(var a=[],n=0;n<=59;n++)a.push(o.a.createElement(Rn,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(B.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(r.periodType){case"1":return o.a.createElement("div",null,o.a.createElement(Mn,M()({},Un,{label:"开始时间"}),i("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.beginHour})(l("beginHour")),o.a.createElement("span",{className:"m-8"},"时"),i("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.beginMin})(s("beginMin")),o.a.createElement("span",{className:"m-8"},"分")),o.a.createElement(Mn,M()({},Un,{label:"间隔时间"}),i("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:r.gapHour?r.gapHour:void 0})(function(){for(var t=[],a=1;a<=23;a++)t.push(o.a.createElement(Rn,{key:a,value:""+a},a,"小时"));return o.a.createElement(B.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),o.a.createElement(Mn,M()({},Un,{label:"结束时间"}),i("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.endHour})(l("endHour")),o.a.createElement("span",{className:"m-8"},"时"),i("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.endMin})(s("endMin")),o.a.createElement("span",{className:"m-8"},"分")));case"2":return o.a.createElement(Mn,M()({},Un,{label:"起调周期"}),i("hour",{rules:[{required:!0}],initialValue:""+r.hour})(l("hour")),o.a.createElement("span",{className:"m-8"},"时"),i("min",{rules:[{required:!0}],initialValue:""+r.min})(s("min")),o.a.createElement("span",{className:"m-8"},"分"));case"3":return o.a.createElement("div",null,o.a.createElement(Mn,M()({},Un,{label:"选择时间"}),i("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:r.weekDay?r.weekDay:[]})(o.a.createElement(B.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},o.a.createElement(Rn,{key:1,value:"1"},"星期一"),o.a.createElement(Rn,{key:2,value:"2"},"星期二"),o.a.createElement(Rn,{key:3,value:"3"},"星期三"),o.a.createElement(Rn,{key:4,value:"4"},"星期四"),o.a.createElement(Rn,{key:5,value:"5"},"星期五"),o.a.createElement(Rn,{key:6,value:"6"},"星期六"),o.a.createElement(Rn,{key:7,value:"7"},"星期天")))),o.a.createElement(Mn,M()({},Un,{label:"起调周期"}),i("hour1",{rules:[{required:!0}],initialValue:""+r.hour})(l("hour")),o.a.createElement("span",{className:"m-8"},"时"),i("min1",{rules:[{required:!0}],initialValue:""+r.min})(s("min")),o.a.createElement("span",{className:"m-8"},"分")));case"4":return o.a.createElement("div",null,o.a.createElement(Mn,M()({},Un,{label:"选择时间"}),i("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:r.day?r.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(o.a.createElement(Rn,{key:a,value:""+a},"每月"+a+"号"));return o.a.createElement(B.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),o.a.createElement(Mn,M()({},Un,{label:"起调周期"}),i("hour2",{rules:[{required:!0}],initialValue:""+r.hour})(l("hour")),o.a.createElement("span",{className:"m-8"},"时"),i("min2",{rules:[{required:!0}],initialValue:""+r.min})(s("min")),o.a.createElement("span",{className:"m-8"},"分")))}}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=t.getFieldDecorator,i=a.periodType,r=a.notifyType,l=a.userList,s=this.state,c=s.currentData,u=s.conditionList,d=s.computeList,p=s.scheduleConfObj,m=s.notifyVO,h=m.sendTypes,g=m.receivers,f=o.a.createElement("div",null,o.a.createElement(On.a,null)," 配置计算逻辑");return o.a.createElement("div",{className:"box-1 m-card shadow"},o.a.createElement(V.a,{title:f,extra:!1,noHovering:!0,bordered:!1},o.a.createElement("div",{className:"tag-edit-step"},o.a.createElement("h2",null,o.a.createElement("div",{className:"rank-number m-r-8"},"1"),"基本信息",o.a.createElement(Ae.a,{type:"primary",className:"right",onClick:this.addNewCondition},"添加")),o.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),pagination:!1,dataSource:u})),o.a.createElement("div",{className:"tag-edit-step"},o.a.createElement("h2",null,o.a.createElement("div",{className:"rank-number m-r-8"},"2"),"同步目标计算引擎"),o.a.createElement(Mn,null,n("computeSourceId",{rules:[{required:!0,message:"不可为空"}],initialValue:c.computeSourceId?c.computeSourceId.toString():void 0})(o.a.createElement(B.a,{style:{width:300},placeholder:"选择要同步的计算引擎"},d.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(Rn,{key:e.id,value:e.id.toString(),title:t},t)}))))),o.a.createElement("div",{className:"tag-edit-step"},o.a.createElement("h2",null,o.a.createElement("div",{className:"rank-number m-r-8"},"3"),"根据以上数据源输入指标计算SQL"),o.a.createElement(Mn,null,n("sqlText",{rules:[{required:!0,message:"SQL不可为空"}],initialValue:c.sqlText})(o.a.createElement(jn,{placeholder:"在此输入指标计算sql",autosize:{minRows:6}})))),o.a.createElement("div",{className:"tag-edit-step"},o.a.createElement("h2",null,o.a.createElement("div",{className:"rank-number m-r-8"},"4"),"调度时间设置"),o.a.createElement(Mn,M()({},Un,{label:"调度周期"}),n("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+p.periodType})(o.a.createElement(B.a,{style:{width:328},onChange:this.onPeriodTypeChange},i.map(function(e){return o.a.createElement(Rn,{key:e.value,value:e.value.toString()},e.name)})))),5!=p.periodType&&o.a.createElement(Mn,M()({},Un,{label:"生效日期"}),n("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:Pn()(p.beginDate)})(o.a.createElement(Ln.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),o.a.createElement("span",{className:"m-8"},"到"),n("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:Pn()(p.endDate)})(o.a.createElement(Ln.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),o.a.createElement(Mn,M()({},Un,{label:"通知方式"}),n("sendTypes",{rules:[{required:g.length,message:"选择通知方式"}],initialValue:h.map(function(e){return e.toString()})})(o.a.createElement(Nn.a.Group,{onChange:this.onSendTypesChange},r.map(function(e){return o.a.createElement(Nn.a,{key:e.value,value:e.value.toString()},e.name)})))),o.a.createElement(Mn,M()({},Un,{label:"通知接收人"}),n("receivers",{rules:[{required:h.length,message:"选择通知接收人"}],initialValue:g.map(function(e){return e.toString()})})(o.a.createElement(B.a,{allowClear:!0,mode:"multiple",style:{width:328},onChange:this.onReceiversChange},l.map(function(e){return o.a.createElement(Rn,{key:e.id,value:e.id.toString()},e.userName)}))))),o.a.createElement("div",{className:"tag-edit-step txt-right"},o.a.createElement(C.c,{to:"/dl/tagConfig"},o.a.createElement(Ae.a,{type:"primary",className:"m-r-8"},"取消")),o.a.createElement(Ae.a,{type:"primary",onClick:this.saveRuleTag},"保存"))))}}]),t}(r.Component))||Tn;Vn=X.a.create()(Vn);var Fn=X.a.Item,qn=Q.a.TextArea,zn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={visible:!1,loading:!1,queryParams:{currentPage:1,pageSize:20},columnData:{},currentData:{}},n.getColumnData=function(e){n.setState({loading:!0}),gn.queryIdentifyColumn(e).then(function(e){1===e.code&&n.setState({columnData:e.data,loading:!1})})},n.initColumns=function(){return[{title:"识别列类型",dataIndex:"name",key:"name",width:"45%"},{title:"描述",dataIndex:"identityDesc",key:"identityDesc",width:"45%"},{title:"操作",width:"10%",render:function(e,t){return o.a.createElement("div",null,o.a.createElement("a",{onClick:n.editColumn.bind(n,t)},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement(cn.a,{title:"确定删除此识别列？",okText:"确定",cancelText:"取消",onConfirm:n.deleteColumn.bind(n,t.id)},o.a.createElement("a",null,"删除")))}}]},n.addColumn=function(){n.openModal(),n.setState({currentData:{}})},n.saveColumn=function(){var e=n.props.form,t=n.state,a=t.queryParams,i=t.currentData;e.validateFields(function(t,r){var o=void 0,l=void 0,s=void 0;t||(i.id?(o=gn.updateIdentifyColumn,l=M()({},r,{id:i.id}),s="更新成功"):(o=gn.addIdentifyColumn,l=r,s="新增成功"),o(l).then(function(t){1===t.code&&(le.a.success(s),n.getColumnData(a),n.closeModal(),n.setState({currentData:{}}),e.resetFields())}))})},n.editColumn=function(e){n.openModal(),n.setState({currentData:e})},n.deleteColumn=function(e){var t=n.state.queryParams;e&&gn.deleteIdentifyColumn({identifyId:e}).then(function(e){1===e.code&&(le.a.success("删除成功！"),n.getColumnData(t))})},n.cancel=function(){n.closeModal(),n.props.form.resetFields()},n.openModal=function(){n.setState({visible:!0})},n.closeModal=function(){n.setState({visible:!1})},n.onTableChange=function(e,t,a){var i=M()({},n.state.queryParams,{currentPage:e.current});n.getColumnData(i),n.setState({queryParams:i})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getColumnData(this.state.queryParams)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.visible,n=t.queryParams,i=t.loading,r=t.columnData,l=t.currentData,s=o.a.createElement("div",null,o.a.createElement(On.a,null)," 识别列类型配置"),c=o.a.createElement(Ae.a,{type:"primary",style:{margin:10},onClick:this.addColumn},"新建识别列"),u={current:n.currentPage,pageSize:n.pageSize,total:r.totalCount};return o.a.createElement("div",{className:"box-1 m-card shadow"},o.a.createElement(V.a,{title:s,extra:c,noHovering:!0,bordered:!1},o.a.createElement(q.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),loading:i,pagination:u,dataSource:r.data,onChange:this.onTableChange}),o.a.createElement(Y.a,{title:l.id?"编辑识别列":"新建识别列",width:"50%",visible:a,maskClosable:!1,okText:"确定",cancelText:"取消",onOk:this.saveColumn,onCancel:this.cancel},o.a.createElement(X.a,null,o.a.createElement(Fn,M()({},Me,{label:"类型名称"}),e("name",{rules:[{required:!0,message:"类型名称不可为空"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:l.name})(o.a.createElement(Q.a,{placeholder:"请输入类型名称"}))),o.a.createElement(Fn,M()({},Me,{label:"描述"}),e("identityDesc",{rules:[{max:200,message:"描述字符不能超过200"}],initialValue:l.identityDesc})(o.a.createElement(qn,{placeholder:"类型描述",autosize:{minRows:3,maxRows:6}})))))))}}]),t}(r.Component);zn=X.a.create()(zn);a("93XW");var Yn,Hn,Bn=a("d1El"),Kn=a.n(Bn),Qn=B.a.Option,Jn=Ln.a.RangePicker,Xn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={loading:!1,queryParams:{tagId:n.props.routeParams.id,currentPage:1,pageSize:20},logList:{}},n.getTagLogData=function(e){n.setState({loading:!0}),gn.queryTagLogInfo(e).then(function(e){1===e.code&&n.setState({loading:!1,logList:e.data})})},n.initColumns=function(){return[{title:"标签名称",dataIndex:"tagName",key:"tagName",width:"15%"},{title:"更新时间",dataIndex:"gmtModifiedFormat",key:"gmtModifiedFormat",width:"15%"},{title:"状态",dataIndex:"status",key:"status",width:"15%",render:function(e){return Ne[e]}},{title:"日志内容",dataIndex:"log",key:"log",width:"45%",render:function(e){return o.a.createElement(Kn.a,{overlayClassName:"m-tooltip",placement:"bottom",title:e,arrowPointAtCenter:!0},o.a.createElement("div",{className:"ellipsis-td"},e))}},{title:"操作",key:"operation",render:function(e,t){return o.a.createElement("a",{onClick:n.showInfo.bind(n,t)},"查看详情")}}]},n.showInfo=function(e){Y.a.info({title:e.tagName+" 日志内容",maskClosable:!0,width:"40%",content:o.a.createElement("div",{style:{maxHeight:400,overflowY:"auto",whiteSpace:"pre-line"}},e.log)})},n.onUpdateTimeChange=function(e,t){var a=M()({},n.state.queryParams,{currentPage:1,startTime:e[0]?e[0].startOf("day").valueOf():void 0,endTime:e[1]?e[1].startOf("day").valueOf():void 0});n.getTagLogData(a),n.setState({queryParams:a})},n.disabledDate=function(e){return e&&e.valueOf()>Date.now()},n.onStatueChange=function(e){var t=M()({},n.state.queryParams,{currentPage:1,tagStatus:e||void 0});n.getTagLogData(t),n.setState({queryParams:t})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getTagLogData(this.state.queryParams)}},{key:"render",value:function(){var e=this.state,t=e.queryParams,a=e.loading,n=e.logList,i=o.a.createElement("div",{className:"flex font-12"},o.a.createElement("div",{className:"flex",style:{alignItems:"center"}},"更新时间：",o.a.createElement(Jn,{format:"YYYY-MM-DD",style:{width:250},placeholder:["更新开始时间","更新结束时间"],disabledDate:this.disabledDate,onChange:this.onUpdateTimeChange})),o.a.createElement("div",{className:"m-l-8"},"状态：",o.a.createElement(B.a,{allowClear:!0,style:{width:150},placeholder:"选择状态",onChange:this.onStatueChange},o.a.createElement(Qn,{key:"3"},"更新完成"),o.a.createElement(Qn,{key:"4"},"更新失败")))),r={current:t.currentPage,pageSize:t.pageSize,total:n.totalCount};return o.a.createElement("div",null,o.a.createElement("h1",{className:"box-title"},o.a.createElement(On.a,null)," 标签日志更新历史"),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(V.a,{title:i,extra:!1,noHovering:!0,bordered:!1},o.a.createElement(q.a,{rowKey:"id",className:"m-table fixed-table",columns:this.initColumns(),loading:a,pagination:r,dataSource:n.data,onChange:this.onTableChange}))))}}]),t}(r.Component),Wn=(a("PzEo"),a("+vAN")),Zn=a.n(Wn),$n=(a("b+Mx"),a("5Dct")),ei=a.n($n),ti=a("iEKX"),ai=X.a.Item,ni=B.a.Option,ii=Q.a.TextArea,ri=Object(T.b)(function(e){return{dataSource:e.dataSource,tagConfig:e.tagConfig,apiMarket:e.apiMarket}},function(e){return{getDataSourcesList:function(t){e(at(t))},getDataSourcesPreview:function(t){e(st(t))},getCatalogue:function(t){e(Se(t))},getAllIdentifyColumn:function(t){e(fn(t))}}})(Yn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={showPreview:!1},n.initCatagoryOption=function(e){return e.some(function(e){return!0===e.api})?[]:e.map(function(e){return{value:e.id,label:e.catalogueName,children:n.initCatagoryOption(e.childCatalogue)}})},n.getCatalogueArray=function(e){var t=n.props.apiMarket.apiCatalogue,a=[];if(!e)return[];return function t(n){for(var i=0;i<n.length;i++){if(n[i].api)return;if(n[i].id===e)return a.push(n[i].id),n[i].id;if(t(n[i].childCatalogue))return a.push(n[i].id),n[i].id}}(t),a.reverse()},n.onSourcePreview=function(){var e=n.props,t=(e.form,e.basicInfo),a=n.state.showPreview,i=t.dataSourceId,r=t.originTable;i&&r?(a||n.props.getDataSourcesPreview({dataSourceId:i,tableName:r}),n.setState({showPreview:!a})):le.a.error("未选择数据源或数据表")},n.previewTableColumns=function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:80,render:function(e){return o.a.createElement(ti.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})},n.getScroll=function(e){var t=n.props.dataSource.sourcePreview;return t.columnList?e*t.columnList.length:0},n.next=function(){var e=n.props,t=e.currentStep,a=e.navToStep;e.form.validateFields({force:!0},function(e,i){e||(i.catalogueId=[].concat(an()(i.catalogueId)).pop(),n.props.changeBasicInfo(i),a(t+1))})},n.cancel=function(){var e=n.props,t=e.url,a=e.history;t?a?C.f.push(t):C.g.push(t):C.f.go(-1)},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.props.getDataSourcesList(),this.props.getAllIdentifyColumn()}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.tagType,n=e.tagConfig,i=e.apiMarket,r=e.dataSource,l=e.basicInfo,s=e.editStatus,c=t.getFieldDecorator,u=i.apiCatalogue,d=n.identifyColumn,p=r.sourceList,m=(r.sourceTable,r.sourceColumn,r.sourcePreview),h=this.state.showPreview;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(X.a,null,o.a.createElement(ai,M()({},Ge,{label:"所属分组"}),c("catalogueId",{rules:[{required:!0,message:"请选择分组"}],initialValue:this.getCatalogueArray(l.catalogueId)})(o.a.createElement(mn.a,{showSearch:!0,popupClassName:"noheight",options:this.initCatagoryOption(u),placeholder:"请选择分组"}))),o.a.createElement(ai,M()({},Ge,{label:"标签名称"}),c("name",{rules:[{required:!0,message:"请输入标签名称"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:l.name})(o.a.createElement(Q.a,{disabled:"edit"===s}))),o.a.createElement(ai,M()({},Ge,{label:"标签描述"}),c("tagDesc",{rules:[{max:200,message:"标签描述字符不能超过200"}],initialValue:l.tagDesc})(o.a.createElement(ii,{placeholder:"标签描述",autosize:{minRows:2,maxRows:6}}))),o.a.createElement(ai,M()({},Ge,{label:"值域"}),c("tagRange",{rules:[{required:!0,message:"值域不可为空"}],initialValue:l.tagRange})(o.a.createElement(ii,{placeholder:"值域",autosize:{minRows:2,maxRows:6}}))),o.a.createElement(ai,M()({},Ge,{label:"调用限制"}),c("reqLimit",{rules:[{required:!0,message:"请输入调用次数限制"},{validator:function(e,t,a){t&&(t>1e3||t<1)?a("请输入不大于1000的正整数"):a()}}],initialValue:l.reqLimit})(o.a.createElement(ei.a,{min:1,step:1,max:1e3,precision:0,style:{width:"100%"},placeholder:"单用户每秒最高调用次数"}))),o.a.createElement(ai,M()({},Ge,{label:"返回条数限制"}),c("respLimit",{rules:[{required:!0,message:"请输入最大返回条数"}],initialValue:l.respLimit})(o.a.createElement(ei.a,{min:1,step:1,max:2e3,precision:0,style:{width:"100%"},placeholder:"单次最大返回数据条数 (最高支持2000条)"}))),o.a.createElement(ai,M()({},Ge,{label:"目标数据库"}),c("dataSourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:l.dataSourceId?l.dataSourceId.toString():void 0})(o.a.createElement(B.a,{showSearch:!0,disabled:!0,placeholder:"请选择数据源"},p.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(ni,{key:e.id,value:e.id.toString(),title:t},t)})))),"注册标签"==De[a]&&o.a.createElement(ai,M()({},Ge,{label:"来源表"}),c("originTable",{rules:[{required:!0,message:"不可为空"}],initialValue:l.originTable})(o.a.createElement(Q.a,{disabled:!0}))),"注册标签"==De[a]&&o.a.createElement(ai,M()({},Ge,{label:"来源列"}),c("originColumn",{rules:[{required:!0,message:"不可为空"}],initialValue:l.originColumn})(o.a.createElement(Q.a,{disabled:!0}))),o.a.createElement(ai,M()({},Ge,{label:"识别列ID"}),c("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"}],initialValue:l.identityColumn})(o.a.createElement(Q.a,{disabled:!0}))),o.a.createElement(ai,M()({},Ge,{label:"识别列类型"}),c("identityId",{rules:[{required:!0,message:"识别列类型不可为空"}],initialValue:l.identityId?l.identityId.toString():void 0})(o.a.createElement(B.a,{showSearch:!0,disabled:!0,optionFilterProp:"title",placeholder:"选择识别列类型"},d.map(function(e){return o.a.createElement(ni,{key:e.id,value:e.id.toString(),title:e.name},e.name)})))),o.a.createElement("div",{className:"txt-center font-14"},o.a.createElement("a",{onClick:this.onSourcePreview.bind(this)},"数据预览",o.a.createElement(ln.a,{type:h?"up":"down",style:{marginLeft:5}}))),h&&o.a.createElement(V.a,{className:"box-2",style:{marginTop:"10px"},noHovering:!0},o.a.createElement(q.a,{rowKey:function(e,t){return t},className:"m-table m-cells",columns:this.previewTableColumns(m.columnList),dataSource:m.dataList,pagination:!1,scroll:{x:this.getScroll(80),y:400}})))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Ae.a,{className:"m-r-8",onClick:this.cancel},"取消"),o.a.createElement(Ae.a,{type:"primary",onClick:this.next},"下一步")))}}]),t}(r.Component))||Yn;ri=X.a.create()(ri);var oi,li,si=Q.a.TextArea,ci=B.a.Option,ui=Object(T.b)(function(e){return{dataSource:e.dataSource}})(Hn=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={loading:!1,tableColumns:[],dataSource:[]},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){e.addInputsignal&&!this.props.addInputsignal&&this.addInput(),e.initValue!=this.props.initValue&&this.initDataSource(e.initValue)}},{key:"initDataSource",value:function(e){this.backMsg(e),this.setState({dataSource:e})}},{key:"backMsg",value:function(e,t){var a=[];for(var n in e){var i=e[n];i.tmp?a.push(i.tmp):i.isEdit||a.push(i)}this.props.inputParamsChange(a,t)}},{key:"addInput",value:function(){var e=this,t=Object(Xt.cloneDeep)(this.state.dataSource);t.unshift({key:Math.random(),fieldName:"",paramType:"",paramName:"",operator:"",required:!0,desc:"",isEdit:!0}),this.setState({dataSource:t},function(){e.props.changeAddinputOverSignal()})}},{key:"getTableColumns",value:function(){var e=this;this.props.tablecolumn(this.props.dataSourceId,this.props.tableId).then(function(t){t&&e.setState({tableColumns:t.data})})}},{key:"getColumnsView",value:function(){return this.props.dataSource.sourceColumn.map(function(e){return o.a.createElement(ci,{title:e.key,key:e.key,value:e.type+"@@"+e.key},e.key)})}},{key:"changeTableParam",value:function(e,t){if(t=t.split("@@")){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].paramType=t[0],a[e].fieldName=t[1],this.setState({dataSource:a})}}},{key:"setRequired",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].required=t.target.checked,this.setState({dataSource:a})}},{key:"textAreaChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].desc=a,this.setState({dataSource:n})}},{key:"paramNameChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].paramName=a,this.setState({dataSource:n})}},{key:"operatorsChange",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].operator=t,this.setState({dataSource:a})}},{key:"checkInfo",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource),n=a[e];if(t&&(n=n.tmp),!n.fieldName)return le.a.error("请选择字段"),!1;if(!n.paramName)return le.a.error("请填写参数名"),!1;if(!n.operator)return le.a.error("请选择操作符"),!1;if(!this.checkVal(n))return!1;for(var i in a)if(i!=e&&a[i].fieldName==n.fieldName&&a[i].operator==n.operator)return t?le.a.error("原数据与现有数据重复，请修改保存"):le.a.error("不能设置相同字段的相同规则"),!1;return!0}},{key:"checkVal",value:function(e){return e.desc&&e.desc.length>200?(le.a.error("说明不得大于200字符"),!1):!(e.paramName&&e.paramName.length>16)||(le.a.error("参数名不得大于16字符"),!1)}},{key:"saveInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(this.checkInfo(e)){t[e].isEdit=!1;var a=!t[e].tmp;t[e].tmp&&(t[e].tmp=null),a?this.backMsg(t,t[e]):this.backMsg(t),this.setState({dataSource:t})}}},{key:"cancelSave",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(t[e].tmp){if(!this.checkInfo(e,!0))return;t[e]=Object(Xt.cloneDeep)(t[e].tmp),t[e].isEdit=!1}else t.splice(e,1);this.setState({dataSource:t})}},{key:"editInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t[e].tmp=Object(Xt.cloneDeep)(t[e]),t[e].isEdit=!0,this.setState({dataSource:t})}},{key:"removeInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t.splice(e,1),this.backMsg(t),this.setState({dataSource:t})}},{key:"initColumns",value:function(){var e=this;return[{title:"字段",dataIndex:"fieldName",key:"fieldName",width:"200px",render:function(t,a,n){return a.isEdit?o.a.createElement(B.a,{showSearch:!0,defaultValue:a.paramType?a.paramType+"@@"+a.fieldName:null,onChange:e.changeTableParam.bind(e,n),style:{width:"100%"}},e.getColumnsView()):a.fieldName}},{title:"参数名",dataIndex:"paramName",key:"paramName",width:"100px",render:function(t,a,n){return a.isEdit?o.a.createElement(Q.a,{onBlur:e.paramNameChange.bind(e,n),defaultValue:a.paramName}):a.paramName}},{title:"数据类型",dataIndex:"paramType",key:"paramType",render:function(e,t){return t.paramType||""}},{title:"操作符",dataIndex:"operator",key:"operator",width:"100px",render:function(t,a,n){return a.isEdit?o.a.createElement(B.a,{style:{width:"100%"},defaultValue:a.operator,onChange:e.operatorsChange.bind(e,n)},o.a.createElement(ci,{value:"="},"="),o.a.createElement(ci,{value:">"},">"),o.a.createElement(ci,{value:">="},">="),o.a.createElement(ci,{value:"<"}," <"),o.a.createElement(ci,{value:"<="},"<="),o.a.createElement(ci,{value:"!="},"!="),o.a.createElement(ci,{value:"in"},"in"),o.a.createElement(ci,{value:"not in"},"not in"),o.a.createElement(ci,{value:"like"},"like"),o.a.createElement(ci,{value:"not like"},"not like")):a.operator}},{title:"是否必填",dataIndex:"required",key:"required",render:function(t,a,n){return a.isEdit?o.a.createElement(Nn.a,{onClick:e.setRequired.bind(e,n),defaultChecked:a.required}):o.a.createElement(Nn.a,{defaultChecked:a.required,disabled:!0})}},{title:"说明",dataIndex:"desc",key:"desc",render:function(t,a,n){return a.isEdit?o.a.createElement(si,{onBlur:e.textAreaChange.bind(e,n),defaultValue:a.desc}):o.a.createElement(si,{key:"textareadisabled",defaultValue:a.desc,disabled:!0})}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a,n){return a.isEdit?o.a.createElement("div",null,o.a.createElement("a",{onClick:e.saveInfo.bind(e,n)},"保存"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.cancelSave.bind(e,n)},"取消")):o.a.createElement("div",null,o.a.createElement("a",{onClick:e.editInfo.bind(e,n)},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.removeInfo.bind(e,n)},"删除"))}}]}},{key:"render",value:function(){return o.a.createElement(q.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:!1,dataSource:this.state.dataSource})}}]),t}(r.Component))||Hn,di=Q.a.TextArea,pi=B.a.Option,mi=Object(T.b)(function(e){return{dataSource:e.dataSource}},function(e){return{}})(oi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={loading:!1,tableColumns:[],dataSource:[]},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){e.addOutputsignal&&!this.props.addOutputsignal&&this.addOutput(e.inputToOutputData),e.initValue!=this.props.initValue&&this.initDataSource(e.initValue)}},{key:"initDataSource",value:function(e){var t=e;e||(t=[]),e&&e.some(function(e){return!e.fieldName})&&(t=[]),this.backMsg(t),this.setState({dataSource:t})}},{key:"backMsg",value:function(e){var t=[];for(var a in e){var n=e[a];n.tmp?t.push(n.tmp):n.isEdit||t.push(n)}this.props.outputParamsChange(t)}},{key:"addOutput",value:function(e){var t=this,a=Object(Xt.cloneDeep)(this.state.dataSource),n={key:Math.random(),fieldName:"",paramType:"",paramName:"",operator:"",required:!0,desc:"",isEdit:!0};e&&(n.fieldName=e.fieldName,n.paramType=e.paramType,n.paramName=e.paramName,n.operator=e.operator,n.required=e.required,n.desc=e.desc),a.unshift(n),this.setState({dataSource:a},function(){t.props.changeAddoutputOverSignal()})}},{key:"getTableColumns",value:function(){var e=this;this.props.tablecolumn(this.props.dataSourceId,this.props.tableId).then(function(t){t&&e.setState({tableColumns:t.data})})}},{key:"getColumnsView",value:function(){return this.props.dataSource.sourceColumn.map(function(e){return o.a.createElement(pi,{title:e.key,key:e.key,value:e.type+"@@"+e.key},e.key)})}},{key:"changeTableParam",value:function(e,t){if(t=t.split("@@")){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].paramType=t[0],a[e].fieldName=t[1],this.setState({dataSource:a})}}},{key:"setRequired",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].required=t.target.checked,this.setState({dataSource:a})}},{key:"textAreaChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].desc=a,this.setState({dataSource:n})}},{key:"paramNameChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].paramName=a,this.setState({dataSource:n})}},{key:"operatorsChange",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].operator=t,this.setState({dataSource:a})}},{key:"checkInfo",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource),n=a[e];if(t&&(n=n.tmp),!n.fieldName)return le.a.error("请选择字段"),!1;if(!n.paramName)return le.a.error("请填写参数名"),!1;if(!this.checkVal(n))return!1;for(var i in a)if(i!=e&&a[i].fieldName==n.fieldName)return t?le.a.error("原数据与现有数据重复，请修改保存"):le.a.error("不能设置相同字段"),!1;return!0}},{key:"checkVal",value:function(e){return e.desc&&e.desc.length>200?(le.a.error("说明不得大于200字符"),!1):!(e.paramName&&e.paramName.length>16)||(le.a.error("参数名不得大于16字符"),!1)}},{key:"saveInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);this.checkInfo(e)&&(t[e].isEdit=!1,t[e].tmp&&(t[e].tmp=null),this.backMsg(t),this.setState({dataSource:t}))}},{key:"cancelSave",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(t[e].tmp){if(!this.checkInfo(e,!0))return;t[e]=Object(Xt.cloneDeep)(t[e].tmp),t[e].isEdit=!1}else t.splice(e,1);this.setState({dataSource:t})}},{key:"editInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t[e].tmp=Object(Xt.cloneDeep)(t[e]),t[e].isEdit=!0,this.setState({dataSource:t})}},{key:"removeInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t.splice(e,1),this.backMsg(t),this.setState({dataSource:t})}},{key:"initColumns",value:function(){var e=this;return[{title:"字段",dataIndex:"fieldName",key:"fieldName",width:"200px",render:function(t,a,n){return a.isEdit?o.a.createElement(B.a,{showSearch:!0,defaultValue:a.paramType?a.paramType+"@@"+a.paramType:null,onChange:e.changeTableParam.bind(e,n),style:{width:"100%"}},e.getColumnsView()):a.fieldName}},{title:"参数名",dataIndex:"paramName",key:"paramName",width:"100px",render:function(t,a,n){return a.isEdit?o.a.createElement(Q.a,{onBlur:e.paramNameChange.bind(e,n),defaultValue:a.paramName}):a.paramName}},{title:"数据类型",dataIndex:"paramType",key:"paramType",render:function(e,t){return t.paramType||""}},{title:"说明",dataIndex:"desc",key:"desc",render:function(t,a,n){return a.isEdit?o.a.createElement(di,{onBlur:e.textAreaChange.bind(e,n),defaultValue:a.desc}):o.a.createElement(di,{key:"textareadisabled",defaultValue:a.desc,disabled:!0})}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a,n){return a.isEdit?o.a.createElement("div",null,o.a.createElement("a",{onClick:e.saveInfo.bind(e,n)},"保存"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.cancelSave.bind(e,n)},"取消")):o.a.createElement("div",null,o.a.createElement("a",{onClick:e.editInfo.bind(e,n)},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement("a",{onClick:e.removeInfo.bind(e,n)},"删除"))}}]}},{key:"render",value:function(){return o.a.createElement(q.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:!1,dataSource:this.state.dataSource})}}]),t}(r.Component))||oi,hi=(X.a.Item,B.a.Option,Q.a.TextArea,Object(T.b)(function(e){return{dataSource:e.dataSource,tagConfig:e.tagConfig,apiMarket:e.apiMarket}},function(e){return{getDataSourcesColumn:function(t){e(ot(t))}}})(li=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={addInputsignal:!1,addOutputsignal:!1,inputData:[],outputData:[],inputToOutputData:{},initInputValue:[],initOutputValue:[]},n.changeAddinputOverSignal=function(){n.setState({addInputsignal:!1})},n.addInput=function(e){n.setState({addInputsignal:!0})},n.inputParamsChange=function(e,t){n.setState({inputData:e})},n.changeAddoutputOverSignal=function(){n.setState({addOutputsignal:!1})},n.addOutput=function(e){e&&!e.param&&(e=null),n.setState({addOutputsignal:!0,inputToOutputData:e})},n.outputParamsChange=function(e){n.setState({outputData:e})},n.prev=function(){var e=n.state,t=e.inputData,a=e.outputData,i=n.props,r=i.currentStep;(0,i.navToStep)(r-1),n.props.changeParamsConfig({inputParams:t,outputParams:a})},n.next=function(){var e=n.state,t=e.inputData,a=e.outputData,i=n.props,r=i.tagId,o=i.currentStep,l=i.navToStep,s=i.basicInfo;if(!t||t.length<1)le.a.error("请设置输入参数");else if(!a||a.length<1)le.a.error("请设置输出参数");else if(t&&a&&t.length>0&&a.length>0){if(!t.some(function(e){return e.required}))return void le.a.error("输入参数必须有一个必填项");n.props.changeParamsConfig({inputParams:t,outputParams:a}),gn.publishTag(M()({},s,{id:r,inputParams:t,outputParams:a})).then(function(e){1===e.code&&l(o+1)})}else le.a.error("请设置输入输出参数")},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.basicInfo,a=e.paramsConfig;Object(Xt.isEmpty)(a)||this.setState({initInputValue:a.inputParams,initOutputValue:a.outputParams}),this.props.getDataSourcesColumn({sourceId:t.dataSourceId,tableName:t.originTable})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.tagConfig,n=e.apiMarket,i=e.dataSource,r=(t.getFieldDecorator,n.apiCatalogue,a.identifyColumn,i.sourceColumn,this.state),l=r.initInputValue,s=r.initOutputValue;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(V.a,{title:o.a.createElement("span",null,o.a.createElement("span",{style:{color:"#f04134"}},"*")," 输入参数"),extra:o.a.createElement(Ae.a,{onClick:this.addInput,style:{marginTop:"10px"},type:"primary"},"添加输入参数"),className:"box-2",noHovering:!0},o.a.createElement(ui,M()({initValue:l,inputParamsChange:this.inputParamsChange,changeAddinputOverSignal:this.changeAddinputOverSignal,addInputsignal:this.state.addInputsignal},this.props))),o.a.createElement(V.a,{title:o.a.createElement("span",null,o.a.createElement("span",{style:{color:"#f04134"}},"*")," 输出参数"),extra:o.a.createElement(Ae.a,{onClick:this.addOutput,style:{marginTop:"10px"},type:"primary"},"添加输出参数"),style:{marginTop:"20px"},className:"box-2",noHovering:!0},o.a.createElement(mi,M()({initValue:s,inputToOutputData:this.state.inputToOutputData,outputParamsChange:this.outputParamsChange,changeAddoutputOverSignal:this.changeAddoutputOverSignal,addOutputsignal:this.state.addOutputsignal},this.props)))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Ae.a,{className:"m-r-8",onClick:this.prev},"上一步"),o.a.createElement(Ae.a,{type:"primary",onClick:this.next},"下一步")))}}]),t}(r.Component))||li);hi=X.a.create()(hi);var gi,fi,yi,Ei,vi,Si=void 0,Ci=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={time:3},n.countDown=function(e){Si=setInterval(function(){e-=1,n.setState({time:e}),0===e&&C.g.push("/dl/manage")},1e3)},n.back=function(){C.g.push("/dl/manage")},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.countDown(this.state.time)}},{key:"componentWillUnmount",value:function(){clearInterval(Si)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"txt-center"},o.a.createElement("div",{style:{fontSize:"30px",marginTop:"40px"}},o.a.createElement(ln.a,{type:"check-circle",style:{fontSize:"60px",color:"#00CD00"}}),o.a.createElement("br",null),"操作成功",o.a.createElement("br",null))),o.a.createElement("div",{className:"txt-center",style:{fontSize:"14px",marginTop:"30px"}},this.state.time,"秒后自动返回"),o.a.createElement("div",{className:"txt-center",style:{padding:"20px 0"}},o.a.createElement(Ae.a,{size:"large",style:{marginLeft:"8px"}},o.a.createElement("a",{onClick:this.back},"返回"))))}}]),t}(r.Component),Ti=Zn.a.Step,bi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={current:0,editStatus:"new",basicInfo:{},paramsConfig:{},tagId:n.props.routeParams.tagId,tagType:1},n.navToStep=function(e){n.setState({current:e})},n.changeBasicInfo=function(e){var t=M()({},n.state.basicInfo,e);n.setState({basicInfo:t})},n.changeParamsConfig=function(e){var t=M()({},n.state.paramsConfig,e);n.setState({paramsConfig:t})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.tagId;ba({tagId:t}).then(function(t){if(1===t.code){var a=t.data,n={name:a.name,catalogueId:a.catalogueId,tagDesc:a.tagDesc,tagRange:a.tagRange,reqLimit:a.reqLimit,respLimit:a.respLimit,dataSourceId:a.dataSourceId,identityColumn:a.identityColumn,identityId:a.identityId,originTable:a.originTable,originColumn:a.originColumn};e.setState({basicInfo:n,paramsConfig:{inputParams:a.inputParam,outputParams:a.outputParam},tagType:a.type})}}),this.props.route.path.indexOf("editApi")>-1&&this.setState({editStatus:"edit"})}},{key:"render",value:function(){var e=this.state,t=e.tagId,a=e.tagType,n=e.current,i=e.basicInfo,r=e.paramsConfig,l=e.editStatus,s=[{title:"基本属性",content:o.a.createElement(ri,{tagType:a,currentStep:n,navToStep:this.navToStep,basicInfo:i,editStatus:l,changeBasicInfo:this.changeBasicInfo})},{title:"参数配置",content:o.a.createElement(hi,{tagId:t,currentStep:n,navToStep:this.navToStep,basicInfo:i,paramsConfig:r,changeParamsConfig:this.changeParamsConfig})},{title:"完成",content:o.a.createElement(Ci,{currentStep:n,navToStep:this.navToStep})}];return o.a.createElement("div",{className:"box-1"},o.a.createElement("h1",{className:"box-title"},o.a.createElement(On.a,null),o.a.createElement("span",{className:"m-l-8"},"标签发布")),o.a.createElement("div",{className:"steps-container"},o.a.createElement(Zn.a,{current:n},s.map(function(e){return o.a.createElement(Ti,{key:e.title,title:e.title})})),s[n].content))}}]),t}(r.Component),ki=o.a.createElement("div",null,"where 条件即针对源头数据筛选条件，根据指定的 column、table、where 条件拼接 SQL 进行数据抽取，暂时不支持limit关键字过滤。利用 where 条件可进行全量同步和增量同步，具体说明如下：",o.a.createElement("br",null),o.a.createElement("ul",null,o.a.createElement("li",null,"1）全量同步：第一次做数据导入时通常为全量导入，可不用设置 where 条件。"),o.a.createElement("li",null,"2）增量同步：增量导入在实际业务场景中，往往会选择当天的数据进行同步，通常需要编写 where 条件语句，请先确认表中描述增量字段（时间戳）为哪一个。如tableA增量的字段为create_time，则填写create_time > 您需要的日期，如果需要日期动态变化，请参考帮助文档。"))),Ii=o.a.createElement("ul",null,o.a.createElement("li",null,"MySQL：支持数值型切分键"),o.a.createElement("li",null,"Oracle：支持数值型、字符串类型切分键")),Ai=o.a.createElement("div",null,"user/hive/warehouse/projectName.db/",o.a.createElement("br",null),"tableName 是RD-OS默认的HDFS文件组织方式，projectName为项目名， 其中每个tableName是HDFS内的一个目录，储存着一张表的数据。 如果此表的数据存储在当前项目空间内，只需修改tableName即可， 否则需要根据HDFS的存储位置填写。"),_i=o.a.createElement("div",null,"设置作业速率上限，则数据同步作业的总速率将尽可能按照这个上限进行同步， 需根据实际硬件配置调整，默认为1"),Di=o.a.createElement("ul",null,o.a.createElement("li",null," 1.作业速率上限=作业并发数单作业的传输速率，当作业速率上限已定，选择的并发数越高则单并发的速率越低，同时所占用的内存会越高，这可以根据你的业务需求选择设定的值"),o.a.createElement("li",null,"2.作业并发数下拉框选择对象，取决作业速率上限。作业速率上限选择值nMB/s，作业并发数最大能选择n")),Ni=o.a.createElement("div",null,"表示脏数据的最大容忍条数，如果您配置0， 则表示严格不允许脏数据存在；如果不填则代表容忍脏数据"),xi=o.a.createElement("div",null,"高可用模式下的填写规则：",o.a.createElement("ul",null,o.a.createElement("li",null,"1、分别要填写：nameservice名称、 namenode名称（多个以逗号分隔）、proxy.provider参数；"),o.a.createElement("li",null,"2、所有参数以JSON格式填写；"),o.a.createElement("li",null,"3、格式为：",o.a.createElement("br",null),'"dfs.nameservices": "nameservice名称", "dfs.ha.namenodes.nameservice名称": "namenode名称，以逗号分隔", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.client.failover.proxy.provider.',o.a.createElement("br",null),'nameservice名称": "org.apache.hadoop.',o.a.createElement("br",null),"hdfs.server.namenode.ha.",o.a.createElement("br",null),'ConfiguredFailoverProxyProvider"'),o.a.createElement("li",null,"4、详细参数含义请参考《帮助文档》或",o.a.createElement("a",{href:"http://hadoop.apache.org/docs/r2.7.4/hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html",target:"blank"},"Hadoop官方文档")))),Li=o.a.createElement("div",null,"JDBC URL配置参考：",o.a.createElement("ul",null,o.a.createElement("li",null,"MySQL: jdbc:mysql://host:port/batch?useCursorFetch=true"),o.a.createElement("li",null,"Oracle: jdbc:oracle:thin:@host:port:ORCL"),o.a.createElement("li",null,"Hive: jdbc:hive2://host:port/projectName"))),wi=o.a.createElement("div",null,"HBase配置说明：",o.a.createElement("ul",null,o.a.createElement("li",null,'1、Zookeeper 集群的地址，多个地址间用逗号分割。例 如：" IP1:Port, IP2:Port, IP3:Port/子目录".默认是 localhost,是给伪分布式用的。要修改才能在完全分布式的情况下使用。如果在hbase-env.sh设置了HBASEMANAGESZK， 这些ZooKeeper节点就会和HBase一起启动'),o.a.createElement("li",null,"2、Port: ZooKeeper的zoo.conf中的配置。客户端连接的端口， 默认2181"),o.a.createElement("li",null,"3、子目录：HBase在ZooKeeper中配置的子目录"))),Pi=o.a.createElement("div",null,o.a.createElement("p",null,"保存到默认位置，您可以在“数据管理-脏数据管理”中查看，表名：defaultName（生命周期：30天）")),Oi=o.a.createElement("div",null,o.a.createElement("p",null,"任务执行结束后统计错误记录占比，当比例过高时，将此任务实例置为失败")),Ri=function(e){function t(){return h()(this,t),E()(this,(t.__proto__||p()(t)).apply(this,arguments))}return S()(t,e),f()(t,[{key:"render",value:function(){var e=this.props.doc;return o.a.createElement(Kn.a,{key:e,title:n[e]},o.a.createElement(ln.a,M()({className:"help-doc"},this.props.style,{type:"question-circle-o"})))}}]),t}(o.a.Component),Mi=X.a.Item,ji=B.a.Option,Gi=Object(T.b)(function(e){return{dataSource:e.dataSource}},function(e){return{getDataSourcesType:function(t){e(tt(t))}}})(gi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={sourceType:void 0,hasHdfsConfig:!1,hadoopConfig:"defaultDfs"},n.onOk=function(e){var t=n.props,a=t.editDataSource,i=t.form;i.validateFields(function(e,t){e||(t.dataJson.jdbcUrl&&(t.dataJson.jdbcUrl=se.a.trim(t.dataJson.jdbcUrl)),t.dataJson.defaultFS&&(t.dataJson.defaultFS=se.a.trim(t.dataJson.defaultFS)),a(t,i))})},n.testConnection=function(){var e=n.state.sourceType,t=n.props.form,a=void 0;e===_e.MAXCOMPUTE&&(a=["type","dataName","dataJson.project","dataJson.endPoint","dataJson.accessKey","dataJson.accessId"]),t.validateFields(a,function(e,t){e||$e.testDSConnection(t).then(function(e){e.data?le.a.success("数据源连接正常！"):le.a.error("数据库连接失败！")})})},n.cancel=function(){var e=n.props,t=e.form,a=e.handCancel;t.resetFields(),a()},n.sourceChange=function(e){n.setState({sourceType:parseInt(e)}),n.props.form.resetFields()},n.enableHdfsConfig=function(e){n.setState({hasHdfsConfig:!e.target.value})},n.renderSourceType=function(e){return e.map(function(e){return o.a.createElement(ji,{key:e.value,value:e.value.toString()},e.name)})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.sourceData,a=e.sourceData;a&&a!==t&&(7===a.type?this.setState({sourceType:a.type||1,hasHdfsConfig:!0}):this.setState({sourceType:a.type||1}))}},{key:"renderDynamic",value:function(){var e=this.state,t=e.hasHdfsConfig,a=e.sourceType,n=this.props,i=n.form,r=n.sourceData,l=i.getFieldDecorator,s=r.dataJson||{};switch(a){case _e.HIVE:return o.a.createElement("div",null,o.a.createElement(Mi,M()({},Me,{label:"JDBC URL",hasFeedback:!0}),l("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:s.jdbcUrl||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"用户名"}),l("dataJson.username",{rules:[],initialValue:s.username||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"密码"}),l("dataJson.password",{rules:[],initialValue:""})(o.a.createElement(Q.a,{type:"password"}))),o.a.createElement(Mi,M()({},Me,{label:"defaultFS",hasFeedback:!0}),l("dataJson.defaultFS",{rules:[{required:!0,message:"defaultFS不可为空！"}],initialValue:s.defaultFS||""})(o.a.createElement(Q.a,{placeholder:"hdfs://host:port"}))),o.a.createElement(Mi,je,l("hasHdfsConfig",{initialValue:!1})(o.a.createElement(Nn.a,{checked:t,onChange:this.enableHdfsConfig},"高可用配置"))),o.a.createElement(Mi,M()({},Me,{label:"高可用配置",style:{display:t?"block":"none"}}),l("dataJson.hadoopConfig",{rules:[],initialValue:s.hadoopConfig||""})(o.a.createElement(Q.a,{type:"textarea",rows:5,placeholder:'{\n    "defaultFS": "",\n    "hadoopConfig": {\n        "dfs.nameservices": "defaultDfs", \n        "dfs.ha.namenodes.defaultDfs": "namenode1", \n        "dfs.namenode.rpc-address.defaultDfs.namenode1": "", \n        "dfs.client.failover.proxy.provider.defaultDfs": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider" \n    }\n}'})),o.a.createElement(Ri,{doc:"hdfsConfig"})));case _e.MAXCOMPUTE:return o.a.createElement("div",null,o.a.createElement(Mi,M()({},Me,{label:"AccessId",hasFeedback:!0}),l("dataJson.accessId",{rules:[{required:!0,message:"access ID不可为空！"}],initialValue:s.accessId||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"AccessKey",hasFeedback:!0}),l("dataJson.accessKey",{rules:[{required:!0,message:"access Key不可为空！"}],initialValue:s.accessKey||""})(o.a.createElement(Q.a,{type:"password",autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"Project Name",hasFeedback:!0}),l("dataJson.project",{rules:[{required:!0,message:"Project Name不可为空！"}],initialValue:s.project||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"End Point",hasFeedback:!0}),l("dataJson.endPoint",{rules:[{required:!0,message:"End Point不可为空！"}],initialValue:s.endPoint||""})(o.a.createElement(Q.a,{autoComplete:"off"}))));case _e.MYSQL:case _e.ORACLE:case _e.SQLSERVER:return o.a.createElement("div",null,o.a.createElement(Mi,M()({},Me,{label:"JDBC URL",hasFeedback:!0}),l("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:s.jdbcUrl||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"用户名",hasFeedback:!0}),l("dataJson.username",{rules:[{required:!0,message:"用户名不可为空！"}],initialValue:s.username||""})(o.a.createElement(Q.a,{autoComplete:"off"}))),o.a.createElement(Mi,M()({},Me,{label:"密码",hasFeedback:!0}),l("dataJson.password",{rules:[{required:!0,message:"密码不可为空！"}],initialValue:""})(o.a.createElement(Q.a,{type:"password"}))))}}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.title,i=e.sourceData,r=e.status,l=e.dataSource,s=(this.state.hasHdfsConfig,a.getFieldDecorator);return o.a.createElement(Y.a,{title:n,maskClosable:!1,wrapClassName:"vertical-center-modal",visible:t,onCancel:this.cancel,footer:!1},o.a.createElement(X.a,null,o.a.createElement(Mi,M()({},Me,{label:"数据源类型",hasFeedback:!0}),s("type",{rules:[{required:!0,message:"数据源类型不可为空！"}],initialValue:i.type?i.type.toString():"1"})(o.a.createElement(B.a,{onChange:this.sourceChange,disabled:"edit"===r},this.renderSourceType(l.sourceType)))),o.a.createElement(Mi,M()({},Me,{label:"数据源名称",hasFeedback:!0}),s("dataName",{rules:[{required:!0,message:"数据源名称不可为空！"},{max:128,message:"数据源名称不得超过128个字符！"},{pattern:/^[A-Za-z0-9_]+$/,message:"名称只能由字母与数字、下划线组成"}],initialValue:i.dataName||""})(o.a.createElement(Q.a,{autoComplete:"off",disabled:"edit"===r}))),o.a.createElement(Mi,M()({},Me,{label:"数据源描述",hasFeedback:!0}),s("dataDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:i.dataDesc||""})(o.a.createElement(Q.a,{type:"textarea",rows:4}))),this.renderDynamic(),o.a.createElement(Mi,je,o.a.createElement(Ae.a,{icon:"sync",type:"primary","data-target":"test",onClick:this.testConnection,style:{marginRight:"10px"}},"测试连通性"),o.a.createElement(Ae.a,{type:"primary",style:{marginRight:"10px"},onClick:this.onOk},"确定"),o.a.createElement(Ae.a,{onClick:this.cancel},"取消"))))}}]),t}(r.Component))||gi,Ui=X.a.create()(Gi),Vi=(a("smhh"),Q.a.Search),Fi=Object(T.b)(function(e){return{dataSource:e.dataSource}},function(e){return{getDataSources:function(t){e(et(t))}}})(fi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,l=Array(r),s=0;s<r;s++)l[s]=arguments[s];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(l))),n.state={visible:!1,title:"新增数据源",status:"add",source:{},params:{currentPage:1,pageSize:20,name:void 0,type:void 0,active:void 0}},n.searchDataSources=function(e){var t=M()({},n.state.params,{name:e||void 0,currentPage:1});n.props.getDataSources(t),n.setState({params:t})},n.editDataSource=function(e,t){var a=n.state,i=a.title,r=a.status,o=a.source,l=a.params;"edit"===r?$e.updateDataSource(M()({},o,e)).then(function(e){1===e.code&&(le.a.success(i+"成功！"),n.props.getDataSources(l))}):$e.addDataSource(e).then(function(e){1===e.code&&(le.a.success(i+"成功！"),n.props.getDataSources(l))}),t.resetFields(),n.setState({visible:!1,source:{}})},n.remove=function(e){1!==e.active?$e.deleteDataSource({sourceId:e.id}).then(function(e){1===e.code&&(le.a.success("移除数据源成功！"),n.props.getDataSources(n.state.params))}):le.a.info("此数据源已在任务中被引用，无法删除!")},n.handleTableChange=function(e,t){var a=t.active,i=t.type,r=M()({},n.state.params,{currentPage:e.current,active:a?a[0]:void 0,type:i?i[0]:void 0});n.props.getDataSources(r),n.setState({params:r})},n.initEdit=function(e){n.setState({visible:!0,title:"编辑数据源",status:"edit",source:e})},n.initColumns=function(){return[{title:"数据源名称",dataIndex:"dataName",key:"dataName",width:"18%",render:function(e){return o.a.createElement("div",{className:"ellipsis-td",title:e},e)}},{title:"类型",dataIndex:"type",key:"type",filters:Re,filterMultiple:!1,width:"10%",render:function(e,t){return t.sourceTypeValue}},{title:"描述信息",dataIndex:"dataDesc",key:"dataDesc",width:"22%"},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"15%"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return Pn()(e).format("YYYY-MM-DD HH:mm:ss")},width:"15%"},{title:"状态",dataIndex:"active",key:"active",filters:[{text:"未启用",value:0},{text:"使用中",value:1}],filterMultiple:!1,render:function(e,t){return 1===t.active?"使用中":"未启用"},width:"10%"},{title:"操作",width:"10%",render:function(e,t){return o.a.createElement("span",null,o.a.createElement("a",{onClick:function(){n.initEdit(t)}},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement(cn.a,{title:"确定删除此数据源？",okText:"确定",cancelText:"取消",onConfirm:function(){n.remove(t)}},o.a.createElement("a",null,"删除")))}}]},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.getDataSources(this.state.params)}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.title,i=t.status,r=t.source,l=t.params,s=this.props.dataSource,c=s.sourceQuery,u=s.loading,d={current:l.currentPage,pageSize:l.pageSize,total:c.totalCount},p=o.a.createElement(Vi,{placeholder:"数据源名称",style:{width:200,margin:"10px 0"},onSearch:this.searchDataSources}),m=o.a.createElement(Ae.a,{type:"primary",style:{margin:"10px 0"},className:"right",onClick:function(){e.setState({visible:!0,source:{},status:"add",title:"添加数据源"})}},"新增数据源");return o.a.createElement("div",{className:"source-page"},o.a.createElement("h1",{className:"box-title"},"数据源管理"),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(V.a,{noHovering:!0,bordered:!1,title:p,extra:m},o.a.createElement(q.a,{rowKey:"id",loading:u,className:"m-table fixed-table",pagination:d,columns:this.initColumns(),dataSource:c.data,onChange:this.handleTableChange}))),o.a.createElement(Ui,{title:n,status:i,visible:a,sourceData:r,editDataSource:this.editDataSource,handCancel:function(){e.setState({visible:!1,source:{}})}}))}}]),t}(r.Component))||fi,qi=void 0,zi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={applyBox:!1,apply:{apiId:"",apiName:"",desc:""}},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"getTopRightButton",value:function(){var e=this.getValue("applyStatus");return 1==e||3==e?null:0==e?o.a.createElement(Ae.a,{onClick:this.jumpToMine.bind(this),size:"large",type:"primary"},"查看审批情况"):o.a.createElement(Ae.a,{onClick:this.doApply.bind(this),size:"large",type:"primary"},"立即订购")}},{key:"doApply",value:function(){this.setState({applyBox:!0,apply:{apiId:this.props.apiId,name:this.getApiValue("name"),desc:this.getApiValue("desc")}})}},{key:"back",value:function(){this.props.router.replace("/dl/market")}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.props.apiId];return t?t[e]:null}},{key:"getApiValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.api&&this.props.apiMarket.api[this.props.apiId];return t?t[e]:null}},{key:"showApplySuccessModal",value:function(){qi=Y.a.success({title:"申请提交成功",content:o.a.createElement("span",null,"您可以在 ",o.a.createElement("a",{onClick:this.jumpToMine.bind(this)},"我的API")," 中查看审批进度"),okText:"确定"})}},{key:"jumpToMine",value:function(){qi&&qi.destroy(),this.props.router.push("/dl/mine")}},{key:"jumpToMineApproved",value:function(){this.props.router.push("/dl/mine/approved?apiId="+this.props.apiId)}},{key:"handleOk",value:function(){this.setState({applyBox:!1}),this.showApplySuccessModal()}},{key:"handleCancel",value:function(){this.setState({applyBox:!1})}},{key:"render",value:function(){var e=this.props.router.location.query&&this.props.router.location.query.isHideBack?null:o.a.createElement(Qt.a,{span:1},o.a.createElement(ln.a,{type:"left-circle-o",onClick:this.back.bind(this),style:{fontSize:18,cursor:"pointer"}}));return o.a.createElement(V.a,{className:"box-1",noHovering:!0},o.a.createElement(Ye,{show:this.state.applyBox,successCallBack:this.handleOk.bind(this),cancelCallback:this.handleCancel.bind(this),apiId:this.state.apply.apiId,name:this.state.apply.name,desc:this.state.apply.desc}),o.a.createElement(Bt.a,{className:"m-count",style:{height:"auto"}},e,o.a.createElement(Qt.a,{span:12},o.a.createElement(Bt.a,{className:"header-title"},this.getApiValue("name")),o.a.createElement(Bt.a,{className:"header-content"},this.getApiValue("desc"))),o.a.createElement(Qt.a,{span:3},o.a.createElement("section",{className:"m-count-section ",style:{width:150,marginTop:0}},o.a.createElement("span",{className:"m-count-title text-left"},"订购人数"),o.a.createElement("span",{className:"m-count-content font-black text-left"},se.a.toQfw(this.getValue("applyNum")||0),o.a.createElement("span",{style:{fontSize:12}})))),o.a.createElement(Qt.a,{span:5},o.a.createElement("section",{className:"m-count-section",style:{width:200,marginTop:0}},o.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),o.a.createElement("span",{className:"m-count-content font-black text-left"},se.a.toQfw(this.getValue("apiCallNum")||0),o.a.createElement("span",{style:{fontSize:12}})))),o.a.createElement(Qt.a,{span:3},this.getTopRightButton())))}}]),t}(r.Component),Yi=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},function(e){return{getApiDetail:function(t){e(Te({apiId:t}))},getApiExtInfo:function(t){e(be({apiId:t}))}}})(yi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={apiId:""},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.router.params&&this.props.router.params.api;t&&this.setState({apiId:t},function(){e.props.getApiDetail(t),e.props.getApiExtInfo(t)})}},{key:"getRequestDataSource",value:function(){return this.getValue("reqParam")||[]}},{key:"getRequestColumns",value:function(){return[{title:"参数名",dataIndex:"paramName",key:"paramName"},{title:"数据类型",dataIndex:"paramType",key:"paramType"},{title:"是否必填",dataIndex:"required",key:"required",render:function(e){return e?"是":"否"}},{title:"说明",dataIndex:"desc",key:"desc"}]}},{key:"getResponseDataSource",value:function(){return this.getValue("respParam")||[]}},{key:"getResponseColumns",value:function(){return[{title:"参数名",dataIndex:"paramName",key:"paramName"},{title:"数据类型",dataIndex:"paramType",key:"paramType"},{title:"是否必填",dataIndex:"required",key:"required",render:function(e){return e?"是":"否"}},{title:"说明",dataIndex:"desc",key:"desc"}]}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.api&&this.props.apiMarket.api[this.state.apiId];return t?t[e]:null}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(zi,M()({},this.state,this.props)),o.a.createElement(V.a,{className:"box-1",noHovering:!0},o.a.createElement("div",null,o.a.createElement("h1",{className:"title-border-l-blue"},"基本信息"),o.a.createElement("div",{style:{marginTop:15}},o.a.createElement("p",{"data-title":"支持格式：",className:"pseudo-title p-line"},this.getValue("supportType")),o.a.createElement("p",{"data-title":"请求协议：",className:"pseudo-title p-line"},this.getValue("reqProtocol")),o.a.createElement("p",{"data-title":"请求方式：",className:"pseudo-title p-line"},this.getValue("reqMethod")))),o.a.createElement(Bt.a,{gutter:30,style:{marginTop:20}},o.a.createElement(Qt.a,{span:12},o.a.createElement("section",null,o.a.createElement("h1",{className:"title-border-l-blue"},"请求参数"),o.a.createElement(q.a,{rowKey:"paramName",style:{marginTop:15},className:"m-table border-table",pagination:!1,dataSource:this.getRequestDataSource(),columns:this.getRequestColumns()}))),o.a.createElement(Qt.a,{span:12},o.a.createElement("section",null,o.a.createElement("h1",{className:"title-border-l-blue"},"返回参数"),o.a.createElement(q.a,{rowKey:"paramName",style:{marginTop:15},className:"m-table border-table",pagination:!1,dataSource:this.getResponseDataSource(),columns:this.getResponseColumns()})))),o.a.createElement("div",{style:{marginTop:20}},o.a.createElement("h1",{className:"title-border-l-blue"},"JSON样例"),o.a.createElement("div",{style:{marginTop:15}},o.a.createElement("pre",null,$()({inFields:{id:175,date:"2017-09-08 12:33:23",in:"12,34,45"}},null,"    \r"))))))}}]),t}(r.Component))||yi,Hi=function(e){function t(){return h()(this,t),E()(this,(t.__proto__||p()(t)).apply(this,arguments))}return S()(t,e),f()(t,[{key:"getTopRightButton",value:function(){var e=Oe[this.getValue("status")];return e?"stop"==e?o.a.createElement("div",null,o.a.createElement(Ae.a,{onClick:this.props.openApi,style:{marginRight:"5px"}},"开启"),o.a.createElement(Ae.a,{onClick:this.editApi.bind(this,this.props.apiId),style:{marginRight:"5px"},type:"primary"},"编辑"),o.a.createElement(Ae.a,{onClick:this.props.deleteApi,type:"danger"},"删除")):o.a.createElement(Ae.a,{onClick:this.props.closeApi,size:"large",type:"danger"},"禁用"):null}},{key:"editApi",value:function(e){this.props.router.push("/dl/manage/editApi/"+e)}},{key:"back",value:function(){this.props.router.goBack()}},{key:"openApiDetail",value:function(){window.open(location.origin+location.pathname+"#/dl/market/detail/"+this.props.apiId+"?isHideBack=true")}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.props.apiId];return t?t[e]:null}},{key:"render",value:function(){return o.a.createElement(V.a,{className:"box-1",noHovering:!0},o.a.createElement(Bt.a,{className:"m-count",style:{height:"auto"}},o.a.createElement(Qt.a,{span:1},o.a.createElement(ln.a,{type:"left-circle-o",onClick:this.back.bind(this),style:{fontSize:18,cursor:"pointer"}})),o.a.createElement(Qt.a,{span:10},o.a.createElement(Bt.a,{className:"header-title"},this.getValue("apiName")),o.a.createElement(Bt.a,{className:"header-content"},this.getValue("apiDesc")),o.a.createElement(Bt.a,{className:"header-content"},o.a.createElement("a",{onClick:this.openApiDetail.bind(this)},"查看详情"))),o.a.createElement(Qt.a,{span:3},o.a.createElement("section",{className:"m-count-section ",style:{width:150,marginTop:0}},o.a.createElement("span",{className:"m-count-title text-left"},"订购人数"),o.a.createElement("span",{className:"m-count-content font-black text-left"},se.a.toQfw(this.getValue("applyNum")||0),o.a.createElement("span",{style:{fontSize:12}})))),o.a.createElement(Qt.a,{span:5},o.a.createElement("section",{className:"m-count-section",style:{width:200,marginTop:0}},o.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),o.a.createElement("span",{className:"m-count-content font-black text-left"},se.a.toQfw(this.getValue("apiCallNum")||0),o.a.createElement("span",{style:{fontSize:12}})))),o.a.createElement(Qt.a,{span:5},this.getTopRightButton())))}}]),t}(r.Component),Bi={1:"disable",2:"unauthorize",3:"paramerror",4:"timeout",5:"outlimit",6:"other"},Ki={disable:"禁用",unauthorize:"未认证",paramerror:"参数错误",timeout:"超时",outlimit:"超过限制",other:"其他"},Qi=Object(T.b)(function(e){return{}},function(e){return{getApiCallErrorInfo:function(t,a){return e(Ra({apiId:t,time:a}))},queryApiCallLog:function(t,a,n){return e(wt({apiId:t,currentPage:a,bizType:n,useAdmin:!0}))}}})(Ei=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={error:{},data:[],loading:!1,pageIndex:1,total:0,filter:{}},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t},function(){n.getErrorInfo()})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.getErrorInfo()}},{key:"getErrorInfo",value:function(e){var t=this;(e=e||this.props.apiId)&&(this.props.getApiCallErrorInfo(e,this.props.dateType).then(function(e){if(e){for(var a={},n=0;n<e.data.recordInfoList.length;n++){var i=e.data.recordInfoList[n],r=Bi[i.type];r&&(a[r]={percent:i.rate,count:i.callNum})}t.setState({error:a})}}),this.props.queryApiCallLog(e,this.state.pageIndex,this.state.filter.bizType&&this.state.filter.bizType[0]).then(function(e){e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId!==e.apiId&&this.getErrorInfo(e.apiId)}},{key:"initColumns",value:function(){var e=this;return[{title:"调用时间",dataIndex:"invokeTime",key:"invokeTime",render:function(e){return se.a.formatDateTime(e)}},{title:"调用用户",dataIndex:"userName",key:"userName"},{title:"错误类型",dataIndex:"bizType",key:"bizType",render:function(e){return Ki[Bi[e]]},filters:[{text:"参数错误",value:"3"},{text:"禁用",value:"1"},{text:"未认证",value:"2"},{text:"超时",value:"4"},{text:"超过限制",value:"5"},{text:"其他",value:"6"}],filterMultiple:!1},{title:"错误日志",dataIndex:"content",key:"content",width:"50%"},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return o.a.createElement("a",{onClick:e.lookAllErrorText.bind(e,a.content)},"查看全部")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.state.total}}},{key:"getSource",value:function(){return this.state.data}},{key:"lookAllErrorText",value:function(e){Y.a.info({title:"错误日志",content:o.a.createElement("div",null,o.a.createElement("p",null,e)),onOk:function(){}})}},{key:"getErrorPercent",value:function(e){return this.state.error[e]&&this.state.error[e].percent||0}},{key:"getErrorCount",value:function(e){return this.state.error[e]&&this.state.error[e].count||0}},{key:"render",value:function(){var e=this.getSource(),t="m-table monitor-table table-p-l20";return e.length<3&&(t+=" mini-filter"),o.a.createElement("div",null,o.a.createElement("p",{style:{lineHeight:"1",padding:"14px 0px 14px 20px"},className:"child-span-padding-r20"},o.a.createElement("span",null,"参数错误: ",this.getErrorPercent("paramerror"),"% (",this.getErrorCount("paramerror"),"次)"),o.a.createElement("span",null,"禁用: ",this.getErrorPercent("disable"),"% (",this.getErrorCount("disable"),"次)"),o.a.createElement("span",null,"未认证: ",this.getErrorPercent("unauthorize"),"% (",this.getErrorCount("unauthorize"),"次)"),o.a.createElement("span",null,"超时: ",this.getErrorPercent("timeout"),"% (",this.getErrorCount("timeout"),"次)"),o.a.createElement("span",null,"超过限制: ",this.getErrorPercent("outlimit"),"% (",this.getErrorCount("outlimit"),"次)"),o.a.createElement("span",null,"其他: ",this.getErrorPercent("other"),"% (",this.getErrorCount("other"),"次)")),o.a.createElement(q.a,{rowKey:"id",className:t,columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:e,onChange:this.onTableChange}))}}]),t}(r.Component))||Ei,Ji=function(e){function t(){return h()(this,t),E()(this,(t.__proto__||p()(t)).apply(this,arguments))}return S()(t,e),f()(t,[{key:"getSource",value:function(){return this.props.data||[]}},{key:"render",value:function(){return o.a.createElement(q.a,{rowKey:function(e){return e.userId},style:{marginTop:"20px",marginBottom:"20px"},className:"m-table border-table table-p-l20",rowClassName:function(){return"h-33"},pagination:!1,columns:[{title:"排名",dataIndex:"rank",key:"rank",className:"color-666",render:function(e,t,a){return o.a.createElement("span",{className:"rank-number rank-number_"+(a+1)},a+1)}},{title:"用户",dataIndex:"userName",key:"userName",className:"color-666"},{title:"调用次数",dataIndex:"callNum",key:"callNum",className:"color-666"}],dataSource:this.getSource(),onChange:this.onTableChange})}}]),t}(r.Component),Xi=a("ProS");a("75ce"),a("0o9m"),a("AH3D"),a("Ynxi");var Wi,Zi,$i,er,tr,ar,nr,ir,rr=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,apiManage:e.apiManage,user:t}},function(e){return{getApiCallUserRankList:function(t,a){return e(xa({apiId:t,time:a}))},getApiCallInfo:function(t,a){return e(Nt({apiId:t,time:a,useAdmin:!0}))}}})(vi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={topCallUser:"",failPercent:"",callCount:"",callList:[],topCallList:[],apiId:"",dateType:""},n.resize=function(){n.state.lineChart&&n.state.lineChart.resize()},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({apiId:this.props.apiId,dateType:this.props.dateType},function(){e.getApiCallUserRankList(),e.getApiCallInfoList()})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.state.apiId==e.apiId&&this.state.dateType==e.dateType||this.setState({apiId:e.apiId,dateType:e.dateType},function(){t.getApiCallUserRankList(),t.getApiCallInfoList()})}},{key:"getApiCallInfoList",value:function(){var e=this,t=this.state.apiId,a=this.state.dateType;t&&a&&this.props.getApiCallInfo(t,a).then(function(t){t&&e.setState({callList:t.data.infoList,topCallUser:t.data.topCallUserName,failPercent:t.data.failRate,callCount:t.data.callCount},function(){e.initLineChart()})})}},{key:"getApiCallUserRankList",value:function(){var e=this,t=this.state.apiId,a=this.state.dateType;t&&a&&this.props.getApiCallUserRankList(t,a).then(function(t){t&&e.setState({topCallList:t.data})})}},{key:"initLineChart",value:function(){for(var e=this.state.callList,t=[],a=[],n=[],i=0;i<e.length;i++)switch(t.push(e[i].callCount),a.push(e[i].failRate),this.props.dateType){case"1":n.push(se.a.formatHours(e[i].time));break;case"7":n.push(se.a.formatDateHours(e[i].time));break;case"30":case"-1":n.push(se.a.formatDate(e[i].time))}var r=Xi.init(document.getElementById("manageApiDetail")),o=Object(Xt.cloneDeep)(Ve);o.tooltip.formatter=function(e){for(var t=e[0].name,a=0,n=e.length;a<n;a++){var i="次";"失败率"==e[a].seriesName&&(i="%"),t+='<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e[a].color+'"></span>'+e[a].seriesName+" : "+e[a].value+i}return t},o.series=[{symbol:"none",name:"调用次数",data:t,type:"line",smooth:!0,itemStyle:{normal:{color:"#1C86EE"}}},{symbol:"none",name:"失败率",data:a,type:"line",smooth:!0,yAxisIndex:1,itemStyle:{normal:{color:"#EE0000"}}}],o.xAxis[0].data=n,r.setOption(o),this.setState({lineChart:r})}},{key:"getDateText",value:function(){switch(this.props.dateType){case"1":return"24小时";case"7":return"7天";case"30":return"30天";case"-1":return"历史以来";default:return""}}},{key:"render",value:function(){return o.a.createElement("div",{style:{paddingLeft:"20px",paddingRight:"20px"}},o.a.createElement(Bt.a,null,o.a.createElement(Qt.a,{span:16},o.a.createElement(Bt.a,{gutter:100,className:"m-count padding-l20 height-101"},o.a.createElement(Qt.a,{span:6},o.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},o.a.createElement("span",{className:"m-count-title text-left"},this.getDateText(),"累计调用"),o.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.callCount||0,o.a.createElement("span",{style:{fontSize:12}},"次")))),o.a.createElement(Qt.a,{span:4},o.a.createElement("section",{className:"m-count-section margin-t20",style:{width:100}},o.a.createElement("span",{className:"m-count-title text-left"},this.getDateText(),"失败率"),o.a.createElement("span",{className:"m-count-content font-red text-left"},this.state.failPercent||0,o.a.createElement("span",{style:{fontSize:12}},"%"))))),o.a.createElement(Jt.a,{onResize:this.resize},o.a.createElement("article",{id:"manageApiDetail",style:{width:"100%",height:"300px"}}))),o.a.createElement(Qt.a,{span:8,style:{paddingTop:"20px"}},o.a.createElement("p",{style:{fontWeight:"bold",lineHeight:1,fontSize:"14px"}},"排行榜"),o.a.createElement(Ji,{data:this.state.topCallList}))))}}]),t}(r.Component))||vi,or=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageIndex:1,filter:{},sortedInfo:{}},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t,sortedInfo:a}),n.props.tableChange({page:e.current,filter:t,sortedInfo:a})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"initColumns",value:function(){var e=this;return[{title:"用户",dataIndex:"userName",key:"userName"},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"正常",value:"1"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}],render:function(e,t){return o.a.createElement("span",{className:"state-"+we[e]},{success:"正常",stop:"停用",disabled:"取消授权"}[we[e]])}},{title:"最近24小时调用",dataIndex:"recent24HCallNum",key:"recent24HCallNum"},{title:"最近24小时失败率",dataIndex:"recent24HFailRate",key:"recent24HFailRate",render:function(e){return e+"%"}},{title:"最近7天调用",dataIndex:"recent7DCallNum",key:"recent7DCallNum"},{title:"最近30天调用",dataIndex:"recent30DCallNum",key:"recent30DCallNum"},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",render:function(e){return se.a.formatDateTime(e)}},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return"disabled"!=we[a.status]?o.a.createElement("a",{onClick:function(){e.props.cancelApi(a.applyId)}},"取消授权"):o.a.createElement("a",{onClick:function(){e.props.applyApi(a.applyId)}},"恢复授权")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.props.total}}},{key:"lookAllErrorText",value:function(){}},{key:"render",value:function(){return o.a.createElement(q.a,{rowKey:"applyId",className:"m-table monitor-table table-p-l20",columns:this.initColumns(),loading:this.props.loading,pagination:this.getPagination(),dataSource:this.props.data,onChange:this.onTableChange})}}]),t}(r.Component),lr=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={pageIndex:1,filter:{},sortedInfo:{}},n.onTableChange=function(e,t,a){n.setState({pageIndex:e.current,filter:t,sortedInfo:a}),n.props.tableChange({page:e.current,filter:t,sortedInfo:a})},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"initColumns",value:function(){return[{title:"用户",dataIndex:"userName",key:"userName"},{title:"最近24小时调用",dataIndex:"recent24HCallNum",key:"recent24HCallNum"},{title:"最近24小时失败率",dataIndex:"recent24HFailRate",key:"recent24HFailRate",render:function(e){return e+"%"}},{title:"最近7天调用",dataIndex:"recent7DCallNum",key:"recent7DCallNum"},{title:"最近30天调用",dataIndex:"recent30DCallNum",key:"recent30DCallNum"},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",render:function(e){return se.a.formatDateTime(e)}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.props.total}}},{key:"lookAllErrorText",value:function(){}},{key:"render",value:function(){return o.a.createElement(q.a,{rowKey:"applyId",className:"m-table monitor-table table-p-l20",columns:this.initColumns(),loading:this.props.loading,pagination:this.getPagination(),dataSource:this.props.data,onChange:this.onTableChange})}}]),t}(r.Component),sr=Y.a.confirm,cr=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,apiManage:e.apiManage,user:t}},function(e){return{getApiUserApplyList:function(t){return e(La(t))},updateUserApiStatus:function(t){return e(Dt(t))}}})(Wi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={data:[],total:0,disAbleKey:"init",enAbleKey:"init",loading:!1},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.tableChange({filter:{},sortedInfo:{},page:1})}},{key:"initState",value:function(){this.setState({disAbleKey:Math.random(),enAbleKey:Math.random(),total:0,dataDisable:[],dataEnable:[]})}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId==e.apiId&&this.props.disAble==e.disAble||(this.initState(),this.tableChange({filter:{},sortedInfo:{},page:1},e.apiId))}},{key:"tableChange",value:function(e,t){var a=e.filter,n=(e.sortedInfo,e.page),i=a.status;(!i||i.length<1)&&(i=["1","3","4"]);var r={};r.apiId=t||this.props.apiId,r.pageSize=10,r.currentPage=n,r.status=i,this.getData(r)}},{key:"getData",value:function(e){var t=this;e||(e=this.state.requestParams),e.apiId&&(this.setState({loading:!0,requestParams:e}),this.props.getApiUserApplyList(e).then(function(e){t.setState({loading:!1}),e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"cancelApi",value:function(e){var t=this;sr({title:"确认取消?",content:"确认取消授权",onOk:function(){t.props.updateUserApiStatus({applyId:e,useAdmin:!0,status:4}).then(function(e){e&&(le.a.success("取消成功"),t.getData())})},onCancel:function(){}})}},{key:"applyApi",value:function(e){var t=this;sr({title:"确认授权?",content:"确认授权",onOk:function(){t.props.updateUserApiStatus({applyId:e,useAdmin:!0,status:1}).then(function(e){e&&(le.a.success("授权成功"),t.getData())})},onCancel:function(){}})}},{key:"lookAllErrorText",value:function(){}},{key:"getTable",value:function(){return this.props.statusDisAble?o.a.createElement(lr,{loading:this.state.loading,key:this.state.disAbleKey,total:this.state.total,data:this.state.data,tableChange:this.tableChange.bind(this)}):o.a.createElement(or,{cancelApi:this.cancelApi.bind(this),applyApi:this.applyApi.bind(this),loading:this.state.loading,key:this.state.enAbleKey,total:this.state.total,data:this.state.data,tableChange:this.tableChange.bind(this)})}},{key:"render",value:function(){return o.a.createElement("div",null,this.getTable())}}]),t}(r.Component))||Wi,ur=Y.a.confirm,dr=zt.a.Button,pr=zt.a.Group,mr=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},function(e){return{getApiDetail:function(t){e(Te({apiId:t}))},getApiExtInfo:function(t){e(be({apiId:t,useAdmin:!0}))},deleteApi:function(t){return e(_a({apiIds:[t]}))},openApi:function(t){return e(Da(t))},closeApi:function(t){return e(Na(t))}}})(Zi=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.state={apiId:"",nowView:"callState",callStateDate:"1",errorLogDate:"7"},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"deleteApi",value:function(){var e=this,t=this.state.apiId;ur({title:"确认删除该标签？",onOk:function(){e.props.deleteApi(t).then(function(t){t&&(le.a.success("删除成功"),e.getApiExtInfo())})},onCancel:function(){}})}},{key:"openApi",value:function(){var e=this,t=this.state.apiId;ur({title:"确认开启该标签？",onOk:function(){e.props.openApi(t).then(function(t){le.a.success("开启成功"),t&&e.getApiExtInfo()})},onCancel:function(){}})}},{key:"closeApi",value:function(){var e=this,t=this.state.apiId;ur({title:"确认禁用该标签？",onOk:function(){e.props.closeApi(t).then(function(t){le.a.success("禁用成功"),t&&e.getApiExtInfo()})},onCancel:function(){}})}},{key:"getApiExtInfo",value:function(){this.props.getApiExtInfo(this.state.apiId)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.router.params&&this.props.router.params.api;t&&this.setState({apiId:t},function(){e.getApiExtInfo()})}},{key:"callback",value:function(e){this.setState({nowView:e})}},{key:"chooseCallStateDate",value:function(e){this.setState({callStateDate:e.target.value})}},{key:"chooseErrorLogDate",value:function(e){this.setState({errorLogDate:e.target.value})}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.state.apiId];return t?t[e]:null}},{key:"getDateTypeView",value:function(){switch(this.state.nowView){case"callState":return o.a.createElement("div",{className:"m-radio-group",key:"callStateDate",style:{marginTop:"4px",marginRight:"8px"}},o.a.createElement(pr,{name:"callStateDate",defaultValue:this.state.callStateDate,className:"no-bd nobackground",onChange:this.chooseCallStateDate.bind(this)},o.a.createElement(dr,{value:"1"},"最近24小时"),o.a.createElement(dr,{value:"7"},"最近7天"),o.a.createElement(dr,{value:"30"},"最近30天"),o.a.createElement(dr,{value:"-1"},"历史以来")));case"errorLog":return o.a.createElement("div",{className:"m-radio-group",key:"errorLogDate",style:{marginTop:"4px",marginRight:"8px"}},o.a.createElement(pr,{name:"errorLogDate",defaultValue:this.state.errorLogDate,className:"no-bd nobackground",onChange:this.chooseErrorLogDate.bind(this)},o.a.createElement(dr,{value:"7"},"最近7天")));default:return null}}},{key:"render",value:function(){var e=void 0;return"stop"==Oe[this.getValue("status")]&&(e=!0),o.a.createElement("div",null,o.a.createElement(Hi,M()({},this.state,this.props,{deleteApi:this.deleteApi.bind(this),openApi:this.openApi.bind(this),closeApi:this.closeApi.bind(this)})),o.a.createElement("div",{className:"tabs-box m-tabs noheight tabs-filter-show"},o.a.createElement(bt.a,{defaultActiveKey:this.state.nowView,onChange:this.callback.bind(this),tabBarExtraContent:this.getDateTypeView()},o.a.createElement(bt.a.TabPane,{tab:"调用情况",key:"callState"},o.a.createElement(rr,{dateType:this.state.callStateDate,apiId:this.state.apiId})),o.a.createElement(bt.a.TabPane,{tab:"错误日志",key:"errorLog"},o.a.createElement(Qi,{dateType:this.state.errorLogDate,apiId:this.state.apiId})),o.a.createElement(bt.a.TabPane,{tab:"订购情况",key:"buyState"},o.a.createElement(cr,{statusDisAble:e,apiId:this.state.apiId})))))}}]),t}(r.Component))||Zi,hr=(a("ywA0"),a("sF4d")),gr=a.n(hr),fr=gr.a.TreeNode,yr=function(e){function t(e){h()(this,t);var a=E()(this,(t.__proto__||p()(t)).call(this,e));return a.state={maxDeepLength:2,expandedKeys:[],editNode:null,mode:"",addPid:"",autoExpandParent:!0},a.onSelect=function(e,t){},a.onCheck=function(e,t){},a.checkVal=function(e){var t=/^([\w|\u4e00-\u9fa5]{1,20})$/.test(e);return t||le.a.error("类目名称不能超过20个字符，只能以字母、数字、下划线和汉字组成！"),t},a.onExpands=function(e,t){a.setState({expandedKeys:e,autoExpandParent:!1})},a.editInput=null,a}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.maxDeepLength&&(this.state.maxDeepLength=this.props.maxDeepLength)}},{key:"componentWillReceiveProps",value:function(e){e.maxDeepLength&&this.props.maxDeepLength!=e.maxDeepLength&&this.setState({maxDeepLength:e.maxDeepLength})}},{key:"getTreeView",value:function(){var e=this.props.tree,t=[];return e?{view:function e(a,n){for(var i=[],r=0;r<a.length;r++){var l=a[r],s=!(l.childCatalogue.length>0);l.api?i.push(o.a.createElement(fr,{title:l.catalogueName,key:l.id})):(t.push(l.id.toString()),i.push(o.a.createElement(fr,{title:this.getTreeNodeTitle.call(this,l.id,l.catalogueName,!1,s,n),key:l.id},e.call(this,l.childCatalogue,n+1))))}return i}.call(this,e,1),expandedKeys:t}:null}},{key:"deleteNode",value:function(e){this.props.deleteCatalogue(e)}},{key:"getTreeNodeTitle",value:function(e,t,a,n,i){var r=this.state.maxDeepLength,l=void 0;return l=a?o.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},o.a.createElement(Kn.a,{title:"添加新分类"},o.a.createElement(ln.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)}))):n?i>=r?o.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},o.a.createElement(Kn.a,{title:"编辑"},o.a.createElement(ln.a,{type:"edit",onClick:this.editNode.bind(this,e)})),o.a.createElement(Kn.a,{title:"删除"},o.a.createElement(cn.a,{title:"您确定删除该分类吗",onConfirm:this.deleteNode.bind(this,e),okText:"确定",cancelText:"取消"},o.a.createElement(ln.a,{type:"minus-square-o"})))):o.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},o.a.createElement(Kn.a,{title:"添加新分类"},o.a.createElement(ln.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)})),o.a.createElement(Kn.a,{title:"编辑"},o.a.createElement(ln.a,{type:"edit",onClick:this.editNode.bind(this,e)})),o.a.createElement(Kn.a,{title:"删除"},o.a.createElement(cn.a,{title:"您确定删除该分类吗",onConfirm:this.deleteNode.bind(this,e),okText:"确定",cancelText:"取消"},o.a.createElement(ln.a,{type:"minus-square-o"})))):i<r?o.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},o.a.createElement(Kn.a,{title:"添加新分类"},o.a.createElement(ln.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)})),o.a.createElement(Kn.a,{title:"编辑"},o.a.createElement(ln.a,{type:"edit",onClick:this.editNode.bind(this,e)}))):o.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},o.a.createElement(Kn.a,{title:"编辑"},o.a.createElement(ln.a,{type:"edit",onClick:this.editNode.bind(this,e)}))),o.a.createElement("span",{className:"tree-hover-show"},this.state.editNode==e?o.a.createElement("input",{ref:this.setRange.bind(this),autoFocus:!0,defaultValue:t,onBlur:this.editOver.bind(this,e)}):t,l)}},{key:"setRange",value:function(e){if(e){var t=e.value.length;e.setSelectionRange(t,t),this.editInput=e}}},{key:"editOver",value:function(e,t){var a=this,n=this.editInput.value;if(!this.checkVal(n))return this.props.getCatalogue(0),void this.setState({editNode:null});this.setState({editNode:null},function(){"add"!=a.state.mode?a.props.updateCatalogue(e,n):a.props.addCatalogue(a.state.addPid,n)})}},{key:"editNode",value:function(e){this.setState({editNode:e,mode:"edit"})}},{key:"addNode",value:function(e){var t=Object(Xt.cloneDeep)(this.props.tree),a=Math.random();!function e(t,n){if(0!=n)for(var i=0;i<t.length;i++){var r=t[i];if(r.id==n)return void r.childCatalogue.push({id:a,catalogueName:"新建分类名"+r.childCatalogue.length,childCatalogue:[]});e(r.childCatalogue,n)}else t.push({id:a,catalogueName:"新建分类名",childCatalogue:[]})}(t,e),this.setState({editNode:a,mode:"add",addPid:e}),this.props.addCatalogueEdit(t)}},{key:"render",value:function(){var e=this.getTreeView(),t=e.view,a=e.expandedKeys,n=this.state.expandedKeys.length>0?this.state.expandedKeys:a;return o.a.createElement(gr.a,{showIcon:!0,expandedKeys:n,onSelect:this.onSelect,onCheck:this.onCheck,onExpand:this.onExpands,autoExpandParent:this.state.autoExpandParent},o.a.createElement(fr,{title:this.getTreeNodeTitle.call(this,0,"标签管理",!0,!1,0),key:0},t))}}]),t}(r.Component),Er=Object(T.b)(function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},function(e){return{getCatalogue:function(t){e(Se(t))},deleteCatalogue:function(t){return e(Pa({id:t}))},updateCatalogue:function(t,a){return e(wa({id:t,nodeName:a}))},addCatalogue:function(t,a){return e(Oa({pid:t,nodeName:a}))},addCatalogueEdit:function(t){e({type:W.a.GET_CATALOGUE,payload:t})}}})($i=function(e){function t(){var e,a,n,i;h()(this,t);for(var r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];return a=n=E()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(o))),n.onSelect=function(e,t){},n.onCheck=function(e,t){},i=a,E()(n,i)}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.getCatalogue(0)}},{key:"deleteCatalogue",value:function(e){var t=this;this.props.deleteCatalogue(e).then(function(e){e&&le.a.success("删除成功"),t.props.getCatalogue(0)})}},{key:"addCatalogue",value:function(e,t){var a=this;this.props.addCatalogue(e,t).then(function(e){e&&le.a.success("新增成功"),a.props.getCatalogue(0)})}},{key:"updateCatalogue",value:function(e,t){var a=this;this.props.updateCatalogue(e,t).then(function(e){e&&le.a.success("更改成功"),a.props.getCatalogue(0)})}},{key:"render",value:function(){return o.a.createElement("div",{className:"m-card"},o.a.createElement("h1",{className:"box-title"}," ",o.a.createElement(On.a,null)," 类目管理"),o.a.createElement(V.a,{className:"box-2 g-datamanage",noHovering:!0},o.a.createElement(yr,{getCatalogue:this.props.getCatalogue,addCatalogue:this.addCatalogue.bind(this),addCatalogueEdit:this.props.addCatalogueEdit,updateCatalogue:this.updateCatalogue.bind(this),deleteCatalogue:this.deleteCatalogue.bind(this),tree:this.props.apiMarket.apiCatalogue})))}}]),t}(r.Component))||$i,vr=o.a.createElement(C.d,{path:"/",component:b.a},o.a.createElement(C.b,{component:Ct}),o.a.createElement(C.d,{path:"/message",component:k.a},o.a.createElement(C.b,{component:I.a}),o.a.createElement(C.d,{path:"list",component:I.a}),o.a.createElement(C.d,{path:"detail/:msgId",component:A.a})),o.a.createElement(C.d,{path:"/admin",component:_.a},o.a.createElement(C.b,{component:D.a}),o.a.createElement(C.d,{path:"user",component:D.a}),o.a.createElement(C.d,{path:"role",component:N.a}),o.a.createElement(C.d,{path:"role/add",component:x.a}),o.a.createElement(C.d,{path:"role/edit/:roleId",component:L.a})),o.a.createElement(C.d,{path:"/dl",component:Ct},o.a.createElement(C.b,{component:Qe}),o.a.createElement(C.d,{path:"market",component:Qe}),o.a.createElement(C.d,{path:"market/detail/:api",component:Yi}),o.a.createElement(C.d,{path:"mine",component:pa}),o.a.createElement(C.d,{path:"mine/:view",component:pa}),o.a.createElement(C.d,{path:"approval",component:en}),o.a.createElement(C.d,{path:"manage",component:qa}),o.a.createElement(C.d,{path:"manage/detail/:api",component:mr}),o.a.createElement(C.d,{path:"manage/apiType",component:Er}),o.a.createElement(C.d,{path:"manage/newApi/:tagId",component:bi}),o.a.createElement(C.d,{path:"manage/editApi/:tagId",component:bi}),o.a.createElement(C.d,{path:"tagConfig",component:_n}),o.a.createElement(C.d,{path:"tagConfig/identify",component:zn}),o.a.createElement(C.d,{path:"tagConfig/ruleTagEdit/:id",component:Vn}),o.a.createElement(C.d,{path:"tagConfig/tagLog/:id",component:Xn}),o.a.createElement(C.d,{path:"dataSource",component:Fi}))),Sr=function(e){function t(){return h()(this,t),E()(this,(t.__proto__||p()(t)).apply(this,arguments))}return S()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=e.store,a=e.history;return o.a.createElement(T.a,{store:t},o.a.createElement(C.e,{routes:vr,history:a,key:Math.random()}))}}]),t}(o.a.Component);er=Sr,tr=a("2XEC").default,ar=Object(u.a)(tr,"hash"),nr=ar.store,ir=ar.history,s.a.render(o.a.createElement(c.AppContainer,null,o.a.createElement(er,{store:nr,history:ir})),document.getElementById("app"))},eRkO:function(e,t,a){var n=a("+TT/"),i=n.getLayoutRect,r=n.box,o=n.positionElement,l=a("7aKB"),s=a("IwbS");t.layout=function(e,t,a){var n=t.getBoxLayoutParams(),l=t.get("padding"),s={width:a.getWidth(),height:a.getHeight()},c=i(n,s,l);r(t.get("orient"),e,t.get("itemGap"),c.width,c.height),o(e,n,s,l)},t.makeBackground=function(e,t){var a=l.normalizeCssArray(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new s.Rect({shape:{x:e.x-a[3],y:e.y-a[0],width:e.width+a[1]+a[3],height:e.height+a[0]+a[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1})}},hNWo:function(e,t,a){var n=a("ProS"),i=a("bYtY"),r=a("Qxkt"),o=n.extendComponentModel({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(e,t,a){this.mergeDefaultAndTheme(e,a),e.selected=e.selected||{}},mergeOption:function(e){o.superCall(this,"mergeOption",e)},optionUpdated:function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,a=0;a<e.length;a++){var n=e[a].get("name");if(this.isSelected(n)){this.select(n),t=!0;break}}!t&&this.select(e[0].get("name"))}},_updateData:function(e){var t=i.map(this.get("data")||[],function(e){return"string"!=typeof e&&"number"!=typeof e||(e={name:e}),new r(e,this,this.ecModel)},this);this._data=t;var a=i.map(e.getSeries(),function(e){return e.name});e.eachSeries(function(e){if(e.legendDataProvider){var t=e.legendDataProvider();a=a.concat(t.mapArray(t.getName))}}),this._availableNames=a},getData:function(){return this._data},select:function(e){var t=this.option.selected;if("single"===this.get("selectedMode")){var a=this._data;i.each(a,function(e){t[e.get("name")]=!1})}t[e]=!0},unSelect:function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},toggleSelected:function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},isSelected:function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&i.indexOf(this._availableNames,e)>=0},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",textStyle:{color:"#333"},selectedMode:!0,tooltip:{show:!1}}}),l=o;e.exports=l},hhe7:function(e,t,a){},iEKX:function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a("QbLZ"),i=a.n(n),r=a("sbe7"),o=a.n(r);function l(e){var t=e.style,a=i()({},{textIndent:"5px",backgroundColor:"transparent",backgroundImage:"none",width:"100%",border:"none"},t);return o.a.createElement("textarea",i()({},e,{style:a}))}},jaNl:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["GET_ALL_API_LIST"],{prefix:"apiManage/"})},kDyi:function(e,t){e.exports=function(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(e){for(var a=0;a<t.length;a++)if(!t[a].isSelected(e.name))return!1;return!0})}},sEhC:function(e,t,a){},smhh:function(e,t,a){},vFmn:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("zbcj"),i=a.n(n)()(["GET_ALL_APPLY_LIST"],{prefix:"approval/"})},zXZS:function(e,t,a){"use strict";a.d(t,"a",function(){return h});var n=a("Yz+Y"),i=a.n(n),r=a("iCc5"),o=a.n(r),l=a("V7oC"),s=a.n(l),c=a("FYw3"),u=a.n(c),d=a("mRg0"),p=a.n(d),m=a("sbe7"),h=function(e){function t(){var e,a,n,r;o()(this,t);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return a=n=u()(this,(e=t.__proto__||i()(t)).call.apply(e,[this].concat(s))),n.resize=function(){var e=n.props.onResize;e&&e()},r=a,u()(n,r)}return p()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1)}},{key:"render",value:function(){return this.props.children}}]),t}(m.Component)}},[["cC79",19,21,20,23,25,22]]]);