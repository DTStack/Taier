(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1406:function(e,a,t){"use strict";t.d(a,"a",function(){return h});t(102);var r=t(53),n=t.n(r),s=t(8),i=t.n(s),c=t(5),o=t.n(c),l=t(6),_=t.n(l),u=t(2),d=t.n(u),p=t(7),m=t.n(p),E=t(0),k=t.n(E),h=function(e){function a(e){return o()(this,a),d()(this,(a.__proto__||i()(a)).call(this,e))}return m()(a,e),_()(a,[{key:"render",value:function(){return this.props.notSynced?k.a.createElement(n.a,{title:"修改已保存至本地存储但尚未同步到服务器，你可以点击上面的保存按钮立即同步。"},k.a.createElement("span",{style:{display:"inline-block",width:8,height:8,marginRight:8,borderRadius:"50%",border:"3px solid ",borderColor:"#EF5350",opacity:.8}})):k.a.createElement("span",{style:{display:"inline-block",width:8,height:8,marginRight:8,borderRadius:"50%",border:"3px solid ",borderColor:"#00a854",opacity:.6}})}}]),a}(k.a.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(h,"SyncBadge","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/components/sync-badge/index.js")},1425:function(e,a,t){"use strict";t.r(a);t(63);var r=t(29),n=t.n(r),s=t(4),i=t.n(s),c=(t(70),t(23)),o=t.n(c),l=(t(48),t(20)),_=t.n(l),u=t(69),d=t.n(u),p=t(42),m=t.n(p),E=(t(791),t(286)),k=t.n(E),h=(t(36),t(13)),T=t.n(h),g=t(8),f=t.n(g),v=t(5),O=t.n(v),R=t(6),A=t.n(R),b=t(2),C=t.n(b),y=t(7),w=t.n(y),L=(t(59),t(31)),D=t.n(L),x=t(0),H=t.n(x),P=t(22),N=t(14),S=t(9),U=t(12),j=t(17),V=t(108),I=t(228),F=t(126),K=t(111),M=t(51),q=t(11),B=(t(647),t(287)),W=t.n(B),Q=(t(85),t(39)),G=t.n(Q),J=(t(207),t(1406)),z=t(135),X=(t(62),t(41),t(16)),Y=t.n(X),Z=(t(84),t(44)),$=t.n(Z),ee=(t(50),t(18)),ae=t.n(ee),te=ae.a.Item,re=$.a.Group,ne=function(e){function a(){return O()(this,a),C()(this,(a.__proto__||f()(a)).apply(this,arguments))}return w()(a,e),A()(a,[{key:"render",value:function(){var e=this.props,a=e.form,t=e.currentPage,r=a.getFieldDecorator;return H.a.createElement("div",{style:{padding:"60px"}},H.a.createElement(ae.a,null,H.a.createElement(te,i()({},q.q,{label:"任务名称",hasFeedback:!0}),r("name",{rules:[{required:!0,message:"任务名称不可为空！"},{max:64,message:"任务名称不得超过64个字符！"}],initialValue:t?t.name:""})(H.a.createElement(Y.a,null))),H.a.createElement(te,i()({},q.q,{label:"任务类型"}),r("taskType",{rules:[],initialValue:t?t.taskType:0})(H.a.createElement(re,{disabled:!0},H.a.createElement($.a,{value:0},"SQL任务"),H.a.createElement($.a,{value:1},"MR任务")))),H.a.createElement(te,i()({},q.q,{label:"资源",hasFeedback:!0}),t&&t.resourceList&&t.resourceList.length>0?t.resourceList[0].resourceName:""),H.a.createElement(te,i()({},q.q,{label:"mainClass"}),r("mainClass",{rules:[{}],initialValue:t&&t.mainClass})(H.a.createElement(Y.a,{placeholder:"请输入mainClass"}))),H.a.createElement(te,i()({},q.q,{label:"参数"}),r("exeArgs",{rules:[{}],initialValue:t&&t.exeArgs})(H.a.createElement(Y.a,{placeholder:"请输入任务参数"}))),H.a.createElement(te,i()({},q.q,{label:"描述",hasFeedback:!0}),r("taskDesc",{rules:[],initialValue:t?t.taskDesc:""})(H.a.createElement(Y.a,{type:"textarea",rows:4})))))}}]),a}(x.Component),se=function(e,a){var t=e.dispatch,r=e.currentPage,n=!1;""===a.name&&(n=!0),a.invalid=n;var s=m()(r,a);t(F.g(s)),t(F.h(s))},ie=ae.a.create({onValuesChange:se})(ne),ce=ie,oe=ce,le=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(te,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js"),__REACT_HOT_LOADER__.register(re,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js"),__REACT_HOT_LOADER__.register(ne,"MrEditor","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js"),__REACT_HOT_LOADER__.register(se,"taskValueChange","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js"),__REACT_HOT_LOADER__.register(ie,"wrappedForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js"),__REACT_HOT_LOADER__.register(ce,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/mrEditor.js")),function(e){function a(){return O()(this,a),C()(this,(a.__proto__||f()(a)).apply(this,arguments))}return w()(a,e),A()(a,[{key:"render",value:function(){var e=this.props,a=e.currentPage,t=e.editorChange,r=e.editorFocus,n=e.editorFocusOut,s=a.taskType===q.m.SQL?H.a.createElement(z.a,{key:"main-editor-"+a.id,value:a.sqlText,sync:a.merged||void 0,onFocus:r,focusOut:n,onChange:t}):H.a.createElement(oe,this.props);return H.a.createElement("div",{className:"editor-container"},s)}}]),a}(x.Component)),_e=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(le,"EditorContainer","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/editorContainer.js"),t(43),t(15)),ue=t.n(_e),de=ue.a.Option,pe=function(e){function a(){var e,t,r,n;O()(this,a);for(var s=arguments.length,i=Array(s),c=0;c<s;c++)i[c]=arguments[c];return t=r=C()(this,(e=a.__proto__||f()(a)).call.apply(e,[this].concat(i))),r.state={visibleAlterRes:!1,resList:[]},r.handleChange=function(){var e;return(e=r).__handleChange__REACT_HOT_LOADER__.apply(e,arguments)},r.alterRes=function(){var e;return(e=r).__alterRes__REACT_HOT_LOADER__.apply(e,arguments)},n=t,C()(r,n)}return w()(a,e),A()(a,[{key:"componentWillReceiveProps",value:function(e){var a=e.currentPage,t=this.props.currentPage;if(a.id!==t.id){var r=a.resourceList.length>0?a.resourceList.map(function(e){return e.id}):[];this.setState({resList:r})}}},{key:"__handleChange__REACT_HOT_LOADER__",value:function(e){this.setState({resList:e})}},{key:"__alterRes__REACT_HOT_LOADER__",value:function(){var e=this,a=this.props.currentPage,t=this.state.resList;0!==(t=Array.isArray(t)?t:[t]).length?a&&a.id&&t.length>0&&j.a.updateTaskRes({id:a.id,resources:t}).then(function(t){1===t.code&&(T.a.success("资源修改成功！"),e.reloadTask(a.id),e.setState({visibleAlterRes:!1,resList:[]}))}):T.a.info("您没有选择任何资源！")}},{key:"reloadTask",value:function(e){var a=this.props.dispatch;j.a.getTask({taskId:e}).then(function(e){1===e.code&&(a(F.g(e.data)),a(F.h(e.data)))})}},{key:"render",value:function(){var e=this,a=this.state,t=a.visibleAlterRes,r=a.resList,s=this.props,i=s.resources,c=s.currentPage,l=c.resourceList&&c.resourceList.map(function(e){return H.a.createElement(k.a,{key:e.id,color:"blue"},e.resourceName)}),_=i&&i.map(function(e){return H.a.createElement(de,{value:e.id,key:e.id,name:e.resourceName},e.resourceName)});return H.a.createElement(n.a,{className:"task-info"},H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"任务名称："),H.a.createElement(o.a,{span:"14"},c.name)),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"任务类型："),H.a.createElement(o.a,{span:"14"},0===c.taskType?"SQL任务":"MR任务")),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"资源："),H.a.createElement(o.a,{span:"14",style:{marginTop:"10px"}},l)),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"创建人员："),H.a.createElement(o.a,{span:"14"},c.createUserName)),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"创建时间："),H.a.createElement(o.a,{span:"14"},U.a.formatDateTime(c.gmtCreate))),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"最近修改时间："),H.a.createElement(o.a,{span:"14"},U.a.formatDateTime(c.gmtModified))),H.a.createElement(n.a,null,H.a.createElement(o.a,{span:"10",className:"txt-right"},"描述："),H.a.createElement(o.a,{span:"14"},c.taskDesc)),H.a.createElement(D.a,{title:"修改任务资源",wrapClassName:"vertical-center-modal",visible:t,onCancel:function(){e.setState({visibleAlterRes:!1})},onOk:this.alterRes},H.a.createElement(ue.a,{mode:0===c.taskType?"multiple":"",style:{width:"100%"},showSearch:!0,value:r,placeholder:"请选择资源",optionFilterProp:"name",onChange:this.handleChange},_)))}}]),a}(x.Component),me=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(de,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/taskDetail.js"),__REACT_HOT_LOADER__.register(pe,"TaskDetail","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/taskDetail.js")),G.a.TabPane),Ee=D.a.confirm,ke=function(e){function a(){var e,t,r,n;O()(this,a);for(var s=arguments.length,i=Array(s),c=0;c<s;c++)i[c]=arguments[c];return t=r=C()(this,(e=a.__proto__||f()(a)).call.apply(e,[this].concat(i))),r.state={selected:"",expanded:!1},r.onChange=function(){var e;return(e=r).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},r.onEdit=function(){var e;return(e=r).__onEdit__REACT_HOT_LOADER__.apply(e,arguments)},r.mapPanels=function(){var e;return(e=r).__mapPanels__REACT_HOT_LOADER__.apply(e,arguments)},r.tabClick=function(){var e;return(e=r).__tabClick__REACT_HOT_LOADER__.apply(e,arguments)},r.unLock=function(){var e;return(e=r).__unLock__REACT_HOT_LOADER__.apply(e,arguments)},r.handleCustomParamsChange=function(){var e;return(e=r).__handleCustomParamsChange__REACT_HOT_LOADER__.apply(e,arguments)},n=t,C()(r,n)}return w()(a,e),A()(a,[{key:"__onChange__REACT_HOT_LOADER__",value:function(e){var a=this.props,t=a.dispatch,r=a.pages,n=parseInt(e,10),s=r&&r.find(function(e){return e.id===n});s&&t(F.g(s))}},{key:"__onEdit__REACT_HOT_LOADER__",value:function(e,a){var t=this.props,r=t.pages,n=t.currentPage,s=t.dispatch;switch(a){case"remove":n.notSynced?Ee({title:"部分任务修改尚未同步到服务器，是否强制关闭 ?",content:"强制关闭将丢弃这些修改数据",onOk:function(){s(F.b(parseInt(e,10),r,n))},onCancel:function(){}}):s(F.b(parseInt(e,10),r,n))}}},{key:"__mapPanels__REACT_HOT_LOADER__",value:function(e){return e&&e.length>0?e.map(function(e){var a=H.a.createElement("span",null,H.a.createElement(J.a,{notSynced:e.notSynced}),e.name);return H.a.createElement(me,{style:{height:"0px"},tab:a,key:e.id})}):[]}},{key:"__tabClick__REACT_HOT_LOADER__",value:function(e){var a=this.state,t=a.selected,r=a.expanded;e===t&&r?(this.setState({selected:"",expanded:!1}),this.SideBench.style.width="30px"):e!==t&&(this.SideBench.style.width="500px",this.setState({selected:e,expanded:!0}))}},{key:"__unLock__REACT_HOT_LOADER__",value:function(){var e=this.props,a=e.currentPage,t=e.dispatch,r=a.readWriteLockVO;Ee({title:"解锁提醒",content:"文件正在被"+r.lastKeepLockUserName+"编辑中，开始编辑时间\n                "+U.a.formatDateTime(r.gmtModified)+"。\n                强制编辑可能导致"+r.lastKeepLockUserName+"对该文件的修改无法保存！\n            ",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){var e={fileId:a.id,type:q.e.STREAM_TASK,lockVersion:r.version};j.a.unlockFile(e).then(function(e){if(1===e.code){var r=e.data;r.getLock?T.a.success("文件解锁成功！"):D.a.error({title:"解锁失败",content:"文件正在被"+r.lastKeepLockUserName+"编辑中!开始编辑时间\n                                "+U.a.formatDateTime(r.gmtModified)+"."});var n={id:a.id};j.a.getTask(n).then(function(e){if(1===e.code){var r=e.data;r.merged=!0;var n={id:a.id,readWriteLockVO:r.readWriteLockVO};t(F.g(r)),t(Object(K.e)(n))}})}})},onCancel:function(){}})}},{key:"renderLock",value:function(e){return e.readWriteLockVO&&!e.readWriteLockVO.getLock?H.a.createElement("div",{className:"lock-layer"},H.a.createElement(W.a,{style:{position:"absolute",top:"10px",left:"35%",zIndex:"999"},showIcon:!0,message:H.a.createElement("span",null,"当前文件为只读状态！",H.a.createElement("a",{onClick:this.unLock},"解锁")),type:"warning"})):null}},{key:"__handleCustomParamsChange__REACT_HOT_LOADER__",value:function(e){var a=this.props,t=a.currentPage,r=a.dispatch,n=m()(t,e);r(F.g(n))}},{key:"render",value:function(){var e=this,a=this.props,t=a.currentPage,r=a.pages,s=a.router,i=a.editorFocus,c=a.editorFocusOut,o=a.editorParamsChange;0===r.length&&s.push("/realtime");var l=this.mapPanels(r);return H.a.createElement(n.a,{className:"task-browser"},H.a.createElement("div",{className:"browser-content"},H.a.createElement(G.a,{hideAdd:!0,onTabClick:this.onChange,activeKey:""+t.id,type:"editable-card",className:"browser-tabs",onEdit:this.onEdit},l),this.renderLock(t),H.a.createElement(le,this.props),H.a.createElement("div",{className:"m-siderbench bd-left",ref:function(a){e.SideBench=a}},H.a.createElement(G.a,{activeKey:this.state.selected,type:"card",className:"task-params",tabPosition:"right",onTabClick:this.tabClick},H.a.createElement(me,{tab:H.a.createElement("span",{className:"title-vertical"},"任务详情"),key:"params1"},H.a.createElement(pe,this.props)),H.a.createElement(me,{tab:H.a.createElement("span",{className:"title-vertical"},"环境参数"),key:"params2"},H.a.createElement(z.a,{key:"params-editor",options:q.x,onFocus:i,focusOut:c,value:t.taskParams,onChange:o}))))))}}]),a}(x.Component),he=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(me,"TabPane","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/taskBrowser.js"),__REACT_HOT_LOADER__.register(Ee,"confirm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/taskBrowser.js"),__REACT_HOT_LOADER__.register(ke,"TaskBrowser","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/taskBrowser.js")),D.a.confirm),Te=function(e){function a(){var e,t,r,n;O()(this,a);for(var s=arguments.length,i=Array(s),c=0;c<s;c++)i[c]=arguments[c];return t=r=C()(this,(e=a.__proto__||f()(a)).call.apply(e,[this].concat(i))),r.saveTask=function(){var e;return(e=r).__saveTask__REACT_HOT_LOADER__.apply(e,arguments)},r.editorChange=function(){var e;return(e=r).__editorChange__REACT_HOT_LOADER__.apply(e,arguments)},r.debounceChange=Object(S.debounce)(r.editorChange,300,{maxWait:2e3}),r.editorParamsChange=function(){var e;return(e=r).__editorParamsChange__REACT_HOT_LOADER__.apply(e,arguments)},r.startTask=function(){var e;return(e=r).__startTask__REACT_HOT_LOADER__.apply(e,arguments)},r.loadTreeData=function(){var e;return(e=r).__loadTreeData__REACT_HOT_LOADER__.apply(e,arguments)},n=t,C()(r,n)}return w()(a,e),A()(a,[{key:"componentDidMount",value:function(){}},{key:"__saveTask__REACT_HOT_LOADER__",value:function(){var e=this.props,a=e.currentPage,t=e.dispatch,r=a.resourceList;r&&r.length>0&&(a.resourceIdList=r.map(function(e){return e.id})),a.lockVersion=a.readWriteLockVO.version,j.a.saveTask(a).then(function(e){var r=function(e){T.a.success("任务保存成功"),e.notSynced=!1,t(F.g(e)),a.taskType===q.m.MR&&t(K.a({id:e.parentId,catalogueType:q.f.TASK}))};if(1===e.code){var n=e.data.readWriteLockVO,s=n.result;0===s?r(e.data):1===s?he({title:"锁定提醒",content:H.a.createElement("span",null,"文件正在被",n.lastKeepLockUserName,"编辑中，开始编辑时间为",U.a.formatDateTime(n.gmtModified),"。 强制保存可能导致",n.lastKeepLockUserName,"对文件的修改无法正常保存！"),okText:"确定保存",okType:"danger",cancelText:"取消",onOk:function(){j.a.forceUpdateTask(a).then(function(e){1===e.code&&r(e.data)})}}):2===s&&he({title:"保存警告",content:H.a.createElement("span",null,"文件已经被",n.lastKeepLockUserName,"编辑过，编辑时间为",U.a.formatDateTime(n.gmtModified),"。 点击确认按钮会",H.a.createElement(k.a,{color:"orange"},"覆盖"),"您本地的代码，请您提前做好备份！"),okText:"确定覆盖",okType:"danger",cancelText:"取消",onOk:function(){var e={id:a.id,lockVersion:n.version};j.a.getTask(e).then(function(e){if(1===e.code){var a=e.data;a.merged=!0,r(a)}})}})}})}},{key:"__editorChange__REACT_HOT_LOADER__",value:function(e,a){var t=this.props,r=t.currentPage,n=t.dispatch;e!==a&&(r.sqlText=a,r.notSynced=!0,n(F.g(r)))}},{key:"__editorParamsChange__REACT_HOT_LOADER__",value:function(e,a){var t=this.props,r=t.currentPage,n=t.dispatch;e!==a&&(r.taskParams=a,n(F.g(r)))}},{key:"__startTask__REACT_HOT_LOADER__",value:function(){var e=this.props,a=e.currentPage,t=e.dispatch;j.a.startTask({id:a.id,isRestoration:0}).then(function(e){1===e.code&&(a.status=10,t(F.g(m()({},a))),T.a.success("任务已经成功提交！"))})}},{key:"autoSaveTask",value:function(){var e=this;this.timerID=setInterval(function(){if("edit"===e.state.editorState){var a=e.props.currentPage;j.a.saveTask(a).then(function(e){1===e.code&&T.a.success("任务已自动保存")})}},3e4)}},{key:"__loadTreeData__REACT_HOT_LOADER__",value:function(e){var a=this.props.dispatch,t=e.props.data;return new d.a(function(e){a(K.a(t)),e()})}},{key:"render",value:function(){var e=this.props,a=e.dispatch,t=e.currentPage;t.status;return H.a.createElement(n.a,{className:"task-editor"},H.a.createElement("header",{className:"toolbar bd-bottom clear"},H.a.createElement(o.a,{className:"left"},H.a.createElement(_.a,{onClick:function(){a(I.a(M.b.ADD_TASK_VISIBLE))},title:"创建任务"},H.a.createElement(V.a,{className:"my-icon",type:"focus"})," 新建任务"),H.a.createElement(_.a,{disabled:t.invalid,onClick:this.saveTask,title:"保存任务"},H.a.createElement(V.a,{className:"my-icon",type:"save"}),"保存")),H.a.createElement(o.a,{className:"right"},H.a.createElement(N.c,{to:"/operation/realtime?tname="+t.name},H.a.createElement(_.a,null,H.a.createElement(V.a,{className:"my-icon",type:"goin"})," 运维")))),H.a.createElement(ke,i()({},this.props,{ayncTree:this.loadTreeData,editorParamsChange:this.editorParamsChange,editorChange:this.debounceChange})))}}]),a}(x.Component),ge=Object(P.b)(function(e){var a=e.realtimeTask,t=a.resources,r=a.pages;return{currentPage:a.currentPage,pages:r,resources:t}})(Te);a.default=ge,"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(he,"confirm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/index.js"),__REACT_HOT_LOADER__.register(Te,"TaskIndex","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/index.js"),__REACT_HOT_LOADER__.register(ge,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/realtime/index.js"))}}]);