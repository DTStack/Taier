(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1410:function(e,t,a){var n=a(1409),r=(a(374),-1),i=1,s=0;!function(e){"use strict";var t=e.Pos,a="http://www.w3.org/2000/svg";function l(e,t){this.mv=e,this.type=t,this.classes="left"==t?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function o(t){t.diffOutOfDate&&(t.diff=L(t.orig.getValue(),t.edit.getValue(),t.mv.options.ignoreWhitespace),t.chunks=x(t.diff),t.diffOutOfDate=!1,e.signal(t.edit,"updateDiff",t.diff))}l.prototype={constructor:l,init:function(t,a,n){this.edit=this.mv.edit,(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this),this.orig=e(t,P({value:a,readOnly:!this.mv.options.allowEditingOriginals},P(n))),"align"==this.mv.options.connect&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new G(this.edit)),this.orig.state.trackAlignable=new G(this.orig)),this.orig.state.diffViews=[this];var r=n.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(r)&&(r=[r]),this.classes.classLocation=r,this.diff=L(D(a),D(n.value),this.mv.options.ignoreWhitespace),this.chunks=x(this.diff),this.diffOutOfDate=this.dealigned=!1,this.needsScrollSync=null,this.showDifferences=!1!==n.showDifferences},registerEvents:function(t){this.forceUpdate=function(t){var a,n={from:0,to:0,marked:[]},s={from:0,to:0,marked:[]},l=!1;function _(e){c=!0,l=!1,"full"==e&&(t.svg&&j(t.svg),t.copyButtons&&j(t.copyButtons),m(t.edit,n.marked,t.classes),m(t.orig,s.marked,t.classes),n.from=n.to=s.from=s.to=0),o(t),t.showDifferences&&(h(t.edit,t.diff,n,i,t.classes),h(t.orig,t.diff,s,r,t.classes)),"align"==t.mv.options.connect&&v(t),g(t),null!=t.needsScrollSync&&u(t,t.needsScrollSync),c=!1}function p(e){c||(t.dealigned=!0,d(e))}function d(e){c||l||(clearTimeout(a),!0===e&&(l=!0),a=setTimeout(_,!0===e?20:250))}function f(e,a){t.diffOutOfDate||(t.diffOutOfDate=!0,n.from=n.to=s.from=s.to=0),p(a.text.length-1!=a.to.line-a.from.line)}function E(){t.diffOutOfDate=!0,t.dealigned=!0,_("full")}return t.edit.on("change",f),t.orig.on("change",f),t.edit.on("swapDoc",E),t.orig.on("swapDoc",E),"align"==t.mv.options.connect&&(e.on(t.edit.state.trackAlignable,"realign",p),e.on(t.orig.state.trackAlignable,"realign",p)),t.edit.on("viewportChange",function(){d(!1)}),t.orig.on("viewportChange",function(){d(!1)}),_(),_}(this),p(this,!0,!1),function(e,t){e.edit.on("scroll",function(){u(e,!0)&&g(e)}),e.orig.on("scroll",function(){u(e,!1)&&g(e),t&&u(t,!0)&&g(t)})}(this,t)},setShowDifferences:function(e){(e=!1!==e)!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}};var c=!1;function u(e,t){if(e.diffOutOfDate)return e.lockScroll&&null==e.needsScrollSync&&(e.needsScrollSync=t),!1;if(e.needsScrollSync=null,!e.lockScroll)return!0;var a,n,r=+new Date;if(t?(a=e.edit,n=e.orig):(a=e.orig,n=e.edit),a.state.scrollSetBy==e&&(a.state.scrollSetAt||0)+250>r)return!1;var i=a.getScrollInfo();if("align"==e.mv.options.connect)f=i.top;else{var s,l,o=.5*i.clientHeight,c=i.top+o,u=a.lineAtHeight(c,"local"),p=function(e,t,a){for(var n,r,i,s,l=0;l<e.length;l++){var o=e[l],c=a?o.editFrom:o.origFrom,u=a?o.editTo:o.origTo;null==r&&(c>t?(r=o.editFrom,s=o.origFrom):u>t&&(r=o.editTo,s=o.origTo)),u<=t?(n=o.editTo,i=o.origTo):c<=t&&(n=o.editFrom,i=o.origFrom)}return{edit:{before:n,after:r},orig:{before:i,after:s}}}(e.chunks,u,t),d=_(a,t?p.edit:p.orig),m=_(n,t?p.orig:p.edit),h=(c-d.top)/(d.bot-d.top),f=m.top-o+h*(m.bot-m.top);if(f>i.top&&(l=i.top/o)<1)f=f*l+i.top*(1-l);else if((s=i.height-i.clientHeight-i.top)<o){var E=n.getScrollInfo(),g=E.height-E.clientHeight-f;g>s&&(l=s/o)<1&&(f=f*l+(E.height-E.clientHeight-s)*(1-l))}}return n.scrollTo(i.left,f),n.state.scrollSetAt=r,n.state.scrollSetBy=e,!0}function _(e,t){var a=t.after;return null==a&&(a=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(a,"local")}}function p(e,t,a){e.lockScroll=t,t&&0!=a&&u(e,i)&&g(e),e.lockButton.innerHTML=t?"⇛⇚":"⇛&nbsp;&nbsp;⇚"}function d(e,t,a){for(var n=a.classLocation,r=0;r<n.length;r++)e.removeLineClass(t,n[r],a.chunk),e.removeLineClass(t,n[r],a.start),e.removeLineClass(t,n[r],a.end)}function m(t,a,n){for(var r=0;r<a.length;++r){var i=a[r];i instanceof e.TextMarker?i.clear():i.parent&&d(t,i,n)}a.length=0}function h(e,t,a,n,r){var i=e.getViewport();e.operation(function(){a.from==a.to||i.from-a.to>20||a.from-i.to>20?(m(e,a.marked,r),E(e,t,n,a.marked,i.from,i.to,r),a.from=i.from,a.to=i.to):(i.from<a.from&&(E(e,t,n,a.marked,i.from,a.from,r),a.from=i.from),i.to>a.to&&(E(e,t,n,a.marked,a.to,i.to,r),a.to=i.to))})}function f(e,t,a,n,r,i){for(var s=a.classLocation,l=e.getLineHandle(t),o=0;o<s.length;o++)n&&e.addLineClass(l,s[o],a.chunk),r&&e.addLineClass(l,s[o],a.start),i&&e.addLineClass(l,s[o],a.end);return l}function E(e,a,n,i,l,o,c){var u=t(0,0),_=t(l,0),p=e.clipPos(t(o-1)),d=n==r?c.del:c.insert;function m(t,a){for(var n=Math.max(l,t),r=Math.min(o,a),s=n;s<r;++s)i.push(f(e,s,c,!0,s==t,s==a-1));t==a&&n==a&&r==a&&(n?i.push(f(e,n-1,c,!1,!1,!0)):i.push(f(e,n,c,!1,!0,!1)))}for(var h=0,E=!1,g=0;g<a.length;++g){var k=a[g],y=k[0],b=k[1];if(y==s){var v=u.line+(N(a,g)?0:1);q(u,b);var T=u.line+(H(a,g)?1:0);T>v&&(E&&(m(h,v),E=!1),h=T)}else if(E=!0,y==n){var C=q(u,b,!0),O=Y(_,u),A=z(p,C);Q(O,A)||i.push(e.markText(O,A,{className:d})),u=C}}E&&m(h,u.line+1)}function g(e){if(e.showDifferences){if(e.svg){j(e.svg);var t=e.gap.offsetWidth;U(e.svg,"width",t,"height",e.gap.offsetHeight)}e.copyButtons&&j(e.copyButtons);for(var a=e.edit.getViewport(),n=e.orig.getViewport(),r=e.mv.wrap.getBoundingClientRect().top,i=r-e.edit.getScrollerElement().getBoundingClientRect().top+e.edit.getScrollInfo().top,s=r-e.orig.getScrollerElement().getBoundingClientRect().top+e.orig.getScrollInfo().top,l=0;l<e.chunks.length;l++){var o=e.chunks[l];o.editFrom<=a.to&&o.editTo>=a.from&&o.origFrom<=n.to&&o.origTo>=n.from&&O(e,o,s,i,t)}}}function k(e,t){for(var a=0,n=0,r=0;r<t.length;r++){var i=t[r];if(i.editTo>e&&i.editFrom<=e)return null;if(i.editFrom>e)break;a=i.editTo,n=i.origTo}return n+(e-a)}function y(e,t,a){for(var n=e.state.trackAlignable,r=e.firstLine(),i=0,s=[],l=0;;l++){for(var o=t[l],c=o?a?o.origFrom:o.editFrom:1e9;i<n.alignable.length;i+=2){var u=n.alignable[i]+1;if(!(u<=r)){if(!(u<=c))break;s.push(u)}}if(!o)break;s.push(r=a?o.origTo:o.editTo)}return s}function b(e,t,a,n){var r=0,i=0,s=0,l=0;e:for(;;r++){var o=e[r],c=t[i];if(!o&&null==c)break;for(var u=o?o[0]:1e9,_=null==c?1e9:c;s<a.length;){var p=a[s];if(p.origFrom<=_&&p.origTo>_){i++,r--;continue e}if(p.editTo>u){if(p.editFrom<=u)continue e;break}l+=p.origTo-p.origFrom-(p.editTo-p.editFrom),s++}if(u==_-l)o[n]=_,i++;else if(u<_-l)o[n]=u+l;else{var d=[_-l,null,null];d[n]=_,e.splice(r,0,d),i++}}}function v(e,t){if(e.dealigned||t){if(!e.orig.curOp)return e.orig.operation(function(){v(e,t)});e.dealigned=!1;var a=e.mv.left==e?e.mv.right:e.mv.left;a&&(o(a),a.dealigned=!1);for(var n=function(e,t){var a=y(e.edit,e.chunks,!1),n=[];if(t)for(var r=0,i=0;r<t.chunks.length;r++){for(var s=t.chunks[r].editTo;i<a.length&&a[i]<s;)i++;i!=a.length&&a[i]==s||a.splice(i++,0,s)}for(var r=0;r<a.length;r++)n.push([a[r],null,null]);return b(n,y(e.orig,e.chunks,!0),e.chunks,1),t&&b(n,y(t.orig,t.chunks,!0),t.chunks,2),n}(e,a),r=e.mv.aligners,i=0;i<r.length;i++)r[i].clear();r.length=0;var s=[e.edit,e.orig],l=[];a&&s.push(a.orig);for(var i=0;i<s.length;i++)l.push(s[i].getScrollInfo().top);for(var c=0;c<n.length;c++)T(s,n[c],r);for(var i=0;i<s.length;i++)s[i].scrollTo(null,l[i])}}function T(e,t,a){for(var n=0,r=[],i=0;i<e.length;i++)if(null!=t[i]){var s=e[i].heightAtLine(t[i],"local");r[i]=s,n=Math.max(n,s)}for(var i=0;i<e.length;i++)if(null!=t[i]){var l=n-r[i];l>1&&a.push(C(e[i],t[i],l))}}function C(e,t,a){var n=!0;t>e.lastLine()&&(t--,n=!1);var r=document.createElement("div");return r.className="CodeMirror-merge-spacer",r.style.height=a+"px",r.style.minWidth="1px",e.addLineWidget(t,r,{height:a,above:n,mergeSpacer:!0,handleMouseEvents:!0})}function O(e,t,n,r,i){var s="left"==e.type,l=e.orig.heightAtLine(t.origFrom,"local",!0)-n;if(e.svg){var o=l,c=e.edit.heightAtLine(t.editFrom,"local",!0)-r;if(s){var u=o;o=c,c=u}var _=e.orig.heightAtLine(t.origTo,"local",!0)-n,p=e.edit.heightAtLine(t.editTo,"local",!0)-r;if(s){var u=_;_=p,p=u}var d=" C "+i/2+" "+c+" "+i/2+" "+o+" "+(i+2)+" "+o,m=" C "+i/2+" "+_+" "+i/2+" "+p+" -1 "+p;U(e.svg.appendChild(document.createElementNS(a,"path")),"d","M -1 "+c+d+" L "+(i+2)+" "+_+m+" z","class",e.classes.connect)}if(e.copyButtons){var h=e.copyButtons.appendChild(V("div","left"==e.type?"⇝":"⇜","CodeMirror-merge-copy")),f=e.mv.options.allowEditingOriginals;if(h.title=f?"Push to left":"Revert chunk",h.chunk=t,h.style.top=(t.origTo>t.origFrom?l:e.edit.heightAtLine(t.editFrom,"local")-r)+"px",f){var E=e.edit.heightAtLine(t.editFrom,"local")-r,g=e.copyButtons.appendChild(V("div","right"==e.type?"⇝":"⇜","CodeMirror-merge-copy-reverse"));g.title="Push to right",g.chunk={editFrom:t.origFrom,editTo:t.origTo,origFrom:t.editFrom,origTo:t.editTo},g.style.top=E+"px","right"==e.type?g.style.left="2px":g.style.right="2px"}}}function A(e,a,n,r){if(!e.diffOutOfDate){var i=r.origTo>n.lastLine()?t(r.origFrom-1):t(r.origFrom,0),s=t(r.origTo,0),l=r.editTo>a.lastLine()?t(r.editFrom-1):t(r.editFrom,0),o=t(r.editTo,0),c=e.mv.options.revertChunk;c?c(e.mv,n,i,s,a,l,o):a.replaceRange(n.getRange(i,s),l,o)}}var R=e.MergeView=function(t,a){if(!(this instanceof R))return new R(t,a);this.options=a;var n=a.origLeft,r=null==a.origRight?a.orig:a.origRight,i=null!=n,s=null!=r,o=1+(i?1:0)+(s?1:0),c=[],u=this.left=null,_=this.right=null,p=this;if(i){u=this.left=new l(this,"left");var d=V("div",null,"CodeMirror-merge-pane CodeMirror-merge-left");c.push(d),c.push(w(u))}var m=V("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");if(c.push(m),s){_=this.right=new l(this,"right"),c.push(w(_));var h=V("div",null,"CodeMirror-merge-pane CodeMirror-merge-right");c.push(h)}(s?h:m).className+=" CodeMirror-merge-pane-rightmost",c.push(V("div",null,null,"height: 0; clear: both;"));var f=this.wrap=t.appendChild(V("div",c,"CodeMirror-merge CodeMirror-merge-"+o+"pane"));this.edit=e(m,P(a)),u&&u.init(d,n,a),_&&_.init(h,r,a),a.collapseIdentical&&this.editor().operation(function(){!function(e,t){"number"!=typeof t&&(t=2);for(var a=[],n=e.editor(),r=n.firstLine(),i=r,s=n.lastLine();i<=s;i++)a.push(!0);e.left&&I(e.left,t,r,a),e.right&&I(e.right,t,r,a);for(var l=0;l<a.length;l++)if(a[l]){for(var o=l+r,c=1;l<a.length-1&&a[l+1];l++,c++);if(c>t){var u=[{line:o,cm:n}];e.left&&u.push({line:k(o,e.left.chunks),cm:e.left.orig}),e.right&&u.push({line:k(o,e.right.chunks),cm:e.right.orig});var _=M(c,u);e.options.onCollapse&&e.options.onCollapse(e,o,c,_)}}}(p,a.collapseIdentical)}),"align"==a.connect&&(this.aligners=[],v(this.left||this.right,!0)),u&&u.registerEvents(_),_&&_.registerEvents(u);var E=function(){u&&g(u),_&&g(_)};e.on(window,"resize",E);var y=setInterval(function(){for(var t=f.parentNode;t&&t!=document.body;t=t.parentNode);t||(clearInterval(y),e.off(window,"resize",E))},5e3)};function w(t){var n=t.lockButton=V("div",null,"CodeMirror-merge-scrolllock");n.title="Toggle locked scrolling";var r=V("div",[n],"CodeMirror-merge-scrolllock-wrap");e.on(n,"click",function(){p(t,!t.lockScroll)});var i=[r];if(!1!==t.mv.options.revertButtons&&(t.copyButtons=V("div",null,"CodeMirror-merge-copybuttons-"+t.type),e.on(t.copyButtons,"click",function(e){var a=e.target||e.srcElement;a.chunk&&("CodeMirror-merge-copy-reverse"!=a.className?A(t,t.edit,t.orig,a.chunk):A(t,t.orig,t.edit,a.chunk))}),i.unshift(t.copyButtons)),"align"!=t.mv.options.connect){var s=document.createElementNS&&document.createElementNS(a,"svg");s&&!s.createSVGRect&&(s=null),t.svg=s,s&&i.push(s)}return t.gap=V("div",i,"CodeMirror-merge-gap")}function D(e){return"string"==typeof e?e:e.getValue()}R.prototype={constructor:R,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)},rightChunks:function(){if(this.right)return o(this.right),this.right.chunks},leftChunks:function(){if(this.left)return o(this.left),this.left.chunks}};var S=new n;function L(e,t,a){for(var n=S.diff_main(e,t),r=0;r<n.length;++r){var i=n[r];(a?/[^ \t]/.test(i[1]):i[1])?r&&n[r-1][0]==i[0]&&(n.splice(r--,1),n[r][1]+=i[1]):n.splice(r--,1)}return n}function x(e){for(var a=[],n=0,r=0,l=t(0,0),o=t(0,0),c=0;c<e.length;++c){var u=e[c],_=u[0];if(_==s){var p=!N(e,c)||l.line<n||o.line<r?1:0,d=l.line+p,m=o.line+p;q(l,u[1],null,o);var h=H(e,c)?1:0,f=l.line+h,E=o.line+h;f>d&&(c&&a.push({origFrom:r,origTo:m,editFrom:n,editTo:d}),n=f,r=E)}else q(_==i?l:o,u[1])}return(n<=l.line||r<=o.line)&&a.push({origFrom:r,origTo:o.line+1,editFrom:n,editTo:l.line+1}),a}function H(e,t){if(t==e.length-1)return!0;var a=e[t+1][1];return!(1==a.length&&t<e.length-2||10!=a.charCodeAt(0))&&(t==e.length-2||((a=e[t+2][1]).length>1||t==e.length-3)&&10==a.charCodeAt(0))}function N(e,t){if(0==t)return!0;var a=e[t-1][1];return 10==a.charCodeAt(a.length-1)&&(1==t||10==(a=e[t-2][1]).charCodeAt(a.length-1))}function F(a,n,r){a.addLineClass(n,"wrap","CodeMirror-merge-collapsed-line");var i=document.createElement("span");i.className="CodeMirror-merge-collapsed-widget",i.title="Identical text collapsed. Click to expand.";var s=a.markText(t(n,0),t(r-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:i,clearOnEnter:!0});function l(){s.clear(),a.removeLineClass(n,"wrap","CodeMirror-merge-collapsed-line")}return e.on(i,"click",l),{mark:s,clear:l}}function M(e,t){var a=[];function n(){for(var e=0;e<a.length;e++)a[e].clear()}for(var r=0;r<t.length;r++){var i=t[r],s=F(i.cm,i.line,i.line+e);a.push(s),s.mark.on("clear",n)}return a[0].mark}function I(e,t,a,n){for(var r=0;r<e.chunks.length;r++)for(var i=e.chunks[r],s=i.editFrom-t;s<i.editTo+t;s++){var l=s+a;l>=0&&l<n.length&&(n[l]=!1)}}function V(e,t,a,n){var r=document.createElement(e);if(a&&(r.className=a),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var i=0;i<t.length;++i)r.appendChild(t[i]);return r}function j(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)}function U(e){for(var t=1;t<arguments.length;t+=2)e.setAttribute(arguments[t],arguments[t+1])}function P(e,t){for(var a in t||(t={}),e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}function q(e,a,n,r){for(var i=n?t(e.line,e.ch):e,s=0;;){var l=a.indexOf("\n",s);if(-1==l)break;++i.line,r&&++r.line,s=l+1}return i.ch=(s?0:i.ch)+(a.length-s),r&&(r.ch=(s?0:r.ch)+(a.length-s)),i}var B=1,K=2,W=4;function G(e){this.cm=e,this.alignable=[],this.height=e.doc.height;var t=this;e.on("markerAdded",function(e,a){if(a.collapsed){var n=a.find(1);null!=n&&t.set(n.line,W)}}),e.on("markerCleared",function(e,a,n,r){null!=r&&a.collapsed&&t.check(r,W,t.hasMarker)}),e.on("markerChanged",this.signal.bind(this)),e.on("lineWidgetAdded",function(e,a,n){a.mergeSpacer||(a.above?t.set(n-1,K):t.set(n,B))}),e.on("lineWidgetCleared",function(e,a,n){a.mergeSpacer||(a.above?t.check(n-1,K,t.hasWidgetBelow):t.check(n,B,t.hasWidget))}),e.on("lineWidgetChanged",this.signal.bind(this)),e.on("change",function(e,a){var n=a.from.line,r=a.to.line-a.from.line,i=a.text.length-1,s=n+i;(r||i)&&t.map(n,r,i),t.check(s,W,t.hasMarker),(r||i)&&t.check(a.from.line,W,t.hasMarker)}),e.on("viewportChange",function(){t.cm.doc.height!=t.height&&t.signal()})}function z(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t}function Y(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t}function Q(e,t){return e.line==t.line&&e.ch==t.ch}function J(e,t,a){for(var n=e.length-1;n>=0;n--){var r=e[n],i=(a?r.origTo:r.editTo)-1;if(i<t)return i}}function $(e,t,a){for(var n=0;n<e.length;n++){var r=e[n],i=a?r.origFrom:r.editFrom;if(i>t)return i}}function X(t,a){var n=null,r=t.state.diffViews,i=t.getCursor().line;if(r)for(var s=0;s<r.length;s++){var l=r[s],c=t==l.orig;o(l);var u=a<0?J(l.chunks,i,c):$(l.chunks,i,c);null==u||null!=n&&!(a<0?u>n:u<n)||(n=u)}if(null==n)return e.Pass;t.setCursor(n,0)}G.prototype={signal:function(){e.signal(this,"realign"),this.height=this.cm.doc.height},set:function(e,t){for(var a=-1;a<this.alignable.length;a+=2){var n=this.alignable[a]-e;if(0==n){if((this.alignable[a+1]&t)==t)return;return this.alignable[a+1]|=t,void this.signal()}if(n>0)break}this.signal(),this.alignable.splice(a,0,e,t)},find:function(e){for(var t=0;t<this.alignable.length;t+=2)if(this.alignable[t]==e)return t;return-1},check:function(e,t,a){var n=this.find(e);if(-1!=n&&this.alignable[n+1]&t&&!a.call(this,e)){this.signal();var r=this.alignable[n+1]&~t;r?this.alignable[n+1]=r:this.alignable.splice(n,2)}},hasMarker:function(e){var t=this.cm.getLineHandle(e);if(t.markedSpans)for(var a=0;a<t.markedSpans.length;a++)if(t.markedSpans[a].mark.collapsed&&null!=t.markedSpans[a].to)return!0;return!1},hasWidget:function(e){var t=this.cm.getLineHandle(e);if(t.widgets)for(var a=0;a<t.widgets.length;a++)if(!t.widgets[a].above&&!t.widgets[a].mergeSpacer)return!0;return!1},hasWidgetBelow:function(e){if(e==this.cm.lastLine())return!1;var t=this.cm.getLineHandle(e+1);if(t.widgets)for(var a=0;a<t.widgets.length;a++)if(t.widgets[a].above&&!t.widgets[a].mergeSpacer)return!0;return!1},map:function(e,t,a){for(var n=a-t,r=e+t,i=-1,s=-1,l=0;l<this.alignable.length;l+=2){var o=this.alignable[l];o==e&&this.alignable[l+1]&K&&(i=l),o==r&&this.alignable[l+1]&K&&(s=l),o<=e||(o<r?this.alignable.splice(l--,2):this.alignable[l]+=n)}if(i>-1){var c=this.alignable[i+1];c==K?this.alignable.splice(i,2):this.alignable[i+1]=c&~K}s>-1&&a&&this.set(e+a,K)}},e.commands.goNextDiff=function(e){return X(e,1)},e.commands.goPrevDiff=function(e){return X(e,-1)}}(a(374))},870:function(e,t,a){"use strict";a.r(t);a(69);var n=a(30),r=a.n(n),i=(a(57),a(23)),s=a.n(i),l=(a(75),a(27)),o=a.n(l),c=a(9),u=a.n(c),_=a(4),p=a.n(_),d=a(6),m=a.n(d),h=a(3),f=a.n(h),E=a(8),g=a.n(E),k=a(0),y=a.n(k),b=a(24),v=a(11),T=a(25),C=a(103),O=(a(592),a(334)),A=a.n(O),R=(a(36),a(14)),w=a.n(R),D=a(209),S=a.n(D),L=(a(47),a(20)),x=a.n(L),H=a(7),N=a.n(H),F=(a(215),a(92)),M=a.n(F),I=(a(49),a(21)),V=a.n(I),j=(a(132),a(34)),U=a.n(j),P=(a(53),a(19)),q=a.n(P),B=(a(64),a(35)),K=a.n(B),W=(a(81),a(38)),G=a.n(W),z=a(13),Y=a(213),Q=a.n(Y),J=a(10),$=a(16),X=a(12),Z=a(727),ee=(a(548),a(369)),te=a.n(ee),ae=(a(376),a(129)),ne=a.n(ae),re=a(26),ie=a.n(re),se=(a(54),a(28)),le=a.n(se),oe=(a(85),a(48)),ce=a.n(oe),ue=(a(44),a(17)),_e=a.n(ue),pe=a(42),de=a.n(pe),me=a(590),he=a(180),fe=q.a.Item,Ee=_e.a.Option,ge=ce.a.Group,ke=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.getTableList=function(){return a.__getTableList__REACT_HOT_LOADER__.apply(a,arguments)},a.validatePath=function(){return a.__validatePath__REACT_HOT_LOADER__.apply(a,arguments)},a.state={tableList:[],showPreview:!1,dataSource:[],columns:[]},a}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.sourceMap.sourceId;e&&this.getTableList(e)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"__getTableList__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.props.sourceMap;(!a.type||a.type.type!==X.b.HDFS&&a.type.type!==X.b.FTP)&&this.setState({tableList:[],showPreview:!1},function(){$.a.getOfflineTableList({sourceId:e,isSys:!1}).then(function(e){1===e.code&&t.setState({tableList:e.data||[]})})})}},{key:"getTableColumn",value:function(e){var t=this.props,a=t.form,n=t.handleTableColumnChange,r=this.props.sourceMap;if(!r.type||r.type.type!==X.b.HBASE){var i=a.getFieldValue("sourceId");$.a.getOfflineTableColumn({sourceId:i,tableName:e}).then(function(e){1===e.code&&n(e.data)})}}},{key:"getDataObjById",value:function(e){return this.props.dataSourceList.filter(function(t){return t.id==e})[0]}},{key:"changeSource",value:function(e){var t=this,a=this.props.handleSourceChange;setTimeout(function(){t.getTableList(e)},0),a(this.getDataObjById(e))}},{key:"changeTable",value:function(e){this.getTableColumn(e),this.submitForm(),this.setState({showPreview:!1})}},{key:"__validatePath__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props,r=n.handleTableColumnChange,i=n.form.getFieldValue,s=i("sourceId");"orc"===i("fileType")?$.a.getOfflineTableColumn({sourceId:s,tableName:t}).then(function(e){1===e.code&&(r(e.data),a()),a("该路径无效！")}):a()}},{key:"submitForm",value:function(){var e=this,t=this.props,a=t.updateTaskFields,n=t.form,r=t.handleSourceMapChange,i=t.currentTab,s=(t.sourceMap,t.taskCustomParams);this.timerID=setTimeout(function(){var t=n.getFieldsValue();for(var l in t)""===t[l]&&delete t[l];if(t.where){var o=Object(he.c)(s,t.where);o.length>0&&a({id:i,taskVariables:o})}if(t.partition){var c=Object(he.c)(s,t.partition);c.length>0&&a({id:i,taskVariables:c})}var u=de()(t,{src:e.getDataObjById(t.sourceId)});r(u)},0)}},{key:"next",value:function(e){var t=this.props,a=t.form,n=(t.handleSourceMapChange,t.sourceMap),r=null;n.type&&n.type.type===X.b.HDFS&&(r=["sourceId","path","fileType"],"text"===n.type.fileType&&r.push("encoding")),a.validateFieldsAndScroll(r,{force:!0},function(t,a){t||e.call(null,1)})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.sourceMap,r=a.dataSourceList,i=a.navtoStep,l=a.isCurrentTabNew;return y.a.createElement("div",{className:"g-step1"},y.a.createElement(q.a,null,y.a.createElement(fe,N()({},X.q,{label:"数据源"}),t("sourceId",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(n)?"":""+n.sourceId})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeSource.bind(this),disabled:!l,optionFilterProp:"name"},r.map(function(e){return y.a.createElement(Ee,{key:e.id,name:e.dataName,value:""+e.id},e.dataName,"( ",X.n[e.type]," )")})))),this.renderDynamicForm()),y.a.createElement("div",{className:"m-datapreview",style:{width:"90%",margin:"0 auto",overflow:"auto"}},y.a.createElement("p",{style:{cursor:"pointer",marginBottom:10}},y.a.createElement("a",{href:"javascript:void(0)",onClick:this.loadPreview.bind(this),disabled:Object(v.isEmpty)(n)||n.type.type===X.b.HDFS||n.type.type===X.b.HBASE},"数据预览",this.state.showPreview?y.a.createElement(s.a,{type:"up"}):y.a.createElement(s.a,{type:"down"}))),this.state.showPreview?y.a.createElement(le.a,{dataSource:this.state.dataSource,columns:this.state.columns,scroll:{x:200*this.state.columns.length},pagination:!1,bordered:!1}):null),!this.props.readonly&&y.a.createElement("div",{className:"steps-action"},y.a.createElement(V.a,{type:"primary",onClick:function(){return e.next(i)}},"下一步")))}},{key:"loadPreview",value:function(){var e=this,t=this.state.showPreview,a=this.props.form,n=a.getFieldValue("sourceId"),r=a.getFieldValue("table");n&&r?t?this.setState({showPreview:!1}):$.a.getDataPreview({sourceId:n,tableName:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList,i=n.map(function(e){return{title:e,dataIndex:e,key:e}}),s=r.map(function(e,t){for(var a={},r=0;r<e.length;r++)a.key=t,a[n[r]]=e[r];return a});e.setState({columns:i,dataSource:s,showPreview:!0})}}):w.a.error("数据源或表名缺失")}},{key:"renderDynamicForm",value:function(){var e,t=this.props.form.getFieldDecorator,a=this.props,n=a.sourceMap,r=(a.dataSourceList,a.isCurrentTabNew),i=n.type&&n.type.fileType||"text",s=void 0;if(Object(v.isEmpty)(n))return null;switch(n.type.type){case X.b.MYSQL:case X.b.ORACLE:case X.b.SQLSERVER:s=[y.a.createElement(fe,N()({},X.q,{label:"表名",key:"table"}),t("table",{rules:[{required:!0,message:"数据源表为必选项！"}],initialValue:Object(v.isEmpty)(n)?"":n.type.table})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!r,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Ee,{key:"rdb-"+e,value:e},e)})))),y.a.createElement(fe,N()({},X.q,{label:"数据过滤",key:"where"}),t("where",{rules:[{max:1e3,message:"过滤语句不可超过1000个字符!"}],initialValue:Object(v.isEmpty)(n)?"":n.type.where})(y.a.createElement(x.a,{type:"textarea",placeholder:"请参考相关SQL语法填写where过滤语句（不要填写where关键字）。该过滤语句通常用作增量同步",onChange:this.submitForm.bind(this)})),y.a.createElement(me.a,{doc:"dataFilterDoc"})),y.a.createElement(fe,N()({},X.q,{label:"切分键",key:"splitPK"}),t("splitPK",{rules:[],initialValue:Object(v.isEmpty)(n)?"":n.splitPK})(y.a.createElement(x.a,{type:"text",placeholder:"根据配置的字段进行数据分片，实现并发读取",onChange:this.submitForm.bind(this)})),y.a.createElement(me.a,{doc:"switchKey"}))];break;case X.b.HIVE:s=[y.a.createElement(fe,N()({},X.q,{label:"表名",key:"table"}),t("table",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(n)?"":n.type.table})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!r,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Ee,{key:"rdb-"+e,value:e},e)})))),y.a.createElement(fe,N()({},X.q,{label:"分区",key:"partition"}),t("partition",{rules:[],initialValue:Object(v.isEmpty)(n)?"":n.type.partition})(y.a.createElement(x.a,(e={placeholder:"请填写分区"},ie()(e,"placeholder","pt=${bdp.system.bizdate};"),ie()(e,"onChange",this.submitForm.bind(this)),e))),y.a.createElement(me.a,{doc:"partitionDesc"}))];break;case X.b.HDFS:s=[y.a.createElement(fe,N()({},X.q,{label:"路径",key:"path"}),t("path",{rules:[{required:!0,message:"路径不得为空！"},{max:200,message:"路径不得超过200个字符！"},{validator:this.validatePath}],validateTrigger:"onSubmit",initialValue:Object(v.isEmpty)(n)?"":n.type.path})(y.a.createElement(x.a,{placeholder:"例如: /rdos/batch",onChange:this.submitForm.bind(this)})),y.a.createElement(me.a,{doc:"hdfsPath"})),y.a.createElement(fe,N()({},X.q,{label:"文件类型",key:"fileType"}),t("fileType",{rules:[{required:!0}],initialValue:n.type&&n.type.fileType?n.type.fileType:"text"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Ee,{value:"orc"},"orc"),y.a.createElement(Ee,{value:"text"},"text")))),y.a.createElement(fe,N()({},X.q,{label:"编码",key:"encoding",style:{display:"text"===i?"block":"none"}}),t("encoding",{rules:[{required:!0}],initialValue:n.type&&n.type.encoding?n.type.encoding:"utf-8"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Ee,{value:"utf-8"},"utf-8"),y.a.createElement(Ee,{value:"gbk"},"gbk")))),y.a.createElement(fe,N()({},X.q,{style:{display:"text"===i?"block":"none"},label:"分隔符",key:"fieldDelimiter"}),t("fieldDelimiter",{rules:[],initialValue:Object(v.isEmpty)(n)?",":n.type.fieldDelimiter})(y.a.createElement(x.a,{placeholder:"若不填写，则默认为\\001",onChange:this.submitForm.bind(this)})))];break;case X.b.HBASE:s=[y.a.createElement(fe,N()({},X.q,{label:"表名",key:"table"}),t("table",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(n)?"":n.type.table})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!r,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Ee,{key:"hbase-"+e,value:e},e)})))),y.a.createElement(fe,N()({},X.q,{label:"编码",key:"encoding"}),t("encoding",{rules:[{required:!0}],initialValue:n.type&&n.type.encoding?n.type.encoding:"utf-8"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Ee,{value:"utf-8"},"utf-8"),y.a.createElement(Ee,{value:"gbk"},"gbk")))),y.a.createElement(fe,N()({},X.q,{label:"开始行健",key:"startRowkey"}),t("startRowkey",{rules:[],initialValue:n.type&&n.type.startRowkey?n.type.startRowkey:""})(y.a.createElement(x.a,{placeholder:"startRowkey",onChange:this.submitForm.bind(this)}))),y.a.createElement(fe,N()({},X.q,{label:"结束行健",key:"endRowkey"}),t("endRowkey",{rules:[],initialValue:n.type&&n.type.endRowkey?n.type.endRowkey:""})(y.a.createElement(x.a,{placeholder:"endRowkey",onChange:this.submitForm.bind(this)}))),y.a.createElement(fe,N()({},X.q,{className:"txt-left",label:"行健二进制转换",key:"isBinaryRowkey"}),t("isBinaryRowkey",{rules:[],initialValue:n.type&&n.type.isBinaryRowkey?n.type.isBinaryRowkey:"0"})(y.a.createElement(ge,{onChange:this.submitForm.bind(this)},y.a.createElement(ce.a,{value:"0",style:{float:"left"}},"FALSE"),y.a.createElement(ce.a,{value:"1",style:{float:"left"}},"TRUE")))),y.a.createElement(fe,N()({},X.q,{label:"每次RPC请求获取行数",key:"scanCacheSize"}),t("scanCacheSize",{rules:[],initialValue:n.type&&n.type.scanCacheSize?n.type.scanCacheSize:""})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"请输入大小, 默认为256",type:"number",min:0,suffix:"行"}))),y.a.createElement(fe,N()({},X.q,{label:"每次RPC请求获取列数",key:"scanBatchSize"}),t("scanBatchSize",{rules:[],initialValue:n.type&&n.type.scanBatchSize?n.type.scanBatchSize:""})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"请输入大小, 默认为100",type:"number",min:0,suffix:"列"})))];break;case X.b.FTP:s=[y.a.createElement(fe,N()({},X.q,{label:"路径",key:"path"}),t("path",{rules:[{required:!0,message:"路径不得为空！"},{max:200,message:"路径不得超过200个字符！"},{validator:this.validatePath}],validateTrigger:"onSubmit",initialValue:Object(v.isEmpty)(n)?"":n.type.path})(y.a.createElement(x.a,{placeholder:"例如: /rdos/batch",onChange:this.submitForm.bind(this)}))),y.a.createElement(fe,N()({},X.q,{label:"编码",key:"encoding",style:{display:"text"===i?"block":"none"}}),t("encoding",{rules:[{required:!0,message:"必须选择一种编码！"}],initialValue:n.type&&n.type.encoding?n.type.encoding:"utf-8"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Ee,{value:"utf-8"},"utf-8"),y.a.createElement(Ee,{value:"gbk"},"gbk")))),y.a.createElement(fe,N()({},X.q,{style:{display:"text"===i?"block":"none"},label:"分隔符",key:"fieldDelimiter"}),t("fieldDelimiter",{rules:[{required:!0,message:"分隔符不可为空！"}],initialValue:Object(v.isEmpty)(n)?",":n.type.fieldDelimiter})(y.a.createElement(x.a,{placeholder:"\\001",onChange:this.submitForm.bind(this)})))]}return s}}]),t}(y.a.Component),ye=q.a.create()(ke),be=function(e){function t(e){return p()(this,t),f()(this,(t.__proto__||u()(t)).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){return y.a.createElement("div",null,y.a.createElement(ye,this.props))}}]),t}(y.a.Component),ve=function(e){var t=e.offlineTask,a=t.dataSync,n=t.workbench;return{isCurrentTabNew:n.isCurrentTabNew,currentTab:n.currentTab,sourceMap:a.sourceMap,dataSourceList:a.dataSourceList,taskCustomParams:n.taskCustomParams}},Te=function(e){return{handleSourceChange:function(t){e({type:T.b.RESET_SOURCE_MAP}),e({type:T.b.RESET_KEYMAP}),e({type:T.j.DATA_SOURCE_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},handleSourceMapChange:function(t){e({type:T.j.DATA_SOURCEMAP_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},handleTableColumnChange:function(t){e({type:T.j.SOURCE_TABLE_COLUMN_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},updateTaskFields:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t})}}},Ce=Object(b.b)(ve,Te)(be),Oe=Ce,Ae=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(fe,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(Ee,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(ge,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(ke,"SourceForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(ye,"SourceFormWrap","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(be,"Source","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(ve,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(Te,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js"),__REACT_HOT_LOADER__.register(Ce,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/source.js")),q.a.Item),Re=_e.a.Option,we=ce.a.Group,De=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.getTableList=function(){return a.__getTableList__REACT_HOT_LOADER__.apply(a,arguments)},a.getTableColumn=function(){return a.__getTableColumn__REACT_HOT_LOADER__.apply(a,arguments)},a.state={tableList:[]},a}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.targetMap.sourceId;e&&this.getTableList(e)}},{key:"__getTableList__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.props.targetMap;if(a.type&&(a.type.type===X.b.HDFS||a.type.type===X.b.FTP))return!0;t.setState({tableList:[]},function(){$.a.getOfflineTableList({sourceId:e,isSys:!1}).then(function(e){1===e.code&&t.setState({tableList:e.data})})})}},{key:"__getTableColumn__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.handleTableColumnChange,r=t.targetMap,i=a.getFieldValue("sourceId");if(r.type&&r.type.type===X.b.HBASE)return!0;$.a.getOfflineTableColumn({sourceId:i,tableName:e}).then(function(e){1===e.code&&n(e.data)})}},{key:"getDataObjById",value:function(e){return this.props.dataSourceList.filter(function(t){return t.id==e})[0]}},{key:"changeSource",value:function(e){var t=this,a=this.props.handleSourceChange;setTimeout(function(){t.getTableList(e)},0),a(this.getDataObjById(e))}},{key:"changeTable",value:function(e){this.getTableColumn(e),this.submitForm()}},{key:"submitForm",value:function(){var e=this,t=this.props,a=t.taskCustomParams,n=t.updateTaskFields,r=t.form,i=t.handleTargetMapChange,s=t.currentTab;setTimeout(function(){var t=r.getFieldsValue(),l=t.preSql+" "+t.postSql;if(l){var o=Object(he.c)(a,l);o.length>0&&n({id:s,taskVariables:o})}if(t.partition){var c=Object(he.c)(a,t.partition);c.length>0&&n({id:s,taskVariables:c})}var u=de()(t,{src:e.getDataObjById(t.sourceId)});i(u)},0)}},{key:"prev",value:function(e){e.call(null,0)}},{key:"next",value:function(e){var t=this.props,a=t.form;t.handleTargetMapChange;a.validateFields(function(t,a){t||e.call(null,2)})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.targetMap,r=(a.sourceMap,a.dataSourceList),i=a.navtoStep,s=a.isCurrentTabNew;return y.a.createElement("div",{className:"g-step2"},y.a.createElement(q.a,null,y.a.createElement(Ae,N()({},X.q,{label:"数据同步目标"}),t("sourceId",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(n)?"":""+n.sourceId})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeSource.bind(this),disabled:!s,optionFilterProp:"name"},r.map(function(e){return y.a.createElement(Re,{key:e.id,name:e.dataName,value:""+e.id},e.dataName,"( ",X.n[e.type]," )")})))),this.renderDynamicForm()),!this.props.readonly&&y.a.createElement("div",{className:"steps-action"},y.a.createElement(V.a,{style:{marginRight:8},onClick:function(){return e.prev(i)}},"上一步"),y.a.createElement(V.a,{type:"primary",onClick:function(){return e.next(i)}},"下一步")))}},{key:"renderDynamicForm",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.targetMap,n=(t.dataSourceList,t.isCurrentTabNew),r=void 0;if(Object(v.isEmpty)(a))return null;switch(a.type.type){case X.b.MYSQL:case X.b.ORACLE:case X.b.SQLSERVER:r=[y.a.createElement(Ae,N()({},X.q,{label:"表名",key:"table"}),e("table",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(a)?"":a.type.table})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!n,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Re,{key:"rdb-target-"+e,value:e},e)})))),y.a.createElement(Ae,N()({},X.q,{label:"导入前准备语句",key:"preSql"}),e("preSql",{rules:[],initialValue:Object(v.isEmpty)(a)?"":a.type.preSql})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"请输入导入数据前执行的SQL脚本",type:"textarea"}))),y.a.createElement(Ae,N()({},X.q,{label:"导入后准备语句",key:"postSql"}),e("postSql",{rules:[],initialValue:Object(v.isEmpty)(a)?"":a.type.postSql})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"请输入导入数据后执行的SQL脚本",type:"textarea"}))),y.a.createElement(Ae,N()({},X.q,{label:"主键冲突",key:"writeMode",className:"txt-left"}),e("writeMode",{rules:[{required:!0}],initialValue:a.type&&a.type.writeMode?a.type.writeMode:"replace"})(y.a.createElement(we,{onChange:this.submitForm.bind(this)},y.a.createElement(ce.a,{value:"replace",style:{float:"left"}},"替换原有数据（Replace Into）"),y.a.createElement(ce.a,{value:"insert",style:{float:"left"}},"视为脏数据，保留原有数据（Insert Into）"))))];break;case X.b.HIVE:r=[y.a.createElement(Ae,N()({},X.q,{label:"表名",key:"table"}),e("table",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(a)?"":a.type.table})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!n,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Re,{key:"rdb-target-"+e,value:e},e)})))),y.a.createElement(Ae,N()({},X.q,{label:"分区",key:"partition"}),e("partition",{rules:[],initialValue:Object(v.isEmpty)(a)?"":a.type.partition})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"pt=${bdp.system.bizdate};"})),y.a.createElement(me.a,{doc:"partitionDesc"})),y.a.createElement(Ae,N()({},X.q,{label:"写入模式",key:"writeMode",className:"txt-left"}),e("writeMode",{rules:[{required:!0}],initialValue:a.type&&a.type.writeMode?a.type.writeMode:"replace"})(y.a.createElement(we,{onChange:this.submitForm.bind(this)},y.a.createElement(ce.a,{value:"replace",style:{float:"left"}},"覆盖（Insert Overwrite）"),y.a.createElement(ce.a,{value:"insert",style:{float:"left"}},"追加（Insert Into）"))))];break;case X.b.HDFS:r=[y.a.createElement(Ae,N()({},X.q,{label:"路径",key:"path"}),e("path",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(a)?"":a.type.path})(y.a.createElement(x.a,{placeholder:"例如: /rdos/batch",onChange:this.submitForm.bind(this)}))),y.a.createElement(Ae,N()({},X.q,{label:"分隔符",key:"fieldDelimiter"}),e("fieldDelimiter",{rules:[],initialValue:Object(v.isEmpty)(a)?",":a.type.fieldDelimiter})(y.a.createElement(x.a,{placeholder:"例如: 目标为hive则 分隔符为\\001",onChange:this.submitForm.bind(this)}))),y.a.createElement(Ae,N()({},X.q,{label:"编码",key:"encoding"}),e("encoding",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(a)||!a.type.encoding?"utf-8":a.type.encoding})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Re,{value:"utf-8"},"utf-8"),y.a.createElement(Re,{value:"gbk"},"gbk")))),y.a.createElement(Ae,N()({},X.q,{label:"文件名",key:"fileName"}),e("fileName",{rules:[{required:!0}],initialValue:Object(v.isEmpty)(a)?"":a.type.fileName})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this)}))),y.a.createElement(Ae,N()({},X.q,{label:"文件类型",key:"fileType"}),e("fileType",{rules:[{required:!0}],initialValue:a.type&&a.type.fileType?a.type.fileType:"orc"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Re,{value:"orc"},"orc"),y.a.createElement(Re,{value:"text"},"text")))),y.a.createElement(Ae,N()({},X.q,{label:"写入模式",className:"txt-left",key:"writeMode"}),e("writeMode",{rules:[{required:!0}],initialValue:a.type&&a.type.writeMode?a.type.writeMode:"APPEND"})(y.a.createElement(we,{onChange:this.submitForm.bind(this)},y.a.createElement(ce.a,{value:"APPEND",style:{float:"left"}},"追加新数据"),y.a.createElement(ce.a,{value:"NONCONFLICT",style:{float:"left"}},"覆盖老数据"))))];break;case X.b.HBASE:r=[y.a.createElement(Ae,N()({},X.q,{label:"表名",key:"table"}),e("table",{rules:[{required:!0}],initialValue:a.type&&a.type.table?a.type.table:""})(y.a.createElement(_e.a,{showSearch:!0,onChange:this.changeTable.bind(this),disabled:!n,optionFilterProp:"value"},this.state.tableList.map(function(e){return y.a.createElement(Re,{key:"hbase-target-"+e,value:e},e)})))),y.a.createElement(Ae,N()({},X.q,{label:"编码",key:"encoding"}),e("encoding",{rules:[{required:!0}],initialValue:a.type&&a.type.encoding?a.type.encoding:"utf-8"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Re,{value:"utf-8"},"utf-8"),y.a.createElement(Re,{value:"gbk"},"gbk")))),y.a.createElement(Ae,N()({},X.q,{label:"读取为空时的处理方式",key:"nullMode",className:"txt-left"}),e("nullMode",{rules:[{required:!0,message:"请选择为空时的处理方式!"}],initialValue:a.type&&a.type.nullMode?a.type.nullMode:"skip"})(y.a.createElement(we,{onChange:this.submitForm.bind(this)},y.a.createElement(ce.a,{value:"skip",style:{float:"left"}},"SKIP"),y.a.createElement(ce.a,{value:"empty",style:{float:"left"}},"EMPTY")))),y.a.createElement(Ae,N()({},X.q,{label:"写入缓存大小",key:"writeBufferSize"}),e("writeBufferSize",{rules:[],initialValue:Object(v.isEmpty)(a)?"":a.type.writeBufferSize})(y.a.createElement(x.a,{onChange:this.submitForm.bind(this),placeholder:"请输入缓存大小",type:"number",min:0,suffix:"KB"})))];break;case X.b.FTP:r=[y.a.createElement(Ae,N()({},X.q,{label:"路径",key:"path"}),e("path",{rules:[{required:!0,message:"路径不得为空！"},{max:200,message:"路径不得超过200个字符！"},{validator:this.validatePath}],validateTrigger:"onSubmit",initialValue:Object(v.isEmpty)(a)?"":a.type.path})(y.a.createElement(x.a,{placeholder:"例如: /rdos/batch",onChange:this.submitForm.bind(this)}))),y.a.createElement(Ae,N()({},X.q,{label:"编码",key:"encoding"}),e("encoding",{rules:[{required:!0}],initialValue:a.type&&a.type.encoding?a.type.encoding:"utf-8"})(y.a.createElement(_e.a,{onChange:this.submitForm.bind(this)},y.a.createElement(Re,{value:"utf-8"},"utf-8"),y.a.createElement(Re,{value:"gbk"},"gbk")))),y.a.createElement(Ae,N()({},X.q,{label:"分隔符",key:"fieldDelimiter"}),e("fieldDelimiter",{rules:[],initialValue:Object(v.isEmpty)(a)?",":a.type.fieldDelimiter})(y.a.createElement(x.a,{placeholder:"若不填写，则默认为\\001",onChange:this.submitForm.bind(this)})))]}return r}}]),t}(y.a.Component),Se=q.a.create()(De),Le=function(e){function t(e){return p()(this,t),f()(this,(t.__proto__||u()(t)).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){return y.a.createElement("div",null,y.a.createElement(Se,this.props))}}]),t}(y.a.Component),xe=function(e){var t=e.offlineTask,a=t.dataSync,n=t.workbench,r=n.isCurrentTabNew;return{currentTab:n.currentTab,isCurrentTabNew:r,targetMap:a.targetMap,sourceMap:a.sourceMap,dataSourceList:a.dataSourceList,taskCustomParams:n.taskCustomParams}},He=function(e){return{handleSourceChange:function(t){e({type:T.b.RESET_TARGET_MAP}),e({type:T.b.RESET_KEYMAP}),e({type:T.m.DATA_SOURCE_TARGET_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},handleTargetMapChange:function(t){e({type:T.m.DATA_TARGETMAP_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},handleTableColumnChange:function(t){e({type:T.m.TARGET_TABLE_COLUMN_CHANGE,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})},updateTaskFields:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t})}}},Ne=Object(b.b)(xe,He)(Le),Fe=Ne,Me=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ae,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(Re,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(we,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(De,"TargetForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(Se,"TargetFormWrap","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(Le,"Target","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(xe,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(He,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js"),__REACT_HOT_LOADER__.register(Ne,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/target.js")),a(82)),Ie=a.n(Me),Ve=(a(109),a(59)),je=a.n(Ve),Ue=a(198),Pe=a.n(Ue),qe=a(193),Be=a(854),Ke=a(117),We=(a(339),a(121)),Ge=a.n(We),ze=q.a.Item,Ye=_e.a.Option,Qe=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.columnFamily=function(){var e;return(e=n).__columnFamily__REACT_HOT_LOADER__.apply(e,arguments)},n.renderFormItems=function(){var e;return(e=n).__renderFormItems__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"shouldComponentUpdate",value:function(e){return this.props!==e}},{key:"__columnFamily__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return y.a.createElement(Ye,{value:e},e)})}},{key:"__renderFormItems__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.keyModal,a=e.dataType,n=e.sourceColumnFamily,r=e.targetColumnFamily,i=t.isReader,s=(t.fileType,t.editField),l=this.props.form.getFieldDecorator;if(i)switch(a){case X.b.FTP:case X.b.HDFS:return[y.a.createElement(ze,N()({},X.q,{label:"索引值",key:"index"}),l("index",{rules:[{required:!0,type:"integer"}],initialValue:s&&s.index||""})(y.a.createElement(Ge.a,{style:{width:"100%"},min:0}))),y.a.createElement(ze,N()({},X.q,{label:"选择类型",key:"type"}),l("type",{rules:[{required:!0}],initialValue:s&&s.type||"STRING"})(y.a.createElement(_e.a,null,y.a.createElement(Ye,{value:"STRING"},"STRING"),y.a.createElement(Ye,{value:"LONG"},"LONG"),y.a.createElement(Ye,{value:"BOOLEAN"},"BOOLEAN"),y.a.createElement(Ye,{value:"DOUBLE"},"DOUBLE"),y.a.createElement(Ye,{value:"DATE"},"DATE"))))];case X.b.HBASE:var o=s&&"rowkey"===s.key;return[y.a.createElement(ze,N()({},X.q,{label:"列名",key:"key"}),l("key",{rules:[{required:!0,type:"string"}],initialValue:s&&s.key||""})(y.a.createElement(x.a,{style:{width:"100%"},disabled:o}))),y.a.createElement(ze,N()({},X.q,{label:"列族",key:"cf"}),l("cf",{rules:[{required:!0}],initialValue:s&&s.cf||""})(y.a.createElement(_e.a,{placeHolder:"请选择列族",disabled:o},this.columnFamily(n)))),y.a.createElement(ze,N()({},X.q,{label:"选择类型",key:"type"}),l("type",{rules:[{required:!0}],initialValue:s&&s.type||"STRING"})(y.a.createElement(_e.a,null,y.a.createElement(Ye,{value:"STRING"},"STRING"),y.a.createElement(Ye,{value:"BOOLEAN"},"BOOLEAN"),y.a.createElement(Ye,{value:"SHORT"},"SHORT"),y.a.createElement(Ye,{value:"INT"},"INT"),y.a.createElement(Ye,{value:"LONG"},"LONG"),y.a.createElement(Ye,{value:"FLOAT"},"FLOAT"),y.a.createElement(Ye,{value:"DOUBLE"},"DOUBLE"))))]}else switch(a){case X.b.FTP:case X.b.HDFS:return[y.a.createElement(ze,N()({},X.q,{label:"选择类型",key:"type"}),l("type",{rules:[{required:!0}],initialValue:s&&s.type||"STRING"})(y.a.createElement(_e.a,null,y.a.createElement(Ye,{value:"STRING"},"STRING"),y.a.createElement(Ye,{value:"BIGINT"},"BIGINT"),y.a.createElement(Ye,{value:"TIMESTAMP"},"TIMESTAMP"),y.a.createElement(Ye,{value:"VARCHAR"},"VARCHAR"),y.a.createElement(Ye,{value:"CHAR"},"CHAR"),y.a.createElement(Ye,{value:"TINYINT"},"TINYINT"),y.a.createElement(Ye,{value:"SMALLINT"},"SMALLINT"),y.a.createElement(Ye,{value:"DECIMAL"},"DECIMAL"),y.a.createElement(Ye,{value:"INT"},"INT"),y.a.createElement(Ye,{value:"FLOAT"},"FLOAT"),y.a.createElement(Ye,{value:"DOUBLE"},"DOUBLE"),y.a.createElement(Ye,{value:"DATE"},"DATE")))),y.a.createElement(ze,N()({},X.q,{label:"字段名",key:"keyName"}),l("key",{rules:[{required:!0}],initialValue:s&&s.key||""})(y.a.createElement(x.a,null)))];case X.b.HBASE:return[y.a.createElement(ze,N()({},X.q,{label:"列名",key:"key"}),l("key",{rules:[{required:!0,type:"string"}],initialValue:s&&s.key||""})(y.a.createElement(x.a,{style:{width:"100%"}}))),y.a.createElement(ze,N()({},X.q,{label:"列族",key:"cf"}),l("cf",{rules:[{required:!0}],initialValue:s&&s.cf||""})(y.a.createElement(_e.a,{placeHolder:"请选择列族"},this.columnFamily(r)))),y.a.createElement(ze,N()({},X.q,{label:"选择类型",key:"type"}),l("type",{rules:[{required:!0}],initialValue:s&&s.type||"STRING"})(y.a.createElement(_e.a,null,y.a.createElement(Ye,{value:"STRING"},"STRING"),y.a.createElement(Ye,{value:"BOOLEAN"},"BOOLEAN"),y.a.createElement(Ye,{value:"SHORT"},"SHORT"),y.a.createElement(Ye,{value:"INT"},"INT"),y.a.createElement(Ye,{value:"LONG"},"LONG"),y.a.createElement(Ye,{value:"FLOAT"},"FLOAT"),y.a.createElement(Ye,{value:"DOUBLE"},"DOUBLE"))))]}return[]}},{key:"render",value:function(){return y.a.createElement(q.a,null,this.renderFormItems())}}]),t}(y.a.Component),Je=q.a.create()(Qe),$e=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.submit=function(){var e;return(e=n).__submit__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__submit__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.onOk;this.Form.validateFields(function(a,n){a?t(null,a):(setTimeout(function(){e.Form.resetFields()},200),console.log("KeyMapModal: ",n),t(n))})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){(0,this.props.onCancel)(),this.Form.resetFields()}},{key:"render",value:function(){var e=this,t=this.props,a=t.title,n=t.visible,r=t.keyModal,i=t.dataType,s=t.sourceColumnFamily,l=t.targetColumnFamily;return y.a.createElement(K.a,{title:a,visible:n,onOk:this.submit,onCancel:this.cancel},y.a.createElement(Je,{sourceColumnFamily:s,targetColumnFamily:l,dataType:i,keyModal:r,ref:function(t){return e.Form=t}}))}}]),t}(y.a.Component),Xe=$e,Ze=Xe,et=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ze,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js"),__REACT_HOT_LOADER__.register(Ye,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js"),__REACT_HOT_LOADER__.register(Qe,"KeyForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js"),__REACT_HOT_LOADER__.register(Je,"KeyFormWrapper","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js"),__REACT_HOT_LOADER__.register($e,"KeyMapModal","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js"),__REACT_HOT_LOADER__.register(Xe,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/keymapModal.js")),function(){return y.a.createElement("span",null,y.a.createElement("b",null,"STRING"),",",y.a.createElement("b",null,"VARCHAR"),",",y.a.createElement("b",null,"CHAR"),",",y.a.createElement("b",null,"TINYINT"),",",y.a.createElement("b",null,"SMALLINT"),",",y.a.createElement("b",null,"DECIMAL"),",",y.a.createElement("br",null),y.a.createElement("b",null,"INT"),",",y.a.createElement("b",null,"BIGINT"),",",y.a.createElement("b",null,"FLOAT"),",",y.a.createElement("b",null,"DOUBLE"),",",y.a.createElement("b",null,"TIMESTAMP"),",",y.a.createElement("b",null,"DATE"))});function tt(e){var t=e.title,a=e.desc,n=e.visible,r=e.onOk,i=e.placeholder,s=e.value,l=e.onCancel,o=e.onChange,c=e.columnFamily;return y.a.createElement(K.a,{title:t,onOk:r,onCancel:l,visible:n},y.a.createElement("p",null,"批量导入的语法格式：",y.a.createElement("b",{style:{color:"rgb(255, 102, 0)"}},a)),y.a.createElement("p",null,"常用数据类型：",y.a.createElement("span",{style:{color:"rgb(255, 102, 0)"}},et())),c?y.a.createElement("p",null,"已有列族：",y.a.createElement("span",{style:{color:"rgb(255, 102, 0)"}},c.map(function(e){return e+","}))):"",y.a.createElement("br",null),y.a.createElement(x.a,{type:"textarea",rows:6,value:s,onChange:o,placeholder:i}))}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(et,"renderHDFSTypes","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/batchModal.js"),__REACT_HOT_LOADER__.register(tt,"BatchModal","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/batchModal.js"));var at=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={constValue:""},n.onChange=function(){var e;return(e=n).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},n.submit=function(){var e;return(e=n).__submit__REACT_HOT_LOADER__.apply(e,arguments)},n.close=function(){var e;return(e=n).__close__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__onChange__REACT_HOT_LOADER__",value:function(e){this.setState({constValue:e.target.value})}},{key:"__submit__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.onOk,a=e.onCancel,n=J.a.trim(this.state.constValue);""!==n?t&&(t({type:"string",key:n,value:n}),a()):w.a.error("常量字段不可为空！")}},{key:"__close__REACT_HOT_LOADER__",value:function(){var e=this.props.onCancel;this.setState({constValue:""},function(){e&&e()})}},{key:"render",value:function(){var e=this.state.constValue,t=this.props,a=t.visible;t.onCancel;return y.a.createElement(K.a,{title:"添加常量",onOk:this.submit,onCancel:this.close,visible:a},y.a.createElement(x.a,{value:e,onChange:this.onChange,placeholder:"请输入常量值"}))}}]),t}(y.a.Component),nt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(at,"ConstModal","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/constModal.js"),q.a.Item),rt=_e.a.Option,it={cf:"-",key:"rowkey",type:"STRING"};function st(e){return X.b.HDFS===parseInt(e,10)}function lt(e){return X.c.indexOf(parseInt(e,10))>-1}function ot(e,t){return Object(v.isObject)(e)&&Object(v.isObject)(t)?Object(v.isEqual)(e,t):Object(v.isObject)(e)&&!Object(v.isObject)(t)?(e.key||e.index)===t:!Object(v.isObject)(e)&&Object(v.isObject)(t)?e===(t.key||t.index):e===t}var ct=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.initData=function(){return a.__initData__REACT_HOT_LOADER__.apply(a,arguments)},a.loadColumnFamily=function(){return a.__loadColumnFamily__REACT_HOT_LOADER__.apply(a,arguments)},a.hbaseRowKeyChange=function(){return a.__hbaseRowKeyChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderKeyModal=function(){return a.__renderKeyModal__REACT_HOT_LOADER__.apply(a,arguments)},a.renderBatchModal=function(){return a.__renderBatchModal__REACT_HOT_LOADER__.apply(a,arguments)},a.checkHBaseRowKey=function(){return a.__checkHBaseRowKey__REACT_HOT_LOADER__.apply(a,arguments)},a.copySourceCols=function(){return a.__copySourceCols__REACT_HOT_LOADER__.apply(a,arguments)},a.batchTextChange=function(){return a.__batchTextChange__REACT_HOT_LOADER__.apply(a,arguments)},a.batchSourceTextChange=function(){return a.__batchSourceTextChange__REACT_HOT_LOADER__.apply(a,arguments)},a.doBatchImport=function(){return a.__doBatchImport__REACT_HOT_LOADER__.apply(a,arguments)},a.hideBatchImportModal=function(){return a.__hideBatchImportModal__REACT_HOT_LOADER__.apply(a,arguments)},a.hideBatchSourceModal=function(){return a.__hideBatchSourceModal__REACT_HOT_LOADER__.apply(a,arguments)},a.importFields=function(){return a.__importFields__REACT_HOT_LOADER__.apply(a,arguments)},a.importSourceFields=function(){return a.__importSourceFields__REACT_HOT_LOADER__.apply(a,arguments)},a.doBatchAddSourceFields=function(){return a.__doBatchAddSourceFields__REACT_HOT_LOADER__.apply(a,arguments)},a.initEditKeyRow=function(){return a.__initEditKeyRow__REACT_HOT_LOADER__.apply(a,arguments)},a.doAddkeyRow=function(){return a.__doAddkeyRow__REACT_HOT_LOADER__.apply(a,arguments)},a.doEditKeyRow=function(){return a.__doEditKeyRow__REACT_HOT_LOADER__.apply(a,arguments)},a.hideKeyModal=function(){return a.__hideKeyModal__REACT_HOT_LOADER__.apply(a,arguments)},a.state={h:40,w:230,W:450,padding:10,rowMap:!1,nameMap:!1,keyModalVisible:!1,visibleConst:!1,keyModal:{operation:"add",isReader:!0,editField:"",position:-1,source:"",fileType:"orc"},batchModal:{visible:!1,batchText:""},batchSourceModal:{visible:!1,batchText:""},sourceColumnFamily:"",targetColumnFamily:""},a}return g()(t,e),m()(t,[{key:"getCanvasW",value:function(){var e=450,t=document.querySelector(".steps-content");if(t){var a=t.getBoundingClientRect().width/6*5;a>e&&(e=a)}return e}},{key:"componentDidMount",value:function(){this.$canvas=Object(qe.b)(this.canvas),this.$activeLine=Object(qe.b)("#activeLine"),this.setState({W:this.getCanvasW()}),this.drawSvg(),this.listenResize(),this.loadColumnFamily(),this.initData()}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.setState({W:this.getCanvasW()})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1)}},{key:"listenResize",value:function(){window.addEventListener&&window.addEventListener("resize",this.resize,!1)}},{key:"componentDidUpdate",value:function(){this.$canvas.selectAll(".dl, .dr, .lines").remove(),this.drawSvg()}},{key:"drawSvg",value:function(){this.renderDags(),this.renderLines(),this.bindEvents()}},{key:"renderDags",value:function(){var e=this.state,t=e.w,a=e.h,n=e.W,r=e.padding,i=this.props,s=i.targetCol,l=i.sourceCol;i.keymap;this.$canvas.append("g").attr("class","dl").selectAll("g").data(l).enter().append("g").attr("class","col-dag-l").append("circle").attr("class","dag-circle").attr("cx",function(e,t){return r}).attr("cy",function(e,t){return a*(t+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7"),this.$canvas.append("g").attr("class","dr").selectAll("g").data(s).enter().append("g").attr("class","col-dag-r").append("circle").attr("class","dag-circle").attr("cx",function(e,a){return n-2*t-r}).attr("cy",function(e,t){return a*(t+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7")}},{key:"renderLines",value:function(){var e=this.state,t=e.w,a=e.h,n=e.W,r=e.padding,i=this.props,s=(i.targetCol,i.sourceCol,i.keymap),l=i.sourceSrcType,o=(i.sourceFileType,i.targetSrcType),c=(i.targetFileType,s.source),u=s.target,_=Object(qe.c)(".col-dag-l"),p=Object(qe.c)(".col-dag-r"),d=[];c.forEach(function(e,i){_.each(function(s,c){var _,m,h=void 0,f=void 0,E=void 0,g=void 0;_=s,m=e,(lt(l)?_.key===m:ot(_,m))&&(h=r,f=(c+1.5)*a,p.each(function(s,l){var c,_;c=s,_=u[i],(lt(o)?c.key===_:ot(c,_))&&(E=n-2*t-r,g=(l+1.5)*a,d.push({s:{x:h,y:f},e:{x:E,y:g},dl:e,dr:u[i]}))}))})}),this.$canvas.append("g").attr("class","lines").selectAll("g").data(d).enter().append("g").attr("class","mapline").append("line").attr("x1",function(e){return e.s.x}).attr("y1",function(e){return e.s.y}).attr("x2",function(e){return e.e.x}).attr("y2",function(e){return e.e.y}).attr("stroke","#2491F7").attr("stroke-width",2).attr("marker-end","url(#arrow)")}},{key:"bindEvents",value:function(){var e=this,t=this.state,a=t.w,n=t.h,r=t.W,i=t.padding,s=this.props,l=s.addLinkedKeys,o=s.delLinkedKeys,c=s.sourceSrcType,u=s.sourceFileType,_=s.targetSrcType,p=s.targetFileType,d=this.$activeLine,m=!1,h=void 0,f=void 0;Object(qe.c)(".col-dag-l").on("mousedown",function(e,t,a){var r=i,s=(t+1.5)*n;d.attr("x1",r).attr("y1",s).attr("x2",r).attr("y2",s),h=e,m=!0}),this.$canvas.on("mousemove",function(){if(m){var t=Object(qe.a)(e.$canvas.node());d.attr("x2",t[0]).attr("y2",t[1])}}).on("mouseup",function(){if(m){var t=Object(qe.a)(e.$canvas.node()),s=Pe()(t,2),o=s[0],u=s[1];if(o<r-2*a-i)e.resetActiveLine();else{var p=Math.floor(u/n)-1;Object(qe.c)(".col-dag-r").each(function(e,t){t===p&&(f=e)})}}h&&f&&(l({source:lt(c)?h.key:h,target:lt(_)?f.key:f}),e.resetActiveLine()),m=!1}),this.$canvas.selectAll(".mapline").on("mouseover",function(e,t,a){Object(qe.b)(a[t]).select("line").attr("stroke-width",3).attr("stroke","#2491F7")}).on("mouseout",function(e,t,a){Object(qe.b)(a[t]).select("line").attr("stroke-width",2).attr("stroke","#2491F7")}).on("click",function(e,t,a){o({source:e.dl,target:e.dr,sourceSrcType:c,sourceFileType:u,targetSrcType:_,targetFileType:p})})}},{key:"resetActiveLine",value:function(){this.$activeLine.attr("x1",-10).attr("y1",-10).attr("x2",-10).attr("y2",-10)}},{key:"__initData__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.sourceMap,a=e.sourceSrcType,n=e.addSourceKeyRow;a===X.b.HBASE&&(t.column&&0!==t.column.length||n(it))}},{key:"__loadColumnFamily__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.sourceMap,a=e.targetMap,n=e.sourceSrcType,r=e.targetSrcType,i=this,s=function(e,t){$.a.getHBaseColumnFamily(e).then(function(e){1===e.code&&t(e.data)})};n===X.b.HBASE&&s({sourceId:t.sourceId,tableName:t.type.table},function(e){i.setState({sourceColumnFamily:e})}),r===X.b.HBASE&&s({sourceId:a.sourceId,tableName:a.type.table},function(e){i.setState({targetColumnFamily:e})})}},{key:"__hbaseRowKeyChange__REACT_HOT_LOADER__",value:function(e){var t=J.a.trim(e.target.value),a=this.props,n=a.handleTargetMapChange,r=a.targetMap;t&&(r.rowkey=t,n(r))}},{key:"renderSource",value:function(){var e=this,t=this.state,a=t.w,n=t.h,r=(t.W,t.H,t.padding),i=this.props,l=(i.targetCol,i.sourceCol),o=(i.keymap,i.sourceSrcType),c=i.sourceFileType,u=i.removeSourceKeyRow,_=i.readonly,p={left:r,top:r,width:a,height:n},d=function(t,a,n){var r=y.a.createElement("div",{className:"remove-cell",onClick:function(){return u(a,n)}},y.a.createElement(je.a,{title:"删除当前列"},y.a.createElement(s.a,{type:"minus"})));switch(t){case X.b.HDFS:var i=a?Object(Be.a)(void 0!==a.index?a.index:"'"+a.key+"'"):"索引位";return y.a.createElement("div",null,y.a.createElement("div",{className:"cell",title:i},i),y.a.createElement("div",{className:"cell"},a?a.value?"常量":a.type.toUpperCase():"类型"),"orc"!==c?y.a.createElement("div",{className:"cell"},a?r:"操作"):"");case X.b.HBASE:var l=a?Object(Be.a)(a.key):"列名/行健",o=a?a.cf:"列族";return y.a.createElement("div",{className:"four-cells"},y.a.createElement("div",{className:"cell",title:o},o),y.a.createElement("div",{className:"cell",title:l},l),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?y.a.createElement("div",null,"rowkey"===a.key?"":r,y.a.createElement("div",{className:"edit-cell",onClick:function(){e.initEditKeyRow(!0,t,null,a,n)}},y.a.createElement(je.a,{title:"编辑当前列"},y.a.createElement(s.a,{type:"edit"})))):"操作"));case X.b.HIVE:var _=a?Object(Be.a)(a.value?"'"+a.key+"'":a.key):"字段名称";return y.a.createElement("div",null,y.a.createElement("div",{className:"cell"},_),y.a.createElement("div",{className:"cell"},a?a.value?"常量":a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?a.value?r:"":"操作"));case X.b.FTP:var p=a?Object(Be.a)(void 0!==a.index?a.index:"'"+a.key+"'"):"字段序号";return y.a.createElement("div",null,y.a.createElement("div",{className:"cell",title:p},p),y.a.createElement("div",{className:"cell"},a?a.value?"常量":a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?r:"操作"));default:return y.a.createElement("div",null,y.a.createElement("div",{className:"cell",title:name},a?Object(Be.a)(a.key):"字段名称"),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"))}};return y.a.createElement("div",{className:"sourceLeft"},y.a.createElement("div",{className:"m-col title pa",style:p},d(o)),l.map(function(e,t){return y.a.createElement("div",{style:{width:a,height:n,left:r,top:r+n*(t+1)},className:"m-col pa",key:"sourceLeft-"+t},d(o,e,t))}),function(t){if(!_){var i="",s=y.a.createElement("span",{onClick:function(){e.setState({visibleConst:!0})}},"+添加常量");switch(t){case X.b.HIVE:i=y.a.createElement("div",null,s);break;case X.b.HBASE:i=y.a.createElement("div",null,y.a.createElement("span",{onClick:e.initAddKeyRow.bind(e,!0,c)},"+添加字段")," ",y.a.createElement("span",{onClick:e.importSourceFields},"批量添加"));break;case X.b.HDFS:i="orc"!==c?y.a.createElement("div",null,y.a.createElement("span",{onClick:e.initAddKeyRow.bind(e,!0,c)},"+添加字段")," ",s," ",y.a.createElement("span",{onClick:e.importSourceFields},"批量添加")):null;break;case X.b.FTP:i=y.a.createElement("div",null,y.a.createElement("span",{onClick:e.initAddKeyRow.bind(e,!0,c)},"+添加字段")," ",s," ",y.a.createElement("span",{onClick:e.importSourceFields},"批量添加"));break;default:i=null}return y.a.createElement("div",{className:"m-col footer pa",style:{left:r,top:r+n*(l.length+1),width:a,height:n,zIndex:100}},i)}return""}(o))}},{key:"renderTarget",value:function(){var e=this,t=this.state,a=t.w,n=t.h,r=t.W,i=(t.H,t.padding),l=this.props,o=l.targetCol,c=l.sourceCol,u=(l.keymap,l.readonly),_=l.targetMap,p=l.targetFileType,d=l.removeTargetKeyRow,m=l.sourceSrcType,h=l.targetSrcType,f={left:r-(i+a),top:i,width:a,height:n},E=function(t,a,n){var r=y.a.createElement("div",null,y.a.createElement("div",{className:"remove-cell",onClick:function(){return d(a,n)}},y.a.createElement(je.a,{title:"删除当前列"},y.a.createElement(s.a,{type:"minus"}))),y.a.createElement("div",{className:"edit-cell",onClick:function(){e.initEditKeyRow(!1,p,c[n],a,n)}},y.a.createElement(je.a,{title:"编辑当前列"},y.a.createElement(s.a,{type:"edit"}))));switch(t){case X.b.HDFS:return y.a.createElement("div",null,y.a.createElement("div",{className:"cell"},a?Object(Be.a)(a.key):"字段名称"),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?r:"操作"));case X.b.HBASE:return y.a.createElement("div",{className:"four-cells"},y.a.createElement("div",{className:"cell"},a?a.cf:"列族"),y.a.createElement("div",{className:"cell"},a?Object(Be.a)(a.key):"列名"),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?r:"操作"));case X.b.FTP:return y.a.createElement("div",null,y.a.createElement("div",{className:"cell"},a?Object(Be.a)(a.key):"字段名称"),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"),y.a.createElement("div",{className:"cell"},a?r:"操作"));default:return y.a.createElement("div",null,y.a.createElement("div",{className:"cell"},a?Object(Be.a)(a.key):"字段名称"),y.a.createElement("div",{className:"cell"},a?a.type.toUpperCase():"类型"))}};return y.a.createElement("div",{className:"targetRight"},y.a.createElement("div",{className:"m-col title  pa",style:f},E(h)),o.map(function(e,t){return y.a.createElement("div",{key:"targetRight-"+t,className:"m-col pa",style:{width:a,height:n,top:i+n*(t+1),left:r-(i+a)}},E(h,e,t))}),function(t){if(!u){var s="";switch(t){case X.b.HBASE:s=y.a.createElement("div",null,y.a.createElement("span",{onClick:e.initAddKeyRow.bind(e,!1,p)},"+添加字段")," ",y.a.createElement("span",{onClick:e.importFields},"批量添加"),y.a.createElement("div",{className:"m-col"},"rowkey: ",y.a.createElement(x.a,{style:{width:"160px"},defaultValue:_.type&&_.type.rowkey||"",placeholder:m===X.b.HBASE?"$(colFamily1:colName1)":"$(colName)",onChange:e.hbaseRowKeyChange})));break;case X.b.HDFS:case X.b.FTP:s=y.a.createElement("div",null,y.a.createElement("span",{onClick:e.initAddKeyRow.bind(e,!1,p)},"+添加字段")," ",y.a.createElement("span",{onClick:e.importFields},"批量添加"));break;default:s=null}return s?y.a.createElement("div",{className:"m-col footer pa",style:{top:i+n*(o.length+1),left:r-(i+a),width:a,height:n,zIndex:100}},s):""}return""}(h))}},{key:"__renderKeyModal__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.keyModal,a=e.keyModalVisible,n=e.sourceColumnFamily,r=e.targetColumnFamily,i=t.operation,s=t.isReader,l=this.props,o=l.sourceSrcType,c=l.targetSrcType,u=t.isReader?o:c,_=this.doAddkeyRow,p="添加HDFS字段";return"add"===i?u===X.b.HBASE?p="添加HBase字段":u===X.b.FTP&&(p="添加FTP字段"):"edit"===i&&(_=this.doEditKeyRow,p="修改HDFS字段",u===X.b.HBASE?p="修改HBase字段":u===X.b.FTP&&(p="添加FTP字段")),y.a.createElement(Ze,{title:p,visible:a,keyModal:t,dataType:u,sourceColumnFamily:n,targetColumnFamily:r,onOk:_,onCancel:this.hideKeyModal,key:s?"source-"+u+"-"+o:"target-"+u+"-"+c})}},{key:"__renderBatchModal__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.batchModal,a=e.batchSourceModal,n=e.sourceColumnFamily,r=e.targetColumnFamily,i=this.props,s=i.sourceSrcType,l=i.targetSrcType,o=void 0,c=void 0,u=void 0,_=void 0;switch(s){case X.b.FTP:case X.b.HDFS:o="0: STRING, 1: INTEGER,...",c="index: type, index: type";break;case X.b.HBASE:o="cf1: field1: STRING, cf1: field2: INTEGER,...",c="columnFamily: fieldName: type,"}switch(l){case X.b.FTP:case X.b.HDFS:u="field1: STRING, field2: INTEGER,...",_="fieldName: type, fieldName: type";break;case X.b.HBASE:u=o,_=c}return[y.a.createElement(tt,{key:"sourceBatchAdd",title:"批量添加源表字段",desc:c,columnFamily:n,placeholder:o,visible:a.visible,value:a.batchText,onOk:this.doBatchAddSourceFields,onCancel:this.hideBatchSourceModal,onChange:this.batchSourceTextChange}),y.a.createElement(tt,{key:"targetBatchAdd",title:"批量添加目标字段",desc:_,columnFamily:r,placeholder:u,visible:t.visible,value:t.batchText,onOk:this.doBatchImport,onCancel:this.hideBatchImportModal,onChange:this.batchTextChange})]}},{key:"render",value:function(){var e=this,t=this.state,a=t.w,n=t.h,i=t.W,s=t.padding,l=t.visibleConst,c=this.props,u=c.targetCol,_=c.sourceCol,p=c.keymap,d=c.sourceSrcType,m=(c.sourceFileType,c.navtoStep),h=c.targetSrcType,f=c.addSourceKeyRow,E=n*(Math.max(u.length,_.length)+1);p.source,p.target;return y.a.createElement("div",null,y.a.createElement("p",{style:{fontSize:12,color:"#ccc",marginTop:-20}},"您要配置来源表与目标表的字段映射关系，通过连线将待同步的字段左右相连，也可以通过同行映射、同名映射批量完成映射"),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"20"},y.a.createElement("div",{className:"m-keymapbox",ref:function(t){return e.container=t},style:{width:i,minHeight:E+20}},this.renderSource(),this.renderTarget(),y.a.createElement("svg",{ref:function(t){return e.canvas=t},width:i>2*a?i-2*a:0,height:E,className:"pa m-keymapcanvas",style:{left:a,top:s}},y.a.createElement("defs",null,y.a.createElement("marker",{id:"arrow",markerUnits:"strokeWidth",markerWidth:"12",markerHeight:"12",viewBox:"0 0 12 12",refX:"6",refY:"6",orient:"auto"},y.a.createElement("path",{d:"M2,3 L9,6 L2,9 L2,6 L2,3",style:{fill:"#2491F7"}}))),y.a.createElement("g",null,y.a.createElement("line",{id:"activeLine",x1:"-10",y1:"-10",x2:"-10",y2:"-10",stroke:"#2491F7",strokeWidth:"2",markerEnd:"url(#arrow)"}))))),y.a.createElement(o.a,{span:"4"},this.props.readonly?null:y.a.createElement("div",{className:"m-buttons"},y.a.createElement(V.a,{type:this.state.rowMap?"primary":"default",onClick:this.setRowMap.bind(this)},this.state.rowMap?"取消同行映射":"同行映射"),y.a.createElement("br",null),y.a.createElement(V.a,{disabled:st(d),type:this.state.nameMap?"primary":"default",onClick:this.setNameMap.bind(this)},this.state.nameMap?"取消同名映射":"同名映射"),y.a.createElement("br",null),st(h)?y.a.createElement(V.a,{onClick:function(){e.copySourceCols(_)}},"拷贝源字段"):""))),this.renderKeyModal(),this.renderBatchModal(),y.a.createElement(at,{visible:l,onOk:f,onCancel:function(){e.setState({visibleConst:!1})}}),!this.props.readonly&&y.a.createElement("div",{className:"steps-action",style:{marginTop:80}},y.a.createElement(V.a,{style:{marginRight:8},onClick:function(){return e.prev(m)}},"上一步"),y.a.createElement(V.a,{type:"primary",onClick:function(){return e.next(m)}},"下一步")))}},{key:"prev",value:function(e){e.call(null,1)}},{key:"next",value:function(e){var t=this.props,a=t.keymap,n=t.targetSrcType,r=a.source,i=a.target;0!==r.length||0!==i.length?(n!==X.b.HBASE||this.checkHBaseRowKey())&&e.call(null,3):w.a.error("尚未配置数据同步的字段映射！")}},{key:"__checkHBaseRowKey__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.keymap,n=t.targetMap,r=t.sourceSrcType,i=n.type,s=a.source;if(i&&i.rowkey){var l=function(){var e=[];if(r===X.b.HBASE)for(var t=i.rowkey.match(/([\w]+:[\w]+)/g),a=function(e){var a=t[e].split(":");if(a&&2===a.length&&!s.find(function(e){return e.cf===a[0]&&e.key===a[1]}))return w.a.error("目标表rowkey在源表中并不存在！"),{v:{v:!1}}},n=0;n<t.length;n++){var l=a(n);if("object"===(void 0===l?"undefined":Ie()(l)))return l.v}else{for(var o=/\$\(([\w]+)\)/g,c=void 0;null!==(c=o.exec(i.rowkey));)e.push(c[1]);var u=function(t){if(!(Object(v.isObject)(s[0])?s.find(function(a){return""+(void 0!==a.key?a.key:a.index)==""+e[t]?a:void 0}):s.find(function(a){return a===e[t]})))return w.a.error("rowkey在已映射的字段中并未找到"+e[t]+"！"),{v:{v:!1}}};for(n=0;n<e.length;n++){var _=u(n);if("object"===(void 0===_?"undefined":Ie()(_)))return _.v}}return{v:!0}}();if("object"===(void 0===l?"undefined":Ie()(l)))return l.v}else if(!i.rowkey)return w.a.error("目标表rowkey不能为空！"),!1}},{key:"__copySourceCols__REACT_HOT_LOADER__",value:function(e){(0,this.props.addBatchTargetKeyRow)(e&&e.map(function(e){return{key:e.key||e.index,type:e.type}}))}},{key:"__batchTextChange__REACT_HOT_LOADER__",value:function(e){this.state.batchModal;this.setState({batchModal:{visible:!0,batchText:e.target.value}})}},{key:"__batchSourceTextChange__REACT_HOT_LOADER__",value:function(e){this.state.batchSourceModal;this.setState({batchSourceModal:{visible:!0,batchText:e.target.value}})}},{key:"__doBatchImport__REACT_HOT_LOADER__",value:function(){var e=this.state.batchModal.batchText,t=this.props,a=t.addBatchTargetKeyRow,n=t.targetSrcType,r=J.a.trim(e).split(","),i=[];switch(n){case X.b.FTP:case X.b.HDFS:for(var s=0;s<r.length;s++){var l=r[s];if(l){var o=l.split(":"),c=o[0],u=o[1];if(!X.r.includes(u))return void w.a.error("字段"+c+"的数据类型错误！");i.push({key:c,type:u})}}break;case X.b.HBASE:for(var _=0;_<r.length;_++){var p=r[_];if(p){var d=p.split(":"),m=J.a.trim(d[0]),h=J.a.trim(d[1]),f=J.a.trim(d[2]);if(!X.r.includes(f))return void w.a.error("字段"+h+"的数据类型错误！");i.push({cf:m,key:h,type:f})}}}a(i),this.hideBatchImportModal()}},{key:"__hideBatchImportModal__REACT_HOT_LOADER__",value:function(){this.setState({batchModal:{visible:!1,batchText:""}})}},{key:"__hideBatchSourceModal__REACT_HOT_LOADER__",value:function(){this.setState({batchSourceModal:{visible:!1,batchText:""}})}},{key:"__importFields__REACT_HOT_LOADER__",value:function(){this.setState({batchModal:{visible:!0}})}},{key:"__importSourceFields__REACT_HOT_LOADER__",value:function(){this.setState({batchSourceModal:{visible:!0}})}},{key:"__doBatchAddSourceFields__REACT_HOT_LOADER__",value:function(){var e=this.state.batchSourceModal.batchText,t=this.props,a=t.addBatchSourceKeyRow,n=t.sourceSrcType,r=(t.sourceCol,J.a.trim(e),e.split(",")),i=[];switch(n){case X.b.FTP:case X.b.HDFS:for(var s=function(e){var t=r[e];if(!t)return"continue";var a=t.split(":"),n=parseInt(J.a.trim(a[0]),10),s=J.a.trim(a[1]);return Object(v.isNaN)(n)||!Object(v.isNumber)(n)?(w.a.error("索引名称应该为整数数字！"),{v:void 0}):X.r.includes(s)?void(i.find(function(e){return e.index===n})||i.push({index:n,type:s})):(w.a.error("字段"+n+"的数据类型错误！"),{v:void 0})},l=0;l<r.length;l++){var o=s(l);switch(o){case"continue":continue;default:if("object"===(void 0===o?"undefined":Ie()(o)))return o.v}}break;case X.b.HBASE:i.push(it);for(l=0;l<r.length;l++){var c=r[l];if(c){var u=c.split(":"),_=J.a.trim(u[0]),p=J.a.trim(u[1]),d=J.a.trim(u[2]);if(!X.r.includes(d))return void w.a.error("字段"+p+"的数据类型错误！");i.push({cf:_,key:p,type:d})}}}a(i),this.hideBatchSourceModal()}},{key:"setRowMap",value:function(){var e,t=this.state,a=t.rowMap,n=t.nameMap,r=this.props,i=r.targetCol,s=r.sourceCol,l=r.sourceSrcType,o=(r.sourceFileType,r.targetSrcType);r.targetFileType;a?this.props.resetLinkedKeys():this.props.setRowMap({sourceCol:(e=s,lt(l)&&(e=e.map(function(e){return e.key})),e),targetCol:function(e){return lt(o)&&(e=e.map(function(e){return e.key})),e}(i)}),this.setState({rowMap:!a,nameMap:n?!n:n})}},{key:"setNameMap",value:function(){var e=this.state,t=e.nameMap,a=e.rowMap,n=this.props,r=n.targetCol,i=n.sourceCol,s=n.targetSrcType;t?this.props.resetLinkedKeys():this.props.setNameMap({sourceCol:i,targetCol:r,targetSrcType:s}),this.setState({nameMap:!t,rowMap:a?!a:a})}},{key:"initAddKeyRow",value:function(e,t){this.setState({keyModalVisible:!0,keyModal:{operation:"add",isReader:e,fileType:t}})}},{key:"__initEditKeyRow__REACT_HOT_LOADER__",value:function(e,t,a,n,r){this.setState({keyModalVisible:!0,keyModal:{operation:"edit",isReader:e,fileType:t,editField:n,position:r,source:a}})}},{key:"__doAddkeyRow__REACT_HOT_LOADER__",value:function(e){var t=this.state.keyModal.isReader,a=this.props,n=a.addSourceKeyRow,r=a.addTargetKeyRow;e&&(t?n(e):r(e),this.hideKeyModal())}},{key:"__doEditKeyRow__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.editSourceKeyRow,n=t.editTargetKeyRow,r=t.editKeyMapTarget,i=this.state.keyModal,s=i.isReader,l=i.position,o=(i.source,i.editField);e&&(s?a(e):(n({index:l,value:e}),r({old:o,replace:e})),this.hideKeyModal())}},{key:"__hideKeyModal__REACT_HOT_LOADER__",value:function(){this.setState({keyModalVisible:!1,keyModal:{operation:"add",editField:"",source:""}})}}]),t}(y.a.Component),ut=function(e){var t=e.offlineTask.dataSync;return{sourceMap:t.sourceMap,targetMap:t.targetMap,targetCol:t.targetMap.column||[],targetSrcType:t.targetMap.type&&t.targetMap.type.type,targetFileType:t.sourceMap.type&&t.targetMap.type.fileType,sourceCol:t.sourceMap.column||[],sourceSrcType:t.sourceMap.type&&t.sourceMap.type.type,sourceFileType:t.sourceMap.type&&t.sourceMap.type.fileType,keymap:t.keymap}},_t=Object(b.b)(ut,Ke.a)(ct),pt=_t,dt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(nt,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(rt,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(it,"DefaultRowKey","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(st,"isHdfsType","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(lt,"isRDB","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(ot,"isFieldMatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(ct,"Keymap","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(ut,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js"),__REACT_HOT_LOADER__.register(_t,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/keymap/index.js")),a(78),a(45)),mt=a.n(dt),ht=(a(1417),a(1414)),ft=a.n(ht),Et=a(141),gt=q.a.Item,kt=_e.a.Option,yt=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.state={isRecord:!1},a.onLifeDayChange=function(){return a.__onLifeDayChange__REACT_HOT_LOADER__.apply(a,arguments)},a}return g()(t,e),m()(t,[{key:"__onLifeDayChange__REACT_HOT_LOADER__",value:function(e){this.props.changeChannelSetting({lifeDay:e})}},{key:"render",value:function(){for(var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.setting,r=(a.changeChannelSetting,a.navtoStep),i=(a.form,{labelCol:{sm:{span:6}},wrapperCol:{sm:{span:14}}}),s=[],l=[],o=1;o<=20;o++)s.push(y.a.createElement(kt,{value:""+o,key:o},o,"MB/s"));for(var c=1;c<=5;c++)l.push(y.a.createElement(kt,{value:""+c,key:c},c));return y.a.createElement("div",{className:"g-step4"},y.a.createElement(q.a,null,y.a.createElement(gt,N()({},i,{label:"作业速率上限",style:{height:"32px"}}),t("speed",{rules:[{required:!0}],initialValue:""+n.speed})(y.a.createElement(ft.a,{dataSource:s,optionLabelProp:"value"},y.a.createElement(x.a,{suffix:"MB/s"}))),y.a.createElement(me.a,{doc:"jobSpeedLimit"})),y.a.createElement(gt,N()({},i,{label:"作业并发数",style:{height:"32px"}}),t("channel",{rules:[{required:!0}],initialValue:""+n.channel})(y.a.createElement(ft.a,{dataSource:l,optionLabelProp:"value"})),y.a.createElement(me.a,{doc:"jobConcurrence"})),y.a.createElement(gt,N()({},i,{label:"错误记录管理",className:"txt-left"}),t("isSaveDirty",{rules:[],initialValue:n.isSaveDirty})(y.a.createElement(mt.a,{checked:n.isSaveDirty}," 记录保存 ")),y.a.createElement(me.a,{doc:"recordDirtyData"})),n.isSaveDirty?y.a.createElement("div",null,y.a.createElement(gt,N()({},i,{label:"脏数据写入hive表"}),t("tableName",{rules:[],initialValue:n.tableName||null})(y.a.createElement(x.a,{placeholder:"默认系统分配"})),y.a.createElement(me.a,{doc:"recordDirtyData"})),y.a.createElement(gt,N()({},i,{label:"脏数据存储生命周期",className:"txt-left"}),t("lifeDay",{rules:[{required:!0,message:"生命周期不可为空！"}],initialValue:n.lifeDay||90})(y.a.createElement(x.a,{type:"hidden"})),y.a.createElement(Et.a,{value:n.lifeDay,width:120,onChange:this.onLifeDayChange}),y.a.createElement(me.a,{doc:"recordDirtyData"}))):"",y.a.createElement(gt,N()({},i,{label:"错误记录数超过"}),t("record",{rules:[],initialValue:n.record})(y.a.createElement(Ge.a,{style:{float:"left"}})),y.a.createElement("span",{style:{float:"left"}},"条, 任务自动结束",y.a.createElement(me.a,{doc:"errorCount",style:{position:"initial",marginLeft:"6px"}}))),y.a.createElement(gt,N()({},i,{label:"错误记录比例配置"}),y.a.createElement("span",{style:{float:"left"}},"任务执行结束后，统计错误记录占比，大于"),t("percentage",{rules:[],initialValue:n.percentage})(y.a.createElement(Ge.a,{style:{float:"left"}})),y.a.createElement("span",{style:{float:"left"}},"%时，任务置为失败"),y.a.createElement(me.a,{doc:"errorPercentConfig",style:{position:"initial",marginLeft:"6px"}}))),!this.props.readonly&&y.a.createElement("div",{className:"steps-action"},y.a.createElement(V.a,{style:{marginRight:8},onClick:function(){return e.prev(r)}},"上一步"),y.a.createElement(V.a,{type:"primary",onClick:function(){return e.next(r)}},"下一步")))}},{key:"prev",value:function(e){e.call(null,2)}},{key:"next",value:function(e){var t=this.props,a=t.changeChannelSetting;t.form.validateFields(function(t,n){t||(e.call(null,4),a(n))})}}]),t}(y.a.Component),bt=q.a.create({onValuesChange:function(e,t){var a=e.changeChannelSetting;t.isSaveDirty&&!t.lifeDay&&(t.lifeDay=90),a(t)}})(yt),vt=function(e){function t(){return p()(this,t),f()(this,(t.__proto__||u()(t)).apply(this,arguments))}return g()(t,e),m()(t,[{key:"render",value:function(){return y.a.createElement("div",null,y.a.createElement(bt,this.props))}}]),t}(y.a.Component),Tt=function(e){var t=e.offlineTask.dataSync;return{setting:t.setting,targetMap:t.targetMap}},Ct=function(e){return{changeChannelSetting:function(t){e({type:T.i.CHANGE_CHANNEL_FIELDS,payload:t}),e({type:T.o.MAKE_TAB_DIRTY})}}},Ot=Object(b.b)(Tt,Ct)(vt),At=Ot,Rt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(gt,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(kt,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(yt,"ChannelForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(bt,"ChannelFormWrap","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(vt,"Channel","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(Tt,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(Ct,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js"),__REACT_HOT_LOADER__.register(Ot,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/channel.js")),a(55),a(29)),wt=a.n(Rt);function Dt(){return y.a.createElement("div",{style:{position:"absolute",top:48,left:0,bottom:0,right:0,zIndex:3,background:"rgba(255, 255, 255, 0.4)",cursor:"not-allowed"}})}var St=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.navtoStep=a.props.navtoStep,a}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this,t=this.navtoStep;return y.a.createElement("div",{className:"g-step5"},y.a.createElement("div",{className:"m-preview",style:{padding:"0 20"}},y.a.createElement(wt.a,{bordered:!1,style:{marginBottom:10},title:"选择来源",extra:y.a.createElement("a",{href:"javascript:void(0)",onClick:function(){return e.navtoStep(0)}},"修改")},y.a.createElement(Oe,{readonly:!0}),y.a.createElement(Dt,null)),y.a.createElement(wt.a,{bordered:!1,style:{marginBottom:10},title:"选择目标",extra:y.a.createElement("a",{href:"javascript:void(0)",onClick:function(){return e.navtoStep(1)}},"修改")},y.a.createElement(Fe,{readonly:!0}),y.a.createElement(Dt,null)),y.a.createElement(wt.a,{bordered:!1,style:{marginBottom:10},title:"字段映射",extra:y.a.createElement("a",{href:"javascript:void(0)",onClick:function(){return e.navtoStep(2)}},"修改")},y.a.createElement(pt,{readonly:!0}),y.a.createElement(Dt,null)),y.a.createElement(wt.a,{bordered:!1,style:{marginBottom:10},title:"通道控制",extra:y.a.createElement("a",{href:"javascript:void(0)",onClick:function(){return e.navtoStep(3)}},"修改")},y.a.createElement(At,{readonly:!0}),y.a.createElement(Dt,null))),y.a.createElement("div",{className:"steps-action"},y.a.createElement(V.a,{style:{marginRight:8},onClick:function(){return e.prev(t)}},"上一步"),y.a.createElement(V.a,{type:"primary",onClick:function(){return e.save(t)}},"保存")))}},{key:"prev",value:function(e){e.call(null,3)}},{key:"save",value:function(e){this.props.saveJob(e)}}]),t}(y.a.Component),Lt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Dt,"Mask","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/save.js"),__REACT_HOT_LOADER__.register(St,"Save","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/save.js")),ne.a.Step),xt=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.state={currentStep:0},a}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getDataSource,a=e.getJobData,n=e.id;e.currentTab;t(),a({taskId:n})}},{key:"next",value:function(){this.setState({currentStep:this.state.currentStep+1})}},{key:"prev",value:function(){this.setState({currentStep:this.state.currentStep-1})}},{key:"navtoStep",value:function(e){this.setState({currentStep:e})}},{key:"save",value:function(){var e=this.props,t=e.saveJobData,a=e.dataSync;t(this.generateRqtBody(a))}},{key:"generateRqtBody",value:function(e){var t=Object(v.cloneDeep)(e),a=this.props,n=a.tabs,r=a.currentTab,i=t.keymap,s=t.sourceMap,l=t.targetMap,o=i.source,c=i.target,u=this.props,_=u.name,p=u.id;t.sourceMap.column=o,t.targetMap.column=c,t.settingMap=t.setting,t.name=_,t.taskId=p;var d=l.type,m=s.type;for(var h in m)m.hasOwnProperty(h)&&(s[h]=m[h]);for(var f in d)d.hasOwnProperty(f)&&(l[f]=d[f]);delete t.keymap,delete t.setting,delete t.dataSourceList,delete t.currentStep;var E=Object(v.cloneDeep)(n.filter(function(e){return e.id===r})[0]);for(var g in t)t.hasOwnProperty(g)&&(E[g]=t[g]);return E.preSave=!0,E.taskVOS&&(E.dependencyTasks=E.taskVOS.map(function(e){return e}),E.taskVOS=null),E}},{key:"render",value:function(){var e=this.state.currentStep,t=[{title:"数据来源",content:y.a.createElement(Oe,{currentStep:e,navtoStep:this.navtoStep.bind(this)})},{title:"选择目标",content:y.a.createElement(Fe,{currentStep:e,navtoStep:this.navtoStep.bind(this)})},{title:"字段映射",content:y.a.createElement(pt,{currentStep:e,navtoStep:this.navtoStep.bind(this)})},{title:"通道控制",content:y.a.createElement(At,{currentStep:e,navtoStep:this.navtoStep.bind(this)})},{title:"预览保存",content:y.a.createElement(St,{currentStep:e,navtoStep:this.navtoStep.bind(this),saveJob:this.save.bind(this)})}];return y.a.createElement("div",{className:"m-datasync"},y.a.createElement(ne.a,{current:e},t.map(function(e){return y.a.createElement(Lt,{key:e.title,title:e.title})})),y.a.createElement("div",{className:"steps-content"},t[e].content))}}]),t}(y.a.Component),Ht=function(e){var t=e.offlineTask.workbench.currentTab;return{dataSync:e.offlineTask.dataSync,tabs:e.offlineTask.workbench.tabs,currentTab:t}},Nt=function(e){return{getDataSource:function(){$.a.getOfflineDataSource().then(function(t){var a=[];1===t.code&&(a=t.data),e({type:T.a.LOAD_DATASOURCE,payload:a})})},getJobData:function(t){$.a.getOfflineJobData(t).then(function(t){e({type:T.b.INIT_JOBDATA,payload:t.data}),null===t.data?e({type:T.o.SET_CURRENT_TAB_NEW}):e({type:T.o.SET_CURRENT_TAB_SAVED})})},saveJobData:function(t){$.a.saveOfflineJobData(t).then(function(t){1===t.code&&(w.a.success("保存成功！"),e({type:T.o.SET_CURRENT_TAB_SAVED}),e({type:T.o.MAKE_TAB_CLEAN}))})}}},Ft=Object(b.b)(Ht,Nt)(xt),Mt=Ft,It=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Lt,"Step","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/index.js"),__REACT_HOT_LOADER__.register(xt,"DataSync","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/index.js"),__REACT_HOT_LOADER__.register(Ht,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/index.js"),__REACT_HOT_LOADER__.register(Nt,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/index.js"),__REACT_HOT_LOADER__.register(Ft,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataSync/index.js")),a(375)),Vt=q.a.Item,jt=_e.a.Option,Ut=ce.a.Group,Pt=function(e){function t(){return p()(this,t),f()(this,(t.__proto__||u()(t)).apply(this,arguments))}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.taskType,n=a===X.m.MR,r=a===X.m.PYTHON,i=n?X.h.JAR:r?X.h.PY:"";return y.a.createElement(q.a,null,y.a.createElement(Vt,N()({},X.q,{label:"任务名称"}),e("name",{rules:[{max:64,message:"任务名称不得超过20个字符！"}],initialValue:t.name})(y.a.createElement(x.a,{disabled:!0}))),y.a.createElement(Vt,N()({},X.q,{label:"任务类型"}),e("taskType",{rules:[{}],initialValue:a})(y.a.createElement(Ut,{disabled:!0,onChange:this.handleRadioChange},y.a.createElement(ce.a,{value:X.m.SQL},"SQL"),y.a.createElement(ce.a,{value:X.m.MR},"MR"),y.a.createElement(ce.a,{value:X.m.SYNC},"数据同步"),y.a.createElement(ce.a,{value:X.m.PYTHON},"Python"),y.a.createElement(ce.a,{value:X.m.VIRTUAL_NODE},"虚节点")))),a!==X.m.VIRTUAL_NODE&&y.a.createElement(Vt,N()({},X.q,{label:"资源"}),e("resourceIdList",{rules:[{required:!0,message:"请选择关联资源"}],initialValue:t.resourceList.length?t.resourceList[0].id:""})(y.a.createElement(x.a,{type:"hidden"})),y.a.createElement(It.a,{ispicker:!0,isFilepicker:!0,acceptRes:i,type:X.f.RESOURCE,treeData:this.props.resTreeData,onChange:this.handleResChange.bind(this),defaultNode:t.resourceList.length?t.resourceList[0].resourceName:""})),a!==X.m.PYTHON&&a!==X.m.VIRTUAL_NODE&&y.a.createElement(Vt,N()({},X.q,{label:"mainClass",hasFeedback:!0}),e("mainClass",{rules:[{required:!0,message:"mainClass 不可为空！"}],initialValue:t.mainClass})(y.a.createElement(x.a,{placeholder:"请输入 mainClass"}))),a!==X.m.VIRTUAL_NODE&&y.a.createElement("span",null,y.a.createElement(Vt,N()({},X.q,{label:"参数"}),e("exeArgs",{initialValue:t.exeArgs})(y.a.createElement(x.a,{placeholder:"请输入任务参数"}))),y.a.createElement(Vt,N()({},X.q,{label:"存储位置"}),e("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:t.nodePid})(y.a.createElement(x.a,{type:"hidden"})),y.a.createElement(It.a,{type:X.f.TASK,ispicker:!0,isFilepicker:!1,treeData:this.props.pathTreeData,onChange:this.handlePathChange.bind(this),defaultNode:t.nodePName}))),y.a.createElement(Vt,N()({},X.q,{label:"描述",hasFeedback:!0}),e("taskDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:t.taskDesc})(y.a.createElement(x.a,{type:"textarea",rows:4,placeholder:"请输入任务描述"}))),y.a.createElement(Vt,{style:{display:"none"}},e("computeType",{initialValue:1})(y.a.createElement(x.a,{type:"hidden"}))))}},{key:"handleResChange",value:function(e){this.props.form.setFieldsValue({resourceIdList:[e]})}},{key:"handlePathChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}}]),t}(y.a.Component),qt=q.a.create({onValuesChange:function(e,t){var a=e.setFieldsValue,n=e.taskCustomParams,r=!1;""===t.mainClass&&(r=!0),t.invalid=r,""!==t.exeArgs&&(t.taskVariables=Object(he.c)(n,t.exeArgs)),a(t)}})(Pt),Bt=function(e){function t(e){return p()(this,t),f()(this,(t.__proto__||u()(t)).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){return y.a.createElement("div",{className:"m-taskedit",style:{padding:60}},y.a.createElement(qt,this.props))}}]),t}(y.a.Component),Kt=function(e,t){var a=e.offlineTask;return{resTreeData:a.resourceTree,pathTreeData:a.taskTree,taskCustomParams:a.workbench.taskCustomParams}},Wt=function(e){return{setFieldsValue:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t})}}},Gt=Object(b.b)(Kt,Wt)(Bt),zt=Gt,Yt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Vt,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(jt,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Ut,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Pt,"NormalTaskForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(qt,"NormalTaskFormWrapper","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Bt,"NormalTaskEditor","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Kt,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Wt,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js"),__REACT_HOT_LOADER__.register(Gt,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/normalTask.js")),a(62)),Qt=a(18),Jt=a.n(Qt),$t=a(134),Xt=a(177),Zt=a(123),ea=a(722),ta=K.a.confirm,aa=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={confirmCode:"",execConfirmVisible:!1},n.onNeverWarning=function(){var e;return(e=n).__onNeverWarning__REACT_HOT_LOADER__.apply(e,arguments)},n.filterSql=function(){var e;return(e=n).__filterSql__REACT_HOT_LOADER__.apply(e,arguments)},n.execSQL=function(){var e;return(e=n).__execSQL__REACT_HOT_LOADER__.apply(e,arguments)},n.reqExecSQL=function(){var e;return(e=n).__reqExecSQL__REACT_HOT_LOADER__.apply(e,arguments)},n.stopSQL=function(){var e;return(e=n).__stopSQL__REACT_HOT_LOADER__.apply(e,arguments)},n.execConfirm=function(){var e;return(e=n).__execConfirm__REACT_HOT_LOADER__.apply(e,arguments)},n.sqlFormat=function(){var e;return(e=n).__sqlFormat__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__onNeverWarning__REACT_HOT_LOADER__",value:function(e){var t=e.target.checked?1:0;this.props.dispatch(Object(Xt.f)({isCheckDDL:t}))}},{key:"__filterSql__REACT_HOT_LOADER__",value:function(e){var t=[],a=Object(Yt.b)(e);if(a&&(a=a.split(";")),a&&a.length>0)for(var n=0;n<a.length;n++){var r=a[n];""!==J.a.trim(r)&&t.push(J.a.trimlr(r))}return t}},{key:"__execSQL__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentTab,a=e.sqlEditor,n=e.user,r=e.currentTabData,i=e.project,s=e.dispatch,l={projectId:i.id,isCheckDDL:n.isCheckDDL,taskVariables:r.taskVariables};this.setState({execConfirmVisible:!1});var o=a.selection||r.sqlText||r.scriptText,c=this.filterSql(o);if(c&&c.length>0){s(Object(Zt.h)(t," 正在提交... \n waiting...")),s(Object(Zt.a)(t)),this.reqExecSQL(r,l,c,0)}}},{key:"__reqExecSQL__REACT_HOT_LOADER__",value:function(e,t,a,n){var r=this.props,i=r.dispatch,s=r.currentTab;i(Object(ea.a)(s,e,t,a))}},{key:"__stopSQL__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentTabData,a=e.dispatch,n=e.currentTab;a(Object(ea.b)(n,t))}},{key:"__execConfirm__REACT_HOT_LOADER__",value:function(){var e=this.props,t=(e.currentTab,e.currentTabData),a=(e.dispatch,e.user),n=e.sqlEditor;if(1!==a.isCheckDDL){var r=n.selection||t.sqlText||t.scriptText;r=Object(Yt.b)(r);/(create|alter|drop|truncate)+\s+(external|temporary)?\s?(table)+\s+([\s\S]*?)/gi.test(r)?this.setState({execConfirmVisible:!0,confirmCode:r}):(this.execSQL(),this.setState({execConfirmVisible:!1}))}else this.execSQL()}},{key:"__sqlFormat__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentTabData,a=e.dispatch,n={sql:t.sqlText||t.scriptText||""};$.a.sqlFormat(n).then(function(e){if(e.data){var n={merged:!0};t.scriptText?n.scriptText=e.data:n.sqlText=e.data,a({type:T.o.SET_TASK_SQL_FIELD_VALUE,payload:n})}})}},{key:"getUniqueKey",value:function(e){return e+"_"+Jt()().valueOf()}},{key:"render",value:function(){var e=this,t=this.state,a=(t.running,t.execConfirmVisible),n=t.confirmCode,r=this.props,i=r.currentTab,s=!(r.sqlEditor.running.indexOf(i)>-1);this.props.currentTabData;return y.a.createElement("div",{className:"ide-toolbar toolbar"},y.a.createElement(V.a,{onClick:this.execConfirm,loading:!s,disabled:!s,title:"立即运行",icon:"play-circle-o",style:{marginLeft:"0px"}}," 运行"),y.a.createElement(V.a,{onClick:this.stopSQL,icon:"pause-circle-o",title:"立即停止",disabled:s},"停止"),y.a.createElement(V.a,{icon:"appstore-o",title:"格式化",onClick:this.sqlFormat},"格式化"),y.a.createElement(K.a,{maskClosable:!0,visible:a,title:"执行的语句中包含DDL语句，是否确认执行？",wrapClassName:"vertical-center-modal modal-body-nopadding",onCancel:function(){e.setState({execConfirmVisible:!1})},footer:y.a.createElement("div",null,y.a.createElement(mt.a,{onChange:this.onNeverWarning},"不再提示"),y.a.createElement(V.a,{onClick:function(){e.setState({execConfirmVisible:!1})}},"取消"),y.a.createElement(V.a,{type:"primary",onClick:this.execSQL},"执行"))},y.a.createElement("div",{style:{height:"400px"}},y.a.createElement($t.a,{value:n,sync:!0}))))}}]),t}(k.Component),na=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ta,"confirm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/toolbar.js"),__REACT_HOT_LOADER__.register(aa,"Toolbar","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/toolbar.js")),G.a.TabPane),ra={mode:"text/x-sql",lineNumbers:!1,readOnly:!0,autofocus:!1,indentWithTabs:!0,smartIndent:!0},ia={position:"fixed",bottom:"0px",height:"30px"},sa=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={currentPage:1},n.onChange=function(){var e;return(e=n).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__onChange__REACT_HOT_LOADER__",value:function(e){this.setState({currentPage:e.current})}},{key:"generateCols",value:function(e){var t=this.state.currentPage;if(e&&e.length>0){var a=[{title:"序号",key:"t-id",render:function(e,a,n){return 10*(t-1)+(n+1)}}];return e.forEach(function(e,t){a.push({title:e,key:t+e,render:function(e,a){return y.a.createElement("textarea",{title:a[t],value:a[t]})}})}),a}return[]}},{key:"render",value:function(){var e=this.props.data,t=e.slice(1,e.length),a=this.generateCols(e[0]);return y.a.createElement(le.a,{rowKey:"id",scroll:{x:!0},className:"console-table",bordered:!0,dataSource:t,onChange:this.onChange,columns:a})}}]),t}(k.Component),la=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={activeKey:"console-log"},n.onEdit=function(){var e;return(e=n).__onEdit__REACT_HOT_LOADER__.apply(e,arguments)},n.onChange=function(){var e;return(e=n).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},n.focusEditor=function(){var e;return(e=n).__focusEditor__REACT_HOT_LOADER__.apply(e,arguments)},n.remove=function(){var e;return(e=n).__remove__REACT_HOT_LOADER__.apply(e,arguments)},n.closeConsole=function(){var e;return(e=n).__closeConsole__REACT_HOT_LOADER__.apply(e,arguments)},n.appendLog=function(){var e;return(e=n).__appendLog__REACT_HOT_LOADER__.apply(e,arguments)},n.exportCsv=function(){var e;return(e=n).__exportCsv__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.data,a=this.props.data;t.showRes&&t.results.length>0&&!Object(v.isEqual)(t.results,a.results)?this.setState({activeKey:""+(t.results.length-1)}):(!t.showRes&&t.log!==a.log||0===t.results.length)&&this.setState({activeKey:"console-log"},this.focusEditor)}},{key:"__onEdit__REACT_HOT_LOADER__",value:function(e,t){this[t](e)}},{key:"__onChange__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({activeKey:e},function(){"console-log"===e&&t.focusEditor()})}},{key:"__focusEditor__REACT_HOT_LOADER__",value:function(){var e=this.editor.self;e.doc.setCursor(e.lineCount(),null)}},{key:"__remove__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.currentTab;(0,t.dispatch)(Object(Zt.f)(a,parseInt(e,10)))}},{key:"__closeConsole__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentTab;(0,e.dispatch)(Object(Zt.g)(t))}},{key:"__appendLog__REACT_HOT_LOADER__",value:function(e){if(e){var t=this.editor.self.doc;t.setValue(e),t.setCursor(t.lineCount(),null)}}},{key:"__exportCsv__REACT_HOT_LOADER__",value:function(){var e=this.props.data.results[parseInt(this.state.activeKey,10)],t="";e.forEach(function(a,n){var r=a.join(",");t+=n<e.length?r+"\n":r});var a=new Blob([t]);if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(a,"下载.csv");else{var n=window.document.createElement("a");n.href=window.URL.createObjectURL(a,{type:"text/plain"}),n.download="下载.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}},{key:"renderTabs",value:function(e){var t=this;return e&&e.length>0?e.map(function(e,a){var n=y.a.createElement("span",null,"结果",a+1);return y.a.createElement(na,{style:{height:"0px"},tab:n,key:""+a},y.a.createElement(sa,{data:e}),y.a.createElement(V.a,{style:ia,onClick:t.exportCsv},"下载"))}):[]}},{key:"render",value:function(){var e=this,t=this.props,a=t.data;t.dispatch;return y.a.createElement("div",{className:"ide-console"},y.a.createElement(G.a,{hideAdd:!0,type:"editable-card",activeKey:this.state.activeKey,onChange:this.onChange,onEdit:this.onEdit},y.a.createElement(na,{tab:"日志",key:"console-log"},y.a.createElement("div",{style:{position:"relative"}},y.a.createElement($t.a,{cursorAlwaysInEnd:!0,style:{minHeight:"auto"},ref:function(t){e.editor=t},options:ra,key:"output-log",sync:!0,value:a.log}))),this.renderTabs(a.results)),y.a.createElement(je.a,{placement:"top",title:"关闭控制台"},y.a.createElement(s.a,{className:"close-console",type:"close",onClick:this.closeConsole})))}}]),t}(k.Component),oa=la,ca=oa,ua=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(na,"TabPane","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js"),__REACT_HOT_LOADER__.register(ra,"editorOptions","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js"),__REACT_HOT_LOADER__.register(ia,"exportStyle","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js"),__REACT_HOT_LOADER__.register(sa,"Result","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js"),__REACT_HOT_LOADER__.register(la,"Console","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js"),__REACT_HOT_LOADER__.register(oa,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/console.js")),function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.handleEditorTxtChange=function(){var e;return(e=n).__handleEditorTxtChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onEditorSelection=function(){var e;return(e=n).__onEditorSelection__REACT_HOT_LOADER__.apply(e,arguments)},n.debounceChange=Object(v.debounce)(n.handleEditorTxtChange,300,{maxWait:2e3}),n.debounceSelectionChange=Object(v.debounce)(n.onEditorSelection,200,{maxWait:2e3}),r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.currentTabData;e&&this.props.getTab(e.id)}},{key:"componentWillReceiveProps",value:function(e){var t=e.currentTabData,a=this.props.currentTabData;t&&t.id!==a.id&&this.props.getTab(t.id)}},{key:"__handleEditorTxtChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.currentTabData,r=this.props.taskCustomParams,i={merged:!1,cursor:a.getCursor()};if(e!==t){if(J.a.checkExist(n.taskType)){i.sqlText=t;var s=Object(Yt.b)(t);i.taskVariables=Object(he.c)(r,s)}else J.a.checkExist(n.type)&&(i.scriptText=t);this.props.updateTaskFields(i)}}},{key:"__onEditorSelection__REACT_HOT_LOADER__",value:function(e,t){var a=t.getSelection();t.somethingSelected()?this.props.setSelection(a):""!==this.props.sqlEditor.selection&&this.props.setSelection("")}},{key:"render",value:function(){var e=this.props,t=e.sqlEditor,a=e.currentTabData,n=e.options,r=e.value,i=a.id,s=t.console,l=s&&s[i]?s[i]:{results:[]},o=a.cursor||void 0;return y.a.createElement("div",{className:"ide-sql"},y.a.createElement("div",{className:"ide-header bd-bottom"},y.a.createElement(aa,this.props)),y.a.createElement("div",{className:"ide-content"},l.log?y.a.createElement(Q.a,{split:"horizontal",minSize:100,maxSize:"80%",style:{paddingBottom:"40px"},defaultSize:"60%",primary:"first"},y.a.createElement("div",{className:"ide-editor bd-bottom"},y.a.createElement($t.a,{key:"sqlEditor",sync:a.merged||void 0,options:n,value:r,cursor:o,cursorActivity:this.debounceSelectionChange,onChange:this.debounceChange})),y.a.createElement(ca,{data:l,currentTab:i,dispatch:this.props.dispatch})):y.a.createElement("div",{className:"ide-editor bd-bottom"},y.a.createElement($t.a,{key:"sqlEditor",sync:a.merged||void 0,options:n,cursor:o,cursorActivity:this.debounceSelectionChange,onChange:this.debounceChange,value:r}))))}}]),t}(k.Component)),_a=Object(b.b)(function(e){return{sqlEditor:e.sqlEditor,project:e.project,user:e.user}},function(e){return{dispatch:e,updateTaskFields:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t})},setSelection:function(t){e(Object(Zt.i)(t))},getTab:function(t){e(Object(Zt.b)(t))}}})(ua),pa=_a,da=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ua,"SQLEditor","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/index.js"),__REACT_HOT_LOADER__.register(_a,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/sqlEditor/index.js")),K.a.confirm),ma=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.unLock=function(){return a.__unLock__REACT_HOT_LOADER__.apply(a,arguments)},a}return g()(t,e),m()(t,[{key:"__unLock__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.tabData,a=e.updateTaskFields,n=e.updateCatalogue,r=t.readWriteLockVO;da({title:"解锁提醒",content:"文件正在被"+r.lastKeepLockUserName+"编辑中，开始编辑时间\n                "+J.a.formatDateTime(r.gmtModified)+"。\n                强制编辑可能导致"+r.lastKeepLockUserName+"对该文件的修改无法保存！\n            ",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){var e={fileId:t.id,lockVersion:r.version};J.a.checkExist(t.taskType)?e.type=X.e.OFFLINE_TASK:J.a.checkExist(t.type)&&(e.type=X.e.OFFLINE_SCRIPT),$.a.unlockFile(e).then(function(r){if(1===r.code){var i=r.data;i.getLock?w.a.success("文件解锁成功！"):K.a.error({title:"解锁失败",content:"文件正在被"+i.lastKeepLockUserName+"编辑中!开始编辑时间\n                                "+J.a.formatDateTime(i.gmtModified)+"."});var s={id:t.id};e.type===X.e.OFFLINE_TASK?$.a.getOfflineTaskDetail(s).then(function(e){if(1===e.code){var r=e.data;r.merged=!0;var i={id:t.id,readWriteLockVO:r.readWriteLockVO};n(i),a(r)}}):e.type===X.e.OFFLINE_SCRIPT&&$.a.getScriptById(s).then(function(e){if(1===e.code){var r=e.data;r.merged=!0;var i={id:t.id,readWriteLockVO:r.readWriteLockVO};n(i),a(r)}})}})},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this.props.tabData;return y.a.createElement("div",{className:"m-mainbench editor-container"},e&&this.renderBench(e),e&&this.renderLock(e))}},{key:"renderLock",value:function(e){var t=e.readWriteLockVO&&!e.readWriteLockVO.getLock,a="0px";return e.taskType&&e.taskType!==X.m.SQL&&(a="10px"),t?y.a.createElement("div",{className:"lock-layer"},y.a.createElement(te.a,{style:{position:"absolute",top:a,left:"35%",zIndex:"999"},showIcon:!0,message:y.a.createElement("span",null,"当前文件为只读状态！",y.a.createElement("a",{onClick:this.unLock},"解锁")),type:"warning"})):""}},{key:"renderBench",value:function(e){var t=this.props.taskCustomParams;if(X.p.autofocus=!0,X.p.indentUnit=4,X.p.indentWithTabs=!1,J.a.checkExist(e&&e.taskType))switch(e.taskType){case X.m.MR:case X.m.PYTHON:case X.m.VIRTUAL_NODE:return y.a.createElement(zt,N()({key:e.id},e));case X.m.SYNC:return y.a.createElement(Mt,N()({key:e.id},e));case X.m.SQL:return y.a.createElement(pa,{options:X.p,taskCustomParams:t,key:e.id,value:e.sqlText,currentTab:e.id,currentTabData:e});default:return y.a.createElement("p",{className:"txt-center",style:{lineHeight:"60px"}},"未知任务类型")}else if(J.a.checkExist(e&&e.type))return y.a.createElement(pa,{options:X.p,key:e.id,value:e.scriptText,currentTab:e.id,currentTabData:e})}}]),t}(y.a.Component),ha=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(da,"confirm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/mainBench.js"),__REACT_HOT_LOADER__.register(ma,"MainBench","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/mainBench.js")),a(850),a(721)),fa=a.n(ha),Ea=a(70),ga=a(41),ka=a.n(ga),ya=(a(1412),a(374));a(855),a(1410);var ba=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.initUI=function(){var e;return(e=n).__initUI__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,a=e.compareTo;this.initUI(t,a)}},{key:"componentWillReceiveProps",value:function(e){var t=e.value,a=e.compareTo;t&&this.props.value!==t&&this._self.edit.doc.setValue(t),a&&this.props.compareTo!==a&&this._self.right.orig.doc.setValue(a)}},{key:"__initUI__REACT_HOT_LOADER__",value:function(e,t){var a=this.props.onChange,n=this.getCodeMirrorIns().MergeView(this.diffView,{value:e,origLeft:null,orig:t,lineNumbers:!0,mode:"text/x-sql",highlightDifferences:!0,connect:null,collapseIdentical:!1});n.edit.doc.on("change",function(t){a&&a(e,t.getValue())}),n.wrap.style.height="500px",this._self=n}},{key:"mergeViewHeight",value:function(e){function t(e){return e?e.getScrollInfo().height:0}return Math.max(t(e.leftOriginal()),t(e.editor()),t(e.rightOriginal()))}},{key:"resize",value:function(e){for(var t=this.mergeViewHeight(e);;){e.leftOriginal()&&e.leftOriginal().setSize(null,t),e.editor().setSize(null,t),e.rightOriginal()&&e.rightOriginal().setSize(null,t);var a=this.mergeViewHeight(e);if(a>=t)break;t=a}e.wrap.style.height=t+"px"}},{key:"getCodeMirrorIns",value:function(){return this._self||ya}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.style,r="code-editor";r=a?r+" "+a:r;var i={position:"relative"};return i=n?ka()(i,n):i,y.a.createElement("div",{ref:function(t){e.diffView=t},className:r,style:i})}}]),t}(k.Component),va=ba,Ta=va,Ca=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ba,"DiffEditor","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/components/diff-code-editor/index.js"),__REACT_HOT_LOADER__.register(va,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/components/diff-code-editor/index.js")),function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.state={showDiff:!1,campareTo:""},a.diffCode=function(){return a.__diffCode__REACT_HOT_LOADER__.apply(a,arguments)},a.close=function(){return a.__close__REACT_HOT_LOADER__.apply(a,arguments)},a.codeChange=function(){return a.__codeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.taskVersionCols=function(){return a.__taskVersionCols__REACT_HOT_LOADER__.apply(a,arguments)},a}return g()(t,e),m()(t,[{key:"__diffCode__REACT_HOT_LOADER__",value:function(e){this.setState({showDiff:!0,campareTo:e})}},{key:"__close__REACT_HOT_LOADER__",value:function(){this.setState({showDiff:!1,campareTo:""})}},{key:"__codeChange__REACT_HOT_LOADER__",value:function(e,t){this.props.changeSql(t)}},{key:"render",value:function(){var e=this.props.taskInfo,t=this.state,a=t.showDiff,n=t.campareTo;return y.a.createElement("div",null,y.a.createElement(le.a,{className:"m-table",rowKey:"id",dataSource:e.taskVersions||[],columns:this.taskVersionCols(),pagination:!1}),y.a.createElement(K.a,{wrapClassName:"vertical-center-modal modal-body-nopadding",title:"历史版本对比",width:"900px",bodyStyle:{height:"500px"},visible:a,onCancel:this.close,cancelText:"关闭",footer:null},y.a.createElement(Ta,{value:e.sqlText,compareTo:n.sqlText,onChange:this.codeChange})))}},{key:"__taskVersionCols__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.taskInfo;return[{width:120,title:"发布时间",dataIndex:"gmtCreate",key:"gmtCreate",render:function(e){return J.a.formatDateTime(e)}},{title:"发布人",dataIndex:"userName",key:"userName"},{width:120,title:"描述",dataIndex:"publishDesc",key:"publishDesc"},{title:"操作",dataIndex:"id",width:80,key:"operation",render:function(a,n){return y.a.createElement("span",null,t.taskType===X.m.SQL?y.a.createElement("a",{onClick:function(){return e.diffCode(n)}},"代码"):"-")}}]}}]),t}(y.a.Component)),Oa=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ca,"TaskVersion","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskVersion.js"),fa.a.Panel);function Aa(e){var t=e.taskInfo;return y.a.createElement(r.a,{className:"task-info"},y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"任务名称："),y.a.createElement(o.a,{span:"14"},t.name)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"任务类型："),y.a.createElement(o.a,{span:"14"},y.a.createElement(Ea.k,{value:t.taskType}))),t.resourceList.length&&y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"资源："),y.a.createElement(o.a,{span:"14t"},t.resourceList.map(function(e){return y.a.createElement(A.a,{key:e.id,color:"blue",style:{marginTop:10}},e.resourceName)}))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"创建人员："),y.a.createElement(o.a,{span:"14"},t.createUser.userName)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"创建时间："),y.a.createElement(o.a,{span:"14"},J.a.formatDateTime(t.gmtCreate))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"最近修改人员："),y.a.createElement(o.a,{span:"14"},t.modifyUser.userName)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"最近修改时间："),y.a.createElement(o.a,{span:"14"},J.a.formatDateTime(t.gmtModified))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"描述："),y.a.createElement(o.a,{span:"14",style:{lineHeight:"20px",padding:"10 0"}},t.taskDesc)))}var Ra=function(e){function t(e){return p()(this,t),f()(this,(t.__proto__||u()(t)).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this.props.tabData;return y.a.createElement("div",{className:"m-taksdetail"},y.a.createElement(fa.a,{bordered:!1,defaultActiveKey:["1","2"]},y.a.createElement(Oa,{key:"1",header:"任务属性"},y.a.createElement(Aa,{taskInfo:e})),y.a.createElement(Oa,{key:"2",header:"历史发布版本"},y.a.createElement(Ca,{taskInfo:e,changeSql:this.props.setSqlText}))))}}]),t}(y.a.Component),wa=Object(b.b)(function(e,t){return N()({},t)},function(e){return{setSqlText:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:{sqlText:t,merged:!0}})}}})(Ra),Da=wa,Sa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Oa,"Panel","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskDetail.js"),__REACT_HOT_LOADER__.register(Aa,"TaskInfo","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskDetail.js"),__REACT_HOT_LOADER__.register(Ra,"TaskDetail","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskDetail.js"),__REACT_HOT_LOADER__.register(wa,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskDetail.js")),fa.a.Panel),La=function(e){function t(e){return p()(this,t),f()(this,(t.__proto__||u()(t)).call(this,e))}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this.props.tabData;return y.a.createElement("div",{className:"m-taksdetail"},y.a.createElement(fa.a,{bordered:!1,defaultActiveKey:["1","2"]},y.a.createElement(Sa,{key:"1",header:"脚本属性"},y.a.createElement(r.a,{className:"task-info"},y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"脚本名称："),y.a.createElement(o.a,{span:"14"},e.name)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"创建人员："),y.a.createElement(o.a,{span:"14"},e.createUser.userName)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"创建时间："),y.a.createElement(o.a,{span:"14"},J.a.formatDateTime(e.gmtCreate))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"最近修改人员："),y.a.createElement(o.a,{span:"14"},e.modifyUser.userName)),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"最近修改时间："),y.a.createElement(o.a,{span:"14"},J.a.formatDateTime(e.gmtModified))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"10",className:"txt-right"},"描述："),y.a.createElement(o.a,{span:"14",style:{lineHeight:"20px",padding:"10 0"}},e.scriptDesc))))))}}]),t}(y.a.Component),xa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Sa,"Panel","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/scriptDetail.js"),__REACT_HOT_LOADER__.register(La,"ScriptDetail","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/scriptDetail.js")),a(110),a(73)),Ha=a.n(xa),Na=fa.a.Panel,Fa=_e.a.Option,Ma=q.a.Item,Ia=ce.a.Group,Va={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},ja=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.changeScheduleStatus=a.props.handleScheduleStatus,a.changeScheduleConf=a.props.handleScheduleConf,a.changeScheduleType=a.props.handleScheduleType,a}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.status,r=a.scheduleConf,i=r.periodType,s=function(){for(var t=[],a=0;a<=23;a++)t.push(y.a.createElement(Fa,{key:a,value:""+a},a<10?"0"+a:a));return y.a.createElement(_e.a,{onChange:e.changeScheduleConf.bind(e)},t)},l=function(){for(var t=[],a=0;a<=59;a++)t.push(y.a.createElement(Fa,{key:a,value:""+a},a<10?"0"+a:a));return y.a.createElement(_e.a,{onChange:e.changeScheduleConf.bind(e)},t)};return y.a.createElement(q.a,{key:i},y.a.createElement(Ma,N()({},Va,{label:"调度状态"}),t("scheduleStatus",{valuePropName:"checked",initialValue:0===n||2===n})(y.a.createElement(mt.a,{onChange:this.changeScheduleStatus.bind(this)},"冻结"))),y.a.createElement(Ma,N()({},Va,{label:"生效日期"}),t("beginDate",{initialValue:Jt()(r.beginDate,"YYYY-MM-DD")})(y.a.createElement(Ha.a,{onChange:this.changeScheduleConf.bind(this)})),"-",t("endDate",{initialValue:Jt()(r.endDate,"YYYY-MM-DD")})(y.a.createElement(Ha.a,{onChange:this.changeScheduleConf.bind(this)}))),y.a.createElement(Ma,N()({},Va,{label:"调度周期"}),y.a.createElement(o.a,{span:"6"},t("periodType",{initialValue:""+r.periodType,rules:[{required:!0}]})(y.a.createElement(_e.a,{onChange:this.changeScheduleType.bind(this)},y.a.createElement(Fa,{key:0,value:"0"},"分钟"),y.a.createElement(Fa,{key:1,value:"1"},"小时"),y.a.createElement(Fa,{key:2,value:"2"},"天"),y.a.createElement(Fa,{key:3,value:"3"},"周"),y.a.createElement(Fa,{key:4,value:"4"},"月"))))),y.a.createElement(Ma,{style:{display:"none"}},t("selfReliance",{initialValue:r.selfReliance})(y.a.createElement(x.a,{type:"hidden"}))),function(a,n){var i=void 0;switch(a){case 0:i=y.a.createElement("span",{key:a},y.a.createElement(Ma,N()({},Va,{label:"开始时间"}),y.a.createElement(o.a,{span:"6"},t("beginHour",{rules:[{required:!0},{validator:n.checkTimeS.bind(n)}],initialValue:""+r.beginHour})(s())),y.a.createElement(o.a,{span:"1"},"时"),y.a.createElement(o.a,{span:"6"},t("beginMin",{rules:[{required:!0}],initialValue:"0"})(y.a.createElement(_e.a,{disabled:!0},y.a.createElement(Fa,{value:"0"},"0")))),y.a.createElement(o.a,{span:"1"},"分")),y.a.createElement(Ma,N()({},Va,{label:"间隔时间"}),y.a.createElement(o.a,{span:"6"},t("gapMin",{rules:[{required:!0}],initialValue:""+r.gapMin})(y.a.createElement(_e.a,{onChange:n.changeScheduleConf.bind(n)},function(){for(var e=[],t=5;t<=55;t+=5)e.push(y.a.createElement(Fa,{key:t,value:""+t},t,"分钟"));return e}())))),y.a.createElement(Ma,N()({},Va,{label:"结束时间"}),y.a.createElement(o.a,{span:"6"},t("endHour",{rules:[{required:!0},{validator:n.checkTimeE.bind(n)}],initialValue:""+r.endHour})(s())),y.a.createElement(o.a,{span:"1"},"时"),y.a.createElement(o.a,{span:"6"},t("endMin",{initialValue:"59"})(y.a.createElement(_e.a,{disabled:!0},y.a.createElement(Fa,{value:"59"},"59")))),y.a.createElement(o.a,{span:"1"},"分")));break;case 1:i=y.a.createElement("span",{key:a},y.a.createElement(Ma,N()({},Va,{label:"开始时间"}),y.a.createElement(o.a,{span:"6"},t("beginHour",{rules:[{required:!0},{validator:n.checkTimeS1.bind(n)}],initialValue:""+r.beginHour})(s())),y.a.createElement(o.a,{span:"1"},"时"),y.a.createElement(o.a,{span:"6"},t("beginMin",{rules:[{required:!0},{validator:n.checkTimeS1.bind(n)}],initialValue:""+r.beginMin})(l())),y.a.createElement(o.a,{span:"1"},"分")),y.a.createElement(Ma,N()({},Va,{label:"间隔时间"}),y.a.createElement(o.a,{span:"6"},t("gapHour",{rules:[{required:!0}],initialValue:""+r.gapHour})(y.a.createElement(_e.a,{onChange:n.changeScheduleConf.bind(n)},function(){for(var e=[],t=1;t<=23;t++)e.push(y.a.createElement(Fa,{key:t,value:""+t},t,"小时"));return e}())))),y.a.createElement(Ma,N()({},Va,{label:"结束时间"}),y.a.createElement(o.a,{span:"6"},t("endHour",{rules:[{required:!0},{validator:n.checkTimeE1.bind(n)}],initialValue:""+r.endHour})(s())),y.a.createElement(o.a,{span:"1"},"时"),y.a.createElement(o.a,{span:"6"},t("endMin",{rules:[{required:!0}],initialValue:"59"})(y.a.createElement(_e.a,{disabled:!0},y.a.createElement(Fa,{value:"59"},"59")))),y.a.createElement(o.a,{span:"1"},"分")));break;case 2:i=y.a.createElement("span",{key:a},y.a.createElement(Ma,N()({},Va,{label:"起调周期"}),y.a.createElement(o.a,{span:"6"},t("hour",{rules:[{required:!0}],initialValue:""+r.hour})(s())),y.a.createElement(o.a,{span:"1"},"时"),y.a.createElement(o.a,{span:"6"},t("min",{rules:[{required:!0}],initialValue:""+r.min})(l())),y.a.createElement(o.a,{span:"1"},"分")));break;case 3:i=y.a.createElement("span",{key:a},y.a.createElement(Ma,N()({},Va,{label:"选择时间"}),y.a.createElement(o.a,{span:"13"},t("weekDay",{rules:[{required:!0}],initialValue:(""+r.weekDay).split(",")})(y.a.createElement(_e.a,{mode:"multiple",style:{width:"100%"},onChange:e.changeScheduleConf.bind(e)},y.a.createElement(Fa,{key:1,value:"1"},"星期一"),y.a.createElement(Fa,{key:2,value:"2"},"星期二"),y.a.createElement(Fa,{key:3,value:"3"},"星期三"),y.a.createElement(Fa,{key:4,value:"4"},"星期四"),y.a.createElement(Fa,{key:5,value:"5"},"星期五"),y.a.createElement(Fa,{key:6,value:"6"},"星期六"),y.a.createElement(Fa,{key:7,value:"7"},"星期天"))))),y.a.createElement(Ma,N()({},Va,{label:"具体时间"}),y.a.createElement(o.a,{span:"6"},t("hour",{rules:[{required:!0}],initialValue:""+r.hour})(s())),y.a.createElement(o.a,{span:"1"}," 时 "),y.a.createElement(o.a,{span:"6"},t("min",{rules:[{required:!0}],initialValue:""+r.min})(l())),y.a.createElement(o.a,{span:"1"},"分")));break;case 4:i=y.a.createElement("span",{key:a},y.a.createElement(Ma,N()({},Va,{label:"选择时间"}),y.a.createElement(o.a,{span:"13"},t("day",{rules:[{required:!0}],initialValue:(""+r.day).split(",")})(function(){for(var t=[],a=1;a<=31;a++)t.push(y.a.createElement(Fa,{key:a,value:""+a},"每月"+a+"号"));return y.a.createElement(_e.a,{mode:"multiple",style:{width:"100%"},onChange:e.changeScheduleConf.bind(e)},t)}()))),y.a.createElement(Ma,N()({},Va,{label:"具体时间"}),y.a.createElement(o.a,{span:"6"},t("hour",{rules:[{required:!0}],initialValue:""+r.hour})(s())),y.a.createElement(o.a,{span:"1"}," 时 "),y.a.createElement(o.a,{span:"6"},t("min",{rules:[{required:!0}],initialValue:""+r.min})(l())),y.a.createElement(o.a,{span:"1"}," 分 ")));break;default:i=y.a.createElement("span",null,"something wrong")}return i}(+i,this))}},{key:"checkTimeS",value:function(e,t,a){+t>+this.props.form.getFieldValue("endHour")&&a("开始时间不能晚于结束时间"),a()}},{key:"checkTimeE",value:function(e,t,a){+t<+this.props.form.getFieldValue("beginHour")&&a("结束时间不能早于开始时间"),a()}},{key:"checkTimeS1",value:function(e,t,a){var n=this.props.form;60*+n.getFieldValue("beginHour")+ +n.getFieldValue("beginMin")>60*+n.getFieldValue("endHour")+59&&a("开始时间不能晚于结束时间"),a()}},{key:"checkTimeE1",value:function(e,t,a){var n=this.props.form;60*+n.getFieldValue("beginHour")+ +n.getFieldValue("beginMin")>60*+n.getFieldValue("endHour")+59&&a("结束时间不能早于开始时间"),a()}}]),t}(y.a.Component),Ua=q.a.create()(ja),Pa=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e)),n=a.props.tabData.scheduleConf,r=""===n?ka()(a.getDefaultScheduleConf(0),{beginDate:"2001-01-01",endDate:"2021-01-01"}):JSON.parse(n);return a._selfReliance=void 0!==r.selfReliance&&r.selfReliance,a}return g()(t,e),m()(t,[{key:"handleScheduleStatus",value:function(e){var t=e.target.checked;this.props.changeScheduleStatus(t?2:1)}},{key:"handleScheduleConf",value:function(){var e=this;setTimeout(function(){e.form.validateFields(function(t,a){if(!t){var n=e.form.getFieldsValue();n.selfReliance=e._selfReliance,delete n.scheduleStatus,e.props.changeScheduleConf(n)}})},0)}},{key:"handleScheduleType",value:function(e){var t=this.getDefaultScheduleConf(e),a=de()({},t,{scheduleStatus:this.form.getFieldValue("scheduleStatus"),beginDate:this.form.getFieldValue("beginDate"),endDate:this.form.getFieldValue("endDate"),periodType:e,selfReliance:this.form.getFieldValue("selfReliance")});this.props.changeScheduleConf(a)}},{key:"getDefaultScheduleConf",value:function(e){return{0:{beginHour:0,gapMin:5,endHour:23,periodType:0},1:{beginHour:0,beginMin:0,endHour:23,gapHour:5,periodType:1},2:{min:0,hour:0,periodType:2},3:{weekDay:3,min:0,hour:23,periodType:3},4:{day:5,hour:0,min:23,periodType:4}}[e]}},{key:"handleDelVOS",value:function(e){this.props.delVOS(e.id)}},{key:"handleAddVOS",value:function(e){this.props.addVOS(e)}},{key:"goEdit",value:function(e){this.props.getTaskDetail(e.id)}},{key:"setSelfReliance",value:function(e){var t=e.target.value;this._selfReliance=t,this.handleScheduleConf()}},{key:"render",value:function(){var e=this,t=this.props.tabData,a=t.scheduleConf,n=""===a?ka()(this.getDefaultScheduleConf(0),{beginDate:"2001-01-01",endDate:"2021-01-01"}):JSON.parse(a),i=[{title:"任务名称",dataIndex:"name",key:"name",render:function(t,a){return y.a.createElement("a",{href:"javascript:void(0)",onClick:e.goEdit.bind(e,a)},t)}},{title:"责任人",dataIndex:"createUser.userName",key:"createUser.userName"},{title:"操作",key:"action",render:function(t,a){return y.a.createElement("span",null,y.a.createElement("a",{href:"javascript:void(0)",onClick:e.handleDelVOS.bind(e,a)},"删除"))}}],s={display:"block",height:"30px",lineHeight:"30px"};return y.a.createElement("div",{className:"m-scheduling"},y.a.createElement(fa.a,{bordered:!1,defaultActiveKey:["1","2","3"]},y.a.createElement(Na,{key:"1",header:"调度属性"},y.a.createElement(Ua,{scheduleConf:n,status:t.scheduleStatus,handleScheduleStatus:this.handleScheduleStatus.bind(this),handleScheduleConf:this.handleScheduleConf.bind(this),handleScheduleType:this.handleScheduleType.bind(this),ref:function(t){return e.form=t},key:t.id+"-"+n.periodType})),t.taskType!==X.m.VIRTUAL_NODE&&y.a.createElement(Na,{key:"2",header:"任务间依赖"},y.a.createElement(q.a,null,y.a.createElement(Ma,N()({},Va,{label:"上游任务"}),y.a.createElement(qa,{onSelect:this.handleAddVOS.bind(this),taskId:t.id}))),y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"6"}),y.a.createElement(o.a,null,y.a.createElement(le.a,{className:"m-table",columns:i,bordered:!1,dataSource:t.taskVOS,rowKey:function(e){return e.id.lable}})))),y.a.createElement(Na,{key:"3",header:"自依赖"},y.a.createElement(r.a,null,y.a.createElement(o.a,{span:"6"}),y.a.createElement(o.a,null,y.a.createElement(Ia,{onChange:this.setSelfReliance.bind(this),value:this._selfReliance},y.a.createElement(ce.a,{style:s,value:!1},"不依赖上一调度周期"),y.a.createElement(ce.a,{style:s,value:!0},"自依赖，等待上一调度周期结束，才能继续运行")))))))}}]),t}(y.a.Component),qa=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.searchVOS=a.fetchVOS.bind(a),a.handleClick=a.handleClick.bind(a),a.selectVOS=a.props.onSelect,a.taskId=a.props.taskId,a.state={list:[]},a}return g()(t,e),m()(t,[{key:"fetchVOS",value:function(e){var t=this,a=e.target.value;""!==a.trim()?$.a.getOfflineTaskByName({name:a,taskId:this.taskId}).then(function(e){1===e.code&&(0===e.data.length&&w.a.error("没有符合条件的任务"),t.setState({list:e.data,fetching:!1}))}):this.setState({list:[]})}},{key:"handleClick",value:function(e){var t=this;$.a.checkIsLoop({taskId:this.taskId,dependencyTaskId:e.id}).then(function(a){1===a.code&&(a.data?w.a.error("添加失败，该任务循环依赖任务"+(a.data.name||"")+"!"):(t.selectVOS(e),t.$input.value="",t.setState({list:[]})))})}},{key:"render",value:function(){var e=this,t=this.state.list;return y.a.createElement("div",{className:"m-taskselector"},y.a.createElement("input",{onInput:Object(he.a)(this.searchVOS,500,{maxWait:2e3}),ref:function(t){return e.$input=t},className:"ant-input"}),t.length>0&&y.a.createElement("ul",{className:"tasklist"},t.map(function(t){return y.a.createElement("li",{className:"taskitem",onClick:function(){e.handleClick(t)},key:t.id},t.name)})))}}]),t}(y.a.Component),Ba=function(e,t){return N()({},t)},Ka=function(e){return{changeScheduleConf:function(t){e({type:T.o.CHANGE_SCHEDULE_CONF,payload:t})},changeScheduleStatus:function(t){e({type:T.o.CHANGE_SCHEDULE_STATUS,payload:t})},addVOS:function(t){e({type:T.o.ADD_VOS,payload:t})},delVOS:function(t){e({type:T.o.DEL_VOS,payload:t})},getTaskDetail:function(t){$.a.getOfflineTaskDetail({id:t}).then(function(a){1===a.code&&(e({type:T.o.LOAD_TASK_DETAIL,payload:a.data}),e({type:T.o.OPEN_TASK_TAB,payload:t}))})}}},Wa=Object(b.b)(Ba,Ka)(Pa),Ga=Wa,za=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Na,"Panel","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Fa,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Ma,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Ia,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Va,"formItemLayout","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(ja,"ScheduleForm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Ua,"FormWrap","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Pa,"SchedulingConfig","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(qa,"TaskSelector","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Ba,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Ka,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js"),__REACT_HOT_LOADER__.register(Wa,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/schedulingConfig.js")),a(172),a(102)),Ya=a.n(za),Qa=a(65),Ja=a.n(Qa),$a=a(199),Xa=a(591)({mxImageBasePath:"public/rdos/mxgraph/images",mxBasePath:"public/rdos/mxgraph"}),Za=Xa.mxGraph,en=Xa.mxShape,tn=Xa.mxConnectionConstraint,an=Xa.mxPoint,nn=Xa.mxPolyline,rn=Xa.mxEvent,sn=Xa.mxRubberband,ln=Xa.mxCellState,on=Xa.mxConstants,cn=Xa.mxEdgeStyle,un=Xa.mxPopupMenu,_n=Xa.mxPerimeter,pn=Xa.mxUndoManager,dn=Xa.mxCompactTreeLayout,mn=Xa.mxMorphing,hn=Xa.mxUtils,fn=Xa.mxXmlCanvas2D,En=Xa.mxImageExport,gn=Xa.mxXmlRequest,kn={width:150,height:36},yn=function(e){return{id:e.id,name:e.name}},bn=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={selectedTask:"",data:{},loading:"success",lastVertex:"",visible:!1},n.loadTaskChidren=function(){var e;return(e=n).__loadTaskChidren__REACT_HOT_LOADER__.apply(e,arguments)},n.insertVertex=function(){var e;return(e=n).__insertVertex__REACT_HOT_LOADER__.apply(e,arguments)},n.loopTree=function(){var e;return(e=n).__loopTree__REACT_HOT_LOADER__.apply(e,arguments)},n.doInsertVertex=function(){var e;return(e=n).__doInsertVertex__REACT_HOT_LOADER__.apply(e,arguments)},n.loadEditor=function(){var e;return(e=n).__loadEditor__REACT_HOT_LOADER__.apply(e,arguments)},n.getStyles=function(){var e;return(e=n).__getStyles__REACT_HOT_LOADER__.apply(e,arguments)},n.formatTooltip=function(){var e;return(e=n).__formatTooltip__REACT_HOT_LOADER__.apply(e,arguments)},n.corvertValueToString=function(){var e;return(e=n).__corvertValueToString__REACT_HOT_LOADER__.apply(e,arguments)},n.refresh=function(){var e;return(e=n).__refresh__REACT_HOT_LOADER__.apply(e,arguments)},n.zoomIn=function(){var e;return(e=n).__zoomIn__REACT_HOT_LOADER__.apply(e,arguments)},n.zoomOut=function(){var e;return(e=n).__zoomOut__REACT_HOT_LOADER__.apply(e,arguments)},n.hideMenu=function(){var e;return(e=n).__hideMenu__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"componentDidMount",value:function(){this._vertexCells=[],this.Container.innerHTML="",this.graph="",this.layout="";var e=this.Container,t=this.props.tabData;this.initEditor(),this.loadEditor(e),this.listenDoubleClick(),this.hideMenu(),this.loadTaskChidren({taskId:t.id,level:6})}},{key:"__loadTaskChidren__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({loading:"loading"}),$.a.getTaskChildren(e).then(function(e){if(1===e.code){var a=e.data;t.setState({selectedTask:a,data:a}),t.doInsertVertex(a)}t.setState({loading:"success"})})}},{key:"__insertVertex__REACT_HOT_LOADER__",value:function(e,t){var a=this.graph,n=a.getDefaultParent(),r=this._vertexCells.find(function(e){var a=e.getAttribute("data");return a?JSON.parse(a).id===t.id:null});if(r)return 0===a.getEdgesBetween(e,r).length&&a.insertEdge(e,null,"",e,r),r;var i=this.getStyles(t),s=hn.createXmlDocument().createElement("Task");s.setAttribute("id",t.id),s.setAttribute("data",Ja()(t));var l="";return this.executeLayout(function(){l=a.insertVertex(n,null,s,0,0,kn.width,kn.height,i),a.view.refresh(l),a.insertEdge(e,null,"",e,l)},function(){a.scrollCellToVisible(l)}),this._vertexCells.push(l),l}},{key:"__loopTree__REACT_HOT_LOADER__",value:function(e,t){if(t){var a=e.getDefaultParent(),n=t.taskVOS,r=t.subTaskVOS,i=yn(t),s=this.insertVertex(a,i);if(n&&n.length>0)for(var l=0;l<n.length;l++){var o=yn(n[l]),c=this.insertVertex(a,o);this.insertVertex(c,i);n[l].taskVOS&&this.loopTree(e,n[l])}if(r&&r.length>0)for(var u=0;u<r.length;u++){var _=yn(r[u]);this.insertVertex(a,_),this.insertVertex(s,_);r[u].subTaskVOS&&this.loopTree(e,r[u])}}}},{key:"__doInsertVertex__REACT_HOT_LOADER__",value:function(e){var t=this.graph,a=this.layout,n=(t.container.clientWidth-kn.width)/2,r=t.getModel(),i=t.getDefaultParent();a||((a=new dn(t)).horizontal=!1,a.useBoundingBox=!1,a.edgeRouting=!1,this.layout=a,this.executeLayout=function(e,n){r.beginUpdate();try{null!=e&&e(),a.execute(i)}catch(e){throw e}finally{var s=new mn(t);s.addListener(rn.DONE,hn.bind(this,function(){t.getModel().endUpdate(),null!=n&&n()})),s.startAnimation()}}),this.loopTree(t,e),this.executeLayout(),t.view.setTranslate(n,200)}},{key:"__loadEditor__REACT_HOT_LOADER__",value:function(e){rn.disableContextMenu(e);var t=new Za(e);this.graph=t,t.setPanning(!0),t.panningHandler.useLeftButtonForPanning=!0,t.setConnectable(!0),t.setTooltips(!0),t.view.setScale(1),t.setHtmlLabels(!0),t.setAllowDanglingEdges(!1),t.setConnectable(!1),t.isCellsMovable=function(e){return!((e=t.getSelectionCell())&&e.edge)},t.isCellEditable=function(){return!1};var a=this.getDefaultVertexStyle();t.getStylesheet().putDefaultVertexStyle(a),t.convertValueToString=this.corvertValueToString,t.getTooltipForCell=this.formatTooltip;var n=this.getDefaultEdgeStyle();t.getStylesheet().putDefaultEdgeStyle(n),on.HANDLE_FILLCOLOR="#ffffff",on.HANDLE_STROKECOLOR="#2491F7",on.VERTEX_SELECTION_COLOR="#2491F7",new sn(t)}},{key:"__getStyles__REACT_HOT_LOADER__",value:function(e){return"whiteSpace=wrap;fillColor=#E6F7FF;strokeColor=#90D5FF;"}},{key:"__formatTooltip__REACT_HOT_LOADER__",value:function(e){var t=e.getAttribute("data"),a=t?JSON.parse(t):"";return a?a.name:""}},{key:"__corvertValueToString__REACT_HOT_LOADER__",value:function(e){if(hn.isNode(e.value)&&"task"==e.value.nodeName.toLowerCase()){var t=e.getAttribute("data"),a=t?JSON.parse(t):"",n=Object($a.c)(a.taskType);if(a)return'<div class="vertex"><span class="vertex-title">'+(a.name||"")+'</span>\n                    <span style="font-size:10px; color: #666666;">'+n+"</span>\n                    </div>"}return""}},{key:"listenDoubleClick",value:function(){this.graph.addListener(rn.DOUBLE_CLICK,function(e,t){t.getProperty("cell")})}},{key:"listenOnClick",value:function(){var e=this;this.graph.addListener(rn.onClick,function(t,a){var n=a.getProperty("cell");if(n){var r=n.getAttribute("data");r=r?JSON.parse(r):"",e.setState({selectedTask:r})}})}},{key:"__refresh__REACT_HOT_LOADER__",value:function(){this.componentDidMount()}},{key:"graphEnable",value:function(){var e=this.graph.isEnabled();this.graph.setEnabled(!e)}},{key:"__zoomIn__REACT_HOT_LOADER__",value:function(){this.graph.zoomIn()}},{key:"__zoomOut__REACT_HOT_LOADER__",value:function(){this.graph.zoomOut()}},{key:"__hideMenu__REACT_HOT_LOADER__",value:function(){var e=this;document.addEventListener("click",function(t){var a=e.graph;a.popupMenuHandler;a.popupMenuHandler.isMenuShowing()&&a.popupMenuHandler.hideMenu()})}},{key:"render",value:function(){var e=this;this.state.selectedTask,this.props.project;return y.a.createElement("div",{className:"graph-editor",style:{position:"relative"}},y.a.createElement("div",{className:"editor pointer",ref:function(t){e.Container=t}}),y.a.createElement(Ya.a,{tip:"Loading...",size:"large",spinning:"loading"===this.state.loading},y.a.createElement("div",{className:"absolute-middle",style:{width:"100%",height:"100%"}})),y.a.createElement("div",{className:"graph-toolbar"},y.a.createElement(je.a,{placement:"bottom",title:"刷新"},y.a.createElement(s.a,{type:"reload",onClick:this.refresh})),y.a.createElement(je.a,{placement:"bottom",title:"放大"},y.a.createElement(C.a,{onClick:this.zoomIn,type:"zoom-in"})),y.a.createElement(je.a,{placement:"bottom",title:"缩小"},y.a.createElement(C.a,{onClick:this.zoomOut,type:"zoom-out"}))))}},{key:"getDefaultVertexStyle",value:function(){var e=[];return e[on.STYLE_SHAPE]=on.SHAPE_RECTANGLE,e[on.STYLE_PERIMETER]=_n.RectanglePerimeter,e[on.STYLE_STROKECOLOR]="#90D5FF",e[on.STYLE_FILLCOLOR]="#E6F7FF;",e[on.STYLE_FONTCOLOR]="#333333;",e[on.STYLE_ALIGN]=on.ALIGN_CENTER,e[on.STYLE_VERTICAL_ALIGN]=on.ALIGN_MIDDLE,e[on.STYLE_FONTSIZE]="12",e[on.STYLE_FONTSTYLE]=1,e}},{key:"getDefaultEdgeStyle",value:function(){var e=[];return e[on.STYLE_SHAPE]=on.SHAPE_CONNECTOR,e[on.STYLE_STROKECOLOR]="#9EABB2",e[on.STYLE_STROKEWIDTH]=1,e[on.STYLE_ALIGN]=on.ALIGN_CENTER,e[on.STYLE_VERTICAL_ALIGN]=on.ALIGN_MIDDLE,e[on.STYLE_EDGE]=cn.TopToBottom,e[on.STYLE_ENDARROW]=on.ARROW_CLASSIC,e[on.STYLE_FONTSIZE]="10",e[on.STYLE_ROUNDED]=!0,e}},{key:"initEditor",value:function(){Za.prototype.getAllConnectionConstraints=function(e,t){if(null!=e&&null!=e.shape)if(null!=e.shape.stencil){if(null!=e.shape.stencil)return e.shape.stencil.constraints}else if(null!=e.shape.constraints)return e.shape.constraints;return null},en.prototype.constraints=[new tn(new an(.25,0),!0),new tn(new an(.5,0),!0),new tn(new an(.75,0),!0),new tn(new an(0,.25),!0),new tn(new an(0,.5),!0),new tn(new an(0,.75),!0),new tn(new an(1,.25),!0),new tn(new an(1,.5),!0),new tn(new an(1,.75),!0),new tn(new an(.25,1),!0),new tn(new an(.5,1),!0),new tn(new an(.75,1),!0)],nn.prototype.constraints=null}}]),t}(k.Component),vn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Xa,"Mx","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(Za,"mxGraph","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(en,"mxShape","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(tn,"mxConnectionConstraint","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(an,"mxPoint","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(nn,"mxPolyline","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(rn,"mxEvent","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(sn,"mxRubberband","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(ln,"mxCellState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(on,"mxConstants","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(cn,"mxEdgeStyle","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(un,"mxPopupMenu","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(_n,"mxPerimeter","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(pn,"mxUndoManager","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(dn,"mxCompactTreeLayout","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(mn,"mxMorphing","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(hn,"mxUtils","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(fn,"mxXmlCanvas2D","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(En,"mxImageExport","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(gn,"mxXmlRequest","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(kn,"VertexSize","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(yn,"getVertexNode","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js"),__REACT_HOT_LOADER__.register(bn,"TaskView","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskView/index.js")),a(46)),Tn=a.n(vn),Cn=q.a.Item,On=fa.a.Panel,An={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:15}}},Rn=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.onChange=function(){var e;return(e=n).__onChange__REACT_HOT_LOADER__.apply(e,arguments)},n.getFormItems=function(){var e;return(e=n).__getFormItems__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__onChange__REACT_HOT_LOADER__",value:function(e,t){var a=this.props,n=a.tabData,r=a.onChange;if(/([a-zA-Z]{4,14})\s*([\-\+])\s*(\d+)/.test(t)){console.log("value:",t);var i=[].concat(Tn()(n.taskVariables));i[e].paramCommand=t,r({taskVariables:i})}}},{key:"__getFormItems__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.tabData.taskVariables,n=[],r=[],i=function(a,n){return y.a.createElement(Cn,N()({key:n.paramName},An,{label:n.paramName}),t(n.paramName,{rules:[{pattern:/([a-zA-Z]{4,14})\s*([\-\+])\s*(\d+)/,message:"参数格式不正确"}],initialValue:n.paramCommand})(y.a.createElement(x.a,{disabled:0===n.type,onChange:function(t){e.onChange(a,t.target.value)}})))};if(a)for(var s=0;s<a.length;s++){var l=a[s],o=i(s,l);0===l.type?n.push(o):1===l.type&&r.push(o)}return{sysItems:n,customItems:r}}},{key:"render",value:function(){var e=this.getFormItems();return y.a.createElement(q.a,null,y.a.createElement(fa.a,{bordered:!1,defaultActiveKey:["1","2"]},y.a.createElement(On,{key:"1",header:y.a.createElement("span",null,"系统参数配置 ",y.a.createElement(me.a,{style:{position:"inherit"},doc:"customSystemParams"}))},e.sysItems),y.a.createElement(On,{key:"2",header:y.a.createElement("span",null,"自定义参数配置 ",y.a.createElement(me.a,{style:{position:"inherit"},doc:"customParams"}))},e.customItems)))}}]),t}(y.a.Component),wn=q.a.create()(Rn),Dn=wn,Sn=Dn,Ln=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Cn,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js"),__REACT_HOT_LOADER__.register(On,"Panel","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js"),__REACT_HOT_LOADER__.register(An,"formItemLayout","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js"),__REACT_HOT_LOADER__.register(Rn,"TaskParams","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js"),__REACT_HOT_LOADER__.register(wn,"FormWrapper","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js"),__REACT_HOT_LOADER__.register(Dn,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/taskParams.js")),G.a.TabPane),xn=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.state={selected:"",expanded:!1},a.handleCustomParamsChange=function(){return a.__handleCustomParamsChange__REACT_HOT_LOADER__.apply(a,arguments)},a.tabClick=function(){return a.__tabClick__REACT_HOT_LOADER__.apply(a,arguments)},a.getTabPanes=function(){return a.__getTabPanes__REACT_HOT_LOADER__.apply(a,arguments)},a}return g()(t,e),m()(t,[{key:"handleTaskParamChange",value:function(e,t){e!==t&&this.props.setTaskParams({taskParams:t})}},{key:"__handleCustomParamsChange__REACT_HOT_LOADER__",value:function(e){this.props.setTaskParams(e)}},{key:"__tabClick__REACT_HOT_LOADER__",value:function(e){var t=this.state,a=t.selected,n=t.expanded;e===a&&n?(this.setState({selected:"",expanded:!1}),this.SideBench.style.width="30px"):e!==a&&(this.SideBench.style.width="500px",this.setState({selected:e,expanded:!0}))}},{key:"__getTabPanes__REACT_HOT_LOADER__",value:function(){var e=this.props.tabData,t=[y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"任务属性"),key:"params1"},y.a.createElement(Da,{tabData:e})),y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"调度依赖"),key:"params2"},y.a.createElement(Ga,{tabData:e})),y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"依赖视图"),key:"params4"},y.a.createElement(bn,{tabData:e}))];if(e&&J.a.checkExist(e.taskType)&&e.taskType!==X.m.VIRTUAL_NODE)t.push([y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"环境参数"),key:"params3"},y.a.createElement($t.a,{options:X.x,key:"params"+e.id,value:e.taskParams,onFocus:function(){},focusOut:function(){},onChange:this.handleTaskParamChange.bind(this)}),";"),y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"任务参数"),key:"params5"},y.a.createElement(Sn,{tabData:e,onChange:this.handleCustomParamsChange}))]);else if(J.a.checkExist(e.type))return y.a.createElement(Ln,{tab:y.a.createElement("span",{className:"title-vertical"},"脚本属性"),key:"params1"},y.a.createElement(La,{tabData:e}));return t}},{key:"render",value:function(){var e=this;return y.a.createElement("div",{className:"m-siderbench bd-left",ref:function(t){e.SideBench=t}},y.a.createElement(G.a,{activeKey:this.state.selected,type:"card",className:"task-params",tabPosition:"right",onTabClick:this.tabClick},this.getTabPanes()))}}]),t}(y.a.Component),Hn=Object(b.b)(function(e){return{}},function(e){return{setTaskParams:function(t){e({type:T.o.SET_TASK_FIELDS_VALUE_SILENT,payload:t})}}})(xn),Nn=Hn,Fn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ln,"TabPane","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/siderBench.js"),__REACT_HOT_LOADER__.register(xn,"SiderBench","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/siderBench.js"),__REACT_HOT_LOADER__.register(Hn,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/siderBench.js")),a(185)),Mn=q.a.Item,In=_e.a.Option,Vn=ce.a.Group,jn=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={radio:1},n.splitChange=function(){var e;return(e=n).__splitChange__REACT_HOT_LOADER__.apply(e,arguments)},n.charsetChange=function(){var e;return(e=n).__charsetChange__REACT_HOT_LOADER__.apply(e,arguments)},n.asTitle=function(){var e;return(e=n).__asTitle__REACT_HOT_LOADER__.apply(e,arguments)},n.changeStartLine=function(){var e;return(e=n).__changeStartLine__REACT_HOT_LOADER__.apply(e,arguments)},n.radioChange=function(){var e;return(e=n).__radioChange__REACT_HOT_LOADER__.apply(e,arguments)},n.generateCols=function(){var e;return(e=n).__generateCols__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__splitChange__REACT_HOT_LOADER__",value:function(e){this.props.changeStatus({splitSymbol:e})}},{key:"__charsetChange__REACT_HOT_LOADER__",value:function(e){this.props.changeStatus({charset:e})}},{key:"__asTitle__REACT_HOT_LOADER__",value:function(e){var t=e.target.checked;this.props.changeStatus({asTitle:t,matchType:t?1:0})}},{key:"__changeStartLine__REACT_HOT_LOADER__",value:function(e){var t=this.props.formState,a=e.target.value;a=a>t.originLineCount?t.originLineCount:a,this.props.changeStatus({startLine:a})}},{key:"__radioChange__REACT_HOT_LOADER__",value:function(e){this.setState({radio:e.target.value})}},{key:"__generateCols__REACT_HOT_LOADER__",value:function(e,t){if(t&&t.length>0){var a=[];return e?(t.forEach(function(e,t){a.push({title:e,width:100,key:t+e,render:function(e,a){return y.a.createElement(Fn.a,{style:{minWidth:100},value:a[t]})}})}),a):(t.forEach(function(e,t){var n="col-"+(t+1);a.push({key:n,width:100,title:n,render:function(e,a){return y.a.createElement(Fn.a,{style:{minWidth:100},value:a[t]})}})}),a)}return[]}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.file,i=t.display,s=t.formState,l=this.generateCols(s.asTitle,a[0]),o=s.asTitle?a.slice(1):a,c=this.state.radio;return y.a.createElement("div",{style:{display:"source"===i?"block":"none"}},y.a.createElement(r.a,null,y.a.createElement(q.a,null,y.a.createElement(Mn,N()({},X.q,{label:"已选文件"}),y.a.createElement("span",{style:{fontSize:"14px"}},n.name||""),"  ",y.a.createElement("span",{style:{color:"#f60"}},"只支持.txt、.csv和.log文件类型")),y.a.createElement(Mn,N()({},X.q,{label:"分隔符"}),y.a.createElement(Vn,{onChange:this.radioChange,defaultValue:1},y.a.createElement(ce.a,{value:1}),y.a.createElement(_e.a,{disabled:2===c,style:{width:"80px"},value:s.splitSymbol,onChange:this.splitChange},y.a.createElement(In,{value:","},"逗号"),y.a.createElement(In,{value:"tab"},"Tab"),y.a.createElement(In,{value:";"},"分号"),y.a.createElement(In,{value:"blank"},"空格"),y.a.createElement(In,{value:"|"},"|"),y.a.createElement(In,{value:"#"},"#"),y.a.createElement(In,{value:"&"},"&")),"  ",y.a.createElement(ce.a,{value:2},"自定义"),y.a.createElement(x.a,{disabled:1===c,onChange:function(t){e.splitChange(t.target.value)},style:{width:"80px"}}))),y.a.createElement(Mn,N()({},X.q,{label:"原始字符集"}),y.a.createElement(_e.a,{value:s.charset,onChange:this.charsetChange},y.a.createElement(In,{value:"UTF-8"},"UTF-8"),y.a.createElement(In,{value:"GBK"},"GBK"),y.a.createElement(In,{value:"CP936"},"CP936"),y.a.createElement(In,{value:"ISO-8859"},"ISO-8859"))),y.a.createElement(Mn,N()({},X.q,{label:"导入起始行"}),y.a.createElement(x.a,{onChange:this.changeStartLine,type:"number",min:1,max:a.length,value:s.startLine})),y.a.createElement(Mn,N()({},X.q,{label:"首行为标题"}),y.a.createElement(mt.a,{checked:s.asTitle,onChange:this.asTitle},"是")))),y.a.createElement(r.a,{className:"no-table-padding"},y.a.createElement(le.a,{rowKey:"id",scroll:{y:240,x:800},bordered:!0,dataSource:o,columns:l})))}}]),t}(k.Component),Un=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Mn,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/source.js"),__REACT_HOT_LOADER__.register(In,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/source.js"),__REACT_HOT_LOADER__.register(Vn,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/source.js"),__REACT_HOT_LOADER__.register(jn,"ImportSource","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/source.js")),a(728)),Pn=ce.a.Group,qn=q.a.Item,Bn=_e.a.Option,Kn=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state={visible:!1},n.tableInput=function(){var e;return(e=n).__tableInput__REACT_HOT_LOADER__.apply(e,arguments)},n.tbNameOnChange=function(){var e;return(e=n).__tbNameOnChange__REACT_HOT_LOADER__.apply(e,arguments)},n.debounceSearch=Object(v.debounce)(n.tableInput,500,{maxWait:2e3}),n.tableChange=function(){var e;return(e=n).__tableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.checkPartition=function(){var e;return(e=n).__checkPartition__REACT_HOT_LOADER__.apply(e,arguments)},n.createTable=function(){var e;return(e=n).__createTable__REACT_HOT_LOADER__.apply(e,arguments)},n.handleCancel=function(){var e;return(e=n).__handleCancel__REACT_HOT_LOADER__.apply(e,arguments)},n.mapChange=function(){var e;return(e=n).__mapChange__REACT_HOT_LOADER__.apply(e,arguments)},n.changeMatchWay=function(){var e;return(e=n).__changeMatchWay__REACT_HOT_LOADER__.apply(e,arguments)},n.changeImportMode=function(){var e;return(e=n).__changeImportMode__REACT_HOT_LOADER__.apply(e,arguments)},n.tablePartitionChange=function(){var e;return(e=n).__tablePartitionChange__REACT_HOT_LOADER__.apply(e,arguments)},n.ddlChange=function(){var e;return(e=n).__ddlChange__REACT_HOT_LOADER__.apply(e,arguments)},n.generateCols=function(){var e;return(e=n).__generateCols__REACT_HOT_LOADER__.apply(e,arguments)},n.generatePartitions=function(){var e;return(e=n).__generatePartitions__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__tableInput__REACT_HOT_LOADER__",value:function(e){var t=this.props.changeStatus;e.length>0&&$.a.getTablesByName({tableName:e}).then(function(e){1===e.code&&t({tableList:e.data||[]})})}},{key:"__tbNameOnChange__REACT_HOT_LOADER__",value:function(e){var t={queryTable:e};""===e&&(t.tableData={}),this.props.changeStatus(t)}},{key:"__tableChange__REACT_HOT_LOADER__",value:function(e,t){var a=t.props.data,n=this.props.changeStatus;$.a.getTable({tableId:a.tableId}).then(function(e){if(1===e.code){var t=e.data,r=t.column&&t.column.map(function(e){return""}),i=t.partition&&t.partition.map(function(e){return ie()({},e.name,"")});n({targetTable:a,queryTable:a.tableName,tableData:t,hasPartition:t.partition&&t.partition.length>0,columnMap:r,originPartitions:t.partition,partitions:i,targetExchangeWarning:!1})}})}},{key:"__checkPartition__REACT_HOT_LOADER__",value:function(){for(var e=this.props.formState,t=e.targetTable,a=e.partitions,n=e.originPartitions,r=0;r<a.length;r++){var i=a[r],s=n[r].name;if(""===J.a.trim(i[s]))return void w.a.error("分区值不可为空！")}$.a.checkTablePartition({tableId:t.tableId,partitionInfo:a}).then(function(e){e.data?w.a.success("分区存在！"):w.a.error("分区不存在！")})}},{key:"__createTable__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.formState.sqlText;$.a.createDdlTable({sql:t}).then(function(t){1===t.code&&(e.setState({visible:!1,tableList:[t.data]}),e.tbNameOnChange(t.data.tableId),e.tableChange(t.data.tableId,{props:{data:t.data}}),w.a.success("表创建成功!"))})}},{key:"__handleCancel__REACT_HOT_LOADER__",value:function(){this.setState({visible:!1})}},{key:"__mapChange__REACT_HOT_LOADER__",value:function(e,t){var a=this.props,n=a.formState,r=a.changeStatus,i=[].concat(Tn()(n.columnMap));i[t]=e,r({columnMap:i,targetExchangeWarning:!1})}},{key:"__changeMatchWay__REACT_HOT_LOADER__",value:function(e){this.props.formState.asTitle&&this.props.changeStatus({matchType:e.target.value,targetExchangeWarning:!1})}},{key:"__changeImportMode__REACT_HOT_LOADER__",value:function(e){this.props.changeStatus({overwriteFlag:e.target.value})}},{key:"__tablePartitionChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.formState.partitions,r=[].concat(Tn()(n));r[a]=ie()({},t.name,e.target.value),this.props.changeStatus({partitions:r})}},{key:"__ddlChange__REACT_HOT_LOADER__",value:function(e,t){(0,this.props.changeStatus)({sqlText:t})}},{key:"__generateCols__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.props,n=a.formState,r=a.warning,i=e?e[0].map(function(e,t){return y.a.createElement(Bn,{key:"col-"+t,value:e},e)}):[];return[{title:"目标字段",key:"target_part",render:function(e,t){return y.a.createElement("span",null,t.name)}},{title:y.a.createElement("span",null,"源字段 ",r&&y.a.createElement("span",{style:{color:"#ce3b3b",float:"right"}},"请至少选择一个源字段")),key:"source_part",render:function(e,a,r){return console.log("record:",a),y.a.createElement("span",null,y.a.createElement(_e.a,{defaultValue:"",disabled:0===n.matchType,onSelect:function(e){t.mapChange(e,r)},style:{width:"200px"}},y.a.createElement(Bn,{key:"col-null",value:""},"空字段"),i))}}]}},{key:"__generatePartitions__REACT_HOT_LOADER__",value:function(e){var t=this;return e.map(function(a,n){return y.a.createElement(r.a,{key:"partition-"+n},y.a.createElement("div",{className:"ellipsis",title:a.name,style:{width:"60px",display:"inline-block"}},a.name),y.a.createElement(x.a,{style:{width:"140px"},onChange:function(e){t.tablePartitionChange(e,a,n)},placeholder:"请输入分区名称"}),"  ",0===n?y.a.createElement(V.a,{type:"primary",onClick:t.checkPartition},"检测"):"",n===e.length-1?y.a.createElement("span",{style:{color:"#f60"}},y.a.createElement("br",null),'点击"检测"按钮，测试分区是否存在'):"")})}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=(t.file,t.display),i=t.formState,s=i.tableList,l=i.tableData,o=i.queryTable,c=i.asTitle,u=this.generateCols(a,l),_=this.generatePartitions(l.partition||[]),p=l&&l.column,d=s.map(function(e,t){return y.a.createElement(Bn,{key:"table-"+t,data:e,value:e.tableName},e.tableName)});return y.a.createElement("div",{style:{display:"target"===n?"block":"none"}},y.a.createElement(r.a,null,y.a.createElement(q.a,null,y.a.createElement(qn,N()({},X.q,{label:"导入至表"}),y.a.createElement("div",null,y.a.createElement(_e.a,{mode:"combobox",style:{width:"200px"},onChange:this.tbNameOnChange,onSearch:this.debounceSearch,onSelect:this.tableChange,notFoundContent:"没有发现相关表",value:o,placeholder:"请输入表名",showArrow:!1,filterOption:!1,defaultActiveFirstOption:!1},d),"  ",y.a.createElement(V.a,{type:"primary",onClick:function(){e.setState({visible:!0})}},"新建表"))),y.a.createElement(qn,N()({},X.q,{style:{display:l.partition&&l.partition.length>0?"block":"none"},label:"分区"}),_),y.a.createElement(qn,N()({},X.q,{label:"字段匹配"}),y.a.createElement(Pn,{value:i.matchType,onChange:this.changeMatchWay},y.a.createElement(ce.a,{value:0},"按位置匹配"),y.a.createElement(ce.a,{disabled:!c,value:1},"按名称匹配"))),y.a.createElement(qn,N()({},X.q,{label:"导入模式"}),y.a.createElement(Pn,{value:i.overwriteFlag,onChange:this.changeImportMode},y.a.createElement(ce.a,{value:0},"写入"),y.a.createElement(ce.a,{value:1},"覆盖"))))),y.a.createElement(r.a,null,y.a.createElement(le.a,{className:"m-table",bordered:!0,columns:u,dataSource:p})),y.a.createElement(K.a,{className:"m-codemodal",title:"建表语句",style:{height:424},visible:this.state.visible,onCancel:this.handleCancel,onOk:this.createTable},y.a.createElement($t.a,{placeholder:Un.a,onChange:this.ddlChange})))}}]),t}(k.Component),Wn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Pn,"RadioGroup","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/target.js"),__REACT_HOT_LOADER__.register(qn,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/target.js"),__REACT_HOT_LOADER__.register(Bn,"Option","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/target.js"),__REACT_HOT_LOADER__.register(Kn,"ImportTarget","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/target.js")),{file:"",startLine:1,asTitle:!0,visible:!1,sourceFile:"",data:[],splitSymbol:",",charset:"UTF-8",step:"source",tableData:{},targetTable:"",tableList:[],partitions:[],hasPartition:!1,originPartitions:[],columnMap:[],matchType:1,sqlText:"",queryTable:"",overwriteFlag:0,originLineCount:0,targetExchangeWarning:!1}),Gn=function(e){function t(){var e,a,n,r;p()(this,t);for(var i=arguments.length,s=Array(i),l=0;l<i;l++)s[l]=arguments[l];return a=n=f()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(s))),n.state=ka()({},Wn),n.importData=function(){var e;return(e=n).__importData__REACT_HOT_LOADER__.apply(e,arguments)},n.checkParams=function(){var e;return(e=n).__checkParams__REACT_HOT_LOADER__.apply(e,arguments)},n.getParams=function(){var e;return(e=n).__getParams__REACT_HOT_LOADER__.apply(e,arguments)},n.fileChange=function(){var e;return(e=n).__fileChange__REACT_HOT_LOADER__.apply(e,arguments)},n.fileClick=function(){var e;return(e=n).__fileClick__REACT_HOT_LOADER__.apply(e,arguments)},n.readFile=function(){var e;return(e=n).__readFile__REACT_HOT_LOADER__.apply(e,arguments)},n.changeStatus=function(){var e;return(e=n).__changeStatus__REACT_HOT_LOADER__.apply(e,arguments)},n.next=function(){var e;return(e=n).__next__REACT_HOT_LOADER__.apply(e,arguments)},n.prev=function(){var e;return(e=n).__prev__REACT_HOT_LOADER__.apply(e,arguments)},r=a,f()(n,r)}return g()(t,e),m()(t,[{key:"__importData__REACT_HOT_LOADER__",value:function(){var e=this,t=this.getParams();this.checkParams(t)&&(t.partitions=Ja()(t.partitions),t.keyRef=Ja()(t.keyRef),$.a.importLocalData(t).then(function(t){if(1===t.code){var a="您已经成功导入"+t.data+"条数据！";w.a.success(a),e.setState({visible:!1})}}))}},{key:"__checkParams__REACT_HOT_LOADER__",value:function(e){var t=!0,a=this.state,n=a.originPartitions,r=a.columnMap,i=a.matchType,s=e.partitions;if(!e.tableId)return w.a.error("请选择要导入的目标表！"),!1;if(1==i){for(var l=!0,o=0;o<r.length;o++){if(r[o]){l=!1;break}}if(l)return this.setState({targetExchangeWarning:!0}),!1}if(n&&n.length>0){for(var c=!0,u=0;u<s.length;u++){""===s[u][n[u].name]&&(t=!1,c=!1)}c||w.a.error("分区每项值必填！")}return t}},{key:"__getParams__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.file,a=e.targetTable,n=e.splitSymbol,r=e.charset,i=e.startLine,s=e.asTitle,l=e.matchType,o=e.columnMap,c=e.partitions,u=e.overwriteFlag;return{tableId:a.tableId,separator:n,oriCharset:r,topLineIsTitle:s,keyRef:o,file:t,matchType:l,startLine:i,partitions:c,overwriteFlag:u}}},{key:"__fileChange__REACT_HOT_LOADER__",value:function(e){var t=this,a=e.target.files[0];a.size>52428800?w.a.error("本地上传文件不可超过50MB!"):this.setState({file:a},function(){t.readFile(a)})}},{key:"__fileClick__REACT_HOT_LOADER__",value:function(e){e.target.value=null,this.setState(ka()({},Wn))}},{key:"__readFile__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.charset;if(e){var n=new FileReader;e.type.split("/")[1];n.onload=function(e){t.setState({sourceFile:e.target.result}),t.parseFile(e.target.result)},n.readAsText(e,a)}}},{key:"parseFile",value:function(e){var t=this.state,a=t.splitSymbol,n=t.startLine,r=[],i=this.parseSplitSymbol(a);e=e.split("\n");for(var s=0;s<e.length;s++){var l=e[s].replace(/\r/,"");r.push(l.split(i))}var o=r.slice(n-1);this.setState({data:o,step:"source",visible:!0,originLineCount:e.length})}},{key:"parseSplitSymbol",value:function(e){switch(e){case"blank":e=" ";break;case"tab":e="\t"}return e}},{key:"__changeStatus__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.sourceFile;this.setState(e,function(){t.parseFile(a)})}},{key:"__next__REACT_HOT_LOADER__",value:function(){this.setState({step:"target"})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){this.setState({step:"source"})}},{key:"footer",value:function(){var e=this,t=this.state.step;return y.a.createElement("div",null,y.a.createElement(V.a,{style:{display:"source"===t?"inline-block":"none"},type:"primary",onClick:this.next},"下一步"),y.a.createElement(V.a,{style:{display:"target"===t?"inline-block":"none"},type:"primary",onClick:this.prev},"上一步"),y.a.createElement(V.a,{style:{display:"target"===t?"inline-block":"none"},onClick:this.importData,type:"primary"},"导入"),y.a.createElement(V.a,{onClick:function(){e.setState({visible:!1})}},"取消"))}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,n=t.file,r=t.visible,i=t.step,s=t.targetExchangeWarning;return y.a.createElement("div",null,y.a.createElement("input",{name:"file",type:"file",accept:".txt, .log, .csv",id:"importFile",onClick:this.fileClick,onChange:this.fileChange,style:{display:"none"}}),y.a.createElement(K.a,{title:"本地数据导入",visible:r,onCancel:function(){e.setState({visible:!1})},footer:this.footer()},y.a.createElement(jn,{data:a,file:n,display:i,formState:this.state,changeStatus:this.changeStatus}),y.a.createElement(Kn,{warning:s,data:a,file:n,formState:this.state,changeStatus:function(t){e.setState(t)},display:i})))}}]),t}(k.Component),zn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Wn,"defaultState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/index.js"),__REACT_HOT_LOADER__.register(Gn,"ImportLocalData","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/dataImport/index.js")),G.a.TabPane),Yn=K.a.confirm,Qn=q.a.Item,Jn=function(e){function t(e){p()(this,t);var a=f()(this,(t.__proto__||u()(t)).call(this,e));return a.state={visible:!1,showPublish:!1,theReqIsEnd:!0},a.handleMenuClick=function(){return a.__handleMenuClick__REACT_HOT_LOADER__.apply(a,arguments)},a.handleCreateClick=function(){return a.__handleCreateClick__REACT_HOT_LOADER__.apply(a,arguments)},a.createMenu=function(){return a.__createMenu__REACT_HOT_LOADER__.apply(a,arguments)},a.importMenu=function(){return a.__importMenu__REACT_HOT_LOADER__.apply(a,arguments)},a.renderPublish=function(){return a.__renderPublish__REACT_HOT_LOADER__.apply(a,arguments)},a.publishChange=function(){return a.__publishChange__REACT_HOT_LOADER__.apply(a,arguments)},a.closePublish=function(){return a.__closePublish__REACT_HOT_LOADER__.apply(a,arguments)},a}return g()(t,e),m()(t,[{key:"__handleMenuClick__REACT_HOT_LOADER__",value:function(e){if("1"===e.key){var t=document.getElementById("importFile");t&&t.click()}}},{key:"__handleCreateClick__REACT_HOT_LOADER__",value:function(e){"task"===e.key?this.props.toggleCreateTask():"script"===e.key&&this.props.toggleCreateScript()}},{key:"__createMenu__REACT_HOT_LOADER__",value:function(){var e=this.props.scriptTreeData;return y.a.createElement(U.a,{onClick:this.handleCreateClick},y.a.createElement(U.a.Item,{key:"task"},"创建任务"),e&&y.a.createElement(U.a.Item,{key:"script"},"创建脚本"))}},{key:"__importMenu__REACT_HOT_LOADER__",value:function(){return y.a.createElement(U.a,{onClick:this.handleMenuClick},y.a.createElement(U.a.Item,{key:"1"},"导入本地数据"))}},{key:"render",value:function(){var e=this,t=this.props,a=t.tabs,n=t.currentTab,i=t.currentTabData,l=t.dataSync,c=t.taskCustomParams,u=l.sourceMap,_=l.targetMap,p=this.state.theReqIsEnd,d=!1;Object(v.isEmpty)(u)||Object(v.isEmpty)(_)||(d=!0),i&&i.taskType!==X.m.SYNC&&(d=!0),i&&i.readWriteLockVO&&!i.readWriteLockVO.getLock&&(d=!1);var m=i&&J.a.checkExist(i.taskType),h=!m||i.notSynced;return y.a.createElement(r.a,{className:"m-workbench task-editor"},y.a.createElement("header",{className:"toolbar bd-bottom clear"},y.a.createElement(o.a,{className:"left"},y.a.createElement(M.a,{overlay:this.createMenu(),trigger:["click"]},y.a.createElement(V.a,{title:"创建"},y.a.createElement(C.a,{className:"my-icon",type:"focus"}),"新建",y.a.createElement(s.a,{type:"down"}))),y.a.createElement(V.a,{onClick:this.saveTab.bind(this,!0),title:"保存任务",disabled:!d||i.invalid||!p},y.a.createElement(C.a,{className:"my-icon",type:"save"}),"保存"),y.a.createElement(M.a,{overlay:this.importMenu(),trigger:["click"]},y.a.createElement(V.a,null,y.a.createElement(C.a,{className:"my-icon",type:"import"}),"导入",y.a.createElement(s.a,{type:"down"})))),y.a.createElement(o.a,{className:"right"},y.a.createElement(V.a,{disabled:h,onClick:function(){e.setState({showPublish:!0})},title:"发布任务"},y.a.createElement(C.a,{className:"my-icon",type:"fly"}),"发布"),y.a.createElement(z.c,{to:"/operation/offline-management?tname="+(i&&i.name)},y.a.createElement(V.a,{disabled:!m},y.a.createElement(C.a,{className:"my-icon",type:"goin"})," 运维")))),y.a.createElement(r.a,{className:"task-browser"},y.a.createElement("div",{className:"browser-content"},y.a.createElement(G.a,{hideAdd:!0,onTabClick:this.switchTab.bind(this,n),activeKey:""+n,type:"editable-card",className:"browser-tabs",onEdit:this.closeTab.bind(this),tabBarExtraContent:y.a.createElement(M.a,{overlay:y.a.createElement(U.a,{style:{marginRight:2},onClick:this.closeAllorOthers.bind(this)},y.a.createElement(U.a.Item,{key:"OHTERS"},"关闭其他"),y.a.createElement(U.a.Item,{key:"ALL"},"关闭所有"))},y.a.createElement(s.a,{type:"bars",style:{margin:"10 0 0 0"}}))},this.renderTabs(a)),y.a.createElement(ma,{tabData:i,taskCustomParams:c,updateTaskFields:this.props.updateTaskFields,updateCatalogue:this.props.updateCatalogue}),y.a.createElement(Nn,{tabData:i,key:i&&i.id}))),y.a.createElement(Gn,{visible:this.state.visible}),this.renderPublish())}},{key:"__renderPublish__REACT_HOT_LOADER__",value:function(){var e=this.props.user,t=this.state.publishDesc;return y.a.createElement(K.a,{wrapClassName:"vertical-center-modal",title:"发布任务",style:{height:"600px",width:"600px"},visible:this.state.showPublish,onCancel:this.closePublish,onOk:this.submitTab.bind(this),cancelText:"关闭"},y.a.createElement(q.a,null,y.a.createElement(Qn,N()({},X.q,{label:"发布人",hasFeedback:!0}),y.a.createElement("span",null,e.userName)),y.a.createElement(Qn,N()({},X.q,{label:y.a.createElement("span",{className:"ant-form-item-required"},"备注"),hasFeedback:!0}),y.a.createElement(x.a,{type:"textarea",value:t,name:"publishDesc",rows:4,onChange:this.publishChange}))))}},{key:"__publishChange__REACT_HOT_LOADER__",value:function(e){this.setState({publishDesc:e.target.value})}},{key:"__closePublish__REACT_HOT_LOADER__",value:function(){this.setState({publishDesc:"",showPublish:!1})}},{key:"closeAllorOthers",value:function(e){var t=e.key,a=this.props,n=a.tabs,r=a.closeAll,i=a.currentTab,s=a.closeOthers;if("ALL"===t){var l=!0,o=!0,c=!1,u=void 0;try{for(var _,p=S()(n);!(o=(_=p.next()).done);o=!0){_.value.notSynced&&(l=!1);break}}catch(e){c=!0,u=e}finally{try{!o&&p.return&&p.return()}finally{if(c)throw u}}l?this.props.closeAll(n):Yn({title:"部分任务修改尚未同步到服务器，是否强制关闭 ?",content:"强制关闭将丢弃所有修改数据",onOk:function(){r(n)},onCancel:function(){}})}else{var d=!0,m=!0,h=!1,f=void 0;try{for(var E,g=S()(n);!(m=(E=g.next()).done);m=!0){var k=E.value;k.notSynced&&k.id!==i&&(d=!1);break}}catch(e){h=!0,f=e}finally{try{!m&&g.return&&g.return()}finally{if(h)throw f}}d?s(i,n):Yn({title:"部分任务修改尚未同步到服务器，是否强制关闭 ?",content:"强制关闭将丢弃这些修改数据",onOk:function(){s(i,n)},onCancel:function(){}})}}},{key:"renderTabs",value:function(e){return e&&e.length>0?e.map(function(e){var t=y.a.createElement("span",null,y.a.createElement(Z.a,{notSynced:e.notSynced}),e.name);return y.a.createElement(zn,{style:{height:"0px"},tab:t,key:e.id})}):[]}},{key:"saveTab",value:function(e){var t=this;this.setState({theReqIsEnd:!1});var a=this.props,n=a.saveTab,r=a.dataSync,i=a.currentTabData,s=(a.currentTab,this.generateRqtBody(r)),l="task";J.a.checkExist(i.taskType)||(s=i,l="script"),s.preSave=!0,s.submitStatus=0,n(s,e,l),setTimeout(function(){t.setState({theReqIsEnd:!0})},500)}},{key:"submitTab",value:function(){var e=this.props,t=e.publishTask,a=e.dataSync,n=e.currentTabData,r=(e.currentTab,e.updateTaskFields),i=e.user,s=this.state.publishDesc,l=this.generateRqtBody(a);if(!s)return w.a.error("发布备注不可为空！"),!1;if(s.length>200)return w.a.error("备注信息不可超过200个字符！"),!1;l.publishDesc=s;var o=n.taskVersions||[],c=Date.now(),u=[{id:c,gmtCreate:c,userName:i.userName,publishDesc:s,sqlText:l.sqlText}].concat(o);r({taskVersions:u=u.length>=5?u.slice(0,5):u}),l.preSave=!0,l.submitStatus=1,t(l),this.closePublish()}},{key:"switchTab",value:function(e,t){var a=this.props.openTab;+t!==e&&a(+t)}},{key:"closeTab",value:function(e){var t=this.props,a=t.closeTab;t.tabs.filter(function(t){return t.id==e})[0].notSynced?Yn({title:"修改尚未同步到服务器，是否强制关闭 ?",content:"强制关闭将丢弃当前修改数据",onOk:function(){a(+e)},onCancel:function(){}}):a(+e)}},{key:"generateRqtBody",value:function(e){var t=Object(v.cloneDeep)(e),a=this.props,n=a.tabs,r=a.currentTab,i=a.currentTabData,s=t.keymap,l=t.sourceMap,o=t.targetMap,c=s.source,u=s.target,_=this.props;_.name,_.id;t.sourceMap.column=c,t.targetMap.column=u,t.settingMap=t.setting,t.name=i.name,t.taskId=i.id;var p=o.type,d=l.type;for(var m in d)d.hasOwnProperty(m)&&(l[m]=d[m]);for(var h in p)p.hasOwnProperty(h)&&(o[h]=p[h]);delete t.keymap,delete t.setting,delete t.dataSourceList;var f=Object(v.cloneDeep)(n.filter(function(e){return e.id===r})[0]);for(var E in t)t.hasOwnProperty(E)&&(f[E]=t[E]);return f.preSave=!0,f.taskVOS&&(f.dependencyTasks=f.taskVOS.map(function(e){return e}),f.taskVOS=null),delete f.taskVersions,f}}]),t}(y.a.Component),$n=function(e){var t=e.offlineTask,a=t.workbench,n=t.dataSync,r=t.scriptTreeData,i=a.currentTab,s=a.tabs,l=a.taskCustomParams,o=s.filter(function(e){return e.id===i})[0];return{currentTab:i,currentTabData:o,tabs:s,dataSync:n,taskCustomParams:l,user:e.user,scriptTreeData:r}},Xn=function(e){var t=Object(Ke.b)(e);return{openTab:function(t){e({type:T.o.OPEN_TASK_TAB,payload:t}),e({type:T.c.SET_SELECTION_CONTENT,data:""})},updateTaskFields:function(t){return e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t})},updateCatalogue:function(t){e({type:T.n.EDIT_FOLDER_CHILD_FIELDS,payload:t})},closeTab:function(t){e(Object(ea.b)(t,null,!0)),e({type:T.o.CLOSE_TASK_TAB,payload:t})},closeAll:function(t){for(var a in t)e(Object(ea.b)(t[a].id,null,!0));e({type:T.o.CLOSE_ALL_TABS})},closeOthers:function(t,a){for(var n in a)a[n].id!=t&&e(Object(ea.b)(a[n].id,null,!0));e({type:T.o.CLOSE_OTHER_TABS,payload:t})},saveTab:function(t,a,n){var r=function(t){e({type:T.o.SET_TASK_FIELDS_VALUE,payload:t}),e({type:T.o.MAKE_TAB_CLEAN})},i=function(e){if(1===e.code){var i=e.data,s=i.readWriteLockVO,l=s.result;0===l?(w.a.success(a?"保存成功！":"发布成功！"),r({version:i.version,readWriteLockVO:i.readWriteLockVO})):1===l?Yn({title:"锁定提醒",content:y.a.createElement("span",null,"文件正在被",s.lastKeepLockUserName,"编辑中，开始编辑时间为",J.a.formatDateTime(s.gmtModified),"。 强制保存可能导致",s.lastKeepLockUserName,"对文件的修改无法正常保存！"),okText:"确定保存",okType:"danger",cancelText:"取消",onOk:function(){var e=function(e){1===e.code&&(w.a.success("保存成功！"),r({version:e.data.version,readWriteLockVO:e.data.readWriteLockVO}))};"task"===n?$.a.forceUpdateOfflineTask(t).then(e):"script"===n&&$.a.forceUpdateOfflineScript(t).then(e)}}):2===l&&Yn({title:"保存警告",content:y.a.createElement("span",null,"文件已经被",s.lastKeepLockUserName,"编辑过，编辑时间为",J.a.formatDateTime(s.gmtModified),"。 点击确认按钮会",y.a.createElement(A.a,{color:"orange"},"覆盖"),"您本地的代码，请您提前做好备份！"),okText:"确定覆盖",okType:"danger",cancelText:"取消",onOk:function(){var e={id:t.id,lockVersion:s.version};"task"===n?$.a.getOfflineTaskDetail(e).then(function(e){if(1===e.code){var t=e.data;t.merged=!0,r(t)}}):"script"===n&&$.a.getScriptById(e).then(function(e){if(1===e.code){var t=e.data;t.merged=!0,r(t)}})}})}};t.lockVersion=t.readWriteLockVO.version,"task"===n?$.a.saveOfflineJobData(t).then(i):"script"===n&&$.a.saveScript(t).then(i)},goToTaskDev:function(e){t.openTaskInDev(e)},publishTask:function(t){$.a.publishOfflineTask(t).then(function(t){1===t.code&&(w.a.success("发布成功！"),e({type:T.o.CHANGE_TASK_SUBMITSTATUS,payload:t.data&&t.data.submitStatus||1}),e({type:T.o.MAKE_TAB_CLEAN}))})},toggleCreateTask:function(){e({type:T.f.TOGGLE_CREATE_TASK})},toggleCreateFolder:function(t){e({type:T.f.TOGGLE_CREATE_FOLDER,payload:t})},toggleCreateScript:function(){e({type:T.f.TOGGLE_CREATE_SCRIPT})}}},Zn=Object(b.b)($n,Xn)(Jn),er=Zn,tr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(zn,"TabPane","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register(Yn,"confirm","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register(Qn,"FormItem","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register(Jn,"Workbench","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register($n,"mapState","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register(Xn,"mapDispatch","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js"),__REACT_HOT_LOADER__.register(Zn,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/workbench.js")),function(e){function t(){return p()(this,t),f()(this,(t.__proto__||u()(t)).apply(this,arguments))}return g()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=(e.createTask,e.upload,e.workbench),a=e.scriptTree,n=e.toggleCreateTask,i=e.toggleUpload,l=e.toggleCreateScript,c={width:"60px",height:"60px",marginTop:"25px"};return t.tabs.length?y.a.createElement(er,null):y.a.createElement(r.a,{className:"box-card txt-left",style:{paddingTop:"30px"}},y.a.createElement(o.a,{className:"operation-card"},y.a.createElement("div",{onClick:n,className:"operation-content"},y.a.createElement(C.a,{style:c,type:"add-file"})),y.a.createElement("p",{className:"txt-center"},"创建离线任务")),y.a.createElement(o.a,{className:"operation-card"},y.a.createElement("div",{onClick:i,className:"operation-content"},y.a.createElement(C.a,{style:c,type:"upload"})),y.a.createElement("p",{className:"txt-center"},"上传离线计算资源")),!Object(v.isEmpty)(a)&&y.a.createElement(o.a,{className:"operation-card"},y.a.createElement("div",{onClick:l,className:"operation-content"},y.a.createElement(s.a,{style:c,type:"code-o"})),y.a.createElement("p",{className:"txt-center"},"创建脚本")))}}]),t}(k.Component)),ar=Object(b.b)(function(e){var t=e.offlineTask.modalShow,a=t.createTask,n=t.upload,r=e.offlineTask;return{createTask:a,upload:n,workbench:r.workbench,scriptTree:r.scriptTree}},function(e){return{toggleCreateTask:function(){e({type:T.f.TOGGLE_CREATE_TASK})},toggleUpload:function(){e({type:T.f.TOGGLE_UPLOAD})},toggleCreateScript:function(){e({type:T.f.TOGGLE_CREATE_SCRIPT})}}})(tr);t.default=ar,"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(tr,"Default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/default.js"),__REACT_HOT_LOADER__.register(ar,"default","/Users/xuexiaokang/Documents/webpack优化/data-stack-web/src/webapps/rdos/views/task/offline/default.js"))}}]);