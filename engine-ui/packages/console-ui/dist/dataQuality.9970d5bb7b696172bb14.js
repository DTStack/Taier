(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{125:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["CHANGE_LOADING","GET_MONITOR_LIST","GET_RULE_FUNCTION","GET_MONITOR_TABLE_COLUMN","CHANGE_PARAMS","GET_MONITOR_RULE","GET_MONITOR_DETAIL","GET_REMOTE_TRIGGER"],{prefix:"ruleConfig/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"ruleConfigActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/ruleConfigActionType.js")},142:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(4),r=a.n(n),s=a(0),i=a.n(s);function o(e){var t=e.style,a=r()({},{textIndent:"5px",backgroundColor:"transparent",backgroundImage:"none",width:"100%",border:"none"},t);return i.a.createElement("textarea",r()({},e,{style:a}))}"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"TableCell","/Users/ziv/Documents/workspace/data-stack/src/widgets/tableCell/index.js")},144:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["ADD_LINKED_KEYS","DEL_LINKED_KEYS","SET_EDIT_MAP","SET_ROW_MAP","SET_NAME_MAP","RESET_LINKED_KEYS","EDIT_KEYMAP_TARGET","REMOVE_KEYMAP"],{prefix:"dataSource/keyMap/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"keyMapActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/keyMapActionType.js")},152:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["CHANGE_LOADING","GET_LIST","GET_CHECK_DETAIL","CHANGE_PARAMS","GET_SOURCE_PART","RESET_SOURCE_PART"],{prefix:"dataCheck/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dataCheckActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/dataCheckActionType.js")},153:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["CHANGE_LOADING","GET_TASK_LIST","GET_TASK_DETAIL","GET_TASK_TABLE_REPORT","GET_TASK_ALARM_NUM"],{prefix:"taskQuery/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"taskQueryActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/taskQueryActionType.js")},154:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["CHANGE_LOADING","GET_TOP_RECORD","GET_ALARM_SUM","GET_ALARM_TREND","GET_USAGE"],{prefix:"dashBoard/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dashBoardActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/dashBoardActionType.js")},176:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(149);function r(e){return{type:n.a.UPDATE_APP,data:e}}"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"updateApp","/Users/ziv/Documents/workspace/data-stack/src/webapps/main/actions/app.js")},177:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(9),r=a(109),s={id:0,dtuicUserId:0,userName:"未登录"};function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case r.a.GET_USER:return t.data;case r.a.UPDATE_USER:return null!==t.data?Object(n.assign)(e,t.data):e;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(s,"initalUser","/Users/ziv/Documents/workspace/data-stack/src/webapps/main/reducers/modules/user.js"),__REACT_HOT_LOADER__.register(i,"user","/Users/ziv/Documents/workspace/data-stack/src/webapps/main/reducers/modules/user.js"))},178:function(e,t,a){"use strict";a.d(t,"a",function(){return _});var n=a(14),r=a(192),s=a(143),i=a.n(s),o=a(62),l=a(112);function c(e){return Object(o.e)(e,Object(o.d)(Object(o.a)(i.a,Object(r.createLogger)()),window.devToolsExtension?window.devToolsExtension():function(e){return e}))}function u(e){return Object(o.e)(e,Object(o.a)(i.a))}function _(e,t){var a=u(e),r=t&&"hash"===t?n.g:n.f;return{store:a,history:Object(l.syncHistoryWithStore)(r,a)}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"configureStoreDev","/Users/ziv/Documents/workspace/data-stack/src/utils/reduxUtils.js"),__REACT_HOT_LOADER__.register(u,"configureStoreProd","/Users/ziv/Documents/workspace/data-stack/src/utils/reduxUtils.js"),__REACT_HOT_LOADER__.register(_,"getStore","/Users/ziv/Documents/workspace/data-stack/src/utils/reduxUtils.js"))},214:function(e,t,a){"use strict";a.d(t,"a",function(){return O});a(91);var n=a(45),r=a.n(n),s=(a(60),a(21)),i=a.n(s),o=a(4),l=a.n(o),c=a(90),u=a.n(c),_=(a(34),a(13)),d=a.n(_),p=a(8),m=a.n(p),h=a(5),E=a.n(h),T=a(7),f=a.n(T),y=a(1),v=a.n(y),g=a(6),R=a.n(g),C=a(0),A=a.n(C),O=(a(584),function(e){function t(){var e,a,n,r;E()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=v()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(i))),n.state={},n.copy=function(){var e;return(e=n).__copy__REACT_HOT_LOADER__.apply(e,arguments)},r=a,v()(n,r)}return R()(t,e),f()(t,[{key:"componentWillUnmount",value:function(){this.removeFake()}},{key:"__copy__REACT_HOT_LOADER__",value:function(e){var t=this;this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style.left="-9999px";var a=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=a+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=e,document.body.appendChild(this.fakeElem),this.fakeElem.select(),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand("copy")}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){e?d.a.success("复制成功"):d.a.error("不支持")}},{key:"render",value:function(){var e=this.props,t=e.copyText,a=e.style,n=u()(e,["copyText","style"]);return a=l()({cursor:"pointer",fontSize:"13px"},a),A.a.createElement(r.a,{placement:"right",title:"复制"},A.a.createElement(i.a,l()({className:"copy-hover",onClick:this.copy.bind(this,t),style:a},n,{type:"copy"})))}}]),t}(C.Component));"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(O,"CopyIcon","/Users/ziv/Documents/workspace/data-stack/src/webapps/main/components/copy-icon/index.js")},227:function(e,t,a){},231:function(e,t,a){},233:function(e,t,a){},235:function(e,t,a){},389:function(e,t,a){"use strict";var n=a(39),r=a.n(n)()(["GET_USER_LIST","GET_ALL_DICT"],{prefix:"common/"}),s=r;t.a=s;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(r,"commonActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/commonActionType.js"),__REACT_HOT_LOADER__.register(s,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/commonActionType.js"))},393:function(e,t,a){},584:function(e,t,a){},606:function(e,t,a){var n={"./af":369,"./af.js":369,"./ar":368,"./ar-dz":367,"./ar-dz.js":367,"./ar-kw":366,"./ar-kw.js":366,"./ar-ly":365,"./ar-ly.js":365,"./ar-ma":364,"./ar-ma.js":364,"./ar-sa":363,"./ar-sa.js":363,"./ar-tn":362,"./ar-tn.js":362,"./ar.js":368,"./az":361,"./az.js":361,"./be":360,"./be.js":360,"./bg":359,"./bg.js":359,"./bm":358,"./bm.js":358,"./bn":357,"./bn.js":357,"./bo":356,"./bo.js":356,"./br":355,"./br.js":355,"./bs":354,"./bs.js":354,"./ca":353,"./ca.js":353,"./cs":352,"./cs.js":352,"./cv":351,"./cv.js":351,"./cy":350,"./cy.js":350,"./da":349,"./da.js":349,"./de":348,"./de-at":347,"./de-at.js":347,"./de-ch":346,"./de-ch.js":346,"./de.js":348,"./dv":345,"./dv.js":345,"./el":344,"./el.js":344,"./en-au":343,"./en-au.js":343,"./en-ca":342,"./en-ca.js":342,"./en-gb":341,"./en-gb.js":341,"./en-ie":340,"./en-ie.js":340,"./en-nz":339,"./en-nz.js":339,"./eo":338,"./eo.js":338,"./es":337,"./es-do":336,"./es-do.js":336,"./es-us":335,"./es-us.js":335,"./es.js":337,"./et":334,"./et.js":334,"./eu":333,"./eu.js":333,"./fa":332,"./fa.js":332,"./fi":331,"./fi.js":331,"./fo":330,"./fo.js":330,"./fr":329,"./fr-ca":328,"./fr-ca.js":328,"./fr-ch":327,"./fr-ch.js":327,"./fr.js":329,"./fy":326,"./fy.js":326,"./gd":325,"./gd.js":325,"./gl":324,"./gl.js":324,"./gom-latn":323,"./gom-latn.js":323,"./gu":322,"./gu.js":322,"./he":321,"./he.js":321,"./hi":320,"./hi.js":320,"./hr":319,"./hr.js":319,"./hu":318,"./hu.js":318,"./hy-am":317,"./hy-am.js":317,"./id":316,"./id.js":316,"./is":315,"./is.js":315,"./it":314,"./it.js":314,"./ja":313,"./ja.js":313,"./jv":312,"./jv.js":312,"./ka":311,"./ka.js":311,"./kk":310,"./kk.js":310,"./km":309,"./km.js":309,"./kn":308,"./kn.js":308,"./ko":307,"./ko.js":307,"./ky":306,"./ky.js":306,"./lb":305,"./lb.js":305,"./lo":304,"./lo.js":304,"./lt":303,"./lt.js":303,"./lv":302,"./lv.js":302,"./me":301,"./me.js":301,"./mi":300,"./mi.js":300,"./mk":299,"./mk.js":299,"./ml":298,"./ml.js":298,"./mr":297,"./mr.js":297,"./ms":296,"./ms-my":295,"./ms-my.js":295,"./ms.js":296,"./mt":294,"./mt.js":294,"./my":293,"./my.js":293,"./nb":292,"./nb.js":292,"./ne":291,"./ne.js":291,"./nl":290,"./nl-be":289,"./nl-be.js":289,"./nl.js":290,"./nn":288,"./nn.js":288,"./pa-in":287,"./pa-in.js":287,"./pl":286,"./pl.js":286,"./pt":285,"./pt-br":284,"./pt-br.js":284,"./pt.js":285,"./ro":283,"./ro.js":283,"./ru":282,"./ru.js":282,"./sd":281,"./sd.js":281,"./se":280,"./se.js":280,"./si":279,"./si.js":279,"./sk":278,"./sk.js":278,"./sl":277,"./sl.js":277,"./sq":276,"./sq.js":276,"./sr":275,"./sr-cyrl":274,"./sr-cyrl.js":274,"./sr.js":275,"./ss":273,"./ss.js":273,"./sv":272,"./sv.js":272,"./sw":271,"./sw.js":271,"./ta":270,"./ta.js":270,"./te":269,"./te.js":269,"./tet":268,"./tet.js":268,"./th":267,"./th.js":267,"./tl-ph":266,"./tl-ph.js":266,"./tlh":265,"./tlh.js":265,"./tr":264,"./tr.js":264,"./tzl":263,"./tzl.js":263,"./tzm":262,"./tzm-latn":261,"./tzm-latn.js":261,"./tzm.js":262,"./uk":260,"./uk.js":260,"./ur":259,"./ur.js":259,"./uz":258,"./uz-latn":257,"./uz-latn.js":257,"./uz.js":258,"./vi":256,"./vi.js":256,"./x-pseudo":255,"./x-pseudo.js":255,"./yo":254,"./yo.js":254,"./zh-cn":229,"./zh-cn.js":229,"./zh-hk":253,"./zh-hk.js":253,"./zh-tw":252,"./zh-tw.js":252};function r(e){var t=s(e);return a(t)}function s(e){var t=n[e];if(!(t+1)){var a=new Error('Cannot find module "'+e+'".');throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=606},81:function(e,t,a){"use strict";a(60);var n=a(21),r=a.n(n),s=a(8),i=a.n(s),o=a(5),l=a.n(o),c=a(7),u=a.n(c),_=a(1),d=a.n(_),p=a(6),m=a.n(p),h=a(2),E=a.n(h),T=a(9),f=a(0),y=a.n(f),v=(a(227),E.a.oneOfType([E.a.string,E.a.number])),g={children:E.a.node,left:v,width:v,visible:E.a.bool},R=function(e){function t(e){return l()(this,t),d()(this,(t.__proto__||i()(t)).call(this,e))}return m()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.visible,n=e.style,s=e.className,i=e.onClose,o="slide-pane",l={top:0,transform:a?"translate3d(0%, 0, 0)":"translate3d(150%, 0, 0)"};return s&&(o=o+" "+s),n&&(l=Object(T.assign)(l,n)),y.a.createElement("div",{className:o,style:l},y.a.createElement("div",{className:"slide-pane-conent"},t),y.a.createElement("span",{className:"slide-pane-toggle",onClick:i},y.a.createElement(r.a,{type:"double-right"})))}}]),t}(f.Component);R.propTypes=g;var C=R;t.a=C;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(v,"strOrNum","/Users/ziv/Documents/workspace/data-stack/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(g,"propType","/Users/ziv/Documents/workspace/data-stack/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(R,"SlidePane","/Users/ziv/Documents/workspace/data-stack/src/widgets/slidePane/index.js"),__REACT_HOT_LOADER__.register(C,"default","/Users/ziv/Documents/workspace/data-stack/src/widgets/slidePane/index.js"))},838:function(e,t,a){"use strict";a.r(t);var n=a(62),r=a(112),s=a(177),i=a(130),o=a(154),l=a(9),c={loading:!1,topRecords:[],alarmTrend:[],alarmSum:{},usage:{}};function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1],a=t.type,n=t.payload;switch(a){case o.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),s=r.loading;return r.loading=!s,r;case o.a.GET_TOP_RECORD:var i=Object(l.cloneDeep)(e);i.topRecords;return i.topRecords=n,i;case o.a.GET_ALARM_SUM:var u=Object(l.cloneDeep)(e);u.alarmSum;return u.alarmSum=n,u;case o.a.GET_ALARM_TREND:var _=Object(l.cloneDeep)(e);_.alarmTrend;return _.alarmTrend=n,_;case o.a.GET_USAGE:var d=Object(l.cloneDeep)(e);d.usage;return d.usage=n,d;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(c,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dashBoard/index.js"),__REACT_HOT_LOADER__.register(u,"dashBoard","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dashBoard/index.js"));var _=a(153),d={loading:!1,taskList:[],taskDetail:[],tableReport:{},alarmNum:[]};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1],a=t.type,n=t.payload;switch(a){case _.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),s=r.loading;return r.loading=!s,r;case _.a.GET_TASK_LIST:var i=Object(l.cloneDeep)(e);i.taskList;return i.taskList=n,i;case _.a.GET_TASK_DETAIL:var o=Object(l.cloneDeep)(e);o.taskDetail;return o.taskDetail=n,o;case _.a.GET_TASK_TABLE_REPORT:var c=Object(l.cloneDeep)(e);c.tableReport;return c.tableReport=n,c;case _.a.GET_TASK_ALARM_NUM:var u=Object(l.cloneDeep)(e);u.alarmNum;return u.alarmNum=n,u;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/taskQuery/index.js"),__REACT_HOT_LOADER__.register(p,"taskQuery","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/taskQuery/index.js"));var m=a(152),h={loading:!1,lists:[],checkReport:{},originPart:[],targetPart:[],reportTable:{}};function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments[1],a=t.type,n=t.payload;switch(a){case m.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),s=r.loading;return r.loading=!s,r;case m.a.GET_LIST:var i=Object(l.cloneDeep)(e);i.lists;return i.lists=n,i;case m.a.GET_SOURCE_PART:var o=Object(l.cloneDeep)(e);o.originPart,o.targetPart;return"origin"===n.type?o.originPart=n.data:o.targetPart=n.data,o;case m.a.RESET_SOURCE_PART:var c=Object(l.cloneDeep)(e);c.originPart,c.targetPart;return"origin"===n?c.originPart=[]:c.targetPart=[],c;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(h,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataCheck/index.js"),__REACT_HOT_LOADER__.register(E,"dataCheck","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataCheck/index.js"));var T=a(94),f={loading:!1,tableLoading:!1,sourceQuery:[],sourceType:[],sourceList:[],sourceTable:[],sourceColumn:[],sourcePart:[],sourcePreview:{}};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments[1],a=t.type,n=t.payload;switch(a){case T.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),s=r.loading;return r.loading=!s,r;case T.a.CHANGE_GETTABLE_LOADING:var i=Object(l.cloneDeep)(e),o=i.tableLoading;return i.tableLoading=!o,i;case T.a.GET_DATA_SOURCES:var c=Object(l.cloneDeep)(e);c.sourceQuery;return c.sourceQuery=n,c;case T.a.GET_DATA_SOURCES_TYPE:var u=Object(l.cloneDeep)(e);u.sourceType;return u.sourceType=n,u;case T.a.GET_DATA_SOURCES_LIST:var _=Object(l.cloneDeep)(e);_.sourceList;return _.sourceList=n,_;case T.a.GET_DATA_SOURCES_TABLE:var d=Object(l.cloneDeep)(e);d.sourceTable;return d.sourceTable=n,d;case T.a.RESET_DATA_SOURCES_TABLE:var p=Object(l.cloneDeep)(e);p.sourceTable;return p.sourceTable=[],p;case T.a.GET_DATA_SOURCES_COLUMN:var m=Object(l.cloneDeep)(e);m.sourceColumn;return m.sourceColumn=n,m;case T.a.GET_DATA_SOURCES_PART:var h=Object(l.cloneDeep)(e);h.sourcePart;return h.sourcePart=n,h;case T.a.RESET_DATA_SOURCES_PART:var E=Object(l.cloneDeep)(e);E.sourcePart;return E.sourcePart=[],E;case T.a.GET_DATA_SOURCES_PREVIEW:var y=Object(l.cloneDeep)(e);y.sourcePreview;return y.sourcePreview=n,y;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(f,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataSource/index.js"),__REACT_HOT_LOADER__.register(y,"dataSource","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataSource/index.js"));var v=a(125),g={loading:!1,monitorList:[],monitorFunction:[],tableColumn:[],monitorRules:[],monitorDetail:{},triggerList:[]};function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments[1],a=t.type,n=t.payload;switch(a){case v.a.CHANGE_LOADING:var r=Object(l.cloneDeep)(e),s=r.loading;return r.loading=!s,r;case v.a.GET_MONITOR_LIST:var i=Object(l.cloneDeep)(e);i.monitorList;return i.monitorList=n,i;case v.a.GET_MONITOR_TABLE_COLUMN:var o=Object(l.cloneDeep)(e);o.tableColumn;return o.tableColumn=n,o;case v.a.GET_RULE_FUNCTION:var c=Object(l.cloneDeep)(e);c.monitorFunction;return c.monitorFunction=n,c;case v.a.GET_MONITOR_RULE:var u=Object(l.cloneDeep)(e);u.monitorRules;return u.monitorRules=n,u;case v.a.GET_MONITOR_DETAIL:var _=Object(l.cloneDeep)(e);_.monitorDetail;return _.monitorDetail=n,_;case v.a.GET_REMOTE_TRIGGER:var d=Object(l.cloneDeep)(e);d.triggerList;return d.triggerList=n,d;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/ruleConfig/index.js"),__REACT_HOT_LOADER__.register(R,"ruleConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/ruleConfig/index.js"));var C=a(37),A=a.n(C),O=a(144),D={source:[],target:[]};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments[1];switch(t.type){case O.a.ADD_LINKED_KEYS:var a=t.payload,n=Object(l.cloneDeep)(e),r=n.source,s=n.target,i=function(e,t){return e.indexOf(t)>-1};return i(r,a.source)?e:i(s,a.target)?e:(n.source=[].concat(A()(n.source),[a.source]),n.target=[].concat(A()(n.target),[a.target]),n);case O.a.DEL_LINKED_KEYS:var o=t.payload,c=Object(l.cloneDeep)(e),u=c.source,_=c.target;return u.splice(u.indexOf(o.source),1),_.splice(_.indexOf(o.target),1),c.source=u,c.target=_,c;case O.a.SET_EDIT_MAP:var d=t.payload,p=Object(l.cloneDeep)(e);return p.source=d.source,p.target=d.target,p;case O.a.SET_ROW_MAP:var m=t.payload,h=m.sourceKeyCol,E=m.targetKeyCol,T=[],f=[];return h.forEach(function(e,t){E[t]&&(T.push(e),f.push(E[t]))}),{source:T,target:f};case O.a.SET_NAME_MAP:var y=t.payload,v=y.sourceKeyCol,g=y.targetKeyCol,R=[],C=[];return v.forEach(function(e,t){g.indexOf(e)>-1&&(R.push(e),C.push(e))}),{source:R,target:C};case O.a.RESET_LINKED_KEYS:return{source:[],target:[]};default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(D,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataCheck/keymap.js"),__REACT_HOT_LOADER__.register(k,"keymap","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/dataCheck/keymap.js"));var S=a(389),b={userList:[],allDict:{}};function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments[1],a=t.type,n=t.payload;switch(a){case S.a.GET_USER_LIST:var r=Object(l.cloneDeep)(e);r.userList;return r.userList=n,r;case S.a.GET_ALL_DICT:var s=Object(l.cloneDeep)(e);s.allDict;return s.allDict=n,s;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(b,"initialState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/common.js"),__REACT_HOT_LOADER__.register(L,"dataCheck","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/modules/common.js"));var w=Object(n.c)({routing:r.routerReducer,user:s.a,app:i.a,apps:i.b,dashBoard:u,taskQuery:p,dataCheck:E,dataSource:y,ruleConfig:R,common:L,keymap:k}),H=w;t.default=H,"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(w,"rootReducer","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/index.js"),__REACT_HOT_LOADER__.register(H,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/reducers/index.js"))},84:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(8),r=a.n(n),s=a(5),i=a.n(s),o=a(7),l=a.n(o),c=a(1),u=a.n(c),_=a(6),d=a.n(_),p=a(0),m=function(e){function t(){var e,a,n,s;i()(this,t);for(var o=arguments.length,l=Array(o),c=0;c<o;c++)l[c]=arguments[c];return a=n=u()(this,(e=t.__proto__||r()(t)).call.apply(e,[this].concat(l))),n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},s=a,u()(n,s)}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize,!1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1)}},{key:"__resize__REACT_HOT_LOADER__",value:function(){var e=this.props.onResize;e&&e()}},{key:"render",value:function(){return this.props.children}}]),t}(p.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(m,"Resize","/Users/ziv/Documents/workspace/data-stack/src/widgets/resize/index.js")},843:function(e,t,a){"use strict";a.r(t);var n={};a.d(n,"dataFilterDoc",function(){return hr}),a.d(n,"switchKey",function(){return Er}),a.d(n,"hdfsPath",function(){return Tr}),a.d(n,"jobSpeedLimit",function(){return fr}),a.d(n,"jobConcurrence",function(){return yr}),a.d(n,"errorCount",function(){return vr}),a.d(n,"hdfsConfig",function(){return gr}),a.d(n,"rdbConfig",function(){return Rr}),a.d(n,"hBaseConfig",function(){return Cr}),a.d(n,"recordDirtyData",function(){return Ar}),a.d(n,"errorPercentConfig",function(){return Or});var r,s,i=a(0),o=a.n(i),l=a(56),c=a.n(l),u=a(195),_=a(178),d=a(8),p=a.n(d),m=a(5),h=a.n(m),E=a(7),T=a.n(E),f=a(1),y=a.n(f),v=a(6),g=a.n(v),R=a(14),C=a(20),A=(a(235),a(393),a(233),a(231),a(879),a(131),a(79),a(117),a(185)),O=a(179),D=a(128),k=a(184),S=a(183),b=a(129),L=a(182),w=a(181),H=a(180),P=a(2),N=a.n(P),x=a(12),I=a(3),U=a(4),j=a.n(U),M=(a(60),a(21)),z=a.n(M),Q=a(93),F=Object(C.b)(function(e){return{user:e.user,apps:e.apps,routing:e.routing,app:e.app}})(r=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.state={},a}return g()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=(e.user,e.apps,"/dataQuality.html#"),a=[{id:"dq/overview",name:"概览",link:t+"/dq/overview",enable:!0},{id:"dq/taskQuery",name:"任务查询",link:t+"/dq/taskQuery",enable:!0},{id:"dq/rule",name:"规则配置",link:t+"/dq/rule",enable:!0},{id:"dq/dataCheck",name:"逐行校验",link:t+"/dq/dataCheck",enable:!0},{id:"dq/dataSource",name:"数据源管理",link:t+"/dq/dataSource",enable:!0}],n=o.a.createElement("span",null,o.a.createElement(z.a,{style:{fontSize:"18px",color:"#2491F7",marginRight:"10px"},type:"database"}),o.a.createElement("span",{style:{fontSize:"14px",color:"#ffffff"}},"DTinsight.Valid"));return o.a.createElement(Q.c,j()({logo:n,menuItems:a},this.props))}}]),t}(i.Component))||r,G=F,V=G,q=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(F,"Header","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/layout/header.js"),__REACT_HOT_LOADER__.register(G,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/layout/header.js")),a(44),a(25)),K=a.n(q),Y=(a(54),a(28)),B=a.n(Y),W=(a(69),a(31)),J=a.n(W),$=(a(74),a(27)),Z=a.n($),X=a(573),ee=a.n(X),te=a(194),ae=a.n(te),ne=a(19),re=a.n(ne),se=a(84),ie={WAIT_RUN:0,RUNNING:1,FAIL:2,PASS:3,UNPASS:4},oe={MYSQL:1,ORACLE:2,SQLSERVER:3,HDFS:6,HIVE:7,HBASE:8,FTP:9,MAXCOMPUTE:10},le={INITIAL:0,RUNNING:1,SUCCESS:2,FAIL:3,PASS:4,UNPASS:5,EXPIRED:6},ce=[{text:"等待运行",value:"0"},{text:"运行中",value:"1"},{text:"运行成功",value:"2"},{text:"运行失败",value:"3"},{text:"校验通过",value:"4"},{text:"校验未通过",value:"5"},{text:"校验结果失效",value:"6"}],ue=["未知类型","MySQL","Oracle","SQLServer","PostgreSQL","RDBMS","HDFS","Spark","HBase","FTP","MaxCompute"],_e=[{text:"MySQL",value:1},{text:"Oracle",value:2},{text:"SQLServer",value:3},{text:"Spark",value:7},{text:"MaxCompute",value:10}],de=["未知类型","小时","天","周","月","手动触发"],pe=[{text:">",value:">"},{text:">=",value:">="},{text:"=",value:"="},{text:"<",value:"<"},{text:"<=",value:"<="},{text:"!=",value:"!="}],me=[{text:">",value:">"},{text:">=",value:">="},{text:"=",value:"="},{text:"<",value:"<"},{text:"<=",value:"<="}],he=[{text:"今日告警数",value:"1"},{text:"最近7天告警数",value:"7"},{text:"最近30天告警数",value:"30"}],Ee=[{text:"等待运行",value:ie.WAIT_RUN},{text:"运行中",value:ie.RUNNING},{text:"运行失败",value:ie.FAIL},{text:"校验通过",value:ie.PASS},{text:"校验未通过",value:ie.UNPASS}],Te={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},fe={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:10}}},ye={wrapperCol:{xs:{span:24,offset:0},sm:{span:14,offset:6}}},ve={labelCol:{span:0},wrapperCol:{span:24}},ge={title:{text:"堆叠区域图",textStyle:{fontSize:12},textAlign:"left"},tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},color:["#2491F7","#7460EF","#26DAD2","#79E079","#7A64F3","#FFDC53","#9a64fb"],legend:{data:["邮件营销","联盟广告","视频广告","直接访问","搜索引擎"]},toolbox:{feature:{saveAsImage:{show:!1}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[],axisTick:{show:!0},axisLine:{lineStyle:{color:"#DDDDDD"}},axisLabel:{textStyle:{color:"#666666"}},nameTextStyle:{color:"#666666"},splitLine:{color:"#666666"}}],yAxis:[{type:"value",axisLabel:{formatter:"{value} 个",textStyle:{color:"#666666",baseline:"bottom"}},nameTextStyle:{color:"#666666"},nameLocation:"end",nameGap:20,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#DDDDDD",type:"dashed"}}}],series:[]},Re=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ie,"TASK_STATUS","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(oe,"DATA_SOURCE","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(le,"CHECK_STATUS","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ce,"CHECK_STATUS_CN","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ue,"dataSourceTypes","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(_e,"dataSourceFilter","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(de,"periodType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(pe,"operatorSelect","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(me,"operatorSelect1","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(he,"alarmDateFilter","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Ee,"taskStatusFilter","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(Te,"formItemLayout","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(fe,"halfFormItemLayout","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ye,"tailFormItemLayout","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ve,"rowFormItemLayout","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js"),__REACT_HOT_LOADER__.register(ge,"lineAreaChartOptions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/index.js")),a(154)),Ce=a(41),Ae=a(42),Oe={getTopRecord:function(e){return Ce.a.post(Ae.a.GET_TOP_RECORD,e)},getAlarmSum:function(e){return Ce.a.post(Ae.a.GET_ALARM_SUM,e)},getAlarmTrend:function(e){return Ce.a.post(Ae.a.GET_ALARM_TREND,e)},getUsage:function(e){return Ce.a.post(Ae.a.GET_DASHBOARD_USAGE,e)}},De=Oe,ke=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Oe,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/dashBoard.js"),{getTopRecord:function(e){return function(t){t({type:Re.a.CHANGE_LOADING}),De.getTopRecord(e).then(function(e){1===e.code&&t({type:Re.a.GET_TOP_RECORD,payload:e.data}),t({type:Re.a.CHANGE_LOADING})})}},getAlarmSum:function(e){return function(t){De.getAlarmSum(e).then(function(e){1===e.code&&t({type:Re.a.GET_ALARM_SUM,payload:e.data})})}},getAlarmTrend:function(e){return function(t){De.getAlarmTrend(e).then(function(e){1===e.code&&t({type:Re.a.GET_ALARM_TREND,payload:e.data})})}},getUsage:function(e){return function(t){De.getUsage(e).then(function(e){1===e.code&&t({type:Re.a.GET_USAGE,payload:e.data})})}}}),Se=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(ke,"dashBoardActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/dashBoard/index.js"),a(72));a(139),a(133),a(132);var be=function(e){return{dashBoard:e.dashBoard}},Le=function(e){return{getTopRecord:function(t){e(ke.getTopRecord(t))},getAlarmSum:function(t){e(ke.getAlarmSum(t))},getUsage:function(t){e(ke.getUsage(t))}}},we=Object(C.b)(be,Le)(s=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={currentDate:"1"},n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},n.alarmTitle=function(){var e;return(e=n).__alarmTitle__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getUsage(),this.props.getAlarmSum(),this.props.getTopRecord({date:7}),De.getAlarmTrend().then(function(t){1===t.code&&e.initLineChart(t.data)})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"__alarmTitle__REACT_HOT_LOADER__",value:function(e){switch(e){case"1":return"今天";case"30":return"最近30天";default:return"最近7天"}}},{key:"jumpToTaskQuery",value:function(e){var t=new re.a,a=re()(re()(t).subtract(e-1,"days").format("YYYY-MM-DD"));R.g.push({pathname:"/dq/taskQuery",query:{startTime:a.valueOf(),endTime:t.valueOf(),statusFilter:[ie.FAIL,ie.UNPASS].join(",")}})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this.state.currentDate;return[{title:"排名",dataIndex:"rank",key:"rank",render:function(e,t,a){return o.a.createElement("div",{className:"rank-number"},a+1)},width:"10%"},{title:"类型",dataIndex:"dataSourceName",key:"dataSourceName",width:"40%"},{title:"表名",dataIndex:"tableName",key:"tableName",render:function(e,t){return o.a.createElement(R.c,{to:"/dq/taskQuery?tb="+e+"&source="+t.dataSourceType},e)},width:"35%"},{title:"告警数",dataIndex:"countByDate",key:"countByDate",filters:he,filteredValue:[e],filterMultiple:!1,render:function(e){return o.a.createElement("span",{style:{color:"#EF5350"}},e)},width:"15%"}]}},{key:"initLineChart",value:function(e){var t=Se.init(document.getElementById("alarm-trend")),a=j()({},ge),n=ae()(e).map(function(e){return re()(e).format("YYYY-MM-DD")}),r=ee()(e);a.title.text="",a.tooltip.axisPointer.label.formatter="{value}",a.legend.data=["告警数"],a.xAxis[0].axisLabel.formatter="{value}",a.xAxis[0].data=e&&n?n:[],a.grid={left:"3%",right:"4%",bottom:"8%",containLabel:!0},a.yAxis[0].axisLabel.formatter="{value}",a.yAxis[0].minInterval=1,a.series=[{name:"告警数",symbol:"none",type:"line",data:r}],t.setOption(a),this.setState({lineChart:t})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=t.countByDate[0]||"7";this.props.getTopRecord({date:n}),this.setState({currentDate:n})}},{key:"render",value:function(){var e=this.props.dashBoard,t=e.topRecords,a=(e.alarmTrend,e.alarmSum),n=e.usage,r=e.loading,s=this.state.currentDate,i=o.a.createElement(R.c,{to:"/dq/taskQuery"},"查看更多"),l={marginTop:20};return o.a.createElement(J.a,{style:{margin:20}},o.a.createElement(Z.a,{span:12,style:{paddingRight:10}},o.a.createElement(J.a,{className:"m-card shadow m-card-small"},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,title:"告警汇总",extra:i},o.a.createElement(J.a,{className:"m-count"},o.a.createElement(Z.a,{span:8},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"今日告警数"),o.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,1),className:"m-count-content font-red"},a.countToday))),o.a.createElement(Z.a,{span:8},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"最近7天告警数"),o.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,7),className:"m-count-content font-red"},a.countWeek))),o.a.createElement(Z.a,{span:8},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"最近30天告警数"),o.a.createElement("a",{onClick:this.jumpToTaskQuery.bind(this,30),className:"m-count-content font-red"},a.countMonth)))))),o.a.createElement(J.a,{style:l,className:"m-card shadow m-card-small"},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,title:"告警趋势(最近30天)"},o.a.createElement(se.a,{onResize:this.resize},o.a.createElement("article",{id:"alarm-trend",style:{width:"100%",height:"317px"}})))),o.a.createElement(J.a,{style:l,className:"m-card shadow m-card-small"},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,title:"使用情况"},o.a.createElement(J.a,{className:"m-count"},o.a.createElement(Z.a,{span:6},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"已配置表数"),o.a.createElement("span",{className:"m-count-content font-black"},n.tableCount))),o.a.createElement(Z.a,{span:6},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"已配置规则数"),o.a.createElement("span",{className:"m-count-content font-black"},n.ruleCount))),o.a.createElement(Z.a,{span:6},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"昨日新增表数"),o.a.createElement("span",{className:"m-count-content font-black"},n.lastTableCount))),o.a.createElement(Z.a,{span:6},o.a.createElement("section",{className:"m-count-section",style:{width:100}},o.a.createElement("span",{className:"m-count-title"},"昨日新增规则数"),o.a.createElement("span",{className:"m-count-content font-black"},n.lastRuleCount))))))),o.a.createElement(Z.a,{span:12,style:{paddingLeft:10}},o.a.createElement(J.a,{className:"m-card shadow m-card-small"},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,title:this.alarmTitle(s)+"告警TOP20"},o.a.createElement(K.a,{rowKey:"monitorId",className:"m-table trend-table",columns:this.initColumns(),loading:r,pagination:!1,dataSource:t,onChange:this.onTableChange})))))}}]),t}(i.Component))||s,He=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(be,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dashboard/index.js"),__REACT_HOT_LOADER__.register(Le,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dashboard/index.js"),__REACT_HOT_LOADER__.register(we,"DashBoard","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dashboard/index.js")),a(216)),Pe=a(39),Ne=a.n(Pe)()(["GET_USER","UPDATE_USER","GET_NOT_PROJECT_USERS","GET_PROJECT_USERS","GET_USER_LIST"],{prefix:"user/"}),xe=Ne,Ie=xe;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ne,"userActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/userActions.js"),__REACT_HOT_LOADER__.register(xe,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/userActions.js"));function Ue(){return function(e){He.a.getLoginedUser().then(function(t){if(1===t.code)return e({type:Ie.GET_USER,data:t.data})})}}function je(e){return{type:Ie.UPDATE_USER,data:e}}function Me(e){return function(t){He.a.getUserList(e).then(function(e){1===e.code&&t({type:Ie.GET_USER_LIST,data:e.data})})}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ue,"getUser","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/user.js"),__REACT_HOT_LOADER__.register(je,"updateUser","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/user.js"),__REACT_HOT_LOADER__.register(Me,"getUserList","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/user.js"));var ze,Qe=a(94),Fe={getDataSources:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES,e)},testDSConnection:function(e){return Ce.a.post(Ae.a.CHECK_CONNECTION,e)},addDataSource:function(e){return Ce.a.post(Ae.a.ADD_DATA_SOURCES,e)},updateDataSource:function(e){return Ce.a.post(Ae.a.UPDATE_DATA_SOURCES,e)},deleteDataSource:function(e){return Ce.a.post(Ae.a.DELETE_DATA_SOURCES,e)},getDataSourcesType:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_TYPE,e)},getDataSourcesList:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_LIST,e)},getDataSourcesTable:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_TABLE,e)},getDataSourcesColumn:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_COLUMN,e)},getDataSourcesPart:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_PART,e)},getDataSourcesPreview:function(e){return Ce.a.post(Ae.a.GET_DATA_SOURCES_PREVIEW,e)}},Ge=Fe,Ve=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Fe,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/dataSource.js"),{getDataSources:function(e){return function(t){t({type:Qe.a.CHANGE_LOADING}),Ge.getDataSources(e).then(function(e){1===e.code&&t({type:Qe.a.GET_DATA_SOURCES,payload:e.data}),t({type:Qe.a.CHANGE_LOADING})})}},getDataSourcesType:function(e){return function(t){Ge.getDataSourcesType(e).then(function(e){1===e.code&&t({type:Qe.a.GET_DATA_SOURCES_TYPE,payload:e.data})})}},getDataSourcesList:function(e){return function(t){Ge.getDataSourcesList(e).then(function(e){1===e.code&&t({type:Qe.a.GET_DATA_SOURCES_LIST,payload:e.data})})}},getDataSourcesTable:function(e){return function(t){t({type:Qe.a.CHANGE_GETTABLE_LOADING}),Ge.getDataSourcesTable(e).then(function(e){1===e.code?t({type:Qe.a.GET_DATA_SOURCES_TABLE,payload:e.data}):t({type:Qe.a.GET_DATA_SOURCES_TABLE,payload:[]}),t({type:Qe.a.CHANGE_GETTABLE_LOADING})})}},resetDataSourcesTable:function(){return function(e){e({type:Qe.a.RESET_DATA_SOURCES_TABLE})}},getDataSourcesColumn:function(e){return function(t){Ge.getDataSourcesColumn(e).then(function(e){1===e.code&&t({type:Qe.a.GET_DATA_SOURCES_COLUMN,payload:e.data})})}},getDataSourcesPart:function(e){return function(t){Ge.getDataSourcesPart(e).then(function(e){1===e.code&&t({type:Qe.a.GET_DATA_SOURCES_PART,payload:e.data?e.data:{}})})}},resetDataSourcesPart:function(){return function(e){e({type:Qe.a.RESET_DATA_SOURCES_PART})}},getDataSourcesPreview:function(e){return function(t){Ge.getDataSourcesPreview(e).then(function(e){if(1===e.code){var a=e.data,n=a.columnList,r=a.dataList;e.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),t({type:Qe.a.GET_DATA_SOURCES_PREVIEW,payload:e.data})}})}}}),qe=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ve,"dataSourceActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/dataSource/index.js"),a(389)),Ke={getUserList:function(){return Ce.a.post(Ae.a.DQ_GET_USER_LIST)},getAllDict:function(){return Ce.a.post(Ae.a.DQ_GET_ALL_DICT)}},Ye=Ke,Be=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ke,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/common.js"),{getUserList:function(e){return function(t){Ye.getUserList(e).then(function(e){1===e.code&&t({type:qe.a.GET_USER_LIST,payload:e.data})})}},getAllDict:function(e){return function(t){Ye.getAllDict(e).then(function(e){1===e.code&&t({type:qe.a.GET_ALL_DICT,payload:e.data})})}}}),We=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Be,"commonActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/common.js"),a(176)),Je={children:N.a.node},$e={children:[]},Ze=Object(C.b)()(ze=function(e){function t(){return h()(this,t),y()(this,(t.__proto__||p()(t)).apply(this,arguments))}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e(Ue()),e(Object(We.a)(I.h)),e(Be.getUserList()),e(Be.getAllDict()),e(Ve.getDataSourcesType())}},{key:"render",value:function(){var e=this.props.children;return o.a.createElement("div",{className:"main header-fixed container-relative"},o.a.createElement(V,null),o.a.createElement("div",{className:"container"},e||o.a.createElement(we,null)))}}]),t}(i.Component))||ze;Ze.propTypes=Je,Ze.defaultProps=$e;var Xe=Ze,et=Xe,tt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Je,"propType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register($e,"defaultPro","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register(Ze,"Main","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/index.js"),__REACT_HOT_LOADER__.register(Xe,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/index.js")),a(75),a(47)),at=a.n(tt),nt=(a(58),a(30)),rt=a.n(nt),st=(a(91),a(45)),it=a.n(st),ot=(a(99),a(68)),lt=a.n(ot),ct=(a(78),a(36)),ut=a.n(ct),_t=(a(40),a(16)),dt=a.n(_t),pt=(a(38),a(15)),mt=a.n(pt),ht=a(81),Et=a(9),Tt=a(64);function ft(e){switch(e.value){case!0:return o.a.createElement("span",null,"通过");case!1:return o.a.createElement("span",null,"未通过");default:return o.a.createElement("span",null,"--")}}function yt(e){switch(e.value){case ie.WAIT_RUN:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"等待运行",style:{background:"#d9d9d9"}})," 等待运行");case ie.RUNNING:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"运行中",style:{background:"#2491F7"}})," 运行中");case ie.FAIL:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"运行失败",style:{background:"#EF5350"}})," 运行失败");case ie.PASS:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"校验通过",style:{background:"#00A755"}})," 校验通过");case ie.UNPASS:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"校验未通过",style:{background:"#F5A623"}})," 校验未通过");default:return o.a.createElement("span",{style:e.style},"--")}}function vt(e){switch(e.value){case le.INITIAL:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"等待运行",style:{background:"#d9d9d9"}})," 等待运行");case le.RUNNING:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"运行中",style:{background:"#2491F7"}})," 运行中");case le.SUCCESS:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"运行成功",style:{background:"#00A755"}})," 运行成功");case le.FAIL:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"运行失败",style:{background:"#EF5350"}})," 运行失败");case le.PASS:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"校验通过",style:{background:"#00A755"}})," 校验通过");case le.UNPASS:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"校验未通过",style:{background:"#F5A623"}})," 校验未通过");case le.EXPIRED:return o.a.createElement("span",{style:e.style},o.a.createElement(Tt.a,{title:"校验结果失效",style:{background:"#F5A623"}})," 校验结果失效");default:return o.a.createElement("span",{style:e.style},"--")}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ft,"DetailCheckStatus","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/display/index.js"),__REACT_HOT_LOADER__.register(yt,"TaskStatus","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/display/index.js"),__REACT_HOT_LOADER__.register(vt,"DataCheckStatus","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/display/index.js"));var gt={getTaskList:function(e){return Ce.a.post(Ae.a.GET_TASK_LIST,e)},getTaskDetail:function(e){return Ce.a.post(Ae.a.GET_TASK_DETAIL,e)},getTaskTableReport:function(e){return Ce.a.post(Ae.a.GET_TABLE_REPORT,e)},getTaskAlarmNum:function(e){return Ce.a.post(Ae.a.GET_TASK_ALARM_NUM,e)}},Rt=gt,Ct=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(gt,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/taskQuery.js"),a(72));a(139),a(133),a(132),a(875);var At=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.initRulesColumns=function(){return a.__initRulesColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onCheckReport=function(){return a.__onCheckReport__REACT_HOT_LOADER__.apply(a,arguments)},a.state={lineChart:"",visible:!1,taskDetail:[],currentRecord:{},showSnapshot:!1},a}return g()(t,e),T()(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props.data,n=e.data;Object(Et.isEmpty)(n)||a===n||Rt.getTaskDetail({recordId:n.id,monitorId:n.monitorId}).then(function(e){1===e.code&&t.setState({taskDetail:e.data,visible:!1})})}},{key:"isSnapshotChange",value:function(e){this.setState({showSnapshot:e.target.checked})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"__initRulesColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(e,t){var a=t.isSnapshot?" (已删除)":"";return{children:(t.isCustomizeSql?t.customizeSql:e)+a,props:{colSpan:t.isCustomizeSql?3:1}}},width:"100px"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(e,t){return{children:t.functionName,props:{colSpan:t.isCustomizeSql?0:1}}},width:"100px"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(e,t){return{children:e,props:{colSpan:t.isCustomizeSql?0:1}}},width:"100px"},{title:"校验方法",dataIndex:"verifyTypeValue",key:"verifyTypeValue",width:"10%"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement(ft,{value:e})},width:"8%"},{title:"统计值",dataIndex:"statistic",key:"statistic",width:"8%"},{title:"阈值",dataIndex:"threshold",key:"threshold",render:function(e,t){return t.isPercentage?t.operator+"  "+e+"  %":t.operator+"  "+e},width:"8%"},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"12%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"12%",render:function(e){return re()(e).format("YYYY-MM-DD HH:mm")}},{title:"操作",width:"8%",render:function(t,a){return o.a.createElement("a",{onClick:e.onCheckReport.bind(e,a)},"查看趋势")}}]}},{key:"__onCheckReport__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({currentRecord:e}),Rt.getTaskAlarmNum({ruleId:e.id,monitorId:e.monitorId}).then(function(e){1===e.code&&(t.setState({visible:!0}),t.initLineChart(e.data))})}},{key:"initLineChart",value:function(e){var t=this.state.currentRecord,a=Ct.init(document.getElementById("TaskTrend")),n=Object(Et.cloneDeep)(ge),r=ae()(e).map(function(e){return re()(e).format("YYYY-MM-DD HH:mm")}),s=ee()(e);n.title.text="",n.tooltip.axisPointer.label.formatter="{value}",n.legend.data=["统计值"],n.xAxis[0].axisTick={show:!1,alignWithLabel:!0},n.xAxis[0].boundaryGap=["5%","5%"],n.xAxis[0].axisLabel.formatter=function(e,t){return re()(e).format("YYYY-MM-DD HH:mm")},n.xAxis[0].data=e&&r?r:[],n.yAxis[0].axisLabel.formatter="{value}",n.yAxis[0].minInterval=1,n.series=[{name:"统计值",type:"line",smooth:!0,symbolSize:8,data:s}],Object(Et.isEmpty)(e)||(n.series[0].markLine="in"===t.operator?void 0:{silent:!0,itemStyle:{normal:{label:{formatter:function(){return"阈值"}}}},data:[{yAxis:+t.threshold}]}),a.setOption(n),this.setState({lineChart:a})}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.currentRecord,n=e.taskDetail,r=e.showSnapshot,s=n.filter(function(e){return!!r||0==e.isSnapshot}),i=Object(Et.isEmpty)(a)?"":"指标最近波动图（"+a.columnName+" -- "+a.functionName+"）";return a&&a.isCustomizeSql&&(i="指标最近波动图"),o.a.createElement("div",{style:{padding:10}},o.a.createElement(at.a,{value:r,style:{marginBottom:"10px"},onChange:this.isSnapshotChange.bind(this)},"查看历史规则"),o.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:this.initRulesColumns(),pagination:!1,dataSource:s,style:{marginBottom:15},scroll:{y:250}}),t&&o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:i},o.a.createElement(se.a,{onResize:this.resize},o.a.createElement("article",{id:"TaskTrend",style:{width:"100%",height:"300px"}}))))}}]),t}(i.Component),Ot=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(At,"TaskDetailPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/taskDetailPane.js"),a(37)),Dt=a.n(Ot),kt=a(72);a(139),a(133),a(132);var St,bt,Lt=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.loadReports=function(){return a.__loadReports__REACT_HOT_LOADER__.apply(a,arguments)},a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.getSeries=function(){return a.__getSeries__REACT_HOT_LOADER__.apply(a,arguments)},a.initTableInfoColumns=function(){return a.__initTableInfoColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.initTableReportColumns=function(){return a.__initTableReportColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.init30TimesInfo=function(){return a.__init30TimesInfo__REACT_HOT_LOADER__.apply(a,arguments)},a.init30TimesTableReport=function(){return a.__init30TimesTableReport__REACT_HOT_LOADER__.apply(a,arguments)},a.state={lineChart:"",tableReport:{}},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this.props.data;this.loadReports({recordId:e.id,tableId:e.tableId})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;Object(Et.isEmpty)(a)||t===a||this.loadReports({recordId:a.id,tableId:a.tableId})}},{key:"__loadReports__REACT_HOT_LOADER__",value:function(e){var t=this;Rt.getTaskTableReport(e).then(function(e){1===e.code&&(t.setState({tableReport:e.data}),t.initLineChart(e.data.usage))})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"initLineChart",value:function(e){var t=kt.init(document.getElementById("TableReportTrend")),a=Object(Et.cloneDeep)(ge),n=e.map(function(e){return re()(e.executeTime).format("YYYY-MM-DD HH:mm")}),r=[{key:"dayCountRecord",name:"记录数"},{key:"dayCountTrigger",name:"总告警数"}];a.grid={left:20,right:20,containLabel:!0},a.title.text="",a.tooltip.axisPointer.label.formatter="{value}",a.xAxis[0].axisTick={show:!1,alignWithLabel:!0},a.xAxis[0].boundaryGap=["5%","5%"],a.xAxis[0].axisLabel.formatter=function(e,t){return re()(e).format("MM-DD HH:mm")},a.xAxis[0].data=e&&n?n:[],a.yAxis[0].axisLabel.formatter="{value}",a.yAxis[0].minInterval=1,a.legend.data=r.map(function(e){return e.name}),a.series=this.getSeries(e,r),t.setOption(a),this.setState({lineChart:t})}},{key:"__getSeries__REACT_HOT_LOADER__",value:function(e,t){var a=[];return e.length&&t.forEach(function(t){a.push({name:t.name,type:"line",smooth:!0,symbolSize:8,data:e.map(function(e){return e[t.key]})})}),a}},{key:"__initTableInfoColumns__REACT_HOT_LOADER__",value:function(){return[{title:"表名",dataIndex:"tableName",key:"tableName",width:"40%"},{title:"总分区数量",dataIndex:"partitionNum",key:"partitionNum",width:"20%"},{title:"类型",dataIndex:"dataSourceType",key:"dataSourceType",width:"40%"}]}},{key:"__initTableReportColumns__REACT_HOT_LOADER__",value:function(){return[{title:"记录数",dataIndex:"countData",key:"countData",width:"50%"},{title:"报警数",dataIndex:"countTrigger",key:"countTrigger",width:"50%"}]}},{key:"__init30TimesInfo__REACT_HOT_LOADER__",value:function(){return[{title:"记录数平均波动率",dataIndex:"standardDeviation",key:"standardDeviation"},{title:"平均记录数",dataIndex:"avgRecord",key:"avgRecord"},{title:"日平均告警数",dataIndex:"avgTrigger",key:"avgTrigger"},{title:"平均告警率",dataIndex:"alarmRate",key:"alarmRate",render:function(e){return e&&e.toFixed?e.toFixed(2):e}}]}},{key:"__init30TimesTableReport__REACT_HOT_LOADER__",value:function(){return[{title:"执行时间",dataIndex:"executeTime",key:"executeTime",render:function(e){return re()(e).format("YYYY-MM-DD HH:mm:ss")},width:"40%"},{title:"记录数",dataIndex:"dayCountRecord",key:"dayCountRecord",width:"30%"},{title:"总告警数",dataIndex:"dayCountTrigger",key:"dayCountTrigger",width:"30%"}]}},{key:"render",value:function(){var e=this.state.tableReport,t=Object(Et.isEmpty)(e)?[]:[e],a=e.usage?[].concat(Dt()(e.usage)).reverse():[],n=o.a.createElement("div",null,"表级统计",o.a.createElement("span",{style:{fontSize:12,color:"#999"}},"（执行时间：",re()(e.executeTime).format("YYYY-MM-DD HH:mm:ss"),"）"));return o.a.createElement("div",{style:{padding:20}},o.a.createElement(K.a,{rowKey:"tableName",className:"m-table txt-center-table",columns:this.initTableInfoColumns(),pagination:!1,dataSource:t}),o.a.createElement(J.a,{style:{padding:"20px 0"},gutter:16},o.a.createElement(Z.a,{span:12},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:n},o.a.createElement(K.a,{rowKey:"tableName",className:"m-table txt-center-table",columns:this.initTableReportColumns(),pagination:!1,dataSource:t}))),o.a.createElement(Z.a,{span:12},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次综合报告"},o.a.createElement(K.a,{rowKey:"tableName",className:"m-table txt-center-table",columns:this.init30TimesInfo(),pagination:!1,dataSource:t})))),o.a.createElement(J.a,{gutter:16},o.a.createElement(Z.a,{span:12},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次表级统计"},o.a.createElement(K.a,{rowKey:"id",className:"m-table txt-center-table",columns:this.init30TimesTableReport(),pagination:!1,dataSource:a,scroll:{y:245}}))),o.a.createElement(Z.a,{span:12},o.a.createElement(B.a,{noHovering:!0,bordered:!1,loading:!1,className:"shadow",title:"最近30次表数据波动图",style:{width:"100%"}},o.a.createElement(se.a,{onResize:this.resize},o.a.createElement("article",{id:"TableReportTrend",style:{width:"100%",height:"280px"}}))))))}}]),t}(i.Component),wt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Lt,"TaskTablePane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/taskTablePane.js"),a(153)),Ht={getTaskList:function(e){return function(t){t({type:wt.a.CHANGE_LOADING}),Rt.getTaskList(e).then(function(e){1===e.code&&t({type:wt.a.GET_TASK_LIST,payload:e.data}),t({type:wt.a.CHANGE_LOADING})})}},getTaskDetail:function(e){return function(t){Rt.getTaskDetail(e).then(function(e){1===e.code&&t({type:wt.a.GET_TASK_DETAIL,payload:e.data})})}},getTaskTableReport:function(e){return function(t){Rt.getTaskTableReport(e).then(function(e){1===e.code&&t({type:wt.a.GET_TASK_TABLE_REPORT,payload:e.data})})}},getTaskAlarmNum:function(e){return function(t){Rt.getTaskAlarmNum(e).then(function(e){1===e.code&&t({type:wt.a.GET_TASK_ALARM_NUM,payload:e.data})})}}},Pt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ht,"taskQueryActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/taskQuery/index.js"),mt.a.Search),Nt=dt.a.Option,xt=ut.a.TabPane,It=lt.a.RangePicker,Ut=function(e){return{taskQuery:e.taskQuery,dataSource:e.dataSource,common:e.common}},jt=function(e){return{getTaskList:function(t){e(Ht.getTaskList(t))},getDataSourcesList:function(t){e(Ve.getDataSourcesList(t))}}},Mt=Object(C.b)(Ut,jt)(St=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={params:{currentPage:1,pageSize:20,fuzzyName:x.a.getParameterByName("tb")||void 0,configureId:void 0,dataSourceId:void 0,dataSourceType:x.a.getParameterByName("source")||void 0,subscribe:void 0,executeStartTime:x.a.getParameterByName("startTime")||void 0,executeEndTime:x.a.getParameterByName("endTime")||void 0,bizTime:0,statusFilter:x.a.getParameterByName("statusFilter")||""},tabKey:"1",showSlidePane:!1,currentTask:{},visibleList:[]},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onExecuteTimeChange=function(){var e;return(e=n).__onExecuteTimeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribeChange=function(){var e;return(e=n).__onSubscribeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableSearch=function(){var e;return(e=n).__onTableSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.openSlidePane=function(){var e;return(e=n).__openSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.closeSlidePane=function(){var e;return(e=n).__closeSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.onTabChange=function(){var e;return(e=n).__onTabChange__REACT_HOT_LOADER__.apply(e,arguments)},n.disabledDate=function(){var e;return(e=n).__disabledDate__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.props.getTaskList(this.state.params),this.props.getDataSourcesList()}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this,t=this.state,a=t.visibleList,n=t.params;return[{title:"表",dataIndex:"tableName",key:"tableName",render:function(t,a){return o.a.createElement("a",{onClick:e.openSlidePane.bind(e,a)},t)},width:"15%"},{title:"分区",dataIndex:"partationValue",key:"partationValue",render:function(e,t){return e||"--"},width:"15%"},{title:"状态",width:"10%",dataIndex:"status",key:"status",render:function(t,n){return o.a.createElement("div",null,o.a.createElement(yt,{style:{marginRight:30},value:t}),2===t&&o.a.createElement(it.a,{placement:"right",visible:a.indexOf(n.id)>-1,onVisibleChange:e.tooltipChange.bind(e,n.id),title:o.a.createElement("a",{className:"tooltip_content_a",onClick:e.showDetailLogInfo.bind(e,n.id,n.tableName,n.logInfo)},n.logInfo),overlayStyle:{wordBreak:"break-word"}},o.a.createElement(z.a,{className:"font-14",type:"info-circle-o"})))},filters:Ee,filteredValue:n.statusFilter?n.statusFilter.split(","):[]},{title:"规则异常数",dataIndex:"alarmSum",key:"alarmSum",width:"8%",sorter:!0},{title:"数据源",dataIndex:"sourceTypeValue",key:"sourceTypeValue",render:function(e,t){return e?e+" / "+t.sourceName:"--"},width:"15%"},{title:"配置人",dataIndex:"configureUserName",key:"configureUserName",width:"12%"},{title:"执行时间",dataIndex:"executeTime",key:"executeTime",render:function(e){return e?re()(e).format("YYYY-MM-DD HH:mm:ss"):"--"},width:"12%",sorter:!0}]}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=a.field,r=a.order,s=j()({},this.state.params,{currentPage:e.current,statusFilter:t.status&&t.status.length>0?t.status.join(","):void 0,alarmSort:void 0,executeTimeSort:void 0});n?s["alarmSum"===n?"alarmSort":"executeTimeSort"]="descend"===r?"desc":"asc":s.alarmSort=s.executeTimeSort=void 0,this.props.getTaskList(s),this.setState({params:s})}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Nt,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,dataSourceType:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(Nt,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,dataSourceId:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Nt,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,configureId:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__onExecuteTimeChange__REACT_HOT_LOADER__",value:function(e,t){var a=j()({},this.state.params,{currentPage:1,executeStartTime:e&&e[0]?e[0].valueOf():null,executeEndTime:e&&e[1]?e[1].valueOf():null});this.props.getTaskList(a),this.setState({params:a})}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,subscribe:!!e.target.checked||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"__onTableSearch__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,fuzzyName:e||void 0});this.props.getTaskList(t),this.setState({params:t})}},{key:"showDetailLogInfo",value:function(e,t,a){this.tooltipChange(e,!1),rt.a.error({width:"70%",title:"表: "+t,content:o.a.createElement("pre",{style:{wordBreak:"break-word",whiteSpace:"pre-wrap"}},a)})}},{key:"tooltipChange",value:function(e,t){var a=this.state.visibleList;t?this.setState({visibleList:a.concat(e)}):this.setState({visibleList:a.filter(function(t){return e!=t})})}},{key:"__openSlidePane__REACT_HOT_LOADER__",value:function(e){this.setState({showSlidePane:!0,currentTask:e})}},{key:"__closeSlidePane__REACT_HOT_LOADER__",value:function(){this.setState({showSlidePane:!1,currentTask:{},tabKey:"1"})}},{key:"__onTabChange__REACT_HOT_LOADER__",value:function(e){this.setState({tabKey:e})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()>Date.now()}},{key:"render",value:function(){var e=this.props,t=e.dataSource,a=e.taskQuery,n=e.common,r=t.sourceType,s=t.sourceList,i=n.userList,l=a.loading,c=a.taskList,u=this.state,_=u.params,d=u.showSlidePane,p=u.tabKey,m=u.currentTask,h=_.executeStartTime,E=_.executeEndTime,T={current:_.currentPage,pageSize:_.pageSize,total:c.totalCount},f=void 0;h&&E&&(f=[re()(parseInt(h)),re()(parseInt(E))]);var y=o.a.createElement("div",{className:"flex font-12"},o.a.createElement(Pt,{placeholder:"输入表名搜索",onSearch:this.onTableSearch,defaultValue:_.fuzzyName,style:{width:200,margin:"10px 0"}}),o.a.createElement("div",{className:"m-l-8"},"类型：",o.a.createElement(dt.a,{allowClear:!0,style:{width:150},value:_.dataSourceType,placeholder:"选择数据源类型",onChange:this.onSourceChange},this.renderSourceType(r))),o.a.createElement("div",{className:"m-l-8"},"数据源：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源",onChange:this.onUserSourceChange},this.renderUserSource(s))),o.a.createElement("div",{className:"m-l-8"},"执行时间：",o.a.createElement(It,{defaultValue:f,format:"YYYY-MM-DD",placeholder:["开始日期","结束日期"],style:{width:200,verticalAlign:"middle",marginTop:"-1px"},disabledDate:this.disabledDate,onChange:this.onExecuteTimeChange})),o.a.createElement("div",{className:"m-8"},"配置人：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},placeholder:"选择配置人",optionFilterProp:"name",onChange:this.onUserChange},this.renderUserList(i))),o.a.createElement("div",{className:"m-l-8"},o.a.createElement(at.a,{onChange:this.onSubscribeChange},"我订阅的表")));return o.a.createElement("div",{className:"task-dashboard",style:{overflowX:"hidden"}},o.a.createElement("h1",{className:"box-title"},"任务查询 ",o.a.createElement("span",{style:{fontSize:"12px",color:"rgb(153, 153, 153)"}},"告警总数: ",c.data&&c.data[0]?c.data[0].allAlarmSum:0)),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(B.a,{title:y,noHovering:!0,bordered:!1},o.a.createElement(K.a,{rowClassName:function(e,t){return m&&m.id==e.id?"row-select":""},rowKey:"id",className:"m-table",columns:this.initColumns(),loading:l,pagination:T,dataSource:c.data,onChange:this.onTableChange}),o.a.createElement(ht.a,{onClose:this.closeSlidePane,visible:d,style:{right:"0",width:"80%",minHeight:"600px",height:"100%"}},o.a.createElement("div",{className:"m-tabs"},o.a.createElement(ut.a,{animated:!1,activeKey:p,onChange:this.onTabChange},o.a.createElement(xt,{tab:"监控报告",key:"1"},o.a.createElement(At,{data:m})),o.a.createElement(xt,{tab:"表级报告",key:"2"},o.a.createElement(Lt,{data:m}))))))))}}]),t}(i.Component))||St,zt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Pt,"Search","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Nt,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(xt,"TabPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(It,"RangePicker","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Ut,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(jt,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js"),__REACT_HOT_LOADER__.register(Mt,"TaskQuery","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/taskQuery/index.js")),a(48),a(18)),Qt=a.n(zt),Ft=(a(34),a(13)),Gt=a.n(Ft),Vt=(a(197),a(97)),qt=a.n(Vt),Kt=(a(96),a(61)),Yt=a.n(Kt),Bt=(a(53),a(17)),Wt=a.n(Bt),Jt=a(70),$t=a.n(Jt),Zt={getMonitorLists:function(e){return Ce.a.post(Ae.a.GET_MONITOR_LIST,e)},getRuleFunction:function(e){return Ce.a.post(Ae.a.GET_RULE_FUNCTION,e)},getTableColumn:function(e){return Ce.a.post(Ae.a.GET_MONITOR_TABLE_COLUMN,e)},getMonitorRule:function(e){return Ce.a.post(Ae.a.GET_MONITOR_RULE,e)},saveMonitorRule:function(e){return Ce.a.post(Ae.a.SAVE_MONITOR_RULE,e)},deleteMonitorRule:function(e){return Ce.a.post(Ae.a.DELETE_MONITOR_RULE,e)},addMonitor:function(e){return Ce.a.post(Ae.a.ADD_MONITOR,e)},updateMonitor:function(e){return Ce.a.post(Ae.a.UPDATE_MONITOR,e)},subscribeTable:function(e){return Ce.a.post(Ae.a.SUBSCRIBE_TABLE,e)},unSubscribeTable:function(e){return Ce.a.post(Ae.a.UNSUBSCRIBE_TABLE,e)},checkSubscribe:function(e){return Ce.a.post(Ae.a.CHECK_SUBSCRIBE,e)},changeMonitorStatus:function(e){return Ce.a.post(Ae.a.CHANGE_MONITOR_STATUS,e)},executeMonitor:function(e){return Ce.a.post(Ae.a.EXECUTE_MONITOR,e)},getMonitorDetail:function(e){return Ce.a.post(Ae.a.GET_MONITOR_DETAIL,e)},getRemoteTrigger:function(e){return Ce.a.post(Ae.a.GET_REMOTE_TRIGGER,e)},addRemoteTrigger:function(e){return Ce.a.post(Ae.a.ADD_REMOTE_TRIGGER,e)},delRemoteTrigger:function(e){return Ce.a.post(Ae.a.DEL_REMOTE_TRIGGER,e)},checkMonitor:function(e){return Ce.a.post(Ae.a.CHECK_MONITOR,e)}},Xt=Zt,ea=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Zt,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/ruleConfig.js"),Wt.a.Item),ta=dt.a.Option,aa={beginDate:re()().format("YYYY-MM-DD"),endDate:re()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},na=function(e){return{common:e.common}},ra=Object(C.b)(na)(bt=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.initState=function(){return a.__initState__REACT_HOT_LOADER__.apply(a,arguments)},a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.renderPeriodType=function(){return a.__renderPeriodType__REACT_HOT_LOADER__.apply(a,arguments)},a.onPeriodTypeChange=function(){return a.__onPeriodTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSendTypeList=function(){return a.__renderSendTypeList__REACT_HOT_LOADER__.apply(a,arguments)},a.onSendTypeChange=function(){return a.__onSendTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onBeginDateChange=function(){return a.__onBeginDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onEndDateChange=function(){return a.__onEndDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.onNotifyUserChange=function(){return a.__onNotifyUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.cancel=function(){return a.__cancel__REACT_HOT_LOADER__.apply(a,arguments)},a.checkTime=function(){return a.__checkTime__REACT_HOT_LOADER__.apply(a,arguments)},a.checkDate=function(){return a.__checkDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={scheduleConfObj:aa,params:{monitorId:void 0,sendTypes:[],notifyUser:[],periodType:void 0,scheduleConf:void 0}},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.initState(this.props.data)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;t.monitorId!=a.monitorId&&this.initState(a)}},{key:"__initState__REACT_HOT_LOADER__",value:function(e){e.scheduleConf&&this.setState({scheduleConfObj:JSON.parse(e.scheduleConf),params:{monitorId:e.monitorId,sendTypes:e.sendTypes,notifyUser:e.notifyUser.map(function(e){return e.id}),periodType:e.periodType,scheduleConf:e.scheduleConf}})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(e){var t=j()({},aa,{periodType:e});this.setState({scheduleConfObj:t,params:j()({},this.state.params,{periodType:e,scheduleConf:$t()(t)})})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(ta,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){this.resetScheduleConf(e)}},{key:"__renderSendTypeList__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return o.a.createElement(at.a,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSendTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("notifyUser");0===e.length&&0===a.length&&t.setFieldsValue({notifyUser:[]}),this.setState({params:j()({},this.state.params,{sendTypes:e})})}},{key:"__onBeginDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("beginDate",t)}},{key:"__onEndDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("endDate",t)}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(ta,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__onNotifyUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("sendTypes");0===e.length&&0===a.length&&t.setFieldsValue({sendTypes:[]}),this.setState({params:j()({},this.state.params,{notifyUser:e})})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t){var a=this.state,n=a.scheduleConfObj,r=a.params,s={};s[e]=t;var i=j()({},n,s);this.setState({scheduleConfObj:i,params:j()({},r,{scheduleConf:$t()(i)})})}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common.allDict,r=a.getFieldDecorator,s=this.state.scheduleConfObj,i=(n.periodType&&n.periodType,function(t){for(var a=[],n=0;n<=23;n++)a.push(o.a.createElement(ta,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(dt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)}),l=function(t){for(var a=[],n=0;n<=59;n++)a.push(o.a.createElement(ta,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(dt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(s.periodType){case"1":return o.a.createElement("div",null,o.a.createElement(ea,j()({},Te,{label:"开始时间"}),r("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.beginHour})(i("beginHour")),o.a.createElement("span",{className:"m-8"},"时"),r("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.beginMin})(l("beginMin")),o.a.createElement("span",{className:"m-8"},"分")),o.a.createElement(ea,j()({},Te,{label:"间隔时间"}),r("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:s.gapHour?s.gapHour:""})(function(){for(var t=[],a=1;a<=23;a++)t.push(o.a.createElement(ta,{key:a,value:""+a},a,"小时"));return o.a.createElement(dt.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),o.a.createElement(ea,j()({},Te,{label:"结束时间"}),r("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.endHour})(i("endHour")),o.a.createElement("span",{className:"m-8"},"时"),r("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.endMin})(l("endMin")),o.a.createElement("span",{className:"m-8"},"分")));case"2":return o.a.createElement(ea,j()({},Te,{label:"起调周期"}),r("hour",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分"));case"3":return o.a.createElement("div",null,o.a.createElement(ea,j()({},Te,{label:"选择时间"}),r("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:s.weekDay?s.weekDay:[]})(o.a.createElement(dt.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},o.a.createElement(ta,{key:1,value:"1"},"星期一"),o.a.createElement(ta,{key:2,value:"2"},"星期二"),o.a.createElement(ta,{key:3,value:"3"},"星期三"),o.a.createElement(ta,{key:4,value:"4"},"星期四"),o.a.createElement(ta,{key:5,value:"5"},"星期五"),o.a.createElement(ta,{key:6,value:"6"},"星期六"),o.a.createElement(ta,{key:7,value:"7"},"星期天")))),o.a.createElement(ea,j()({},Te,{label:"起调周期"}),r("hour1",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min1",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分")));case"4":return o.a.createElement("div",null,o.a.createElement(ea,j()({},Te,{label:"选择时间"}),r("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:s.day?s.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(o.a.createElement(ta,{key:a,value:""+a},"每月"+a+"号"));return o.a.createElement(dt.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),o.a.createElement(ea,j()({},Te,{label:"起调周期"}),r("hour2",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min2",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分")))}}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.data;t.resetFields(),this.initState(a),this.props.closeModal(!1)}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginHour"),s=n.getFieldValue("beginMin"),i=n.getFieldValue("endHour"),o=n.getFieldValue("endMin");60*parseInt(r)+parseInt(s)>=60*parseInt(i)+parseInt(o)?a("开始时间不能晚于结束时间"):n.setFieldsValue({beginHour:r,beginMin:s,endHour:i,endMin:o}),a()}},{key:"__checkDate__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginDate"),s=n.getFieldValue("endDate");r&&s?r.valueOf()>s.valueOf()?a("生效日期的开始时间不能晚于结束时间"):n.setFieldsValue({beginDate:r,endDate:s}):a(),a()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.form,a=this.state.params;t.validateFields(function(t,n){t&&t.endDate&&Gt.a.error(t.endDate.errors[0].message),t||Xt.updateMonitor(a).then(function(t){1===t.code&&(Gt.a.success("更新成功！"),e.props.closeModal(!0))})})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.visible,r=t.getFieldDecorator,s=a.allDict,i=a.userList,l=this.state,c=l.scheduleConfObj,u=l.params,_=u.notifyUser,d=u.sendTypes,p=s.periodType?s.periodType:[],m=s.notifyType?s.notifyType:[];return o.a.createElement(rt.a,{title:"编辑调度属性",wrapClassName:"editExecuteModal",maskClosable:!1,visible:n,width:"50%",okText:"保存",cancelText:"取消",onOk:this.save,onCancel:this.cancel},o.a.createElement(Wt.a,null,o.a.createElement(ea,j()({},Te,{label:"调度周期"}),r("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+c.periodType})(o.a.createElement(dt.a,{onChange:this.onPeriodTypeChange},this.renderPeriodType(p)))),5!=c.periodType&&o.a.createElement(ea,j()({},Te,{label:"生效日期"}),r("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:re()(c.beginDate)})(o.a.createElement(lt.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),o.a.createElement("span",{className:"m-8"},"到"),r("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:re()(c.endDate)})(o.a.createElement(lt.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),o.a.createElement(ea,j()({},Te,{label:"告警方式"}),r("sendTypes",{rules:[{required:_.length,message:"选择告警方式"}],initialValue:d.map(function(e){return e.toString()})})(o.a.createElement(at.a.Group,{onChange:this.onSendTypeChange},this.renderSendTypeList(m)))),o.a.createElement(ea,j()({},Te,{label:"告警接收人"}),r("notifyUser",{rules:[{required:d.length,message:"选择告警接收人"}],initialValue:_.map(function(e){return e.toString()})})(o.a.createElement(dt.a,{allowClear:!0,mode:"multiple",onChange:this.onNotifyUserChange},this.renderUserList(i))))))}}]),t}(i.Component))||bt;ra=Wt.a.create()(ra);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ea,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(ta,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(aa,"initialSchedule","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(na,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"),__REACT_HOT_LOADER__.register(ra,"ExecuteForm","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/executeForm.js"));var sa,ia=a(125),oa={getMonitorLists:function(e){return function(t){return t({type:ia.a.CHANGE_LOADING}),Xt.getMonitorLists(e).then(function(e){if(t({type:ia.a.CHANGE_LOADING}),1===e.code)return t({type:ia.a.GET_MONITOR_LIST,payload:e.data}),e})}},getRuleFunction:function(e){return function(t){Xt.getRuleFunction(e).then(function(e){1===e.code&&t({type:ia.a.GET_RULE_FUNCTION,payload:e.data})})}},getTableColumn:function(e){return function(t){Xt.getTableColumn(e).then(function(e){1===e.code&&t({type:ia.a.GET_MONITOR_TABLE_COLUMN,payload:e.data})})}},addMonitor:function(e){return function(t){Xt.addMonitor(e).then(function(e){1===e.code&&Gt.a.success("添加成功！")})}},updateMonitor:function(e){return function(t){Xt.updateMonitor(e).then(function(e){1===e.code&&Gt.a.success("更新成功！")})}},getMonitorRule:function(e){return function(t){Xt.getMonitorRule(e).then(function(e){1===e.code&&t({type:ia.a.GET_MONITOR_RULE,payload:e.data})})}},changeMonitorStatus:function(e){return function(t){Xt.changeMonitorStatus(e).then(function(e){1===e.code&&Gt.a.success("操作成功！")})}},getMonitorDetail:function(e){return function(t){Xt.getMonitorDetail(e).then(function(e){1===e.code&&t({type:ia.a.GET_MONITOR_DETAIL,payload:e.data})})}},getRemoteTrigger:function(e){return function(t){Xt.getRemoteTrigger(e).then(function(e){1===e.code&&t({type:ia.a.GET_REMOTE_TRIGGER,payload:e.data})})}}},la=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(oa,"ruleConfigActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/ruleConfig/index.js"),Wt.a.Item),ca=dt.a.Option,ua=mt.a.TextArea,_a=function(e){return{ruleConfig:e.ruleConfig,common:e.common}},da=function(e){return{getRuleFunction:function(t){e(oa.getRuleFunction(t))},getTableColumn:function(t){e(oa.getTableColumn(t))},getMonitorDetail:function(t){e(oa.getMonitorDetail(t))},changeMonitorStatus:function(t){e(oa.changeMonitorStatus(t))}}},pa=Object(C.b)(_a,da)(sa=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.initData=function(){return a.__initData__REACT_HOT_LOADER__.apply(a,arguments)},a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.changeRuleParams=function(){return a.__changeRuleParams__REACT_HOT_LOADER__.apply(a,arguments)},a.onColumnNameChange=function(){return a.__onColumnNameChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onFunctionChange=function(){return a.__onFunctionChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onVerifyTypeChange=function(){return a.__onVerifyTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderEditTD=function(){return a.__renderEditTD__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTD=function(){return a.__renderTD__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRule=function(){return a.__addNewRule__REACT_HOT_LOADER__.apply(a,arguments)},a.onMonitorIdChange=function(){return a.__onMonitorIdChange__REACT_HOT_LOADER__.apply(a,arguments)},a.executeMonitor=function(){return a.__executeMonitor__REACT_HOT_LOADER__.apply(a,arguments)},a.changeMonitorStatus=function(){return a.__changeMonitorStatus__REACT_HOT_LOADER__.apply(a,arguments)},a.openExecuteModal=function(){return a.__openExecuteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.closeExecuteModal=function(){return a.__closeExecuteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.state={enumFields:["columnName","functionId","thresholdEnum"],SQLFields:["customizeSql","verifyType","operator","threshold"],columnFields:["columnName","functionId","verifyType","operator","threshold"],rules:[],currentRule:{},functionList:[],monitorId:void 0,havePart:!1,showExecuteModal:!1},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.props.getRuleFunction()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;if(!Object(Et.isEmpty)(a)&&t.tableId!==a.tableId){var n=a.monitorPartVOS[0].monitorId;this.initData(n,a),this.setState({monitorId:n,havePart:!1,currentRule:{},functionList:[]}),7!==a.dataSourceType&&10!==a.dataSourceType||this.setState({havePart:!0})}}},{key:"__initData__REACT_HOT_LOADER__",value:function(e,t){var a=this;this.props.getMonitorDetail({monitorId:e}),Xt.getMonitorRule({monitorId:e}).then(function(e){1===e.code&&a.setState({rules:e.data})}),this.props.getTableColumn({sourceId:t.sourceId,tableName:t.tableName})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(t,a){return e.renderColumns(t,a,"columnName")},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(t,a){return e.renderColumns(t,a,"functionId")},width:"15%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(t,a){return e.renderColumns(t,a,"filter")},width:"25%"},{title:"校验方法",dataIndex:"verifyType",key:"verifyType",render:function(t,a){return e.renderColumns(t,a,"verifyType")},width:"15%"},{title:"阈值配置（不符合阈值条件时触发告警）",dataIndex:"threshold",key:"threshold",render:function(t,a){return e.renderColumns(t,a,"threshold")},width:"20%"},{title:"操作",width:"10%",render:function(t,a){var n=a.editable;return o.a.createElement("div",null,n?o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:function(){return e.save(a.id)}},"保存"),o.a.createElement("a",{onClick:function(){return e.cancel(a.id)}},"取消")):o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:function(){return e.edit(a.id)}},"编辑"),o.a.createElement(Yt.a,{title:"确定要删除吗？",onConfirm:function(){return e.delete(a.id)}},o.a.createElement("a",null,"删除"))))}}]}},{key:"renderColumns",value:function(e,t,a){var n={children:o.a.createElement(Wt.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}};if(t.isCustomizeSql)switch(a){case"columnName":n.props.colSpan=3;break;case"functionId":case"filter":n.props.colSpan=0}return n}},{key:"__changeRuleParams__REACT_HOT_LOADER__",value:function(e,t){var a={};a[e]=t.target?t.target.value:t,this.setState({currentRule:j()({},this.state.currentRule,a)})}},{key:"__onColumnNameChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.ruleConfig,r=n.tableColumn,s=n.monitorFunction,i=this.state.currentRule,o=s[r.filter(function(t){return t.key===e})[0].type],l={};l["functionId@"+i.id]=void 0,a.setFieldsValue(l),this.setState({functionList:o,currentRule:j()({},i,{columnName:e,functionId:void 0})})}},{key:"__onFunctionChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state,n=a.functionList,r=a.currentRule,s=n.filter(function(t){return t.id==e})[0].isPercent,i=n.filter(function(t){return t.id==e})[0].nameZc,o="枚举值"===i,l=j()({},this.state.currentRule,{functionId:e,functionName:i,verifyType:o?"1":void 0,operator:o?"in":void 0,isPercentage:s,percentType:1===s?"limit":"free"}),c={};c["verifyType@"+r.id]=o?"1":void 0,c["operator@"+r.id]=void 0,t.setFieldsValue(c),this.setState({currentRule:l})}},{key:"__onVerifyTypeChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.currentRule,{verifyType:e});"limit"!==t.percentType&&(t.isPercentage=1==e?0:1),this.setState({currentRule:t})}},{key:"__renderEditTD__REACT_HOT_LOADER__",value:function(e,t,a){var n,r=this.props,s=r.form,i=r.common,l=r.ruleConfig,c=s.getFieldDecorator,u=l.tableColumn,_=i.allDict.verifyType,d=this.state,p=d.currentRule,m=d.functionList,h="字符串最大长度"===(n=p.functionName)||"字符串最小长度"===n?me:pe;switch(a){case"columnName":return t.isCustomizeSql?o.a.createElement(la,j()({},ve,{className:"rule-edit-td cell-center"}),c("customizeSql@"+t.id,{rules:[{required:!0,message:"自定义SQL不可为空"}],initialValue:t.customizeSql})(t.isCustomizeSql?o.a.createElement(ua,{style:{resize:"vertical"},autosize:{minRows:3,maxRows:8},placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}):o.a.createElement(mt.a,{placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}))):o.a.createElement(la,j()({},ve,{className:"rule-edit-td cell-center"}),c("columnName@"+t.id,{rules:[{required:!0,message:"字段不可为空"}],initialValue:t.columnName})(o.a.createElement(dt.a,{showSearch:!0,onChange:this.onColumnNameChange,disabled:t.isTable||1==t.level},u.map(function(e){return o.a.createElement(ca,{key:e.key,value:e.key},e.key)}))));case"functionId":return o.a.createElement(la,j()({},ve,{className:"rule-edit-td cell-center"}),c("functionId@"+t.id,{rules:[{required:!0,message:"统计函数不可为空"}],initialValue:"edit"===t.editStatus?t.functionName:t.functionId})(o.a.createElement(dt.a,{onChange:this.onFunctionChange},m.map(function(e){return o.a.createElement(ca,{key:e.id,value:e.id.toString()},e.nameZc)}))));case"filter":return o.a.createElement(la,j()({},ve,{className:"rule-edit-td cell-center"}),c("filter@"+t.id,{rules:[],initialValue:t.filter})(o.a.createElement(mt.a,{placeholder:'"and"开头的条件语句，如and col = "val"',onChange:this.changeRuleParams.bind(this,"filter")})));case"verifyType":return o.a.createElement(la,j()({},ve,{className:"rule-edit-td cell-center"}),c("verifyType@"+t.id,{rules:[{required:!0,message:"校验方法不可为空"}],initialValue:t.verifyType?t.verifyType.toString():void 0})(o.a.createElement(dt.a,{onChange:this.onVerifyTypeChange},_.map(function(e){return o.a.createElement(ca,{key:e.value,value:e.value.toString()},e.name)}))));case"threshold":return"in"===p.operator?o.a.createElement(la,j()({},ve,{className:"rule-edit-td"}),c("thresholdEnum@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.threshold})(o.a.createElement(mt.a,{placeholder:"枚举格式为(value1,value2,.....)",onChange:this.changeRuleParams.bind(this,"threshold")}))):o.a.createElement("div",{className:"cell-center-box"},o.a.createElement(la,{className:"cell-multiple-center"},c("operator@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.operator})(o.a.createElement(dt.a,{style:{width:65},onChange:this.changeRuleParams.bind(this,"operator")},h.map(function(e){return o.a.createElement(ca,{key:e.value,value:e.value},e.text)})))),o.a.createElement(la,{className:"cell-multiple-center"},c("threshold@"+t.id,{rules:[{required:!0,message:"不可为空"}],initialValue:t.threshold})(o.a.createElement(qt.a,{style:{width:65},onChange:this.changeRuleParams.bind(this,"threshold")}))),1===p.isPercentage&&o.a.createElement("span",{style:{height:32,lineHeight:"32px"}},"%"))}}},{key:"__renderTD__REACT_HOT_LOADER__",value:function(e,t,a){switch(a){case"columnName":return t.isCustomizeSql?t.customizeSql:e;case"functionId":return t.functionName;case"verifyType":return t.verifyTypeValue;case"threshold":var n=t.operator+"  "+e;return t.isPercentage?n+" %":n;default:return e}}},{key:"edit",value:function(e){var t=this.state,a=t.currentRule,n=t.rules,r=this.props.ruleConfig,s=r.monitorFunction,i=r.tableColumn,o=[],l=[].concat(Dt()(n)),c=l.filter(function(t){return e===t.id})[0];if(Object(Et.isEmpty)(a)||("edit"===a.editStatus?(delete a.editable,delete a.editStatus):l.shift()),c){if(c.editable=!0,c.editStatus="edit",!c.isCustomizeSql)if(c.isTable||1==c.level)o=s.all.filter(function(e){return 1===e.level});else o=s[i.filter(function(e){return e.key===c.columnName})[0].type];this.setState({currentRule:c,rules:l,functionList:o})}}},{key:"cancel",value:function(e){var t=[].concat(Dt()(this.state.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);"edit"===a.editStatus?(delete a.editable,delete a.editStatus):t.splice(n,1),this.setState({currentRule:{},rules:t})}},{key:"delete",value:function(e){var t=this,a=this.state.monitorId;[].concat(Dt()(this.state.rules)).filter(function(t){return e===t.id})[0]&&Xt.deleteMonitorRule({ruleIds:[e],monitorId:a}).then(function(e){1===e.code&&(Gt.a.success("删除成功"),Xt.getMonitorRule({monitorId:a}).then(function(e){1===e.code&&(t.setState({rules:e.data}),Object(Et.isNull)(e.data)&&t.props.refresh())}))})}},{key:"save",value:function(e){var t=this,a=this.state,n=a.currentRule,r=a.enumFields,s=a.SQLFields,i=a.columnFields,o=a.monitorId,l=n.isCustomizeSql?s:i;"in"===n.operator&&(l=r),this.props.form.validateFields(l,{force:!0},function(e,a){e||("new"===n.editStatus&&(n.monitorId=o,delete n.id),delete n.isTable,delete n.editable,delete n.editStatus,delete n.percentType,Xt.saveMonitorRule(j()({},n)).then(function(e){1===e.code&&(Gt.a.success("保存成功"),Xt.getMonitorRule({monitorId:o}).then(function(e){1===e.code&&t.setState({rules:e.data,currentRule:{}})}))}))})}},{key:"__addNewRule__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.data,r=t.ruleConfig,s=this.state,i=s.currentRule,o=s.rules,l=o?[].concat(Dt()(o)):[];Object(Et.isEmpty)(i)||("edit"===i.editStatus?(delete i.editable,delete i.editStatus):(l.shift(),a.resetFields(),this.setState({currentRule:{},functionList:[]})));var c={id:0,editStatus:"new",editable:!0,filter:"",verifyType:void 0,operator:void 0,threshold:void 0};switch(e){case"column":c.isCustomizeSql=!1,c.columnName=void 0,c.functionId=void 0;break;case"SQL":c.isCustomizeSql=!0,c.customizeSql=void 0;break;case"table":c.isTable=!0,c.isCustomizeSql=!1,c.columnName=n.tableName,c.functionId=void 0,this.setState({functionList:r.monitorFunction.all.filter(function(e){return 1===e.level})})}l.unshift(c),this.setState({currentRule:c,rules:l})}},{key:"__onMonitorIdChange__REACT_HOT_LOADER__",value:function(e){var t=this,a=e;this.props.getMonitorDetail({monitorId:a}),Xt.getMonitorRule({monitorId:a}).then(function(e){1===e.code&&t.setState({rules:e.data})}),this.setState({monitorId:a,currentRule:{}})}},{key:"__executeMonitor__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.data;Xt.executeMonitor({monitorId:e}).then(function(e){1===e.code?(Gt.a.success("操作成功，稍后可在任务查询中查看详情"),t.props.closeSlidePane()):Gt.a.error("执行失败")})}},{key:"__changeMonitorStatus__REACT_HOT_LOADER__",value:function(e){var t=this;Xt.changeMonitorStatus({monitorId:e}).then(function(a){1===a.code&&(Gt.a.success("操作成功"),t.props.getMonitorDetail({monitorId:e}))})}},{key:"__openExecuteModal__REACT_HOT_LOADER__",value:function(){this.setState({showExecuteModal:!0})}},{key:"__closeExecuteModal__REACT_HOT_LOADER__",value:function(e){var t=this.state.monitorId;e&&this.props.getMonitorDetail({monitorId:t}),this.setState({showExecuteModal:!1})}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.ruleConfig,n=e.form,r=e.common,s=(n.getFieldDecorator,a.monitorDetail),i=r.allDict,l=(i.periodType,i.notifyType,this.state),c=l.rules,u=l.monitorId,_=l.havePart,d=l.showExecuteModal,p=c?c.filter(function(e){return 0==e.isSnapshot||"new"==e.editStatus}):[],m=t.monitorPartVOS?t.monitorPartVOS:[];return o.a.createElement("div",{className:"rule-manage"},o.a.createElement(J.a,null,o.a.createElement(Z.a,{span:12,className:"txt-left"},_&&o.a.createElement("div",null,"分区：",o.a.createElement(dt.a,{style:{width:150},value:u?u.toString():void 0,onChange:this.onMonitorIdChange},m.map(function(e){return o.a.createElement(ca,{key:e.monitorId,value:e.monitorId.toString()},e.partValue?e.partValue:"全表")})))),o.a.createElement(Z.a,{span:12,className:"txt-right"},o.a.createElement(Qt.a,{type:"primary",onClick:this.executeMonitor.bind(this,u)},"立即执行"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.openExecuteModal},"编辑调度属性"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.changeMonitorStatus.bind(this,u)},s.isClosed?"开启检测":"关闭检测"))),o.a.createElement("div",{className:"monitor-info-table"},o.a.createElement("table",{width:"100%",cellPadding:"0",cellSpacing:"0"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null,"执行周期"),o.a.createElement("td",{className:"width-3"},s.periodTypeName),o.a.createElement("th",null,"告警方式"),o.a.createElement("td",{className:"width-3"},s.sendTypeNames)),o.a.createElement("tr",null,o.a.createElement("th",null,"执行时间"),o.a.createElement("td",{className:"width-3"},s.executeTime),o.a.createElement("th",null,"接收人"),o.a.createElement("td",{className:"width-3"},s.notifyUser?s.notifyUser.map(function(e){return e.name}).join("，"):""))))),o.a.createElement("div",{className:"txt-right"},o.a.createElement(Qt.a,{type:"primary",onClick:this.addNewRule.bind(this,"table")},"添加表级规则"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.addNewRule.bind(this,"column")},"添加字段级规则"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.addNewRule.bind(this,"SQL")},"添加自定义SQL")),o.a.createElement(K.a,{rowKey:"id",className:"m-table rule-edit-table",style:{padding:"20px 0"},pagination:!1,dataSource:p,columns:this.initColumns(),scroll:{y:361}}),o.a.createElement(ra,{data:s,visible:d,closeModal:this.closeExecuteModal}))}}]),t}(i.Component))||sa;pa=Wt.a.create()(pa);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(la,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(ca,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(ua,"TextArea","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(_a,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(da,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"),__REACT_HOT_LOADER__.register(pa,"RuleEditPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/ruleEditPane.js"));var ma,ha=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={},n.copy=function(){var e;return(e=n).__copy__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentWillUnmount",value:function(){this.removeFake()}},{key:"__copy__REACT_HOT_LOADER__",value:function(e){var t=this;this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style.left="-9999px";var a=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=a+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=e,document.body.appendChild(this.fakeElem),this.fakeElem.select(),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand("copy")}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){e?Gt.a.success("复制成功"):Gt.a.error("不支持")}},{key:"render",value:function(){var e=this.props.value;return o.a.createElement(it.a,{placement:"right",overlayClassName:"copy-area",overlayStyle:{cursor:"pointer"},title:o.a.createElement("span",{onClick:this.copy.bind(this,e)},"复制")},e)}}]),t}(i.Component),Ea=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(ha,"ToolTipCopy","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/tooltipCopy/index.js"),dt.a.Option),Ta=mt.a.TextArea,fa=Wt.a.Item,ya=APP_CONF&&APP_CONF.API_SERVER?APP_CONF.API_SERVER:"",va=function(e){return{ruleConfig:e.ruleConfig}},ga=function(e){return{getRemoteTrigger:function(t){e(oa.getRemoteTrigger(t))},getMonitorRule:function(t){e(oa.getMonitorRule(t))}}},Ra=Object(C.b)(va,ga)(ma=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.initTriggerColumns=function(){return a.__initTriggerColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.editTrigger=function(){return a.__editTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.deleteTrigger=function(){return a.__deleteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.initRulesColumns=function(){return a.__initRulesColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onMonitorIdChange=function(){return a.__onMonitorIdChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onRemarkChange=function(){return a.__onRemarkChange__REACT_HOT_LOADER__.apply(a,arguments)},a.newRemoteTrigger=function(){return a.__newRemoteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.showRemoteModal=function(){return a.__showRemoteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.closeRemoteModal=function(){return a.__closeRemoteModal__REACT_HOT_LOADER__.apply(a,arguments)},a.saveRemoteTrigger=function(){return a.__saveRemoteTrigger__REACT_HOT_LOADER__.apply(a,arguments)},a.state={visible:!1,havePart:!1,selectedIds:[],remark:void 0,monitorId:void 0},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this.props.data,t=e.monitorPartVOS[0].monitorId;this.props.getRemoteTrigger({tableId:e.tableId}),this.setState({monitorId:t})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.data,a=e.data;if(!Object(Et.isEmpty)(a)&&t.tableId!==a.tableId){var n=a.monitorPartVOS[0].monitorId;this.props.getRemoteTrigger({tableId:a.tableId}),this.setState({monitorId:n,havePart:!1,remark:void 0,selectedIds:[]}),7!==a.dataSourceType&&10!==a.dataSourceType||this.setState({havePart:!0})}}},{key:"__initTriggerColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"分区",dataIndex:"partitionValue",key:"partitionValue",width:"12%"},{title:"触发规则数",dataIndex:"ruleNumber",key:"ruleNumber",width:"8%"},{title:"访问接口",dataIndex:"url",key:"url",width:"23%",render:function(e){return o.a.createElement(ha,{value:""+ya+e})}},{title:"请求方式",dataIndex:"method",key:"method",width:"8%",render:function(e){return"POST"}},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"12%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"12%",render:function(e){return re()(e).format("YYYY-MM-DD HH:mm")}},{title:"备注",dataIndex:"remark",key:"remark",width:"15%"},{title:"操作",width:"10%",render:function(t,a){return o.a.createElement("div",null,o.a.createElement("a",{className:"m-r-8",onClick:function(){return e.editTrigger(a)}},"编辑"),o.a.createElement(Yt.a,{title:"确定要删除吗？",onConfirm:function(){return e.deleteTrigger(a.id)}},o.a.createElement("a",null,"删除")))}}]}},{key:"__editTrigger__REACT_HOT_LOADER__",value:function(e){this.props.data;this.showRemoteModal(),this.props.getMonitorRule({monitorId:e.id}),this.setState({monitorId:e.id,selectedIds:e.ruleIds,remark:e.remark})}},{key:"__deleteTrigger__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.props.data;Xt.delRemoteTrigger({monitorId:e}).then(function(e){1===e.code&&(Gt.a.success("删除成功！"),t.props.getRemoteTrigger({tableId:a.tableId}))})}},{key:"__initRulesColumns__REACT_HOT_LOADER__",value:function(){return[{title:"字段",dataIndex:"columnName",key:"columnName",render:function(e,t){return{children:t.isCustomizeSql?t.customizeSql:e,props:{colSpan:t.isCustomizeSql?3:1}}},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(e,t){return{children:t.functionName,props:{colSpan:t.isCustomizeSql?0:1}}},width:"13%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(e,t){return{children:e,props:{colSpan:t.isCustomizeSql?0:1}}},width:"20%"},{title:"校验方法",dataIndex:"verifyTypeValue",key:"verifyTypeValue",width:"12%"},{title:"阈值配置",dataIndex:"threshold",key:"threshold",render:function(e,t){var a=t.operator+"  "+e;return t.isPercentage?a+" %":a},width:"12%"},{title:"最近修改人",key:"modifyUser",dataIndex:"modifyUser",width:"14%"},{title:"最近修改时间",key:"gmtModified",dataIndex:"gmtModified",width:"14%",render:function(e){return re()(e).format("YYYY-MM-DD HH:mm")}}]}},{key:"__onMonitorIdChange__REACT_HOT_LOADER__",value:function(e){var t=e;this.props.getMonitorRule({monitorId:t}),this.setState({monitorId:t,selectedIds:[],remark:void 0})}},{key:"__onRemarkChange__REACT_HOT_LOADER__",value:function(e){this.setState({remark:e.target.value})}},{key:"__newRemoteTrigger__REACT_HOT_LOADER__",value:function(){var e=this.state.monitorId;this.props.getMonitorRule({monitorId:e}),this.showRemoteModal()}},{key:"__showRemoteModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!0})}},{key:"__closeRemoteModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!1,selectedIds:[]}),this.props.form.resetFields()}},{key:"__saveRemoteTrigger__REACT_HOT_LOADER__",value:function(){var e=this,t=this.state,a=t.selectedIds,n=t.monitorId,r=t.remark,s=this.props,i=s.data,o=s.form,l=s.getRemoteTrigger;a.length?o.validateFields(function(t,s){t||Xt.addRemoteTrigger({monitorId:n,ruleIds:a,remark:r}).then(function(t){1===t.code&&(Gt.a.success("操作成功！"),e.closeRemoteModal(),l({tableId:i.tableId}))})}):Gt.a.error("请选择一个监控规则！")}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.ruleConfig,r=t.form.getFieldDecorator,s=n.triggerList,i=n.monitorRules,l=this.state,c=l.monitorId,u=l.havePart,_=l.visible,d=l.selectedIds,p=l.remark,m=a.monitorPartVOS?a.monitorPartVOS:[],h={selectedRowKeys:d,onChange:function(t){e.setState({selectedIds:t})}};return o.a.createElement("div",{className:"trigger-box"},s.length>0&&o.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:this.initTriggerColumns(),pagination:!1,dataSource:s}),o.a.createElement("h2",null,"什么是远程触发？"),o.a.createElement("p",null,"您可以在自建的大数据平台或公有云平台上通过接口调用的形式,触发本系统中的数据质量校验任务执行。"),o.a.createElement("p",null,"典型的场景：您自建的大数据平台上对某张表进行ETL任务处理，需要在ETL任务处理前， 对此表的数据质量进行校验，校验通过后再启动后续的计算任务 （防止错误数据流入下一个计算环节，同时可以节约计算资源）。"),o.a.createElement("p",{style:{marginTop:10}},"配置的流程如下："),o.a.createElement("p",null,"1、在本平台配置表的数据质量检测任务，并在本页面开启远程触发"),o.a.createElement("p",null,"2、在您自建的大数据平台上，新建一个脚本任务，并编写调用的代码，详细的使用教程请参考",o.a.createElement("a",null,"《帮助文档》"),"；"),o.a.createElement("p",null,"3、在您自建的大数据平台上，将数据处理任务作为脚本任务的下游任务；"),s.length<1&&o.a.createElement(Qt.a,{style:{marginTop:10},type:"primary",onClick:this.newRemoteTrigger},"配置远程触发"),o.a.createElement(rt.a,{title:"配置远程调用",wrapClassName:"remoteTriggerModal",width:"85%",visible:_,maskClosable:!1,okText:"生成远程调用API",cancelText:"取消",onOk:this.saveRemoteTrigger,onCancel:this.closeRemoteModal},u&&o.a.createElement("div",null,"分区：",o.a.createElement(dt.a,{style:{width:150},value:c?c.toString():void 0,onChange:this.onMonitorIdChange},m.map(function(e){return o.a.createElement(Ea,{key:e.monitorId,value:e.monitorId.toString()},e.partValue?e.partValue:"全表")}))),o.a.createElement(K.a,{rowKey:"id",className:"m-table select-all-table",style:{padding:"16px 0"},pagination:!1,rowSelection:h,dataSource:i,columns:this.initRulesColumns()}),o.a.createElement(Wt.a,null,o.a.createElement(fa,j()({},ve,{style:{marginBottom:0}}),r("remark",{rules:[{max:100,message:"备注不能超过100个字符"}],initialValue:p})(o.a.createElement(Ta,{placeholder:"备注信息",className:"trigger-remarks",autosize:{minRows:3,maxRows:6},onChange:this.onRemarkChange}))))))}}]),t}(i.Component))||ma;Ra=Wt.a.create()(Ra);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ea,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(Ta,"TextArea","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(fa,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(ya,"API_SERVER","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(va,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(ga,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"),__REACT_HOT_LOADER__.register(Ra,"RemoteTriggerPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/remoteTriggerPane.js"));var Ca,Aa,Oa=a(90),Da=a.n(Oa),ka=dt.a.Option,Sa=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={searchValue:""},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"wrapOption",value:function(){var e=this.state.searchValue,t=this.props.children;if(t&&t.length>0)for(var a in t)if(t[a].props.title==e)return null;return e?o.a.createElement(ka,{key:e,value:e,title:e},e):null}},{key:"onSearch",value:function(e){this.setState({searchValue:e})}},{key:"render",value:function(){var e=this.props,t=e.children,a=Da()(e,["children"]),n=this.wrapOption();return o.a.createElement(dt.a,j()({allowClear:!0,showSearch:!0,onSearch:this.onSearch.bind(this)},a),n,t)}}]),t}(i.Component),ba=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ka,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/selectSearch/index.js"),__REACT_HOT_LOADER__.register(Sa,"SelectSearch","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/components/selectSearch/index.js")),a(866),mt.a.Search),La=dt.a.Option,wa=ut.a.TabPane,Ha=function(e){return{ruleConfig:e.ruleConfig,dataSource:e.dataSource,common:e.common}},Pa=function(e){return{getMonitorLists:function(t){return e(oa.getMonitorLists(t))},getDataSourcesList:function(t){e(Ve.getDataSourcesList(t))}}},Na=Object(C.b)(Ha,Pa)(Ca=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={params:{pageIndex:1,pageSize:20,tableName:x.a.getParameterByName("tableName")||void 0,modifyUserId:void 0,sourceType:void 0,dataSourceId:void 0,isSubscribe:void 0,periodType:void 0},tabKey:"1",showSlidePane:!1,currentMonitor:{}},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribe=function(){var e;return(e=n).__onSubscribe__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderPeriodType=function(){var e;return(e=n).__renderPeriodType__REACT_HOT_LOADER__.apply(e,arguments)},n.onPeriodTypeChange=function(){var e;return(e=n).__onPeriodTypeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onDateChange=function(){var e;return(e=n).__onDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSubscribeChange=function(){var e;return(e=n).__onSubscribeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.handleSearch=function(){var e;return(e=n).__handleSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.openSlidePane=function(){var e;return(e=n).__openSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.closeSlidePane=function(){var e;return(e=n).__closeSlidePane__REACT_HOT_LOADER__.apply(e,arguments)},n.refresh=function(){var e;return(e=n).__refresh__REACT_HOT_LOADER__.apply(e,arguments)},n.onTabChange=function(){var e;return(e=n).__onTabChange__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getDataSourcesList(),this.props.getMonitorLists(this.state.params).then(function(t){if(t&&t.data&&t.data.data){var a=t.data.data.filter(function(e){return e.tableId==x.a.getParameterByName("tableId")});a&&a.length>0&&e.openSlidePane(a[0])}e.props.router.replace("/dq/rule")})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"表",dataIndex:"tableName",key:"tableName",render:function(t,a){return o.a.createElement("a",{onClick:e.openSlidePane.bind(e,a)},t)}},{title:"类型",dataIndex:"sourceTypeName",key:"sourceTypeName",render:function(e,t){return e?e+" / "+t.dataName:"--"}},{title:"执行周期",dataIndex:"periodTypeName",key:"periodTypeName"},{title:"最近30天告警数",dataIndex:"recentNotifyNum",key:"recentNotifyNum",sorter:!0},{title:"远程触发",dataIndex:"isRemoteTrigger",key:"isRemoteTrigger",render:function(e){return e?"已开启":""}},{title:"最近修改人",dataIndex:"modifyUser",key:"modifyUser"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return e?re()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}},{title:"操作",render:function(t,a){return o.a.createElement("a",{onClick:e.onSubscribe.bind(e,a)},a.isSubscribe?"取消订阅":"订阅")}}]}},{key:"__onSubscribe__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.params;e.isSubscribe?Xt.unSubscribeTable({tableId:e.tableId}).then(function(e){1===e.code&&(Gt.a.success("取消订阅成功"),t.props.getMonitorLists(a))}):Xt.subscribeTable({tableId:e.tableId}).then(function(e){1===e.code&&(Gt.a.success("订阅成功"),t.props.getMonitorLists(a))})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=j()({},this.state.params,{pageIndex:e.current,sort:a.columnKey?"descend"===a.order?"desc":"asc":void 0});this.setState({params:n}),this.props.getMonitorLists(n)}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(La,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,sourceType:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(La,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,dataSourceId:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(La,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,periodType:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(La,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,lastModifyUserId:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__onDateChange__REACT_HOT_LOADER__",value:function(e,t){var a=j()({},this.state.params,{pageIndex:1,executeTime:e?e.valueOf():void 0});this.props.getMonitorLists(a),this.setState({params:a})}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,isSubscribe:e.target.checked?1:void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__handleSearch__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{pageIndex:1,tableName:e||void 0});this.props.getMonitorLists(t),this.setState({params:t})}},{key:"__openSlidePane__REACT_HOT_LOADER__",value:function(e){this.setState({showSlidePane:!0,currentMonitor:e})}},{key:"__closeSlidePane__REACT_HOT_LOADER__",value:function(){this.setState({showSlidePane:!1,currentMonitor:{},tabKey:"1"})}},{key:"__refresh__REACT_HOT_LOADER__",value:function(){this.closeSlidePane(),this.props.getMonitorLists(this.state.params)}},{key:"__onTabChange__REACT_HOT_LOADER__",value:function(e){this.setState({tabKey:e})}},{key:"render",value:function(){var e=this.props.ruleConfig,t=e.monitorList,a=e.loading,n=this.props.dataSource,r=n.sourceType,s=n.sourceList,i=this.props.common,l=i.userList,c=i.allDict,u=this.state,_=u.params,d=u.showSlidePane,p=u.currentMonitor,m=u.tabKey,h={current:_.pageIndex,pageSize:_.pageSize,total:t?t.totalCount:0},E=c.periodType?c.periodType:[],T=o.a.createElement("div",{className:"flex font-12"},o.a.createElement(ba,{placeholder:"输入表名搜索",onSearch:this.handleSearch,defaultValue:_.tableName,style:{width:200,margin:"10px 0"}}),o.a.createElement("div",{className:"m-l-8"},"类型：",o.a.createElement(dt.a,{allowClear:!0,style:{width:150},placeholder:"选择数据源类型",onChange:this.onSourceChange},this.renderSourceType(r))),o.a.createElement("div",{className:"m-l-8"},"数据源：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源",onChange:this.onUserSourceChange},this.renderUserSource(s))),o.a.createElement("div",{className:"m-l-8"},"执行周期：",o.a.createElement(dt.a,{allowClear:!0,style:{width:150},placeholder:"选择执行周期",onChange:this.onPeriodTypeChange},this.renderPeriodType(E))),o.a.createElement("div",{className:"m-8"},"最近修改人：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"name",placeholder:"选择最近修改人",onChange:this.onUserChange},this.renderUserList(l))),o.a.createElement("div",{className:"m-l-8"},o.a.createElement(at.a,{onChange:this.onSubscribeChange},"我订阅的表"))),f=o.a.createElement(Qt.a,{type:"primary",style:{margin:"10px 0"}},o.a.createElement(R.c,{to:"/dq/rule/add"},"新建监控规则"));return o.a.createElement("div",{className:"rule-dashboard"},o.a.createElement("h1",{className:"box-title"},"监控规则"),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(B.a,{title:T,extra:f,noHovering:!0,bordered:!1},o.a.createElement(K.a,{rowClassName:function(e,t){return p&&p.tableId==e.tableId?"row-select":""},rowKey:"tableId",className:"m-table",columns:this.initColumns(),loading:a,pagination:h,dataSource:t.data,onChange:this.onTableChange}),o.a.createElement(ht.a,{onClose:this.closeSlidePane,visible:d,className:"slide-pane-box",style:{right:"0px",width:"80%",height:"100%",minHeight:"650px"}},o.a.createElement("div",{className:"m-tabs"},o.a.createElement(ut.a,{animated:!1,activeKey:m,onChange:this.onTabChange},o.a.createElement(wa,{tab:"规则管理",key:"1"},o.a.createElement(pa,{data:p,closeSlidePane:this.closeSlidePane,refresh:this.refresh})),o.a.createElement(wa,{tab:"远程触发",key:"2"},o.a.createElement(Ra,{data:p,closeSlidePane:this.closeSlidePane}))))))))}}]),t}(i.Component))||Ca,xa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ba,"Search","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(La,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(wa,"TabPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Ha,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Pa,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(Na,"RuleConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/dashboard/index.js")),a(224),a(108)),Ia=a.n(xa),Ua=(a(225),a(123)),ja=a.n(Ua),Ma=a(142),za=Wt.a.Item,Qa=dt.a.Option,Fa=ja.a.TreeNode,Ga=function(e){return{dataSource:e.dataSource}},Va=function(e){return{getDataSourcesList:function(t){e(Ve.getDataSourcesList(t))},getDataSourcesTable:function(t){e(Ve.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(Ve.resetDataSourcesTable())},getDataSourcesPart:function(t){e(Ve.getDataSourcesPart(t))},resetDataSourcesPart:function(){e(Ve.resetDataSourcesPart())}}},qa=Object(C.b)(Ga,Va)(Aa=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.renderSourceType=function(){return a.__renderSourceType__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSourceTable=function(){return a.__renderSourceTable__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.havePartition=function(){return a.__havePartition__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourceTypeChange=function(){return a.__onSourceTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onTableChange=function(){return a.__onTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.handleInputPartChange=function(){return a.__handleInputPartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.partHintText=function(){return a.__partHintText__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onSubscribeChange=function(){return a.__onSubscribeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderColumnPart=function(){return a.__renderColumnPart__REACT_HOT_LOADER__.apply(a,arguments)},a.onPartitionTypeChange=function(){return a.__onPartitionTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{},loading:!1},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.props.getDataSourcesList()}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(Qa,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__renderSourceTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Qa,{key:e,value:e},e)})}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(Et.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?o.a.createElement(Fa,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e)):o.a.createElement(Fa,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__havePartition__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.dataSource.sourceList.forEach(function(a){a.id==e&&t.props.changeHavePart(7===a.type||10===a.type)})}},{key:"checkMonitor",value:function(){var e=this,t=this.props,a=t.editParams,n=t.havePart,r={tableName:a.tableName,dataSourceId:a.dataSourceId,partition:n?a.partition:void 0};return this.setState({loading:!0}),Xt.checkMonitor(r).then(function(t){if(e.setState({loading:!1}),t&&t.data)return t.data;if(1!=t.code)throw new Error(t.message);return null})}},{key:"__onSourceTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=(t.editParams,{dataSourceId:e,rules:[],partition:void 0});this.havePartition(e),this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:e}),a.setFieldsValue({sourceTable:void 0}),n&&(this.props.resetDataSourcesPart(),a.setFieldsValue({partition:void 0,partitionInput:"column=${sys.recentPart}"})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams(r)}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams,s={tableName:e,rules:[],partition:"column=${sys.recentPart}"};n&&(this.props.resetDataSourcesPart(),a.setFieldsValue({partition:void 0,partitionInput:"column=${sys.recentPart}"}),this.props.getDataSourcesPart({sourceId:r.dataSourceId,table:e})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams(s)}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams,a=t.dataSourceId,n=t.tableName,r=t.partition,s=this.state.showPreview;a&&n?(s||Ge.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!s})):Gt.a.error("未选择数据源或表")}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({partition:n})}},{key:"__handleInputPartChange__REACT_HOT_LOADER__",value:function(e){var t=e.target.value?e.target.value:void 0;this.props.changeParams({partition:t})}},{key:"__partHintText__REACT_HOT_LOADER__",value:function(){return o.a.createElement("p",{className:"font-14"},"支持填写系统参数，格式为：column=${sys.recentPart}，column为分区字段名，需要您根据情况修改，${sys.recentPart}为系统参数，系统每次执行时会对最新的1个分区的数据做校验")}},{key:"jumpToEditRule",value:function(e,t){this.modal&&this.modal.destroy(),R.g.push({pathname:"/dq/rule",query:{tableName:e.tableName,tableId:e.tableId}})}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.currentStep,n=t.navToStep;t.form.validateFields({force:!0},function(t,r){t||e.checkMonitor().then(function(t){if(t){var r=rt.a.warning({title:"该规则配置已存在",content:o.a.createElement("span",null,"该规则配置已存在，您可以直接前往",o.a.createElement("a",{onClick:e.jumpToEditRule.bind(e,t)}," 编辑"))});e.modal=r}else n(a+1)})})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){if(e)return e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return o.a.createElement(Ma.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.sourcePreview&&this.state.sourcePreview.columnList;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"__onSubscribeChange__REACT_HOT_LOADER__",value:function(e){var t=e.target.checked?1:0;this.props.changeParams({isSubscribe:t})}},{key:"__renderColumnPart__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.editParams,a=e.form,n=e.dataSource,r=e.useInput,s=t.partition,i=n.sourcePart,l=a.getFieldDecorator;return r?o.a.createElement(za,j()({},Te,{label:"输入分区",extra:this.partHintText()}),l("partitionInput",{rules:[],initialValue:s||"column=${sys.recentPart}"})(o.a.createElement(mt.a,{style:{width:"85%",marginRight:15},placeholder:"手动输入分区的格式为：分区字段=分区值，如column=${sys.recentPart}",onChange:this.handleInputPartChange})),o.a.createElement("a",{onClick:this.onPartitionTypeChange},"选择已有分区")):o.a.createElement(za,j()({},Te,{label:"选择分区"}),l("partition",{rules:[],initialValue:s})(o.a.createElement(ja.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",style:{width:"85%",marginRight:15},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(i))),o.a.createElement("a",{onClick:this.onPartitionTypeChange},"手动输入"))}},{key:"__onPartitionTypeChange__REACT_HOT_LOADER__",value:function(){var e=this.props.useInput;this.props.changeParams({partition:void 0}),this.props.changeUseInput(!e)}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.editParams,n=e.dataSource,r=e.havePart,s=t.getFieldDecorator,i=a.dataSourceId,l=a.tableName,c=n.sourceList,u=n.sourceTable,_=n.tableLoading,d=this.state,p=d.showPreview,m=d.sourcePreview,h=d.loading;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(Wt.a,null,o.a.createElement(za,j()({},Te,{label:"选择数据源"}),s("sourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:i?i.toString():i})(o.a.createElement(dt.a,{showSearch:!0,optionFilterProp:"title",style:{width:"85%",marginRight:15},onChange:this.onSourceTypeChange,disabled:_},this.renderSourceType(c)))),o.a.createElement(za,j()({},Te,{label:"选择数据表"}),s("sourceTable",{rules:[{required:!0,message:"请选择数据表"}],initialValue:l})(o.a.createElement(dt.a,{mode:"combobox",showSearch:!0,style:{width:"85%",marginRight:15},onChange:this.onTableChange},this.renderSourceTable(u))),l&&o.a.createElement(at.a,{checked:!0,onChange:this.onSubscribeChange},"订阅")),r&&this.renderColumnPart(),o.a.createElement("div",{className:"txt-center font-14"},o.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",o.a.createElement(z.a,{type:"down",style:{marginLeft:5}}))),p&&o.a.createElement(K.a,{rowKey:"key",className:"m-table m-cells preview-table",columns:this.previewTableColumns(m.columnList),dataSource:m.dataList,pagination:!1,scroll:{x:this.getScroll()}}))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,null,o.a.createElement(R.c,{to:"/dq/rule"},"取消")),o.a.createElement(Qt.a,{loading:h,className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(i.Component))||Aa;qa=Wt.a.create()(qa);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(za,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Qa,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Fa,"TreeNode","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Ga,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Va,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"),__REACT_HOT_LOADER__.register(qa,"StepOne","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepOne.js"));var Ka,Ya=Wt.a.Item,Ba=dt.a.Option,Wa=mt.a.TextArea,Ja=function(e){return{ruleConfig:e.ruleConfig,common:e.common}},$a=function(e){return{getRuleFunction:function(t){e(oa.getRuleFunction(t))},getTableColumn:function(t){e(oa.getTableColumn(t))}}},Za=Object(C.b)(Ja,$a)(Ka=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.changeRuleParams=function(){return a.__changeRuleParams__REACT_HOT_LOADER__.apply(a,arguments)},a.onColumnNameChange=function(){return a.__onColumnNameChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onFunctionChange=function(){return a.__onFunctionChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onVerifyTypeChange=function(){return a.__onVerifyTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderEditTD=function(){return a.__renderEditTD__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTD=function(){return a.__renderTD__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRuleWrap=function(){return a.__addNewRuleWrap__REACT_HOT_LOADER__.apply(a,arguments)},a.addNewRule=function(){return a.__addNewRule__REACT_HOT_LOADER__.apply(a,arguments)},a.state={currentRule:{},functionList:[],enumFields:["columnName","functionId","thresholdEnum"],SQLFields:["customizeSql","verifyType","operator","threshold"],columnFields:["columnName","functionId","verifyType","operator","threshold"]},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this.props.editParams;this.props.getRuleFunction(),this.props.getTableColumn({sourceId:e.dataSourceId,tableName:e.tableName})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep,n=this.state.currentRule;Object(Et.isEmpty)(n)?a(t-1):(this.cancel(n.id),a(t-1))}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep,n=e.editParams,r=this.state.currentRule;n.rules.length?Object(Et.isEmpty)(r)?a(t+1):this.save(r.id,function(){a(t+1)}):Gt.a.error("请添加监控规则")}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"字段/数据表",dataIndex:"columnName",key:"columnName",render:function(t,a){return e.renderColumns(t,a,"columnName")},width:"15%"},{title:"统计函数",dataIndex:"functionId",key:"functionId",render:function(t,a){return e.renderColumns(t,a,"functionId")},width:"15%"},{title:"过滤条件",dataIndex:"filter",key:"filter",render:function(t,a){return e.renderColumns(t,a,"filter")},width:"25%"},{title:"校验方法",dataIndex:"verifyType",key:"verifyType",render:function(t,a){return e.renderColumns(t,a,"verifyType")},width:"15%"},{title:"阈值配置（不符合阈值条件时触发告警）",dataIndex:"threshold",key:"threshold",render:function(t,a){return e.renderColumns(t,a,"threshold")},width:"20%"},{title:"操作",width:"10%",render:function(t,a){var n=a.editable;return o.a.createElement("div",null,n?o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:function(){return e.save(a.id)}},"保存"),o.a.createElement("a",{onClick:function(){return e.cancel(a.id)}},"取消")):o.a.createElement("span",null,o.a.createElement("a",{className:"m-r-8",onClick:function(){return e.edit(a.id)}},"编辑"),o.a.createElement(Yt.a,{title:"确定要删除吗？",onConfirm:function(){return e.delete(a.id)}},o.a.createElement("a",null,"删除"))))}}]}},{key:"renderColumns",value:function(e,t,a){var n={children:o.a.createElement(Wt.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}};if(t.isCustomizeSql)switch(a){case"columnName":n.props.colSpan=3;break;case"functionId":case"filter":n.props.colSpan=0}return n}},{key:"__changeRuleParams__REACT_HOT_LOADER__",value:function(e,t){var a={};a[e]=t.target?t.target.value:t,this.setState({currentRule:j()({},this.state.currentRule,a)})}},{key:"__onColumnNameChange__REACT_HOT_LOADER__",value:function(e){var t=this.state.currentRule,a=this.props,n=a.form,r=a.ruleConfig,s=r.tableColumn,i=r.monitorFunction[s.filter(function(t){return t.key===e})[0].type],o={};o["functionId@"+t.id]=void 0,n.setFieldsValue(o),this.setState({functionList:i,currentRule:j()({},t,{columnName:e,functionId:void 0})})}},{key:"__onFunctionChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state,n=a.functionList,r=a.currentRule,s=n.filter(function(t){return t.id==e})[0].isPercent,i=n.filter(function(t){return t.id==e})[0].nameZc,o="枚举值"===i,l=j()({},this.state.currentRule,{functionId:e,functionName:i,verifyType:o?"1":void 0,operator:o?"in":void 0,isPercentage:s,percentType:1===s?"limit":"free"}),c={};c["verifyType@"+r.id]=o?"1":void 0,c["operator@"+r.id]=void 0,t.setFieldsValue(c),this.setState({currentRule:l})}},{key:"__onVerifyTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.common.allDict.verifyType,a=j()({},this.state.currentRule,{verifyType:e,verifyTypeValue:t.filter(function(t){return t.value==e})[0].name});"limit"!==a.percentType&&(a.isPercentage=1==e?0:1),this.setState({currentRule:a})}},{key:"__renderEditTD__REACT_HOT_LOADER__",value:function(e,t,a){var n,r=this.props,s=r.form,i=r.common,l=r.ruleConfig,c=s.getFieldDecorator,u=l.tableColumn,_=i.allDict.verifyType,d=this.state,p=d.currentRule,m=d.functionList,h="字符串最大长度"===(n=p.functionName)||"字符串最小长度"===n?me:pe;switch(a){case"columnName":return t.isCustomizeSql?o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("customizeSql@"+t.id,{rules:[{required:!0,message:"自定义SQL不可为空"}],initialValue:t.customizeSql})(t.isCustomizeSql?o.a.createElement(Wa,{style:{resize:"vertical"},autosize:{minRows:3,maxRows:8},placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql")}):o.a.createElement(mt.a,{placeholder:"查询结果为一个数值类型",onChange:this.changeRuleParams.bind(this,"customizeSql"),disabled:"edit"===t.editStatus}))):o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("columnName@"+t.id,{rules:[{required:!0,message:"字段不可为空"}],initialValue:t.columnName})(o.a.createElement(dt.a,{showSearch:!0,onChange:this.onColumnNameChange,disabled:t.isTable},u.map(function(e){return o.a.createElement(Ba,{key:e.key,value:e.key},e.key)}))));case"functionId":return o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("functionId@"+t.id,{rules:[{required:!0,message:"统计函数不可为空"}],initialValue:t.functionId})(o.a.createElement(dt.a,{onChange:this.onFunctionChange},m.map(function(e){return o.a.createElement(Ba,{key:e.id,value:e.id.toString()},e.nameZc)}))));case"filter":return o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("filter@"+t.id,{rules:[],initialValue:t.filter})(o.a.createElement(mt.a,{placeholder:'以"and"开头的条件语句，例：and colA = "value"',onChange:this.changeRuleParams.bind(this,"filter")})));case"verifyType":return o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("verifyType@"+t.id,{rules:[{required:!0,message:"校验方法不可为空"}],initialValue:t.verifyType})(o.a.createElement(dt.a,{onChange:this.onVerifyTypeChange,disabled:"in"===p.operator},_.map(function(e){return o.a.createElement(Ba,{key:e.value,value:e.value.toString()},e.name)}))));case"threshold":return"in"===p.operator?o.a.createElement(Ya,j()({},ve,{className:"rule-edit-td cell-center"}),c("thresholdEnum@"+t.id,{rules:[{required:!0,message:"范围不可为空"}],initialValue:t.threshold})(o.a.createElement(mt.a,{placeholder:"枚举格式为(value1,value2,.....)",onChange:this.changeRuleParams.bind(this,"threshold")}))):o.a.createElement("div",{className:"cell-center-box"},o.a.createElement(Ya,{className:"cell-multiple-center"},c("operator@"+t.id,{rules:[{required:!0,message:"设置不可为空"}],initialValue:t.operator})(o.a.createElement(dt.a,{style:{width:80},onChange:this.changeRuleParams.bind(this,"operator")},h.map(function(e){return o.a.createElement(Ba,{key:e.value,value:e.value},e.text)})))),o.a.createElement(Ya,{className:"cell-multiple-center"},c("threshold@"+t.id,{rules:[{required:!0,message:"阈值不可为空"}],initialValue:t.threshold})(o.a.createElement(qt.a,{style:{width:80,marginRight:10},onChange:this.changeRuleParams.bind(this,"threshold")}))),1===p.isPercentage&&o.a.createElement("span",{style:{height:32,lineHeight:"32px"}},"%"))}}},{key:"__renderTD__REACT_HOT_LOADER__",value:function(e,t,a){switch(a){case"columnName":return t.isCustomizeSql?t.customizeSql:e;case"functionId":return t.functionName;case"verifyType":return t.verifyTypeValue;case"threshold":var n=(t.operator?t.operator:"")+"  "+e;return t.isPercentage?n+" %":n;default:return e}}},{key:"edit",value:function(e){var t=this.state.currentRule,a=this.props.ruleConfig,n=a.monitorFunction,r=a.tableColumn,s=[],i=[].concat(Dt()(this.props.editParams.rules)),o=i.filter(function(t){return e===t.id})[0];if(!Object(Et.isEmpty)(t)){var l=i.filter(function(e){return t.id===e.id})[0];"edit"===l.editStatus?(delete l.editable,delete l.editStatus):i.shift()}if(o){if(o.editable=!0,o.editStatus="edit",!o.isCustomizeSql)if(o.isTable)s=n.all.filter(function(e){return 1===e.level});else s=n[r.filter(function(e){return e.key===o.columnName})[0].type];this.setState({currentRule:o,functionList:s}),this.props.changeParams({rules:i})}}},{key:"cancel",value:function(e){var t=[].concat(Dt()(this.props.editParams.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);"edit"===a.editStatus?(delete a.editable,delete a.editStatus):t.splice(n,1),this.setState({currentRule:{}}),this.props.changeParams({rules:t})}},{key:"delete",value:function(e){var t=[].concat(Dt()(this.props.editParams.rules)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);a&&(t.splice(n,1),this.props.changeParams({rules:t}))}},{key:"checkRepeat",value:function(){for(var e=this.state.currentRule,t=[].concat(Dt()(this.props.editParams.rules)),a=["columnName","filter","functionId","verifyType","customizeSql","operator"],n=!0,r=0;r<t.length;r++){var s=t[r],i=!1;if(s.id!=e.id){for(var o=0;o<a.length;o++){var l=a[o];if(e[l]!=s[l]){i=!0;break}}if(!i){n=!1;break}}}return n}},{key:"save",value:function(e,t){var a=this,n=this.state,r=n.currentRule,s=n.enumFields,i=n.SQLFields,o=n.columnFields,l=[].concat(Dt()(this.props.editParams.rules)),c=l.filter(function(t){return e===t.id})[0],u=l.indexOf(c);r.isCustomizeSql;r.operator,this.checkRepeat()?this.props.form.validateFields(null,{force:!0},function(e,n){e||(delete r.editStatus,delete r.editable,l[u]=r,a.setState({currentRule:{}},function(){t&&t()}),a.props.changeParams({rules:l}))}):Gt.a.error("规则不能重复！")}},{key:"__addNewRuleWrap__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.currentRule;Object(Et.isEmpty)(a)?this.addNewRule(e):this.save(a.id,function(){t.addNewRule(e)})}},{key:"__addNewRule__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.editParams,r=t.ruleConfig.monitorFunction,s=this.state.currentRule,i=[].concat(Dt()(n.rules));Object(Et.isEmpty)(s)||("edit"===s.editStatus?(delete s.editable,delete s.editStatus):(i.shift(),a.resetFields(),this.setState({currentRule:{},functionList:[]})));var o={id:i[0]?i[0].id+1:1,editStatus:"new",editable:!0,filter:"",verifyType:void 0,operator:void 0,threshold:void 0};switch(e){case"column":o.isCustomizeSql=!1,o.columnName=void 0,o.functionId=void 0;break;case"SQL":o.isCustomizeSql=!0,o.customizeSql=void 0;break;case"table":o.isTable=!0,o.isCustomizeSql=!1,o.columnName=n.tableName,o.functionId=void 0,this.setState({functionList:r.all.filter(function(e){return 1===e.level})})}i.unshift(o),this.setState({currentRule:o}),this.props.changeParams({rules:i})}},{key:"render",value:function(){var e=this.props.editParams.rules;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement("div",{className:"rule-action"},o.a.createElement(Qt.a,{type:"primary",onClick:this.addNewRuleWrap.bind(this,"table")},"添加表级规则"),o.a.createElement(Qt.a,{type:"primary",className:"m-l-8",onClick:this.addNewRuleWrap.bind(this,"column")},"添加字段级规则"),o.a.createElement(Qt.a,{type:"primary",className:"m-l-8",onClick:this.addNewRuleWrap.bind(this,"SQL")},"添加自定义SQL")),o.a.createElement(K.a,{rowKey:"id",className:"m-table rule-edit-table",style:{margin:"0 20px"},columns:this.initColumns(),pagination:!1,dataSource:e,onChange:this.onTableChange})),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,{onClick:this.prev},"上一步"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(i.Component))||Ka;Za=Wt.a.create()(Za);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ya,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Ba,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Wa,"TextArea","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Ja,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register($a,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Za,"StepTwo","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepTwo.js"));var Xa,en=Wt.a.Item,tn=dt.a.Option,an={beginDate:re()().format("YYYY-MM-DD"),endDate:re()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},nn=function(e){return{common:e.common}},rn=function(e){return{addMonitor:function(t){e(oa.addMonitor(t))}}},sn=Object(C.b)(nn,rn)(Xa=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.initState=function(){return a.__initState__REACT_HOT_LOADER__.apply(a,arguments)},a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.renderPeriodType=function(){return a.__renderPeriodType__REACT_HOT_LOADER__.apply(a,arguments)},a.onPeriodTypeChange=function(){return a.__onPeriodTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSendTypeList=function(){return a.__renderSendTypeList__REACT_HOT_LOADER__.apply(a,arguments)},a.onSendTypeChange=function(){return a.__onSendTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.onNotifyUserChange=function(){return a.__onNotifyUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.onBeginDateChange=function(){return a.__onBeginDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onEndDateChange=function(){return a.__onEndDateChange__REACT_HOT_LOADER__.apply(a,arguments)},a.checkTime=function(){return a.__checkTime__REACT_HOT_LOADER__.apply(a,arguments)},a.checkDate=function(){return a.__checkDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={scheduleConfObj:an},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.initState()}},{key:"__initState__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.scheduleConf;e&&this.setState({scheduleConfObj:JSON.parse(e)})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(e){var t=j()({},an,{periodType:e});this.setState({scheduleConfObj:t}),this.props.changeParams({scheduleConf:$t()(t)})}},{key:"__renderPeriodType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(tn,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){this.resetScheduleConf(e)}},{key:"__renderSendTypeList__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return o.a.createElement(at.a,{key:e.value,value:e.value.toString()},e.name)})}},{key:"__onSendTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("notifyUser");0===e.length&&0===a.length&&t.setFieldsValue({notifyUser:[]}),this.props.changeParams({sendTypes:e})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(tn,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__onNotifyUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=t.getFieldValue("sendTypes");0===e.length&&0===a.length&&t.setFieldsValue({sendTypes:[]}),this.props.changeParams({notifyUser:e})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t){var a=this.state.scheduleConfObj,n={};n[e]=t;var r=j()({},a,n);this.setState({scheduleConfObj:r}),this.props.changeParams({scheduleConf:$t()(r)})}},{key:"__onBeginDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("beginDate",t)}},{key:"__onEndDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("endDate",t)}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common.allDict,r=a.getFieldDecorator,s=this.state.scheduleConfObj,i=(n.periodType&&n.periodType,function(t){for(var a=[],n=0;n<=23;n++)a.push(o.a.createElement(tn,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(dt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,t)},a)}),l=function(t){for(var a=[],n=0;n<=59;n++)a.push(o.a.createElement(tn,{key:n,value:""+n},n<10?"0"+n:n));return o.a.createElement(dt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(s.periodType){case"1":return o.a.createElement("div",null,o.a.createElement(en,j()({},fe,{label:"开始时间"}),r("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.beginHour})(i("beginHour")),o.a.createElement("span",{className:"m-8"},"时"),r("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.beginMin})(l("beginMin")),o.a.createElement("span",{className:"m-8"},"分")),o.a.createElement(en,j()({},fe,{label:"间隔时间"}),r("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:s.gapHour?s.gapHour:""})(function(){for(var t=[],a=1;a<=23;a++)t.push(o.a.createElement(tn,{key:a,value:""+a},a,"小时"));return o.a.createElement(dt.a,{style:{width:200},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),o.a.createElement(en,j()({},fe,{label:"结束时间"}),r("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.endHour})(i("endHour")),o.a.createElement("span",{className:"m-8"},"时"),r("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+s.endMin})(l("endMin")),o.a.createElement("span",{className:"m-8"},"分")));case"2":return o.a.createElement(en,j()({},fe,{label:"起调时间"}),r("hour",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分"));case"3":return o.a.createElement("div",null,o.a.createElement(en,j()({},fe,{label:"选择时间"}),r("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:s.weekDay?s.weekDay:[]})(o.a.createElement(dt.a,{mode:"multiple",style:{width:428},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},o.a.createElement(tn,{key:1,value:"1"},"星期一"),o.a.createElement(tn,{key:2,value:"2"},"星期二"),o.a.createElement(tn,{key:3,value:"3"},"星期三"),o.a.createElement(tn,{key:4,value:"4"},"星期四"),o.a.createElement(tn,{key:5,value:"5"},"星期五"),o.a.createElement(tn,{key:6,value:"6"},"星期六"),o.a.createElement(tn,{key:7,value:"7"},"星期天")))),o.a.createElement(en,j()({},fe,{label:"起调时间"}),r("hour1",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min1",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分")));case"4":return o.a.createElement("div",null,o.a.createElement(en,j()({},fe,{label:"选择时间"}),r("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:s.day?s.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(o.a.createElement(tn,{key:a,value:""+a},"每月"+a+"号"));return o.a.createElement(dt.a,{mode:"multiple",style:{width:428},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),o.a.createElement(en,j()({},fe,{label:"起调时间"}),r("hour2",{rules:[{required:!0}],initialValue:""+s.hour})(i("hour")),o.a.createElement("span",{className:"m-8"},"时"),r("min2",{rules:[{required:!0}],initialValue:""+s.min})(l("min")),o.a.createElement("span",{className:"m-8"},"分")))}}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginHour"),s=n.getFieldValue("beginMin"),i=n.getFieldValue("endHour"),o=n.getFieldValue("endMin");60*parseInt(r)+parseInt(s)>=60*parseInt(i)+parseInt(o)?a("开始时间不能晚于结束时间"):n.setFieldsValue({beginHour:r,beginMin:s,endHour:i,endMin:o}),a()}},{key:"__checkDate__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,r=n.getFieldValue("beginDate"),s=n.getFieldValue("endDate");r&&s?r.valueOf()>s.valueOf()?a("生效日期的开始时间不能晚于结束时间"):n.setFieldsValue({beginDate:r,endDate:s}):a(),a()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.form,n=t.editParams,r=t.havePart;a.validateFields(function(t,a){t&&t.endDate&&Gt.a.error(t.endDate.errors[0].message),t||(n.rules.forEach(function(e){delete e.id,delete e.isTable,delete e.percentType,delete e.functionName,delete e.verifyTypeValue}),r||(n.partition=void 0),e.props.addMonitor(j()({},n)),setTimeout(function(){R.g.push("/dq/rule")},1e3))})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.editParams,r=t.getFieldDecorator,s=a.allDict,i=a.userList,l=n.notifyUser,c=n.sendTypes,u=this.state.scheduleConfObj,_=s.periodType?s.periodType:[],d=s.notifyType?s.notifyType:[];return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(Wt.a,null,o.a.createElement(en,j()({},fe,{label:"调度周期"}),r("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+u.periodType})(o.a.createElement(dt.a,{onChange:this.onPeriodTypeChange},this.renderPeriodType(_)))),5!=u.periodType&&o.a.createElement(en,j()({},fe,{label:"生效日期"}),r("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:re()(u.beginDate)})(o.a.createElement(lt.a,{style:{width:200},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),o.a.createElement("span",{className:"m-8"},"到"),r("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:re()(u.endDate)})(o.a.createElement(lt.a,{style:{width:200},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),o.a.createElement(en,j()({},fe,{label:"告警方式"}),r("sendTypes",{rules:[{required:l.length,message:"选择告警方式"}],initialValue:c.map(function(e){return e.toString()})})(o.a.createElement(at.a.Group,{onChange:this.onSendTypeChange},this.renderSendTypeList(d)))),o.a.createElement(en,j()({},fe,{label:"告警接收人"}),r("notifyUser",{rules:[{required:c.length,message:"选择告警接收人"}],initialValue:l.map(function(e){return e.toString()})})(o.a.createElement(dt.a,{allowClear:!0,mode:"multiple",onChange:this.onNotifyUserChange},this.renderUserList(i)))))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,{onClick:this.prev},"上一步"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.save},"新建")))}}]),t}(i.Component))||Xa;sn=Wt.a.create()(sn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(en,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(tn,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(an,"initialSchedule","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(nn,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(rn,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"),__REACT_HOT_LOADER__.register(sn,"StepThree","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/stepThree.js"));var on,ln,cn=a(67),un=Ia.a.Step,_n=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={current:0,editParams:{dataSourceId:void 0,tableName:void 0,partition:"column=${sys.recentPart}",isSubscribe:1,scheduleConf:"",sendTypes:[],notifyUser:[],rules:[]},havePart:!1,useInput:!0},n.changeParams=function(){var e;return(e=n).__changeParams__REACT_HOT_LOADER__.apply(e,arguments)},n.changeHavePart=function(){var e;return(e=n).__changeHavePart__REACT_HOT_LOADER__.apply(e,arguments)},n.changeUseInput=function(){var e;return(e=n).__changeUseInput__REACT_HOT_LOADER__.apply(e,arguments)},n.navToStep=function(){var e;return(e=n).__navToStep__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"__changeParams__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.editParams,e);this.setState({editParams:t})}},{key:"__changeHavePart__REACT_HOT_LOADER__",value:function(e){this.setState({havePart:e})}},{key:"__changeUseInput__REACT_HOT_LOADER__",value:function(e){this.setState({useInput:e})}},{key:"__navToStep__REACT_HOT_LOADER__",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.editParams,n=e.havePart,r=e.useInput,s=[{title:"监控对象",content:o.a.createElement(qa,{currentStep:t,navToStep:this.navToStep,havePart:n,useInput:r,editParams:a,changeParams:this.changeParams,changeHavePart:this.changeHavePart,changeUseInput:this.changeUseInput})},{title:"监控规则",content:o.a.createElement(Za,{currentStep:t,navToStep:this.navToStep,editParams:a,changeParams:this.changeParams})},{title:"调度属性",content:o.a.createElement(sn,{currentStep:t,havePart:n,navToStep:this.navToStep,editParams:a,changeParams:this.changeParams})}];return o.a.createElement("div",{className:"box-1 rule-edit"},o.a.createElement("h1",{className:"box-title"},o.a.createElement(cn.a,null),o.a.createElement("span",{className:"m-l-8"},"新建质量监控")),o.a.createElement("div",{className:"steps-container"},o.a.createElement(Ia.a,{current:t},s.map(function(e){return o.a.createElement(un,{key:e.title,title:e.title})})),s[t].content))}}]),t}(i.Component),dn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(un,"Step","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/index.js"),__REACT_HOT_LOADER__.register(_n,"RuleConfigEdit","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/ruleConfig/edit/index.js")),a(223),a(101)),pn=a.n(dn),mn=(a(188),a(52)),hn=a.n(mn),En=a(152),Tn={getLists:function(e){return Ce.a.post(Ae.a.GET_CHECK_LIST,e)},getCheckDetail:function(e){return Ce.a.post(Ae.a.GET_CHECK_DETAIL,e)},addCheck:function(e){return Ce.a.post(Ae.a.ADD_CHECK,e)},updateCheck:function(e){return Ce.a.post(Ae.a.UPDATE_CHECK,e)},deleteCheck:function(e){return Ce.a.post(Ae.a.DELETE_CHECK,e)},getCheckReport:function(e){return Ce.a.post(Ae.a.GET_CHECK_REPORT,e)},getCheckReportTable:function(e){return Ce.a.post(Ae.a.GET_CHECK_REPORT_TABLE,e)}},fn=Tn,yn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Tn,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/api/dataCheck.js"),{getLists:function(e){return function(t){t({type:En.a.CHANGE_LOADING}),fn.getLists(e).then(function(e){1===e.code&&t({type:En.a.GET_LIST,payload:e.data}),t({type:En.a.CHANGE_LOADING})})}},getCheckDetail:function(e){return function(t){fn.getCheckDetail(e).then(function(e){1===e.code&&t({type:En.a.GET_CHECK_DETAIL,payload:e.data})})}},getSourcePart:function(e,t){return function(a){Ge.getDataSourcesPart(e).then(function(e){1===e.code&&a({type:En.a.GET_SOURCE_PART,payload:{data:e.data?e.data:[],type:t}})})}},resetSourcePart:function(e){return function(t){t({type:En.a.RESET_SOURCE_PART,payload:e})}},changeParams:function(e){return function(t){t({type:En.a.CHANGE_PARAMS,payload:e})}},addCheck:function(e){return function(t){fn.addCheck(e).then(function(e){1===e.code&&Gt.a.success("操作成功",2)})}},updateCheck:function(e){return function(t){fn.updateCheck(e).then(function(e){1===e.code&&Gt.a.success("操作成功",2)})}},deleteCheck:function(e){return function(t){fn.deleteCheck(e).then(function(e){1===e.code&&Gt.a.success("删除成功",2)})}}}),vn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(yn,"dataCheckActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/dataCheck/index.js"),a(864),mt.a.Search),gn=mt.a.Group,Rn=dt.a.Option,Cn=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource,common:e.common}},An=function(e){return{getLists:function(t){e(yn.getLists(t))},getDataSourcesList:function(t){e(Ve.getDataSourcesList(t))}}},On=Object(C.b)(Cn,An)(on=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={params:{currentPage:1,pageSize:20,tableName:void 0,lastModifyUserId:void 0,executeTime:void 0}},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.enableCheckReport=function(){var e;return(e=n).__enableCheckReport__REACT_HOT_LOADER__.apply(e,arguments)},n.deleteDataCheck=function(){var e;return(e=n).__deleteDataCheck__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserSource=function(){var e;return(e=n).__renderUserSource__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserSourceChange=function(){var e;return(e=n).__onUserSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderCheckStatus=function(){var e;return(e=n).__renderCheckStatus__REACT_HOT_LOADER__.apply(e,arguments)},n.onCheckStatusChange=function(){var e;return(e=n).__onCheckStatusChange__REACT_HOT_LOADER__.apply(e,arguments)},n.renderUserList=function(){var e;return(e=n).__renderUserList__REACT_HOT_LOADER__.apply(e,arguments)},n.onUserChange=function(){var e;return(e=n).__onUserChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onDateChange=function(){var e;return(e=n).__onDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableSearch=function(){var e;return(e=n).__onTableSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.disabledDate=function(){var e;return(e=n).__disabledDate__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.props.getDataSourcesList(),this.props.getLists(this.state.params)}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"左侧表",dataIndex:"originTableName",key:"originTableName",width:"11%"},{title:"分区",dataIndex:"originPartition",key:"originPartition",width:"11%",render:function(e,t){return e||"--"}},{title:"右侧表",dataIndex:"targetTableName",key:"targetTableName",width:"11%"},{title:"分区",dataIndex:"targetPartition",key:"targetPartition",width:"11%",render:function(e,t){return e||"--"}},{title:o.a.createElement("div",null,"校验结果",o.a.createElement(it.a,{placement:"bottom",overlayClassName:"m-tooltip",title:o.a.createElement("div",null,o.a.createElement("p",null,"以下条件同时满足计为校验通过："),o.a.createElement("p",null,"1、逻辑主键匹配，但数据不匹配=0"),o.a.createElement("p",null,"2、max（左表数据在右表未找到，右表数据在左表未找到）<（右表记录数*记录数差异比例配置）"))},o.a.createElement(z.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"status",key:"status",width:"10%",render:function(e,t){return 3==e?o.a.createElement("div",{className:"flex"},o.a.createElement(vt,{style:{flexBasis:"60%"},value:e}),o.a.createElement(it.a,{placement:"right",title:t.report,overlayClassName:"m-tooltip"},o.a.createElement(z.a,{className:"font-14",type:"info-circle-o"}))):o.a.createElement(vt,{value:e})}},{title:o.a.createElement("div",null,"差异总数",o.a.createElement(it.a,{placement:"bottom",overlayClassName:"m-tooltip",title:"差异总数 = 逻辑主键匹配但数据不匹配 + 左表数据在右表未找到 + 右表数据在左表未找到"},o.a.createElement(z.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"diverseNum",key:"diverseNum",width:"8%"},{title:o.a.createElement("div",null,"差异比例",o.a.createElement(it.a,{placement:"bottom",overlayClassName:"m-tooltip",title:"统计左右2表的记录数最大值，统计整体匹配条数，整体匹配条数/记录数最大值为匹配率，差异比例=1-匹配率"},o.a.createElement(z.a,{className:"font-12 m-l-8",type:"question-circle-o"}))),dataIndex:"diverseRatio",key:"diverseRatio",width:"8%",render:function(e){return e?e+" %":e}},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"11%"},{title:"执行时间",dataIndex:"executeTimeFormat",key:"executeTimeFormat",render:function(e,t){return e||"--"},width:"11%"},{title:"操作",width:"8%",render:function(t,a){var n=o.a.createElement(hn.a,null,e.enableCheckReport(a.status)&&o.a.createElement(hn.a.Item,null,o.a.createElement(R.c,{to:"dq/dataCheck/report/"+a.id},"查看报告")),o.a.createElement(hn.a.Item,null,o.a.createElement(R.c,{to:"dq/dataCheck/edit/"+a.verifyId},"再次运行")));return o.a.createElement(pn.a,{overlay:n,trigger:["click"]},o.a.createElement(Qt.a,null,"操作",o.a.createElement(z.a,{type:"down"})))}}]}},{key:"__enableCheckReport__REACT_HOT_LOADER__",value:function(e){return e===le.SUCCESS||e===le.PASS||e===le.UNPASS||e===le.EXPIRED}},{key:"__deleteDataCheck__REACT_HOT_LOADER__",value:function(e){var t=this;fn.deleteCheck({verifyRecordId:e}).then(function(e){1===e.code&&(Gt.a.success("删除成功！"),t.props.getLists(t.state.params))})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=j()({},this.state.params,{currentPage:e.current});this.props.getLists(n),this.setState({params:n})}},{key:"__renderUserSource__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(Rn,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__onUserSourceChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,dataSourceId:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__renderCheckStatus__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Rn,{key:e.value,value:e.value,title:e.text},e.text)})}},{key:"__onCheckStatusChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,status:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Rn,{key:e.id,value:e.id.toString(),name:e.userName},e.userName)})}},{key:"__onUserChange__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,lastModifyUserId:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__onDateChange__REACT_HOT_LOADER__",value:function(e,t){var a=j()({},this.state.params,{currentPage:1,executeTime:e?e.valueOf():void 0});this.props.getLists(a),this.setState({params:a})}},{key:"__onTableSearch__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{currentPage:1,tableName:e||void 0});this.props.getLists(t),this.setState({params:t})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()>Date.now()}},{key:"render",value:function(){var e=this.props,t=e.dataCheck,a=e.dataSource,n=e.common.userList,r=a.sourceList,s=t.lists,i=t.loading,l=this.state.params,c={current:l.currentPage,pageSize:l.pageSize,total:s.totalCount},u=o.a.createElement("div",{className:"flex font-12"},o.a.createElement(vn,{placeholder:"输入表名搜索",onSearch:this.onTableSearch,style:{width:200,margin:"10px 0"}}),o.a.createElement("div",{className:"m-l-8"},"数据源：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择数据源类型",onChange:this.onUserSourceChange},this.renderUserSource(r))),o.a.createElement("div",{className:"m-l-8"},"校验结果：",o.a.createElement(dt.a,{allowClear:!0,style:{width:150},placeholder:"选择校验结果",onChange:this.onCheckStatusChange},this.renderCheckStatus(ce))),o.a.createElement("div",{className:"m-l-8"},"最近修改人：",o.a.createElement(dt.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"name",placeholder:"选择最近修改人",onChange:this.onUserChange},this.renderUserList(n))),o.a.createElement("div",{className:"m-l-8"},"执行时间：",o.a.createElement(lt.a,{format:"YYYY-MM-DD",style:{width:150},placeholder:"选择日期",onChange:this.onDateChange,disabledDate:this.disabledDate}))),_=o.a.createElement(Qt.a,{type:"primary",style:{margin:"10px 0"}},o.a.createElement(R.c,{to:"/dq/dataCheck/add"},"新建逐行校验"));return o.a.createElement("div",{className:"check-dashboard"},o.a.createElement("h1",{className:"box-title"},"逐行校验"),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(B.a,{title:u,extra:_,noHovering:!0,bordered:!1},o.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),loading:i,pagination:c,dataSource:s.data,onChange:this.onTableChange}))))}}]),t}(i.Component))||on,Dn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(vn,"Search","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(gn,"InputGroup","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(Rn,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(Cn,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(An,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js"),__REACT_HOT_LOADER__.register(On,"DataCheck","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/dashboard/index.js")),Wt.a.Item),kn=dt.a.Option,Sn=ja.a.TreeNode,bn=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource}},Ln=function(e){return{getDataSourcesList:function(t){e(Ve.getDataSourcesList(t))},getDataSourcesTable:function(t){e(Ve.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(Ve.resetDataSourcesTable())},getSourcePart:function(t,a){e(yn.getSourcePart(t,a))},resetSourcePart:function(t){e(yn.resetSourcePart(t))}}},wn=Object(C.b)(bn,Ln)(ln=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.renderSourceType=function(){return a.__renderSourceType__REACT_HOT_LOADER__.apply(a,arguments)},a.renderSourceTable=function(){return a.__renderSourceTable__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.havePartition=function(){return a.__havePartition__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourceTypeChange=function(){return a.__onSourceTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onOriginTableChange=function(){return a.__onOriginTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{}},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){"new"===this.props.editStatus&&this.props.getDataSourcesList()}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return o.a.createElement(kn,{key:e.id,value:e.id.toString(),title:t},t)})}},{key:"__renderSourceTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(kn,{key:e,value:e},e)})}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(Et.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?o.a.createElement(Sn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e)):o.a.createElement(Sn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__havePartition__REACT_HOT_LOADER__",value:function(e){var t=this;this.props.dataSource.sourceList.forEach(function(a){a.id==e&&t.props.changeHavePart(7===a.type||10===a.type)})}},{key:"__onSourceTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=(t.editParams,{dataSourceId:e});this.havePartition(e),this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:e}),a.setFieldsValue({originTable:void 0}),n&&(this.props.resetSourcePart("origin"),a.setFieldsValue({originPartition:void 0})),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({origin:r,target:r,mappedPK:{}})}},{key:"__onOriginTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams.origin.dataSourceId,s={dataSourceId:r,table:e};n&&(this.props.resetSourcePart("origin"),a.setFieldsValue({originPartition:void 0}),this.props.getSourcePart({sourceId:r,table:e},"origin")),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({origin:s,mappedPK:{}})}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams.origin,a=t.dataSourceId,n=t.table,r=t.partition,s=this.state.showPreview;a&&n?(s||Ge.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!s})):Gt.a.error("未选择数据源或数据表")}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.editParams.origin,r=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({origin:j()({},n,{partition:r})})}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep;e.form.validateFields({force:!0},function(e,n){e||a(t+1)})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return o.a.createElement(Ma.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.sourcePreview&&this.state.sourcePreview.columnList;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"render",value:function(){var e=this.props,t=e.editStatus,a=e.editParams,n=e.form,r=e.dataSource,s=e.dataCheck,i=e.havePart,l=s.originPart,c=n.getFieldDecorator,u=r.sourceList,_=r.sourceTable,d=r.tableLoading,p=a.origin,m=p.dataSourceId,h=p.table,E=p.partition,T=this.state,f=T.sourcePreview,y=T.showPreview;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(Wt.a,null,o.a.createElement(Dn,j()({},Te,{label:"选择数据源"}),c("sourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:m?m.toString():void 0})(o.a.createElement(dt.a,{showSearch:!0,optionFilterProp:"title",style:{width:"85%",marginRight:15},onChange:this.onSourceTypeChange,disabled:"edit"===t||d},this.renderSourceType(u))),o.a.createElement(R.c,{to:"/dq/dataSource"},"添加数据源")),o.a.createElement(Dn,j()({},Te,{label:"选择左侧表"}),c("originTable",{rules:[{required:!0,message:"请选择左侧表"}],initialValue:h})(o.a.createElement(dt.a,{showSearch:!0,style:{width:"85%"},onChange:this.onOriginTableChange,disabled:"edit"===t},this.renderSourceTable(_)))),(i||E)&&o.a.createElement(Dn,j()({},Te,{label:"选择分区"}),c("originPartition",{rules:[],initialValue:E})(o.a.createElement(ja.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",disabled:"edit"===t,style:{width:"85%"},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(l)))),o.a.createElement("div",{className:"txt-center font-14"},o.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",o.a.createElement(z.a,{type:"down",style:{marginLeft:5}}))),y&&o.a.createElement(K.a,{rowKey:"key",className:"m-table m-cells",columns:this.previewTableColumns(f.columnList),dataSource:f.dataList,pagination:!1,scroll:{x:this.getScroll()}}))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,null,o.a.createElement(R.c,{to:"/dq/dataCheck"},"取消")),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(i.Component))||ln;wn=Wt.a.create()(wn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Dn,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(kn,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Sn,"TreeNode","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(bn,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(Ln,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"),__REACT_HOT_LOADER__.register(wn,"StepOne","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepOne.js"));var Hn,Pn=Wt.a.Item,Nn=dt.a.Option,xn=ja.a.TreeNode,In=function(e){return{dataCheck:e.dataCheck,dataSource:e.dataSource}},Un=function(e){return{getSourcePart:function(t,a){e(yn.getSourcePart(t,a))},resetSourcePart:function(t){e(yn.resetSourcePart(t))}}},jn=Object(C.b)(In,Un)(Hn=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.renderTargetTable=function(){return a.__renderTargetTable__REACT_HOT_LOADER__.apply(a,arguments)},a.onTargetTableChange=function(){return a.__onTargetTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onSourcePreview=function(){return a.__onSourcePreview__REACT_HOT_LOADER__.apply(a,arguments)},a.renderTreeSelect=function(){return a.__renderTreeSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.handlePartChange=function(){return a.__handlePartChange__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.previewTableColumns=function(){return a.__previewTableColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.state={showPreview:!1,sourcePreview:{}},a}return g()(t,e),T()(t,[{key:"__renderTargetTable__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Nn,{key:e,value:e},e)})}},{key:"__onTargetTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.form,n=t.havePart,r=t.editParams.target.dataSourceId,s={dataSourceId:r,table:e};n&&(this.props.resetSourcePart("target"),a.setFieldsValue({targetPartition:void 0}),this.props.getSourcePart({sourceId:r,table:e},"target")),this.setState({showPreview:!1,sourcePreview:{}}),this.props.changeParams({target:s,mappedPK:{}})}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams.target,a=t.dataSourceId,n=t.table,r=t.partition,s=this.state.showPreview;n?(s||Ge.getDataSourcesPreview({sourceId:a,tableName:n,partition:r}).then(function(t){if(1===t.code){var a=t.data,n=a.columnList,r=a.dataList;t.data.dataList=r.map(function(e,t){var a={};return e.forEach(function(e,r){a.key=t,a[n[r]]=e}),a}),e.setState({sourcePreview:t.data})}}),this.setState({showPreview:!s})):Gt.a.error("未选择数据表")}},{key:"__renderTreeSelect__REACT_HOT_LOADER__",value:function(e){var t=this;if(!Object(Et.isEmpty)(e))return e.children.map(function(e){var a=e.partName,n=e.partValue,r=n?"分区字段："+a+"  分区值："+n:a;return e.children.length?o.a.createElement(xn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e},t.renderTreeSelect(e.children)):o.a.createElement(xn,{key:e.nodeId,title:r,value:e.partColumn,dataRef:e,isLeaf:!0})})}},{key:"__handlePartChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.editParams.target,r=e?a.triggerNode.props.dataRef.partColumn:void 0;this.props.changeParams({target:j()({},n,{partition:r})})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep,a=e.navToStep;e.form.validateFields({force:!0},function(e,n){e||a(t+1)})}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:80,render:function(e){return o.a.createElement(Ma.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.editStatus,n=e.editParams,r=e.dataSource,s=e.dataCheck,i=e.havePart,l=s.targetPart,c=r.sourceTable,u=t.getFieldDecorator,_=n.target,d=_.table,p=_.partition,m=this.state,h=m.sourcePreview,E=m.showPreview;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(Wt.a,null,o.a.createElement(Pn,j()({},Te,{label:"选择右侧表"}),u("table",{rules:[{required:!0,message:"请选择右侧表"}],initialValue:d})(o.a.createElement(dt.a,{showSearch:!0,style:{width:"85%"},onChange:this.onTargetTableChange,disabled:"edit"===a},this.renderTargetTable(c)))),(i||p)&&o.a.createElement(Pn,j()({},Te,{label:"选择分区"}),u("targetPartition",{rules:[],initialValue:p})(o.a.createElement(ja.a,{allowClear:!0,showSearch:!0,placeholder:"分区列表",treeNodeLabelProp:"value",disabled:"edit"===a,style:{width:"85%",marginRight:15},dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handlePartChange},this.renderTreeSelect(l)))),o.a.createElement("div",{className:"txt-center font-14"},o.a.createElement("a",{onClick:this.onSourcePreview},"数据预览",o.a.createElement(z.a,{type:"down",style:{marginLeft:5}}))),E&&o.a.createElement(K.a,{rowKey:"key",className:"m-table m-cells",columns:this.previewTableColumns(h.columnList),dataSource:h.dataList,pagination:!1,scroll:{x:1e3}}))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,{onClick:this.prev},"上一步"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(i.Component))||Hn;jn=Wt.a.create()(jn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Pn,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Nn,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(xn,"TreeNode","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(In,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(Un,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"),__REACT_HOT_LOADER__.register(jn,"StepTwo","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepTwo.js"));var Mn,zn=a(175),Qn=a.n(zn),Fn=a(574),Gn=a.n(Fn),Vn=a(172),qn=a.n(Vn),Kn=a(187),Yn=a(144),Bn=function(e){return{addLinkedKeys:function(t){e({type:Yn.a.ADD_LINKED_KEYS,payload:t})},delLinkedKeys:function(t){e({type:Yn.a.DEL_LINKED_KEYS,payload:t})},setEditMap:function(t){e({type:Yn.a.SET_EDIT_MAP,payload:t})},setRowMap:function(t){e({type:Yn.a.SET_ROW_MAP,payload:t})},setNameMap:function(t){e({type:Yn.a.SET_NAME_MAP,payload:t})},resetLinkedKeys:function(){e({type:Yn.a.RESET_LINKED_KEYS})}}},Wn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Bn,"keyMapActions","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/actions/dataCheck/keyMapActions.js"),Wt.a.Item),Jn=function(e){return{keymap:e.keymap}},$n=Object(C.b)(Jn,Bn)(Mn=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.resize=function(){return a.__resize__REACT_HOT_LOADER__.apply(a,arguments)},a.getColumnData=function(){return a.__getColumnData__REACT_HOT_LOADER__.apply(a,arguments)},a.setEditKeymapData=function(){return a.__setEditKeymapData__REACT_HOT_LOADER__.apply(a,arguments)},a.setSettingTableFields=function(){return a.__setSettingTableFields__REACT_HOT_LOADER__.apply(a,arguments)},a.setKeymapCheckData=function(){return a.__setKeymapCheckData__REACT_HOT_LOADER__.apply(a,arguments)},a.initDiverseSetting=function(){return a.__initDiverseSetting__REACT_HOT_LOADER__.apply(a,arguments)},a.initDiverseData=function(){return a.__initDiverseData__REACT_HOT_LOADER__.apply(a,arguments)},a.getSettingItem=function(){return a.__getSettingItem__REACT_HOT_LOADER__.apply(a,arguments)},a.keymapTableColumn=function(){return a.__keymapTableColumn__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.next=function(){return a.__next__REACT_HOT_LOADER__.apply(a,arguments)},a.setRowMap=function(){return a.__setRowMap__REACT_HOT_LOADER__.apply(a,arguments)},a.setNameMap=function(){return a.__setNameMap__REACT_HOT_LOADER__.apply(a,arguments)},a.state={selectedSetting:[],selectedSource:[],selectedTarget:[],h:40,W:0,H:0,originColumn:[],targetColumn:[],rowMap:!1,nameMap:!1},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.initDiverseData(),this.$canvas=Object(Kn.b)(this.canvas),this.$activeLine=Object(Kn.b)("#activeLine"),this.listenResize(),this.getColumnData(),this.setEditKeymapData(),this.setKeymapCheckData(),this.setSettingTableFields(),this.drawSvg()}},{key:"componentWillReceiveProps",value:function(e){var t=e.keymap,a=this.props.keymap;if(t.source.length!=a.source.length){var n=this.props.editParams,r=n.origin,s=n.target;this.props.changeParams({origin:j()({},r,{column:t.source}),target:j()({},s,{column:t.target})})}}},{key:"componentDidUpdate",value:function(){this.$canvas.selectAll(".dl, .dr, .lines").remove(),this.drawSvg()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize,!1),this.props.resetLinkedKeys()}},{key:"listenResize",value:function(){window.addEventListener("resize",this.resize,!1)}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.setState({W:this.getCanvasW(),H:this.getCanvasH()})}},{key:"__getColumnData__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.editParams,a=t.origin,n=t.target;Ge.getDataSourcesColumn({sourceId:a.dataSourceId,tableName:a.table}).then(function(t){1===t.code&&(e.setState({originColumn:t.data}),e.resize())}),Ge.getDataSourcesColumn({sourceId:n.dataSourceId,tableName:n.table}).then(function(t){1===t.code&&(e.setState({targetColumn:t.data}),e.resize())})}},{key:"__setEditKeymapData__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams,t=e.origin,a=e.target;t.column&&a.column&&this.props.setEditMap({source:t.column,target:a.column})}},{key:"__setSettingTableFields__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.setting,t=this.props.form;if(!Object(Et.isEmpty)(e)){var a=[],n={};ae()(e).forEach(function(t){e[t]&&(a.push(t),"matchCase"!=t&&"matchNull"!=t&&(n[t]=e[t]))}),t.setFieldsValue(n),this.setState({selectedSetting:a})}}},{key:"__setKeymapCheckData__REACT_HOT_LOADER__",value:function(){var e=this.props.editParams.mappedPK;if(!Object(Et.isEmpty)(e)){var t=[],a=[],n=!0,r=!1,s=void 0;try{for(var i,o=qn()(Gn()(e));!(n=(i=o.next()).done);n=!0){var l=Qn()(i.value,2),c=l[0],u=l[1];t.push(c),a.push(u)}}catch(e){r=!0,s=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw s}}this.setState({selectedSource:t,selectedTarget:a})}}},{key:"drawSvg",value:function(){this.renderDags(),this.renderLines(),this.bindEvents()}},{key:"renderDags",value:function(){var e=this.state,t=e.h,a=e.W,n=e.originColumn,r=e.targetColumn;this.$canvas.append("g").attr("class","dl").selectAll("g").data(n).enter().append("g").attr("class","col-dag-l").append("circle").attr("class","dag-circle").attr("cx",function(e,t){return 15}).attr("cy",function(e,a){return t*(a+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7"),this.$canvas.append("g").attr("class","dr").selectAll("g").data(r).enter().append("g").attr("class","col-dag-r").append("circle").attr("class","dag-circle").attr("cx",function(e,t){return a-15}).attr("cy",function(e,a){return t*(a+1.5)}).attr("r",5).attr("stroke-width",2).attr("stroke","#fff").attr("fill","#2491F7")}},{key:"renderLines",value:function(){var e=this.state,t=e.h,a=e.W,n=this.props.keymap,r=n.source,s=n.target,i=Object(Kn.c)(".col-dag-l"),o=Object(Kn.c)(".col-dag-r"),l=[];r.forEach(function(e,n){i.each(function(r,i){var c=void 0,u=void 0,_=void 0,d=void 0;r.key===e&&(c=15,u=(i+1.5)*t,o.each(function(r,i){r.key===s[n]&&(_=a-15,d=(i+1.5)*t,l.push({s:{x:c,y:u},e:{x:_,y:d},dl:e,dr:s[n]}))}))})});var c=this.$canvas.append("g").attr("class","lines").selectAll("g").data(l).enter().append("g").attr("class","mapline");c.append("line").attr("x1",function(e){return e.s.x}).attr("y1",function(e){return e.s.y}).attr("x2",function(e){return e.e.x}).attr("y2",function(e){return e.e.y}).attr("stroke","#2491F7").attr("stroke-width",2).attr("marker-end","url(#arrow)"),c.append("rect").attr("x",function(e){return e.s.x}).attr("y",function(e){return e.s.y>e.e.y?e.s.y-15:e.s.y-10}).attr("width",function(e){return Math.pow(Math.pow(e.e.x-e.s.x,2)+Math.pow(e.e.y-e.s.y,2),.5)}).attr("transform",function(e){return"rotate(\n                            "+180/(Math.PI/Math.atan((e.e.y-e.s.y)/(e.e.x-e.s.x)))+"\n                        )"}).attr("transform-origin",function(e){var t=e.s.y>e.e.y?15:10;return e.s.x+" "+(e.s.y-t)}).attr("height",function(e){return e.s.y>e.e.y?"20px":"15px"}).attr("fill","transparent")}},{key:"bindEvents",value:function(){var e=this,t=this.state,a=t.h,n=t.W,r=t.selectedSource,s=t.selectedTarget,i=this.$activeLine,o=Object(Kn.c)(".col-dag-l"),l=Object(Kn.c)(".col-dag-r"),c=!1,u=void 0,_=void 0;o.on("mousedown",function(e,t,n){u=e,c=!0;var r=(t+1.5)*a;i.attr("x1",15).attr("y1",r).attr("x2",15).attr("y2",r)}),this.$canvas.on("mousemove",function(){if(c){var t=Object(Kn.a)(e.$canvas.node());i.attr("x2",t[0]).attr("y2",t[1])}}).on("mouseup",function(){if(c){var t=Object(Kn.a)(e.$canvas.node()),r=Qn()(t,2),s=r[0],i=r[1];if(s<n-30)e.resetActiveLine();else{var o=Math.floor(i/a)-1;l.each(function(e,t){t===o&&(_=e)})}}u&&_&&(e.props.addLinkedKeys({source:u.key,target:_.key}),e.resetActiveLine()),c=!1}),this.$canvas.selectAll(".mapline").on("mouseover",function(e,t,a){Object(Kn.b)(a[t]).select("line").attr("stroke-width",4).attr("stroke","#2491F7")}).on("mouseout",function(e,t,a){Object(Kn.b)(a[t]).select("line").attr("stroke-width",2).attr("stroke","#2491F7")}).on("click",function(t,a,n){e.props.delLinkedKeys({source:t.dl,target:t.dr});var i=[].concat(Dt()(r)),o=[].concat(Dt()(s)),l={};i=i.filter(function(e){return e!==t.dl}),o=o.filter(function(e){return e!==t.dr}),e.setState({selectedSource:i,selectedTarget:o}),i.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})})}},{key:"resetActiveLine",value:function(){this.$activeLine.attr("x1",-10).attr("y1",-10).attr("x2",-10).attr("y2",-10)}},{key:"__initDiverseSetting__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"差异特征",dataIndex:"setting",key:"setting",render:function(t,a){return e.getSettingItem(t)},width:"95%"}]}},{key:"__initDiverseData__REACT_HOT_LOADER__",value:function(){return[{id:1,setting:"diverseNum"},{id:2,setting:"diverseRatio"},{id:3,setting:"diverseAbsolute"},{id:4,setting:"decimalRetain"},{id:5,setting:"matchCase"},{id:6,setting:"matchNull"}]}},{key:"__getSettingItem__REACT_HOT_LOADER__",value:function(e){var t=this.props.form.getFieldDecorator,a=this.props.editParams.setting;switch(e){case"diverseNum":return o.a.createElement(Wn,{style:{marginBottom:0}},"记录数差异，对比左右表的总记录数，差距小于",t("diverseNum",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseNum})(o.a.createElement(qt.a,{size:"default",min:1,step:1})),"%时候，计为成功匹配");case"diverseRatio":return o.a.createElement(Wn,{style:{marginBottom:0}},"数值差异百分比，对比左右表的数值型数据时，差距百分比小于",t("diverseRatio",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseRatio})(o.a.createElement(qt.a,{size:"default",min:1,step:1})),"%时候，计为成功匹配");case"diverseAbsolute":return o.a.createElement(Wn,{style:{marginBottom:0}},"数值差异绝对值，对比左右表的数值型数据时，差距绝对值小于",t("diverseAbsolute",{rules:[{required:!0,message:"不能为空"}],initialValue:a.diverseAbsolute})(o.a.createElement(qt.a,{size:"default",min:1,step:1})),"时候，计为成功匹配");case"decimalRetain":return o.a.createElement(Wn,{style:{marginBottom:0}},"数值对比忽略小数点，忽略小数点后",t("decimalRetain",{rules:[{required:!0,message:"不能为空"}],initialValue:a.decimalRetain})(o.a.createElement(qt.a,{size:"default",min:1,step:1,precision:0})),"位");case"matchCase":return o.a.createElement("p",null,"字符不区分大小写，对比左右表的字符串型数据时，不区分大小写");case"matchNull":return o.a.createElement("p",null,"空值与NULL等价，对比左右表的数据时，认为空值与NULL值是相等的")}}},{key:"getCanvasW",value:function(){return document.querySelector(".keymap-svg").getBoundingClientRect().width}},{key:"getCanvasH",value:function(){var e=document.querySelectorAll(".keymap-table")[0].getBoundingClientRect().height,t=document.querySelectorAll(".keymap-table")[1].getBoundingClientRect().height;return e>t?e:t}},{key:"__keymapTableColumn__REACT_HOT_LOADER__",value:function(e){return[{title:"left"===e?"左侧表字段":"右侧表字段",dataIndex:"key",key:"key",width:"45%"},{title:"类型",dataIndex:"type",key:"type",width:"40%"}]}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.form,n=t.editParams,r=t.keymap,s=t.currentStep,i=this.state.selectedSetting;r.source.length?Object(Et.isEmpty)(n.mappedPK)?Gt.a.error("请选择逻辑主键"):(ae()(a.getFieldsValue()).forEach(function(e){i.indexOf(e)<0&&a.resetFields([e])}),a.validateFields(i,function(t,a){t?Gt.a.error("请填写已选中的差异设置"):(ae()(a).forEach(function(e){"matchCase"!==e&&"matchNull"!==e||(a[e]=!0)}),e.props.changeParams({setting:a}),e.props.navToStep(s+1))})):Gt.a.error("请连接要比对的字段")}},{key:"__setRowMap__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.rowMap,a=e.nameMap,n=e.originColumn,r=e.targetColumn;t?(this.props.resetLinkedKeys(),this.setState({selectedSource:[],selectedTarget:[]}),this.props.changeParams({mappedPK:{}})):this.props.setRowMap({sourceKeyCol:n.map(function(e){return e.key}),targetKeyCol:r.map(function(e){return e.key})}),this.setState({rowMap:!t,nameMap:a?!a:a})}},{key:"__setNameMap__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.nameMap,a=e.rowMap,n=e.originColumn,r=e.targetColumn,s=this.props.editParams;s.origin,s.target;t?(this.props.resetLinkedKeys(),this.setState({selectedSource:[],selectedTarget:[]}),this.props.changeParams({mappedPK:{}})):this.props.setNameMap({sourceKeyCol:n.map(function(e){return e.key}),targetKeyCol:r.map(function(e){return e.key})}),this.setState({nameMap:!t,rowMap:a?!a:a})}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedSetting,n=t.selectedSource,r=t.selectedTarget,s=(t.h,t.W,t.H),i=t.originColumn,l=t.targetColumn,c=t.nameMap,u=t.rowMap,_=this.props.keymap,d=_.source,p=_.target,m={selectedRowKeys:n,getCheckboxProps:function(e){return{disabled:!d.includes(e.key)}},onSelect:function(t,a,s){var i=[].concat(Dt()(n)),o=[].concat(Dt()(r)),l={};a?(i.push(t.key),o.push(p[d.indexOf(t.key)])):(i.splice(i.indexOf(t.key),1),o.splice(o.indexOf(t.key),1)),e.setState({selectedSource:i,selectedTarget:o}),i.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})}},h={selectedRowKeys:r,getCheckboxProps:function(e){return{disabled:!p.includes(e.key)}},onSelect:function(t,a,s){var i=[].concat(Dt()(n)),o=[].concat(Dt()(r)),l={};a?(o.push(t.key),i.push(d[p.indexOf(t.key)])):(o.splice(o.indexOf(t.key),1),i.splice(i.indexOf(t.key),1)),e.setState({selectedSource:i,selectedTarget:o}),i.forEach(function(e,t){l[e]=o[t]}),e.props.changeParams({mappedPK:l})}},E={selectedRowKeys:a,onChange:function(t){e.setState({selectedSetting:t})}};return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement("p",{className:"keymap-title"},"提示：您要配置来源表与目标表的字段映射关系，通过连线将待同步的字段左右相连，也可以通过同行映射、同名映射批量完成映射,同时，您需要添加主键"),o.a.createElement(J.a,{className:"keymap-content"},o.a.createElement(Z.a,{span:3},o.a.createElement("div",{className:"keymap-action"},o.a.createElement(Qt.a,{type:u?"primary":"default",onClick:this.setRowMap},u?"取消同行映射":"同行映射"),o.a.createElement("br",null),o.a.createElement(Qt.a,{type:c?"primary":"default",onClick:this.setNameMap},c?"取消同名映射":"同名映射"))),o.a.createElement(Z.a,{span:6},o.a.createElement(K.a,{className:"keymap-table m-table table-select-text-key",rowKey:function(e){return e.key},columns:this.keymapTableColumn("left"),dataSource:i,rowSelection:m,pagination:!1})),o.a.createElement(Z.a,{span:8,className:"canvas-content"},o.a.createElement("svg",{ref:function(t){return e.canvas=t},width:"100%",height:s,className:"keymap-svg"},o.a.createElement("defs",null,o.a.createElement("marker",{id:"arrow",markerUnits:"strokeWidth",markerWidth:"12",markerHeight:"12",viewBox:"0 0 12 12",refX:"6",refY:"6",orient:"auto"},o.a.createElement("path",{d:"M2,3 L9,6 L2,9 L2,3",style:{fill:"#2491F7"}}))),o.a.createElement("g",null,o.a.createElement("line",{id:"activeLine",x1:"-10",y1:"-10",x2:"-10",y2:"-10",stroke:"#2491F7",strokeWidth:"2",markerEnd:"url(#arrow)"})))),o.a.createElement(Z.a,{span:6},o.a.createElement(K.a,{className:"keymap-table m-table table-select-text-key",rowKey:function(e){return e.key},columns:this.keymapTableColumn("right"),dataSource:l,rowSelection:h,pagination:!1}))),o.a.createElement(J.a,{className:"keymap-content"},o.a.createElement(Z.a,{offset:2,span:20},o.a.createElement(K.a,{className:"m-table setting-table",showHeader:!1,rowKey:function(e){return e.setting},columns:this.initDiverseSetting(),dataSource:this.initDiverseData(),rowSelection:E,pagination:!1})))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,{onClick:this.prev},"上一步"),o.a.createElement(Qt.a,{className:"m-l-8",type:"primary",onClick:this.next},"下一步")))}}]),t}(i.Component))||Mn;$n=Wt.a.create()($n);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Wn,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js"),__REACT_HOT_LOADER__.register(Jn,"mapState","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js"),__REACT_HOT_LOADER__.register($n,"StepThree","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepThree.js")),a(607);var Zn,Xn=a(385),er=a.n(Xn),tr=(a(85),a(50)),ar=a.n(tr),nr=Wt.a.Item,rr=ar.a.Group,sr=dt.a.Option,ir={beginDate:re()().format("YYYY-MM-DD"),hour:0,min:0,endDate:re()().add(100,"years").format("YYYY-MM-DD"),periodType:"2"},or=function(e){return{common:e.common}},lr=Object(C.b)(or)(Zn=function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.resetScheduleConf=function(){return a.__resetScheduleConf__REACT_HOT_LOADER__.apply(a,arguments)},a.onExecuteTypeChange=function(){return a.__onExecuteTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformChange=function(){return a.__onInformChange__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformTypeChange=function(){return a.__onInformTypeChange__REACT_HOT_LOADER__.apply(a,arguments)},a.changeScheduleConfTime=function(){return a.__changeScheduleConfTime__REACT_HOT_LOADER__.apply(a,arguments)},a.onInformUserChange=function(){return a.__onInformUserChange__REACT_HOT_LOADER__.apply(a,arguments)},a.renderUserList=function(){return a.__renderUserList__REACT_HOT_LOADER__.apply(a,arguments)},a.disabledDate=function(){return a.__disabledDate__REACT_HOT_LOADER__.apply(a,arguments)},a.prev=function(){return a.__prev__REACT_HOT_LOADER__.apply(a,arguments)},a.save=function(){return a.__save__REACT_HOT_LOADER__.apply(a,arguments)},a.state={isInform:!1,scheduleConfObj:ir},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this.props.editParams,t=e.scheduleConf,a=e.notifyVO,n=this.state.scheduleConfObj;t?this.setState({scheduleConfObj:JSON.parse(t)}):this.props.changeParams({scheduleConf:$t()(n)}),a&&this.setState({isInform:!0})}},{key:"__resetScheduleConf__REACT_HOT_LOADER__",value:function(){var e=ir;this.setState({scheduleConfObj:e}),this.props.changeParams({scheduleConf:$t()(e)})}},{key:"__onExecuteTypeChange__REACT_HOT_LOADER__",value:function(e){0===e.target.value&&this.resetScheduleConf(),this.props.changeParams({executeType:e.target.value})}},{key:"__onInformChange__REACT_HOT_LOADER__",value:function(e){this.setState({isInform:e.target.checked}),e.target.checked||this.props.changeParams({notifyVO:null})}},{key:"__onInformTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.editParams.notifyVO;this.props.changeParams({notifyVO:j()({},t,{sendTypes:e})})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.state.scheduleConfObj,r={};r[e]=a,this.setState({scheduleConfObj:j()({},n,r)}),this.props.changeParams({scheduleConf:$t()(j()({},n,r))})}},{key:"__onInformUserChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.editParams.notifyVO;this.props.changeParams({notifyVO:j()({},t,{receivers:e})})}},{key:"__renderUserList__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(sr,{key:e.id,value:e.id.toString()},e.userName)})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()<re()().startOf("day").valueOf()}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.currentStep;(0,e.navToStep)(t-1)}},{key:"__save__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.editParams;t.validateFields({force:!0},function(e,t){e&&(e.beginDate||e.hour||e.min)&&Gt.a.error("执行时间不能为空"),e||(a.id?fn.updateCheck(a).then(function(e){1===e.code&&(Gt.a.success("操作成功"),setTimeout(function(){R.g.push("/dq/dataCheck")},1e3))}):fn.addCheck(a).then(function(e){1===e.code&&(Gt.a.success("操作成功"),setTimeout(function(){R.g.push("/dq/dataCheck")},1e3))}))})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=e.editParams,r=e.editStatus,s=a.userList,i=t.getFieldDecorator,l=n.executeType,c=n.notifyVO,u=this.state,_=u.isInform,d=u.scheduleConfObj,p=c?c.sendTypes:void 0,m=c?c.receivers:void 0;return o.a.createElement("div",null,o.a.createElement("div",{className:"steps-content"},o.a.createElement(Wt.a,null,o.a.createElement(nr,j()({},Te,{label:"执行时间"}),i("executeType",{rules:[{required:!0,message:"不能为空"}],initialValue:l})(o.a.createElement(rr,{onChange:this.onExecuteTypeChange},o.a.createElement(ar.a,{value:0},"立即执行"),o.a.createElement(ar.a,{value:1},"定时执行")))),1===l&&o.a.createElement(J.a,{style:{marginBottom:24}},o.a.createElement(Z.a,{span:12,offset:6},i("beginDate",{rules:[{required:!0}],initialValue:re()(d.beginDate)})(o.a.createElement(lt.a,{format:"YYYY-MM-DD",placeholder:"开始时间",style:{width:150,marginRight:15},disabledDate:this.disabledDate,onChange:this.changeScheduleConfTime.bind(this,"beginDate")})),i("hour",{rules:[{required:!0}],initialValue:re()(d.hour,"HH")})(o.a.createElement(er.a,{format:"HH",placeholder:"小时",style:{marginRight:15},onChange:this.changeScheduleConfTime.bind(this,"hour")})),i("min",{rules:[{required:!0}],initialValue:re()(d.min,"mm")})(o.a.createElement(er.a,{format:"mm",placeholder:"分钟",onChange:this.changeScheduleConfTime.bind(this,"min")})))),o.a.createElement(nr,j()({},Te,{label:"通知设置"}),o.a.createElement(at.a,{value:_,onChange:this.onInformChange},"执行完成后发送通知")),!0===_&&o.a.createElement("div",null,o.a.createElement(nr,j()({},Te,{label:"通知方式"}),i("sendTypes",{rules:[{required:!0,message:"选择通知方式"}],initialValue:p?p.map(function(e){return e.toString()}):[]})(o.a.createElement(at.a.Group,{onChange:this.onInformTypeChange},o.a.createElement(at.a,{value:"0"},"邮件"),o.a.createElement(at.a,{value:"1"},"短信")))),o.a.createElement(nr,j()({},Te,{label:"通知接收人"}),i("receivers",{rules:[{required:!0,message:"选择接收人"}],initialValue:m?m.map(function(e){return e.toString()}):[]})(o.a.createElement(dt.a,{allowClear:!0,mode:"multiple",onChange:this.onInformUserChange},this.renderUserList(s))))))),o.a.createElement("div",{className:"steps-action"},o.a.createElement(Qt.a,{onClick:this.prev},"上一步"),o.a.createElement(Qt.a,{type:"primary",className:"m-l-8",onClick:this.save},"edit"===r?"保存":"新建")))}}]),t}(i.Component))||Zn;lr=Wt.a.create()(lr);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(nr,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(rr,"RadioGroup","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(sr,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(ir,"initialSchedule","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(or,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"),__REACT_HOT_LOADER__.register(lr,"StepFour","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/stepFour.js"));var cr,ur,_r=Ia.a.Step,dr=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={current:0,editParams:{origin:{},target:{},mappedPK:{},executeType:0,setting:{},scheduleConf:void 0,notifyVO:null},editStatus:"new",havePart:!1},n.changeParams=function(){var e;return(e=n).__changeParams__REACT_HOT_LOADER__.apply(e,arguments)},n.changeHavePart=function(){var e;return(e=n).__changeHavePart__REACT_HOT_LOADER__.apply(e,arguments)},n.navToStep=function(){var e;return(e=n).__navToStep__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.routeParams.verifyId,a=this.state.editParams;t&&(this.setState({editStatus:"edit"}),fn.getCheckDetail({verifyId:t}).then(function(t){if(1===t.code){var n=t.data;e.setState({editParams:j()({},a,{id:n.id,origin:n.origin,target:n.target,setting:n.setting,mappedPK:n.mappedPK,notifyVO:n.notifyVO,executeType:n.executeType,scheduleConf:n.scheduleConf})})}}))}},{key:"__changeParams__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.editParams,e);this.setState({editParams:t})}},{key:"__changeHavePart__REACT_HOT_LOADER__",value:function(e){this.setState({havePart:e})}},{key:"__navToStep__REACT_HOT_LOADER__",value:function(e){this.setState({current:e})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.editParams,n=e.editStatus,r=e.havePart,s=[{title:"选择左侧表",content:o.a.createElement(wn,{currentStep:t,navToStep:this.navToStep,havePart:r,editParams:a,editStatus:n,changeParams:this.changeParams,changeHavePart:this.changeHavePart})},{title:"选择右侧表",content:o.a.createElement(jn,{currentStep:t,navToStep:this.navToStep,havePart:r,editParams:a,editStatus:n,changeParams:this.changeParams})},{title:"选择字段",content:o.a.createElement($n,{currentStep:t,navToStep:this.navToStep,editParams:a,editStatus:n,changeParams:this.changeParams})},{title:"执行配置",content:o.a.createElement(lr,{currentStep:t,navToStep:this.navToStep,editParams:a,editStatus:n,changeParams:this.changeParams})}];return o.a.createElement("div",{className:"box-1 check-setting"},o.a.createElement("h1",{className:"box-title"},o.a.createElement(cn.a,null),o.a.createElement("span",{className:"m-l-8"},"new"===n?"新建逐行校验":"编辑逐行校验")),o.a.createElement("div",{className:"steps-container"},o.a.createElement(Ia.a,{current:t},s.map(function(e){return o.a.createElement(_r,{key:e.title,title:e.title})})),s[t].content))}}]),t}(i.Component),pr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(_r,"Step","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/index.js"),__REACT_HOT_LOADER__.register(dr,"DataCheckEdit","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/edit/index.js")),function(e){function t(e){h()(this,t);var a=y()(this,(t.__proto__||p()(t)).call(this,e));return a.initColumns=function(){return a.__initColumns__REACT_HOT_LOADER__.apply(a,arguments)},a.onTableChange=function(){return a.__onTableChange__REACT_HOT_LOADER__.apply(a,arguments)},a.handleDownload=function(){return a.__handleDownload__REACT_HOT_LOADER__.apply(a,arguments)},a.state={params:{currentPage:1,pageSize:20,verifyRecordId:a.props.routeParams.verifyRecordId},tableData:{},reportData:{}},a}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.params,a=t.verifyRecordId;fn.getCheckReport({verifyRecordId:a}).then(function(t){1===t.code&&e.setState({reportData:t.data})}),fn.getCheckReportTable(t).then(function(t){1===t.code&&e.setState({tableData:t.data})})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(e){return e.length&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:8*e.length+28+"px",render:function(e){return o.a.createElement(Ma.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"getScroll",value:function(){var e=100,t=this.state.tableData.attachment;for(var a in t){e=e+8*t[a].length+28}return e+"px"}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this,r=j()({},this.state.params,{currentPage:e.current});fn.getCheckReportTable(r).then(function(e){1===e.code&&n.setState({params:r,tableData:e.data})})}},{key:"__handleDownload__REACT_HOT_LOADER__",value:function(){var e=this.state.params,t="verifyRecordId="+e.verifyRecordId+"&currentPage="+e.currentPage+"&pageSize="+e.pageSize;window.open("/api/dq/export/verify/doExport?"+t)}},{key:"render",value:function(){var e=this.state,t=e.params,a=e.tableData,n=e.reportData,r=n.verifyVO,s=n.lAll,i=n.rAll,l=n.mapSuccess,c=n.mapFailure,u=n.rightUnfound,_=n.leftUnfound,d=n.dataSourceEN,p={current:t.currentPage,pageSize:t.pageSize,total:a.totalCount};return o.a.createElement("div",{className:"box-1"},o.a.createElement("h1",{className:"box-title"},o.a.createElement(cn.a,null),o.a.createElement("span",{className:"m-l-8"},"查看报告")),o.a.createElement("div",{className:"report-content"},o.a.createElement("h3",null,"整体校验"),o.a.createElement("table",{className:"report-table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null),o.a.createElement("th",null,"左侧表"),o.a.createElement("th",null,"右侧表")),o.a.createElement("tr",null,o.a.createElement("th",null,"表名"),o.a.createElement("td",null,r?r.originTableName:""),o.a.createElement("td",null,r?r.targetTableName:"")),o.a.createElement("tr",null,o.a.createElement("th",null,"分区名"),o.a.createElement("td",null,r?r.originPartition:" -- "),o.a.createElement("td",null,r?r.targetPartition:" -- ")),o.a.createElement("tr",null,o.a.createElement("th",null,"类型"),o.a.createElement("td",null,d),o.a.createElement("td",null,d)),o.a.createElement("tr",null,o.a.createElement("th",null,"总记录数"),o.a.createElement("td",null,s),o.a.createElement("td",null,i))))),o.a.createElement("div",{className:"report-content"},o.a.createElement("h3",null,"未匹配数据报告"),o.a.createElement("table",{className:"report-table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null,"匹配成功"),o.a.createElement("td",{className:"width-30"},l),o.a.createElement("th",null,"左表数据在右表未找到"),o.a.createElement("td",{className:"width-30"},u)),o.a.createElement("tr",null,o.a.createElement("th",null,"逻辑主键匹配，但数据不匹配"),o.a.createElement("td",{className:"width-30"},c),o.a.createElement("th",null,"右表数据在左表未找到"),o.a.createElement("td",{className:"width-30"},_))))),o.a.createElement("div",{className:"report-content"},o.a.createElement("h3",{className:"flex",style:{justifyContent:"space-between"}},"具体差异",o.a.createElement(z.a,{type:"download",onClick:this.handleDownload,style:{fontSize:16,marginRight:25,cursor:"pointer"}})),o.a.createElement(K.a,{className:"m-cells m-table",scroll:{x:this.getScroll()},pagination:p,dataSource:a.data?a.data:[],columns:this.initColumns(a.attachment?a.attachment:[]),onChange:this.onTableChange})))}}]),t}(i.Component)),mr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(pr,"DataCheckReport","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataCheck/report/index.js"),a(214)),hr=o.a.createElement("div",null,"where 条件即针对源头数据筛选条件，根据指定的 column、table、where 条件拼接 SQL 进行数据抽取，暂时不支持limit关键字过滤。利用 where 条件可进行全量同步和增量同步，具体说明如下：",o.a.createElement("br",null),o.a.createElement("ul",null,o.a.createElement("li",null,"1）全量同步：第一次做数据导入时通常为全量导入，可不用设置 where 条件。"),o.a.createElement("li",null,"2）增量同步：增量导入在实际业务场景中，往往会选择当天的数据进行同步，通常需要编写 where 条件语句，请先确认表中描述增量字段（时间戳）为哪一个。如tableA增量的字段为create_time，则填写create_time > 您需要的日期，如果需要日期动态变化，请参考帮助文档。"))),Er=o.a.createElement("ul",null,o.a.createElement("li",null,"MySQL：支持数值型切分键"),o.a.createElement("li",null,"Oracle：支持数值型、字符串类型切分键")),Tr=o.a.createElement("div",null,"user/hive/warehouse/projectName.db/",o.a.createElement("br",null),"tableName 是RD-OS默认的HDFS文件组织方式，projectName为项目名， 其中每个tableName是HDFS内的一个目录，储存着一张表的数据。 如果此表的数据存储在当前项目空间内，只需修改tableName即可， 否则需要根据HDFS的存储位置填写。"),fr=o.a.createElement("div",null,"设置作业速率上限，则数据同步作业的总速率将尽可能按照这个上限进行同步， 需根据实际硬件配置调整，默认为1"),yr=o.a.createElement("ul",null,o.a.createElement("li",null," 1.作业速率上限=作业并发数单作业的传输速率，当作业速率上限已定，选择的并发数越高则单并发的速率越低，同时所占用的内存会越高，这可以根据你的业务需求选择设定的值"),o.a.createElement("li",null,"2.作业并发数下拉框选择对象，取决作业速率上限。作业速率上限选择值nMB/s，作业并发数最大能选择n")),vr=o.a.createElement("div",null,"表示脏数据的最大容忍条数，如果您配置0， 则表示严格不允许脏数据存在；如果不填则代表容忍脏数据"),gr=o.a.createElement("div",null,"高可用模式下的填写规则：",o.a.createElement("ul",null,o.a.createElement("li",null,"1、分别要填写：nameservice名称、 namenode名称（多个以逗号分隔）、proxy.provider参数；"),o.a.createElement("li",null,"2、所有参数以JSON格式填写；"),o.a.createElement("li",null,"3、格式为：",o.a.createElement("br",null),'"dfs.nameservices": "nameservice名称", "dfs.ha.namenodes.nameservice名称": "namenode名称，以逗号分隔", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.client.failover.proxy.provider.',o.a.createElement("br",null),'nameservice名称": "org.apache.hadoop.',o.a.createElement("br",null),"hdfs.server.namenode.ha.",o.a.createElement("br",null),'ConfiguredFailoverProxyProvider"'),o.a.createElement("li",null,"4、详细参数含义请参考《帮助文档》或",o.a.createElement("a",{href:"http://hadoop.apache.org/docs/r2.7.4/hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html",target:"blank"},"Hadoop官方文档")))),Rr=o.a.createElement("div",null,"JDBC URL配置参考：",o.a.createElement("ul",null,o.a.createElement("li",null,"MySQL: jdbc:mysql://host:port/batch?useCursorFetch=true"),o.a.createElement("li",null,"Oracle: jdbc:oracle:thin:@host:port:ORCL"),o.a.createElement("li",null,"Hive: jdbc:hive2://host:port/projectName"))),Cr=o.a.createElement("div",null,"HBase配置说明：",o.a.createElement("ul",null,o.a.createElement("li",null,'1、Zookeeper 集群的地址，多个地址间用逗号分割。例 如：" IP1:Port, IP2:Port, IP3:Port/子目录".默认是 localhost,是给伪分布式用的。要修改才能在完全分布式的情况下使用。如果在hbase-env.sh设置了HBASEMANAGESZK， 这些ZooKeeper节点就会和HBase一起启动'),o.a.createElement("li",null,"2、Port: ZooKeeper的zoo.conf中的配置。客户端连接的端口， 默认2181"),o.a.createElement("li",null,"3、子目录：HBase在ZooKeeper中配置的子目录"))),Ar=o.a.createElement("div",null,o.a.createElement("p",null,"保存到默认位置，您可以在“数据管理-脏数据管理”中查看，表名：defaultName（生命周期：30天）")),Or=o.a.createElement("div",null,o.a.createElement("p",null,"任务执行结束后统计错误记录占比，当比例过高时，将此任务实例置为失败")),Dr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(hr,"dataFilterDoc","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Er,"switchKey","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Tr,"hdfsPath","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(fr,"jobSpeedLimit","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(yr,"jobConcurrence","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(vr,"errorCount","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(gr,"hdfsConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Rr,"rdbConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Cr,"hBaseConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Ar,"recordDirtyData","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Or,"errorPercentConfig","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/docs.js")),function(e){function t(){return h()(this,t),y()(this,(t.__proto__||p()(t)).apply(this,arguments))}return g()(t,e),T()(t,[{key:"render",value:function(){var e=this.props.doc;return o.a.createElement(it.a,{key:e,title:n[e]},o.a.createElement(z.a,j()({className:"help-doc"},this.props.style,{type:"question-circle-o"})))}}]),t}(o.a.Component)),kr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Dr,"HelpDoc","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/helpDoc/index.js"),Wt.a.Item),Sr=dt.a.Option,br='{\n    "defaultFS": "",\n    "hadoopConfig": {\n        "dfs.nameservices": "defaultDfs", \n        "dfs.ha.namenodes.defaultDfs": "namenode1", \n        "dfs.namenode.rpc-address.defaultDfs.namenode1": "", \n        "dfs.client.failover.proxy.provider.defaultDfs": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider" \n    }\n}',Lr=function(e){return{dataSource:e.dataSource}},wr=function(e){return{getDataSourcesType:function(t){e(Ve.getDataSourcesType(t))}}},Hr=Object(C.b)(Lr,wr)(cr=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={sourceType:void 0,hasHdfsConfig:!1,hadoopConfig:"defaultDfs"},n.onOk=function(){var e;return(e=n).__onOk__REACT_HOT_LOADER__.apply(e,arguments)},n.testConnection=function(){var e;return(e=n).__testConnection__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},n.sourceChange=function(){var e;return(e=n).__sourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.enableHdfsConfig=function(){var e;return(e=n).__enableHdfsConfig__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.sourceData,a=e.sourceData;a&&a!==t&&(7===a.type?this.setState({sourceType:a.type||1,hasHdfsConfig:!0}):this.setState({sourceType:a.type||1}))}},{key:"__onOk__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.editDataSource,n=t.form;n.validateFields(function(e,t){e||(t.dataJson.jdbcUrl&&(t.dataJson.jdbcUrl=x.a.trim(t.dataJson.jdbcUrl)),t.dataJson.defaultFS&&(t.dataJson.defaultFS=x.a.trim(t.dataJson.defaultFS)),a(t,n))})}},{key:"__testConnection__REACT_HOT_LOADER__",value:function(){var e=this.state.sourceType,t=this.props.form,a=void 0;e===oe.MAXCOMPUTE&&(a=["type","dataName","dataJson.project","dataJson.endPoint","dataJson.accessKey","dataJson.accessId"]),t.validateFields(a,function(e,t){e||Ge.testDSConnection(t).then(function(e){e.data?Gt.a.success("数据源连接正常！"):Gt.a.error("数据库连接失败！")})})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.handCancel;t.resetFields(),a()}},{key:"__sourceChange__REACT_HOT_LOADER__",value:function(e){this.setState({sourceType:parseInt(e)}),this.props.form.resetFields()}},{key:"__enableHdfsConfig__REACT_HOT_LOADER__",value:function(e){this.setState({hasHdfsConfig:!e.target.value})}},{key:"renderDynamic",value:function(){var e=this.state,t=e.hasHdfsConfig,a=e.sourceType,n=this.props,r=n.form,s=n.sourceData,i=r.getFieldDecorator,l=s.dataJson||{};switch(a){case oe.HIVE:return o.a.createElement("div",null,o.a.createElement(kr,j()({},Te,{label:"JDBC URL",hasFeedback:!0}),i("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:l.jdbcUrl||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"用户名"}),i("dataJson.username",{rules:[],initialValue:l.username||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"密码"}),i("dataJson.password",{rules:[],initialValue:""})(o.a.createElement(mt.a,{type:"password"}))),o.a.createElement(kr,j()({},Te,{label:"defaultFS",hasFeedback:!0}),i("dataJson.defaultFS",{rules:[{required:!0,message:"defaultFS不可为空！"}],initialValue:l.defaultFS||""})(o.a.createElement(mt.a,{placeholder:"hdfs://host:port"}))),o.a.createElement(kr,ye,i("hasHdfsConfig",{initialValue:!1})(o.a.createElement(at.a,{checked:t,onChange:this.enableHdfsConfig},"高可用配置"))),o.a.createElement(kr,j()({},Te,{label:"高可用配置",style:{display:t?"block":"none"}}),i("dataJson.hadoopConfig",{rules:[],initialValue:l.hadoopConfig||""})(o.a.createElement(mt.a,{type:"textarea",rows:5,placeholder:br})),o.a.createElement(Dr,{doc:"hdfsConfig"}),o.a.createElement(mr.a,{style:{position:"absolute",right:"-20px",bottom:"0px"},copyText:br})));case oe.MAXCOMPUTE:return o.a.createElement("div",null,o.a.createElement(kr,j()({},Te,{label:"AccessId",hasFeedback:!0}),i("dataJson.accessId",{rules:[{required:!0,message:"access ID不可为空！"}],initialValue:l.accessId||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"AccessKey",hasFeedback:!0}),i("dataJson.accessKey",{rules:[{required:!0,message:"access Key不可为空！"}],initialValue:l.accessKey||""})(o.a.createElement(mt.a,{type:"password",autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"Project Name",hasFeedback:!0}),i("dataJson.project",{rules:[{required:!0,message:"Project Name不可为空！"}],initialValue:l.project||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"End Point",hasFeedback:!0}),i("dataJson.endPoint",{rules:[{required:!0,message:"End Point不可为空！"}],initialValue:l.endPoint||""})(o.a.createElement(mt.a,{autoComplete:"off"}))));case oe.MYSQL:case oe.ORACLE:case oe.SQLSERVER:return o.a.createElement("div",null,o.a.createElement(kr,j()({},Te,{label:"JDBC URL",hasFeedback:!0}),i("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:l.jdbcUrl||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"用户名",hasFeedback:!0}),i("dataJson.username",{rules:[{required:!0,message:"用户名不可为空！"}],initialValue:l.username||""})(o.a.createElement(mt.a,{autoComplete:"off"}))),o.a.createElement(kr,j()({},Te,{label:"密码",hasFeedback:!0}),i("dataJson.password",{rules:[{required:!0,message:"密码不可为空！"}],initialValue:""})(o.a.createElement(mt.a,{type:"password"}))))}}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return o.a.createElement(Sr,{key:e.value,value:e.value.toString()},e.name)})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.title,r=e.sourceData,s=e.status,i=e.dataSource,l=(this.state.hasHdfsConfig,a.getFieldDecorator);return o.a.createElement(rt.a,{title:n,maskClosable:!1,wrapClassName:"vertical-center-modal",visible:t,onCancel:this.cancel,footer:!1},o.a.createElement(Wt.a,null,o.a.createElement(kr,j()({},Te,{label:"数据源类型",hasFeedback:!0}),l("type",{rules:[{required:!0,message:"数据源类型不可为空！"}],initialValue:r.type?r.type.toString():"1"})(o.a.createElement(dt.a,{onChange:this.sourceChange,disabled:"edit"===s},this.renderSourceType(i.sourceType)))),o.a.createElement(kr,j()({},Te,{label:"数据源名称",hasFeedback:!0}),l("dataName",{rules:[{required:!0,message:"数据源名称不可为空！"},{max:128,message:"数据源名称不得超过128个字符！"},{pattern:/^[A-Za-z0-9_]+$/,message:"名称只能由字母与数字、下划线组成"}],initialValue:r.dataName||""})(o.a.createElement(mt.a,{autoComplete:"off",disabled:"edit"===s}))),o.a.createElement(kr,j()({},Te,{label:"数据源描述",hasFeedback:!0}),l("dataDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:r.dataDesc||""})(o.a.createElement(mt.a,{type:"textarea",rows:4}))),this.renderDynamic(),o.a.createElement(kr,ye,o.a.createElement(Qt.a,{icon:"sync",type:"primary","data-target":"test",onClick:this.testConnection,style:{marginRight:"10px"}},"测试连通性"),o.a.createElement(Qt.a,{type:"primary",style:{marginRight:"10px"},onClick:this.onOk},"确定"),o.a.createElement(Qt.a,{onClick:this.cancel},"取消"))))}}]),t}(i.Component))||cr,Pr=Wt.a.create()(Hr),Nr=Pr,xr=Nr,Ir=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(kr,"FormItem","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Sr,"Option","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(br,"hdfsConf","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Lr,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(wr,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Hr,"DataSourceModal","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Pr,"DataSourceFormWrapper","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(Nr,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/editModal.js")),mt.a.Search),Ur=function(e){return{dataSource:e.dataSource}},jr=function(e){return{getDataSources:function(t){e(Ve.getDataSources(t))}}},Mr=Object(C.b)(Ur,jr)(ur=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=y()(this,(e=t.__proto__||p()(t)).call.apply(e,[this].concat(i))),n.state={visible:!1,title:"新增数据源",status:"add",source:{},params:{currentPage:1,pageSize:20,name:void 0,type:void 0,active:void 0}},n.searchDataSources=function(){var e;return(e=n).__searchDataSources__REACT_HOT_LOADER__.apply(e,arguments)},n.editDataSource=function(){var e;return(e=n).__editDataSource__REACT_HOT_LOADER__.apply(e,arguments)},n.remove=function(){var e;return(e=n).__remove__REACT_HOT_LOADER__.apply(e,arguments)},n.handleTableChange=function(){var e;return(e=n).__handleTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.initEdit=function(){var e;return(e=n).__initEdit__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},r=a,y()(n,r)}return g()(t,e),T()(t,[{key:"componentDidMount",value:function(){this.props.getDataSources(this.state.params)}},{key:"__searchDataSources__REACT_HOT_LOADER__",value:function(e){var t=j()({},this.state.params,{name:e||void 0,currentPage:1});this.setState({params:t}),this.props.getDataSources(t)}},{key:"__editDataSource__REACT_HOT_LOADER__",value:function(e,t){var a=this,n=this.state,r=n.title,s=n.status,i=n.source,o=n.params;"edit"===s?Ge.updateDataSource(j()({},i,e)).then(function(e){1===e.code&&(Gt.a.success(r+"成功！"),a.props.getDataSources(o))}):Ge.addDataSource(e).then(function(e){1===e.code&&(Gt.a.success(r+"成功！"),a.props.getDataSources(o))}),t.resetFields(),this.setState({visible:!1,source:{}})}},{key:"__remove__REACT_HOT_LOADER__",value:function(e){var t=this;1!==e.active?Ge.deleteDataSource({sourceId:e.id}).then(function(e){1===e.code&&(Gt.a.success("移除数据源成功！"),t.props.getDataSources(t.state.params))}):Gt.a.info("此数据源已在任务中被引用，无法删除!")}},{key:"__handleTableChange__REACT_HOT_LOADER__",value:function(e,t){var a=t.active,n=t.type,r=j()({},this.state.params,{currentPage:e.current,active:a?a[0]:void 0,type:n?n[0]:void 0});this.setState({params:r}),this.props.getDataSources(r)}},{key:"__initEdit__REACT_HOT_LOADER__",value:function(e){this.setState({visible:!0,title:"编辑数据源",status:"edit",source:e})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"数据源名称",dataIndex:"dataName",key:"dataName",width:"18%",render:function(e){return o.a.createElement("div",{className:"ellipsis-td",title:e},e)}},{title:"类型",dataIndex:"type",key:"type",filters:_e,filterMultiple:!1,width:"10%",render:function(e,t){return t.sourceTypeValue}},{title:"描述信息",dataIndex:"dataDesc",key:"dataDesc",width:"22%"},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"15%"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return re()(e).format("YYYY-MM-DD HH:mm:ss")},width:"15%"},{title:"状态",dataIndex:"active",key:"active",filters:[{text:"未启用",value:0},{text:"使用中",value:1}],filterMultiple:!1,render:function(e,t){return 1===t.active?"使用中":"未启用"},width:"10%"},{title:"操作",width:"10%",render:function(t,a){return o.a.createElement("span",null,o.a.createElement("a",{onClick:function(){e.initEdit(a)}},"编辑"),o.a.createElement("span",{className:"ant-divider"}),o.a.createElement(Yt.a,{title:"确定删除此数据源？",okText:"确定",cancelText:"取消",onConfirm:function(){e.remove(a)}},o.a.createElement("a",null,"删除")))}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.title,r=t.status,s=t.source,i=t.params,l=this.props.dataSource,c=l.sourceQuery,u=l.loading,_={current:i.currentPage,pageSize:i.pageSize,total:c.totalCount},d=o.a.createElement(Ir,{placeholder:"数据源名称",style:{width:200,margin:"10px 0"},onSearch:this.searchDataSources}),p=o.a.createElement(Qt.a,{type:"primary",style:{margin:"10px 0"},className:"right",onClick:function(){e.setState({visible:!0,source:{},status:"add",title:"添加数据源"})}},"新增数据源");return o.a.createElement("div",{className:"source-page"},o.a.createElement("h1",{className:"box-title"},"数据源管理"),o.a.createElement("div",{className:"box-2 m-card shadow"},o.a.createElement(B.a,{noHovering:!0,bordered:!1,title:d,extra:p},o.a.createElement(K.a,{rowKey:"id",loading:u,className:"m-table fixed-table",pagination:_,columns:this.initColumns(),dataSource:c.data,onChange:this.handleTableChange}))),o.a.createElement(xr,{title:n,status:r,visible:a,sourceData:s,editDataSource:this.editDataSource,handCancel:function(){e.setState({visible:!1,source:{}})}}))}}]),t}(i.Component))||ur,zr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ir,"Search","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(Ur,"mapStateToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(jr,"mapDispatchToProps","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(Mr,"DataSource","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/views/dataSource/index.js")),o.a.createElement(R.d,{path:"/",component:A.a},o.a.createElement(R.b,{component:et}),o.a.createElement(R.d,{path:"/message",component:O.a},o.a.createElement(R.b,{component:D.a}),o.a.createElement(R.d,{path:"list",component:D.a}),o.a.createElement(R.d,{path:"detail/:msgId",component:k.a})),o.a.createElement(R.d,{path:"/admin",component:S.a},o.a.createElement(R.b,{component:b.a}),o.a.createElement(R.d,{path:"user",component:b.a}),o.a.createElement(R.d,{path:"role",component:L.a}),o.a.createElement(R.d,{path:"role/add",component:w.a}),o.a.createElement(R.d,{path:"role/edit/:roleId",component:H.a})),o.a.createElement(R.d,{path:"/dq",component:et},o.a.createElement(R.b,{component:we}),o.a.createElement(R.d,{path:"overview",component:we}),o.a.createElement(R.d,{path:"taskQuery",component:Mt}),o.a.createElement(R.d,{path:"rule",component:Na}),o.a.createElement(R.d,{path:"rule/add",component:_n}),o.a.createElement(R.d,{path:"rule/edit/:id",component:_n}),o.a.createElement(R.d,{path:"dataCheck",component:On}),o.a.createElement(R.d,{path:"dataCheck/add",component:dr}),o.a.createElement(R.d,{path:"dataCheck/edit/:verifyId",component:dr}),o.a.createElement(R.d,{path:"dataCheck/report/:verifyRecordId",component:pr}),o.a.createElement(R.d,{path:"dataSource",component:Mr})))),Qr=zr,Fr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(zr,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/routers.js"),function(e){function t(){return h()(this,t),y()(this,(t.__proto__||p()(t)).apply(this,arguments))}return g()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.store,a=e.history;return o.a.createElement(C.a,{store:t},o.a.createElement(R.e,{routes:Qr,history:a,key:Math.random()}))}}]),t}(o.a.Component)),Gr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Fr,"Root","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/root.js"),function(e){var t=a(838).default,n=Object(_.a)(t,"hash"),r=n.store,s=n.history;c.a.render(o.a.createElement(u.AppContainer,null,o.a.createElement(e,{store:r,history:s})),document.getElementById("app"))});Gr(Fr);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Gr,"render","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/app.js")},864:function(e,t,a){},866:function(e,t,a){},879:function(e,t,a){},94:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(39),r=a.n(n)()(["CHANGE_LOADING","GET_DATA_SOURCES","GET_DATA_SOURCES_TYPE","GET_DATA_SOURCES_LIST","CHANGE_GETTABLE_LOADING","GET_DATA_SOURCES_TABLE","RESET_DATA_SOURCES_TABLE","GET_DATA_SOURCES_COLUMN","GET_DATA_SOURCES_PART","RESET_DATA_SOURCES_PART","GET_DATA_SOURCES_PREVIEW"],{prefix:"dataSource/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(r,"dataSourceActionType","/Users/ziv/Documents/workspace/data-stack/src/webapps/dataQuality/consts/dataSourceActionType.js")}},[[843,13,15,14,17,18,20,22,16]]]);