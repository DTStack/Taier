(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1921:function(e,a,t){"use strict";t.r(a);var n=t(8),r=t.n(n),i=t(4),s=t.n(i),l=t(6),o=t.n(l),d=t(1),c=t.n(d),u=t(5),p=t.n(u),f=t(0),m=t.n(f),h=t(1068),_=(t(81),t(42)),E=t.n(_),k=(t(70),t(27)),g=t.n(k),T=(t(60),t(16)),v=t.n(T),D=t(58),b=t.n(D),y=(t(110),t(48)),C=t.n(y),w=(t(90),t(33)),O=t.n(w),R=t(3),F=t.n(R),A=(t(144),t(73)),M=t.n(A),S=(t(61),t(17)),x=t.n(S),L=(t(68),t(20)),I=t.n(L),U=(t(72),t(21)),N=t.n(U),H=t(30),V=t(32),j=t(34),P=t(639),q=t(172),z=t(11),Y=t(502),W=N.a.Item,G=I.a.Option,Z=x.a.TextArea,J=M.a.Group,K=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.loadTaskTypes=function(){return t.__loadTaskTypes__REACT_HOT_LOADER__.apply(t,arguments)},t.handleTaskTypeChange=t.handleTaskTypeChange.bind(t),t.isEditExist=!1,t.state={value:0,operateModel:"",taskTypes:[]},t._resChange=!1,t}return p()(a,e),o()(a,[{key:"componentWillMount",value:function(){var e=this.props.defaultData;this.loadTaskTypes(),this.setState({operateModel:e&&e.operateModel?e.operateModel:z.f.RESOURCE})}},{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"handleResSelectTreeChange",value:function(e){this._resChange=!0,this.props.form.setFieldsValue({resourceIdList:e}),this.props.form.validateFields(["resourceIdList"])}},{key:"__loadTaskTypes__REACT_HOT_LOADER__",value:function(){var e=this;V.a.getTaskTypes().then(function(a){1===a.code&&e.setState({taskTypes:a.data||[]})})}},{key:"handleTaskTypeChange",value:function(e){this.setState({value:e})}},{key:"handleOperateModel",value:function(e){this.setState({operateModel:e.target.value})}},{key:"render",value:function(){var e=this.props.form,a=e.getFieldDecorator,t=(e.getFieldValue,this.props.defaultData),n=this.state,r=n.taskTypes,i=n.operateModel,s=void 0===t,l=!s&&void 0===t.id;this.isEditExist=!s&&!l;var o=s?this.state.value:l?this.state.value:t.taskType,d=r.map(function(e){return m.a.createElement(G,{key:e.key,value:e.key},e.value)}),c=m.a.createElement("div",null,"功能释义：",m.a.createElement("br",null),"向导模式：便捷、简单，可视化字段映射，快速完成同步任务配置",m.a.createElement("br",null),"脚本模式：全能 高效，可深度调优，支持全部数据源",m.a.createElement("br",null),m.a.createElement("a",{href:z.h.DATA_SOURCE,target:"blank"},"查看支持的数据源")),u=o===z.t.MR,p=o===z.t.PYTHON,f=o==z.t.SYNC,h=o==z.t.DEEP_LEARNING,_=o==z.t.PYTHON_23,E=u?z.o.JAR:p||_||h?z.o.PY:"",k=s?this.props.treeData.id:l?t.parentId:t.nodePid;return m.a.createElement(N.a,null,m.a.createElement(W,F()({},z.w,{label:"任务名称",hasFeedback:!0}),a("name",{rules:[{required:!0,message:"任务名称不可为空！"},{max:64,message:"任务名称不得超过64个字符！"},{pattern:/^[A-Za-z0-9_]+$/,message:"任务名称只能由字母、数字、下划线组成!"}],initialValue:s?void 0:l?void 0:t.name})(m.a.createElement(x.a,{placeholder:"请输入任务名称"}))),m.a.createElement(W,F()({},z.w,{label:"任务类型"}),a("taskType",{rules:[{required:!0,message:"请选择任务类型"}],initialValue:this.isEditExist?t.taskType:r.length>0&&r[0].key})(m.a.createElement(I.a,{disabled:!s&&!l,onChange:this.handleTaskTypeChange},d)),u&&m.a.createElement(C.a,{title:m.a.createElement("div",null,m.a.createElement("p",null,"支持基于Spark MLLib的机器学习任务"),m.a.createElement("p",null,"支持基于Spark API的Java处理程序"))},m.a.createElement(O.a,{className:"formItem_inline_icon",type:"question-circle-o"}))),h&&m.a.createElement(W,F()({},z.w,{label:"框架类型"}),a("learningType",{rules:[{required:!0,message:"请选择框架类型"}],initialValue:this.isEditExist?t.learningType:z.i.TENSORFLOW})(m.a.createElement(J,{disabled:!s&&!l},m.a.createElement(M.a,{key:z.i.TENSORFLOW,value:z.i.TENSORFLOW},"TensorFlow"),m.a.createElement(M.a,{key:z.i.MXNET,value:z.i.MXNET},"MXNet")))),(h||_)&&m.a.createElement("div",null,m.a.createElement(W,F()({},z.w,{label:"python版本"}),a("pythonVersion",{rules:[{required:!0,message:"请选择python版本"}],initialValue:this.isEditExist?t.pythonVersion:z.m.PYTHON2})(m.a.createElement(J,{disabled:!s&&!l},m.a.createElement(M.a,{key:z.m.PYTHON2,value:z.m.PYTHON2},"python2.x"),m.a.createElement(M.a,{key:z.m.PYTHON3,value:z.m.PYTHON3},"python3.x")))),m.a.createElement(W,F()({},z.w,{label:"操作模式"}),a("operateModel",{rules:[{required:!0,message:"请选择操作模式"}],initialValue:i})(m.a.createElement(J,{disabled:!s&&!l,onChange:this.handleOperateModel.bind(this)},m.a.createElement(M.a,{key:z.f.RESOURCE,value:z.f.RESOURCE},"资源上传"),m.a.createElement(M.a,{key:z.f.EDIT,value:z.f.EDIT},"WEB编辑"))))),h&&m.a.createElement("div",null,m.a.createElement(W,F()({},z.w,{label:"数据输入路径"}),a("input",{initialValue:this.isEditExist?t.input:""})(m.a.createElement(x.a,{placeholder:"请输入数据输入路径"})),m.a.createElement(P.a,{doc:"inputTaskHelp"})),m.a.createElement(W,F()({},z.w,{label:"模型输出路径"}),a("output",{initialValue:this.isEditExist?t.output:""})(m.a.createElement(x.a,{placeholder:"请输入模型输出路径"})),m.a.createElement(P.a,{doc:"outputTaskHelp"}))),(h||_)&&m.a.createElement(W,F()({},z.w,{label:"参数"}),a("options",{initialValue:this.isEditExist?t.options:""})(m.a.createElement(Z,{autosize:{minRows:2,maxRows:4},placeholder:"\b输入命令行参数，多个参数用空格隔开"}))),(u||p||(h||_)&&i==z.f.RESOURCE)&&m.a.createElement("span",null,m.a.createElement(W,F()({},z.w,{label:"资源",hasFeedback:!0}),a("resourceIdList",{rules:[{required:!0,message:"请选择关联资源"},{validator:this.checkNotDir.bind(this)}],initialValue:s?void 0:l?void 0:t.resourceList[0]&&t.resourceList[0].id})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.RESOURCE,ispicker:!0,placeholder:"请选择关联资源",isFilepicker:!0,acceptRes:E,treeData:this.props.resTreeData,onChange:this.handleResSelectTreeChange.bind(this),defaultNode:s?void 0:l?void 0:t.resourceList[0]&&t.resourceList[0].resourceName})),u&&m.a.createElement(W,F()({},z.w,{label:"mainClass",hasFeedback:!0}),a("mainClass",{rules:[{required:!0,message:"mainClass 不可为空！"},{pattern:/^[A-Za-z0-9_.-]+$/,message:"mainClass 只能由字母、数字、下划线、分隔点组成!"}],initialValue:s?void 0:l?void 0:t.mainClass})(m.a.createElement(x.a,{placeholder:"请输入 mainClass"}))),(u||p)&&m.a.createElement(W,F()({},z.w,{label:"参数",hasFeedback:!0}),a("exeArgs",{rules:[{pattern:/^[A-Za-z0-9_\/-]+$/,message:"任务参数只能由字母、数字、下划线、斜杠组成!"}],initialValue:s?void 0:l?void 0:t.exeArgs})(m.a.createElement(x.a,{placeholder:"请输入任务参数"})))),f&&m.a.createElement(W,F()({},z.w,{label:"配置模式"}),a("createModel",{rules:[{required:!0,message:"请选择配置模式"}],initialValue:this.isEditExist?t.createModel:z.e.GUIDE})(m.a.createElement(J,{disabled:!s&&!l},m.a.createElement(M.a,{key:z.e.GUIDE,value:z.e.GUIDE},"向导模式"),m.a.createElement(M.a,{key:z.e.SCRIPT,value:z.e.SCRIPT},"脚本模式"))),m.a.createElement(C.a,{placement:"right",title:c},m.a.createElement(O.a,{type:"question-circle-o"}))),m.a.createElement(W,F()({},z.w,{label:"存储位置"}),a("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:k})(m.a.createElement(Y.a,{ispicker:!0,id:"Task_dev_catalogue",type:z.k.TASK_DEV,treeData:this.props.treeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:s?this.props.treeData.name:l?this.getFolderName(t.parentId):this.getFolderName(t.nodePid)}))),m.a.createElement(W,F()({},z.w,{label:"描述",hasFeedback:!0}),a("taskDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:s?void 0:l?void 0:t.taskDesc})(m.a.createElement(x.a,{type:"textarea",rows:4,placeholder:"请输入任务描述"}))),m.a.createElement(W,{style:{display:"none"}},a("computeType",{initialValue:1})(m.a.createElement(x.a,{type:"hidden"}))))}},{key:"checkNotDir",value:function(e,a,t){var n=void 0;!function e(t){t.forEach(function(t,r){t.id===a?n=t.type:e(t.children||[])})}([this.props.resTreeData]),"folder"===n&&t("请选择具体文件, 而非文件夹"),t()}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.treeData]),a}}]),a}(m.a.Component),$=N.a.create()(K),B=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.handleCancel=t.handleCancel.bind(t),t.dtcount=0,t}return p()(a,e),o()(a,[{key:"handleSubmit",value:function(){var e=this,a=this.props,t=a.addOfflineTask,n=a.defaultData,r=this.form,i=void 0===n,s=!i&&void 0===n.id,l=!i&&!s;r.validateFields(function(a,i){a||(i.lockVersion=0,i.version=0,i.resourceIdList&&(i.resourceIdList=[i.resourceIdList]),n&&n.id&&(i.id=n.id,i.version=n.version,i.readWriteLockVO=b()({},n.readWriteLockVO)),t(i,l,n).then(function(a){a&&(v.a.success("操作成功"),r.resetFields(),e.closeModal())}))})}},{key:"handleCancel",value:function(){this.closeModal()}},{key:"closeModal",value:function(){this.props.toggleCreateTask(),this.props.emptyModalDefault(),this.dtcount++}},{key:"render",value:function(){var e=this,a=this.props,t=a.isModalShow,n=a.taskTreeData,r=a.resourceTreeData,i=a.defaultData,s=!0;return i&&i.name&&(s=!1),m.a.createElement("div",null,m.a.createElement(E.a,{title:s?"新建离线任务":"编辑离线任务",key:this.dtcount,visible:t,maskClosable:!1,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.handleCancel},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],onCancel:this.handleCancel},m.a.createElement($,{ref:function(a){return e.form=a},treeData:n,resTreeData:r,defaultData:i})))}}]),a}(m.a.Component),X=Object(H.b)(function(e){return{isModalShow:e.offlineTask.modalShow.createTask,taskTreeData:e.offlineTask.taskTree,currentTab:e.offlineTask.workbench.currentTab,defaultData:e.offlineTask.modalShow.defaultData,resourceTreeData:e.offlineTask.resourceTree}},function(e){var a=Object(q.b)(e);return{toggleCreateTask:function(){a.toggleCreateTask()},addOfflineTask:function(t,n,r){return V.a.addOfflineTask(t).then(function(t){if(1===t.code){if(n){var i=b()(r,t.data);i.originPid=r.nodePid,e({type:j.n.EDIT_FOLDER_CHILD,payload:i}),V.a.getOfflineTaskDetail({id:r.id}).then(function(e){1===e.code&&a.updateTabData(e.data)})}else a.openTaskInDev(t.data.id);return a.loadTreeNode(t.data.parentId,z.k.TASK_DEV),!0}})},emptyModalDefault:function(){e({type:j.f.EMPTY_MODAL_DEFAULT})}}})(B),Q=X,ee=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(W,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(G,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(Z,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(J,"RadioGroup","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(K,"TaskForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register($,"TaskFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(B,"TaskModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js"),__REACT_HOT_LOADER__.register(X,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/taskModal.js")),t(65)),ae=t.n(ee),te=N.a.Item,ne=I.a.Option,re=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.renderFormItem=function(){return t.__renderFormItem__REACT_HOT_LOADER__.apply(t,arguments)},t.changeFileType=t.changeFileType.bind(t),t.fileChange=t.fileChange.bind(t),t.state={file:"",accept:".jar",fileType:z.o.JAR},t}return p()(a,e),o()(a,[{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"handleCoverTargetChange",value:function(e){this.props.form.setFieldsValue({id:e}),this.props.form.validateFields(["id"])}},{key:"validateFileType",value:function(e,a,t){a&&!/\.(jar|sql|py|egg|zip)$/.test(a.toLocaleLowerCase())&&t("资源文件只能是Jar、SQL、egg、Zip或者Python文件!"),t()}},{key:"changeFileType",value:function(e){var a="";switch(e){case z.o.JAR:a=".jar";break;case z.o.PY:a=".py,.zip,.egg";break;default:a=""}this.setState({accept:a,fileType:e})}},{key:"fileChange",value:function(e){var a=e.target;this.setState({file:a}),this.props.handleFileChange(a)}},{key:"__renderFormItem__REACT_HOT_LOADER__",value:function(){var e=this.state.file,a=this.props.form.getFieldDecorator,t=this.props,n=t.defaultData,r=t.isEditExist,i=t.isCreateFromMenu,s=t.isCreateNormal;return t.isCoverUpload?[m.a.createElement(te,F()({},z.w,{label:"选择目标替换资源",key:"id",hasFeedback:!0}),a("id",{rules:[{required:!0,message:"替换资源为必选！"},{validator:this.checkNotDir.bind(this)}],initialValue:s?this.props.treeData.id:i?n.parentId:r?n.id:void 0})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.RESOURCE,ispicker:!0,isFilepicker:!0,treeData:this.props.treeData,onChange:this.handleCoverTargetChange.bind(this),defaultNode:s?this.props.treeData.name:i?this.getFolderName(n.parentId):r?n.name:void 0})),m.a.createElement(te,F()({},z.w,{label:"上传",key:"file",hasFeedback:!0}),a("file",{rules:[{required:!0,message:"请选择上传文件"},{validator:this.validateFileType}]})(m.a.createElement("div",null,m.a.createElement("label",{style:{lineHeight:"28px"},className:"ant-btn",htmlFor:"myOfflinFile"},"选择文件"),m.a.createElement("span",null," ",e.files&&e.files[0].name),m.a.createElement("input",{name:"file",type:"file",id:"myOfflinFile",onChange:this.fileChange,style:{display:"none"}})))),m.a.createElement(te,F()({},z.w,{label:"描述",key:"resourceDesc",hasFeedback:!0}),a("resourceDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:""})(m.a.createElement(x.a,{type:"textarea",rows:4})))]:[m.a.createElement(te,F()({},z.w,{label:"资源名称",hasFeedback:!0,key:"resourceName"}),a("resourceName",{rules:[{required:!0,message:"资源名称不可为空!"},{pattern:/^[A-Za-z0-9_-]+$/,message:"资源名称只能由字母、数字、下划线组成!"},{max:20,message:"资源名称不得超过20个字符!"}]})(m.a.createElement(x.a,{placeholder:"请输入资源名称"}))),m.a.createElement(te,F()({},z.w,{label:"资源类型",key:"resourceType",hasFeedback:!0}),a("resourceType",{rules:[{required:!0,message:"资源类型必选！"}],initialValue:z.o.JAR})(m.a.createElement(I.a,{onChange:this.changeFileType},m.a.createElement(ne,{key:z.o.JAR,value:z.o.JAR},"jar"),m.a.createElement(ne,{key:z.o.PY,value:z.o.PY},"python")))),m.a.createElement(te,F()({},z.w,{label:"上传",key:"file",hasFeedback:!0}),a("file",{rules:[{required:!0,message:"请选择上传文件"},{validator:this.validateFileType}]})(m.a.createElement("div",null,m.a.createElement("label",{style:{lineHeight:"28px"},className:"ant-btn",htmlFor:"myOfflinFile"},"选择文件"),m.a.createElement("span",null," ",e.files&&e.files[0].name),m.a.createElement("input",{name:"file",type:"file",id:"myOfflinFile",accept:this.state.accept,onChange:this.fileChange,style:{display:"none"}})))),m.a.createElement(te,F()({},z.w,{label:"选择存储位置",key:"nodePid",hasFeedback:!0}),a("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:s?this.props.treeData.id:i?n.parentId:void 0})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.RESOURCE,ispicker:!0,treeData:this.props.treeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:s?this.props.treeData.name:i?this.getFolderName(n.parentId):void 0})),m.a.createElement(te,F()({},z.w,{label:"描述",key:"resourceDesc",hasFeedback:!0}),a("resourceDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:""})(m.a.createElement(x.a,{type:"textarea",rows:4}))),m.a.createElement(te,{key:"computeType",style:{display:"none"}},a("computeType",{initialValue:1})(m.a.createElement(x.a,{type:"hidden"})))]}},{key:"render",value:function(){return m.a.createElement(N.a,null,this.renderFormItem())}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.treeData]),a}},{key:"checkNotDir",value:function(e,a,t){var n=void 0;!function e(t){t.forEach(function(t,r){t.id===a?n=t.type:e(t.children||[])})}([this.props.treeData]),"folder"===n&&t("请选择具体文件, 而非文件夹"),t()}}]),a}(m.a.Component),ie=N.a.create()(re),se=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.handleCancel=t.handleCancel.bind(t),t.state={file:""},t.dtcount=0,t}return p()(a,e),o()(a,[{key:"shouldComponentUpdate",value:function(e,a){return this.props!==e}},{key:"handleSubmit",value:function(){var e=this,a=this.form;a.validateFields(function(t,n){t||(n.file=e.state.file.files[0],e.props.addResource(n).then(function(t){t&&(e.closeModal(),e.setState({file:""}),a.resetFields())}))})}},{key:"handleCancel",value:function(){var e=this.props;e.isModalShow,e.toggleUploadModal;this.closeModal()}},{key:"closeModal",value:function(){this.dtcount++,this.props.toggleUploadModal(),this.props.emptyModalDefault()}},{key:"handleFileChange",value:function(e){this.setState({file:e})}},{key:"render",value:function(){var e=this,a=this.props,t=a.isModalShow,n=(a.toggleUploadModal,a.resourceTreeData),r=a.defaultData,i=a.isCoverUpload,s=void 0===r,l=!s&&void 0===r.id,o=!s&&!l;return m.a.createElement("div",null,m.a.createElement(E.a,{title:i?"替换离线资源":o?"编辑资源":"上传离线计算资源",visible:t,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.handleCancel},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],key:this.dtcount,onCancel:this.handleCancel},m.a.createElement(ie,{ref:function(a){return e.form=a},treeData:n,handleFileChange:this.handleFileChange.bind(this),defaultData:r,isCreateNormal:s,isCreateFromMenu:l,isCoverUpload:i,isEditExist:o})))}}]),a}(m.a.Component),le=Object(H.b)(function(e){return{isModalShow:e.offlineTask.modalShow.upload,isCoverUpload:e.offlineTask.modalShow.isCoverUpload,resourceTreeData:e.offlineTask.resourceTree,defaultData:e.offlineTask.modalShow.defaultData}},function(e){return{toggleUploadModal:function(){e({type:j.f.TOGGLE_UPLOAD})},addResource:function(a){return V.a.addOfflineResource(a).then(function(a){var t=a.data;if(1===a.code)return v.a.success("资源上传成功！"),e({type:j.g.ADD_FOLDER_CHILD,payload:t}),!0;v.a.success("资源上传异常！")})},emptyModalDefault:function(){e({type:j.f.EMPTY_MODAL_DEFAULT})}}})(se),oe=le,de=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(te,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js"),__REACT_HOT_LOADER__.register(ne,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js"),__REACT_HOT_LOADER__.register(re,"ResForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js"),__REACT_HOT_LOADER__.register(ie,"ResFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js"),__REACT_HOT_LOADER__.register(se,"ResModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js"),__REACT_HOT_LOADER__.register(le,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/uploadModal.js")),N.a.Item),ce=function(e){function a(e){return s()(this,a),c()(this,(a.__proto__||r()(a)).call(this,e))}return p()(a,e),o()(a,[{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a=this.props.defaultData,t=void 0===a;return m.a.createElement(N.a,null,m.a.createElement(de,F()({label:"目录名称"},z.w,{hasFeedback:!0}),e("nodeName",{rules:[{max:20,message:"项目名称不得超过20个字符！"},{required:!0,message:"文件夹名称不能为空"}],initialValue:t?void 0:a.name})(m.a.createElement(x.a,{type:"text",placeholder:"文件夹名称"}))),m.a.createElement(de,F()({label:"选择目录位置"},z.w),e("nodePid",{rules:[{required:!0,message:"请选择目录位置"}],initialValue:t?this.props.treeData.id:a.parentId})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:this.props.cateType,ispicker:!0,treeData:this.props.treeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:t?this.props.treeData.name:this.getFolderName(a.parentId)})))}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.treeData]),a}}]),a}(m.a.Component),ue=N.a.create()(ce),pe=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.handleCancel=t.handleCancel.bind(t),t.dtcount=0,t}return p()(a,e),o()(a,[{key:"handleSubmit",value:function(){var e=this,a=this.props,t=a.cateType,n=a.defaultData,r=this.form;r.validateFields(function(a,i){a||(e.isCreate?e.props.addOfflineCatalogue(i,t).then(function(a){a&&(e.closeModal(),r.resetFields())}):e.props.editOfflineCatalogue(ae()(i,{id:n.id}),n,t).then(function(a){a&&(e.closeModal(),r.resetFields())}))})}},{key:"handleCancel",value:function(){var e=this.props;e.isModalShow,e.toggleCreateFolder;this.closeModal()}},{key:"closeModal",value:function(){var e=this.props,a=e.toggleCreateFolder,t=e.emptyModalDefault;this.dtcount++,t(),a()}},{key:"getTreeData",value:function(e){switch(e){case z.k.TASK:case z.k.TASK_DEV:return this.props.taskTreeData;case z.k.RESOURCE:return this.props.resourceTreeData;case z.k.COSTOMFUC:case z.k.FUNCTION:case z.k.SYSFUC:return this.props.functionTreeData;case z.k.SCRIPT:return this.props.scriptTreeData;default:return this.props.taskTreeData}}},{key:"render",value:function(){var e=this,a=this.props,t=a.isModalShow,n=(a.toggleCreateFolder,a.cateType),r=a.defaultData;return r&&r.name?this.isCreate=!1:this.isCreate=!0,m.a.createElement("div",null,m.a.createElement(E.a,{title:this.isCreate?"新建文件夹":"编辑文件夹",visible:t,key:this.dtcount,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.handleCancel},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],onCancel:this.handleCancel},m.a.createElement(ue,{ref:function(a){return e.form=a},treeData:this.getTreeData(n),defaultData:r})))}}]),a}(m.a.Component),fe=Object(H.b)(function(e){var a=e.offlineTask;return{isModalShow:e.offlineTask.modalShow.createFolder,cateType:e.offlineTask.modalShow.cateType,defaultData:e.offlineTask.modalShow.defaultData,taskTreeData:a.taskTree,resourceTreeData:a.resourceTree,functionTreeData:a.functionTree,scriptTreeData:a.scriptTree}},function(e){var a=Object(q.b)(e);return{toggleCreateFolder:function(){e({type:j.f.TOGGLE_CREATE_FOLDER})},addOfflineCatalogue:function(e,t){return V.a.addOfflineCatalogue(e).then(function(n){if(1===n.code)return a.loadTreeNode(e.nodePid,t),!0})},editOfflineCatalogue:function(e,t,n){return V.a.editOfflineCatalogue(e).then(function(r){if(1===r.code){var i=t;switch(n){case z.k.TASK:case z.k.TASK_DEV:j.n;break;case z.k.RESOURCE:j.g;break;case z.k.FUNCTION:case z.k.SYSFUC:case z.k.COSTOMFUC:j.d;break;case z.k.SCRIPT:j.h;break;default:j.n}return i.name=e.nodeName,i.originPid=t.parentId,i.parentId=e.nodePid,a.loadTreeNode(e.nodePid,z.k.TASK_DEV),!0}})},emptyModalDefault:function(){e({type:j.f.EMPTY_MODAL_DEFAULT})}}})(pe),me=fe,he=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(de,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/folderModal.js"),__REACT_HOT_LOADER__.register(ce,"FolderForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/folderModal.js"),__REACT_HOT_LOADER__.register(ue,"FolderFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/folderModal.js"),__REACT_HOT_LOADER__.register(pe,"FolderModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/folderModal.js"),__REACT_HOT_LOADER__.register(fe,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/folderModal.js")),N.a.Item),_e=I.a.Option,Ee=function(e){function a(e){return s()(this,a),c()(this,(a.__proto__||r()(a)).call(this,e))}return p()(a,e),o()(a,[{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"handleResSelectTreeChange",value:function(e){this.props.form.setFieldsValue({resources:e}),this.props.form.validateFields(["resources"])}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a=this.props,t=a.defaultData,n=(a.isEditExist,a.isCreateFromMenu),r=a.isCreateNormal,i={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}};return m.a.createElement(N.a,null,m.a.createElement(he,F()({},i,{label:"函数名称",hasFeedback:!0}),e("name",{rules:[{required:!0,message:"函数名称不可为空！"},{pattern:/^[A-Za-z0-9_-]+$/,message:"函数名称只能由字母、数字、下划线组成!"},{max:20,message:"函数名称不得超过20个字符！"}]})(m.a.createElement(x.a,{placeholder:"请输入函数名称"}))),m.a.createElement(he,F()({},i,{label:"类名",hasFeedback:!0}),e("className",{rules:[{required:!0,message:"类名不能为空"},{pattern:/^[a-zA-Z]+[0-9a-zA-Z_]*(\.[a-zA-Z]+[0-9a-zA-Z_]*)*$/,message:"请输入有效的类名!"}]})(m.a.createElement(x.a,{placeholder:"请输入类名"}))),m.a.createElement(he,F()({},i,{label:"资源",hasFeedback:!0}),e("resources",{rules:[{required:!0,message:"请选择关联资源"},{validator:this.checkNotDir.bind(this)}]})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.RESOURCE,ispicker:!0,isFilepicker:!0,treeData:this.props.resTreeData,onChange:this.handleResSelectTreeChange.bind(this)})),m.a.createElement(he,F()({},i,{label:"用途",hasFeedback:!0}),e("purpose")(m.a.createElement(x.a,{placeholder:""}))),m.a.createElement(he,F()({},i,{label:"命令格式",hasFeedback:!0}),e("commandFormate",{rules:[{max:200,message:"描述请控制在200个字符以内！"}]})(m.a.createElement(x.a,{type:"textarea",rows:4,placeholder:"请输入函数的命令格式，例如：datetime dateadd(datetime date, bigint delta, string datepart)"}))),m.a.createElement(he,F()({},i,{label:"参数说明",hasFeedback:!0}),e("paramDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}]})(m.a.createElement(x.a,{type:"textarea",rows:4,placeholder:"请输入函数的参数说明"}))),m.a.createElement(he,F()({},i,{label:"选择存储位置",hasFeedback:!0}),e("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:r?this.props.functionTreeData.id:n?t.parentId:void 0})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.FUNCTION,ispicker:!0,treeData:this.props.functionTreeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:r?this.props.functionTreeData.name:n?this.getFolderName(t.parentId):void 0})))}},{key:"checkNotDir",value:function(e,a,t){var n=void 0;!function e(t){t.forEach(function(t,r){t.id===a?n=t.type:e(t.children||[])})}([this.props.resTreeData]),"folder"===n&&t("请选择具体文件, 而非文件夹"),t()}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.functionTreeData]),a}}]),a}(m.a.Component),ke=N.a.create()(Ee),ge=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.handleCancel=t.handleCancel.bind(t),t.dtcount=0,t}return p()(a,e),o()(a,[{key:"shouldComponentUpdate",value:function(e,a){return this.props!==e}},{key:"handleSubmit",value:function(){var e=this,a=this.props,t=(a.isModalShow,a.toggleCreateFn,a.addFn),n=this.form;n.validateFields(function(a,r){a||t(r).then(function(a){a&&(e.closeModal(),n.resetFields())})})}},{key:"handleCancel",value:function(){this.props.toggleCreateFn;this.closeModal()}},{key:"closeModal",value:function(){this.dtcount++,this.props.emptyModalDefault(),this.props.toggleCreateFn()}},{key:"render",value:function(){var e=this,a=this.props,t=a.isModalShow,n=(a.toggleCreateFn,a.functionTreeData),r=a.resTreeData,i=a.defaultData,s=void 0===i,l=!s&&void 0===i.id,o=!s&&!l;return m.a.createElement("div",null,m.a.createElement(E.a,{title:"创建函数",visible:t,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.handleCancel},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],key:this.dtcount,onCancel:this.handleCancel},m.a.createElement(ke,{ref:function(a){return e.form=a},functionTreeData:n,resTreeData:r,isCreateFromMenu:l,isCreateNormal:s,isEditExist:o,defaultData:i})))}}]),a}(m.a.Component),Te=Object(H.b)(function(e){return{isModalShow:e.offlineTask.modalShow.createFn,functionTreeData:e.offlineTask.functionTree,resTreeData:e.offlineTask.resourceTree,defaultData:e.offlineTask.modalShow.defaultData}},function(e){return{toggleCreateFn:function(){e({type:j.f.TOGGLE_CREATE_FN})},addFn:function(a){return V.a.addOfflineFunction(a).then(function(a){var t=a.data;if(1===a.code)return e({type:j.d.ADD_FOLDER_CHILD,payload:t}),!0})},emptyModalDefault:function(){e({type:j.f.EMPTY_MODAL_DEFAULT})}}})(ge),ve=Te,De=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(he,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js"),__REACT_HOT_LOADER__.register(_e,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js"),__REACT_HOT_LOADER__.register(Ee,"FnForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js"),__REACT_HOT_LOADER__.register(ke,"FnFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js"),__REACT_HOT_LOADER__.register(ge,"FnModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js"),__REACT_HOT_LOADER__.register(Te,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnModal.js")),N.a.Item),be=I.a.Option,ye=function(e){function a(e){return s()(this,a),c()(this,(a.__proto__||r()(a)).call(this,e))}return p()(a,e),o()(a,[{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a=this.props,t=a.originFn,n=a.isVisible,r=t.parentId,i=t.name;t.functionId;return n?m.a.createElement(N.a,null,m.a.createElement(De,F()({},z.w,{label:"函数名称",hasFeedback:!0}),e("name",{rules:[{required:!0,message:"函数名称不可为空！"},{max:20,message:"函数名称不得超过20个字符！"}],initialValue:i})(m.a.createElement(x.a,{disabled:!0,placeholder:"请输入函数名称"}))),m.a.createElement(De,F()({},z.w,{label:"选择存储位置",hasFeedback:!0}),e("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:r})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.FUNCTION,ispicker:!0,treeData:this.props.functionTreeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:this.getFolderName(r)}))):null}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.functionTreeData]),a}}]),a}(m.a.Component),Ce=N.a.create()(ye),we=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.handleCancel=t.handleCancel.bind(t),t.dtcount=0,t}return p()(a,e),o()(a,[{key:"shouldComponentUpdate",value:function(e,a){return this.props!==e}},{key:"handleSubmit",value:function(){var e=this,a=this.props,t=a.doMoveFn,n=a.moveFnData,r=n.originFn.id;this.form.validateFields(function(a,i){a||(i.functionId=r,delete i.name,t(i,n.originFn).then(function(a){a&&e.closeModal()}))})}},{key:"handleCancel",value:function(){this.closeModal()}},{key:"closeModal",value:function(){this.dtcount++,this.props.toggleMoveFn()}},{key:"render",value:function(){var e=this,a=this.props,t=a.moveFnData,n=(a.toggleMoveFn,a.functionTreeData),r=void 0!==t;return m.a.createElement("div",null,m.a.createElement(E.a,{title:"移动函数",visible:r,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.handleCancel},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],key:this.dtcount,onCancel:this.handleCancel},m.a.createElement(Ce,F()({ref:function(a){return e.form=a},functionTreeData:n},t))))}}]),a}(m.a.Component),Oe=Object(H.b)(function(e){return{moveFnData:e.offlineTask.modalShow.moveFnData,functionTreeData:e.offlineTask.functionTree}},function(e){return{toggleMoveFn:function(){e({type:j.f.TOGGLE_MOVE_FN})},doMoveFn:function(a,t){return V.a.moveOfflineFn(a).then(function(n){if(1===n.code){var r=t;return r.originPid=t.parentId,r.parentId=a.nodePid,e({type:j.d.EDIT_FOLDER_CHILD,payload:r}),!0}})}}})(we),Re=Oe,Fe=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(De,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js"),__REACT_HOT_LOADER__.register(be,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js"),__REACT_HOT_LOADER__.register(ye,"FnMoveForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js"),__REACT_HOT_LOADER__.register(Ce,"FnMoveFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js"),__REACT_HOT_LOADER__.register(we,"FnMoveModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js"),__REACT_HOT_LOADER__.register(Oe,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnMoveModal.js")),t(201),t(126)),Ae=t.n(Fe),Me=t(23),Se=t.n(Me),xe=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.state={loading:!0,data:void 0},t}return p()(a,e),o()(a,[{key:"componentWillReceiveProps",value:function(e){e.fnId!==this.props.fnId&&this.getFnDetail(e.fnId)}},{key:"getFnDetail",value:function(e){var a=this;e&&V.a.getOfflineFn({functionId:e}).then(function(e){1===e.code&&a.setState({data:e.data}),a.setState({loading:!1})})}},{key:"render",value:function(){var e=this.props,a=e.visible,t=e.fnId,n=e.closeModal,r=this.state,i=r.data,s=r.loading;return m.a.createElement(E.a,{title:"函数详情",visible:a,onCancel:n,key:t,footer:[m.a.createElement(g.a,{size:"large",onClick:n,key:"cancel"},"取消")]},s?m.a.createElement(Ae.a,null):null===i?"系统异常":m.a.createElement("table",{className:"ant-table ant-table-bordered bd-top bd-left",style:{width:"100%"}},m.a.createElement("tbody",{className:"ant-table-tbody"},m.a.createElement("tr",null,m.a.createElement("td",{width:"15%"},"函数名称"),m.a.createElement("td",null,i.name)),m.a.createElement("tr",null,m.a.createElement("td",null,"用途"),m.a.createElement("td",null,i.purpose)),m.a.createElement("tr",null,m.a.createElement("td",null,"命令格式"),m.a.createElement("td",null,i.commandFormate||"/")),m.a.createElement("tr",null,m.a.createElement("td",null,"参数说明"),m.a.createElement("td",null,i.paramDesc||"/")),m.a.createElement("tr",null,m.a.createElement("td",null,"创建"),m.a.createElement("td",null,i.createUser.userName," 于 ",Se()(i.gmtCreate).format("YYYY-MM-DD hh:mm:ss"))),m.a.createElement("tr",null,m.a.createElement("td",null,"最后修改"),m.a.createElement("td",null,i.modifyUser.userName," 于 ",Se()(i.gmtModified).format("YYYY-MM-DD hh:mm:ss"))))))}}]),a}(m.a.Component),Le=Object(H.b)(function(e){var a=e.offlineTask.modalShow;return{visible:a.fnViewModal,fnId:a.fnId}},function(e){return{closeModal:function(){e({type:j.f.HIDE_FNVIEW_MODAL})}}})(xe),Ie=Le,Ue=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(xe,"FnViewModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnViewModal.js"),__REACT_HOT_LOADER__.register(Le,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/fnViewModal.js")),t(18)),Ne=t(103),He=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.state={loading:!0,data:void 0},t}return p()(a,e),o()(a,[{key:"componentWillReceiveProps",value:function(e){e.resId!==this.props.resId&&this.getResDetail(e.resId)}},{key:"getResDetail",value:function(e){var a=this;e&&V.a.getOfflineRes({resourceId:e}).then(function(e){1===e.code&&a.setState({loading:!1,data:e.data})})}},{key:"render",value:function(){var e=this.props,a=e.visible,t=e.resId,n=e.closeModal,r=this.state,i=r.data,s=r.loading;return m.a.createElement(E.a,{title:"资源详情",visible:a,onCancel:n,key:t,footer:[m.a.createElement(g.a,{size:"large",onClick:n,key:"cancel"},"取消")]},s?m.a.createElement(Ae.a,null):null===i?"系统异常":m.a.createElement("table",{className:"ant-table ant-table-bordered bd-top bd-left",style:{width:"100%"}},m.a.createElement("tbody",{className:"ant-table-tbody"},m.a.createElement("tr",null,m.a.createElement("td",{width:"15%"},"资源名称"),m.a.createElement("td",null,i.resourceName)),m.a.createElement("tr",null,m.a.createElement("td",null,"资源描述"),m.a.createElement("td",null,i.resourceDesc)),m.a.createElement("tr",null,m.a.createElement("td",null,"资源类型"),m.a.createElement("td",null," ",m.a.createElement(Ne.f,{value:i.resourceType}))),m.a.createElement("tr",null,m.a.createElement("td",null,"创建"),m.a.createElement("td",null,i.createUser.userName," 于 ",Ue.a.formatDateTime(i.gmtCreate))),m.a.createElement("tr",null,m.a.createElement("td",null,"修改时间"),m.a.createElement("td",null,Ue.a.formatDateTime(i.gmtModified))))))}}]),a}(m.a.Component),Ve=Object(H.b)(function(e){var a=e.offlineTask.modalShow;return{visible:a.resViewModal,resId:a.resId}},function(e){return{closeModal:function(){e({type:j.f.HIDE_RESVIEW_MODAL})}}})(He),je=Ve,Pe=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(He,"ResViewModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/resViewModal.js"),__REACT_HOT_LOADER__.register(Ve,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/resViewModal.js")),N.a.Item),qe=I.a.Optioin,ze=M.a.Group,Ye=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.loadScritTypes=function(){return t.__loadScritTypes__REACT_HOT_LOADER__.apply(t,arguments)},t.handleRadioChange=t.handleRadioChange.bind(t),t.isEditExist=!1,t.state={value:0,types:[]},t}return p()(a,e),o()(a,[{key:"componentDidMount",value:function(){this.loadScritTypes()}},{key:"__loadScritTypes__REACT_HOT_LOADER__",value:function(){var e=this;V.a.getScriptTypes().then(function(a){e.setState({types:a.data||[]})})}},{key:"handleSelectTreeChange",value:function(e){this.props.form.setFieldsValue({nodePid:e})}},{key:"handleRadioChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a=this.props.defaultData,t=this.state.types,n=void 0===a,r=!n&&void 0===a.id;this.isEditExist=!n&&!r;var i=n?this.state.value:r?this.state.value:a.taskType,s=t.map(function(e){return m.a.createElement(M.a,{key:e.value,value:e.value},e.name)});return m.a.createElement(N.a,null,m.a.createElement(Pe,F()({},z.w,{label:"脚本名称",hasFeedback:!0}),e("name",{rules:[{required:!0,message:"脚本名称不可为空！"},{max:64,message:"脚本名称不得超过20个字符！"},{pattern:/^[A-Za-z0-9_-]+$/,message:"脚本名称只能由字母、数字、下划线组成!"}],initialValue:n?void 0:r?void 0:a.name})(m.a.createElement(x.a,{placeholder:"请输入脚本名称"}))),m.a.createElement(Pe,F()({},z.w,{label:"脚本类型"}),e("type",{rules:[{required:!0,message:"请选择任务类型"}],initialValue:t.length>0?t[0].value:i})(m.a.createElement(ze,{disabled:!n&&!r,onChange:this.handleRadioChange},s))),m.a.createElement(Pe,F()({},z.w,{label:"存储位置"}),e("nodePid",{rules:[{required:!0,message:"存储位置必选！"}],initialValue:n?this.props.treeData.id:r?a.parentId:a.nodePid})(m.a.createElement(x.a,{type:"hidden"})),m.a.createElement(Y.a,{type:z.k.SCRIPT,ispicker:!0,treeData:this.props.treeData,onChange:this.handleSelectTreeChange.bind(this),defaultNode:n?this.props.treeData.name:r?this.getFolderName(a.parentId):this.getFolderName(a.nodePid)})),m.a.createElement(Pe,F()({},z.w,{label:"描述",hasFeedback:!0}),e("scriptDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:n?void 0:r?void 0:a.scriptDesc})(m.a.createElement(x.a,{type:"textarea",rows:4,placeholder:"请输入脚本描述"}))))}},{key:"checkNotDir",value:function(e,a,t){var n=void 0;!function e(t){t.forEach(function(t,r){t.id===a?n=t.type:e(t.children||[])})}([this.props.resTreeData]),"folder"===n&&t("请选择具体文件, 而非文件夹"),t()}},{key:"getFolderName",value:function(e){var a=void 0;return function t(n){n.forEach(function(n,r){n.id===e?a=n.name:t(n.children||[])})}([this.props.treeData]),a}}]),a}(m.a.Component),We=N.a.create()(Ye),Ge=function(e){function a(e){s()(this,a);var t=c()(this,(a.__proto__||r()(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.closeModal=t.closeModal.bind(t),t.dtcount=0,t}return p()(a,e),o()(a,[{key:"handleSubmit",value:function(){var e=this,a=this.props.defaultData,t=this.form,n=void 0===a,r=!n&&void 0===a.id,i=!n&&!r;t.validateFields(function(n,r){n||(r.resourceIdList&&(r.resourceIdList=[r.resourceIdList]),void 0!==a&&void 0!==a.id&&(r.id=a.id,r.version=a.version,r.readWriteLockVO=b()({},a.readWriteLockVO)),e.props.createScript(r,i,a).then(function(a){a&&(e.closeModal(),t.resetFields())}))})}},{key:"closeModal",value:function(){this.dtcount++,this.props.emptyModalDefault(),this.props.toggleCreateScript()}},{key:"render",value:function(){var e=this,a=this.props,t=a.isModalShow,n=a.scriptTreeData,r=a.defaultData;return r&&r.name?this.isCreate=!1:this.isCreate=!0,m.a.createElement("div",null,m.a.createElement(E.a,{title:this.isCreate?"新建脚本":"编辑脚本",visible:t,footer:[m.a.createElement(g.a,{key:"back",size:"large",onClick:this.closeModal},"取消"),m.a.createElement(g.a,{key:"submit",type:"primary",size:"large",onClick:this.handleSubmit}," 确认 ")],onCancel:this.closeModal},m.a.createElement(We,{ref:function(a){return e.form=a},treeData:n,defaultData:r})))}}]),a}(m.a.Component),Ze=Object(H.b)(function(e){return{isModalShow:e.offlineTask.modalShow.createScript,scriptTreeData:e.offlineTask.scriptTree,defaultData:e.offlineTask.modalShow.defaultData}},function(e){return{toggleCreateScript:function(){e({type:j.f.TOGGLE_CREATE_SCRIPT})},createScript:function(a,t,n){return V.a.saveScript(a).then(function(a){if(1===a.code)return V.a.getScriptById({id:a.data.id}).then(function(r){if(t){var i=b()(n,a.data);i.originPid=n.nodePid,e({type:j.h.EDIT_FOLDER_CHILD,payload:i}),e({type:j.o.SET_TASK_FIELDS_VALUE,payload:r.data})}else{var s=a.data;s.catalogueType&&(s.catalogueType=z.k.SCRIPT),e({type:j.h.ADD_FOLDER_CHILD,payload:s}),e({type:j.o.LOAD_TASK_DETAIL,payload:r.data}),e({type:j.o.OPEN_TASK_TAB,payload:r.data.id})}}),!0})},emptyModalDefault:function(){e({type:j.f.EMPTY_MODAL_DEFAULT})}}})(Ge),Je=Ze;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Pe,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(qe,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(ze,"RadioGroup","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(Ye,"ScriptForm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(We,"ScriptFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(Ge,"ScriptModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"),__REACT_HOT_LOADER__.register(Ze,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/scriptModal.js"));t.d(a,"default",function(){return Ke});var Ke=function(e){function a(){return s()(this,a),c()(this,(a.__proto__||r()(a)).apply(this,arguments))}return p()(a,e),o()(a,[{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(Q,null),m.a.createElement(oe,null),m.a.createElement(me,null),m.a.createElement(ve,null),m.a.createElement(Re,null),m.a.createElement(Ie,null),m.a.createElement(je,null),m.a.createElement(Je,null),m.a.createElement(h.default,null))}}]),a}(m.a.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ke,"Offline","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/rdos/views/task/offline/index.js")}}]);