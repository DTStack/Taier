(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{108:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["CHANGE_LOADING","GET_DATA_SOURCES","GET_DATA_SOURCES_TYPE","GET_DATA_SOURCES_LIST","GET_TAG_DATA_SOURCES_LIST","GET_DATA_SOURCES_TABLE","RESET_DATA_SOURCES_TABLE","GET_DATA_SOURCES_COLUMN","RESET_DATA_SOURCES_COLUMN","GET_DATA_SOURCES_PREVIEW"],{prefix:"dataSource/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"dataSourceActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/dataSourceActionType.js")},152:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(4),i=a.n(n),r=a(0),s=a.n(r);function o(e){var t=e.style,a=i()({},{textIndent:"5px",backgroundColor:"transparent",backgroundImage:"none",width:"100%",border:"none"},t);return s.a.createElement("textarea",i()({},e,{style:a}))}"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(o,"TableCell","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/widgets/tableCell/index.js")},172:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["CHANGE_LOADING","GET_RULE_TAG_LIST","GET_REGISTERED_TAG_LIST","GET_ALL_IDENTIFY_COLUMN"],{prefix:"tagConfig/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"tagConfigActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/tagConfigActionType.js")},185:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["GET_CATALOGUE","GET_API_MARKET_LIST","GET_MARKET_API_DETAIL","GET_API_EXT_INFO"],{prefix:"apiMarket/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"apiMarketActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/apiMarketActionType.js")},208:function(e,t,a){"use strict";var n=a(35),i=a.n(n)()(["GET_USER_LIST","GET_ALL_MENU_LIST","GET_PERIOD_TYPE","GET_NOTIFY_TYPE"],{prefix:"common/"}),r=i;t.a=r;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(i,"commonActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/commonActionType.js"),__REACT_HOT_LOADER__.register(r,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/commonActionType.js"))},402:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["GET_APPLYING_LIST","GET_APPLYED_LIST"],{prefix:"mine/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"mineActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/mineActionType.js")},587:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["GET_ALL_APPLY_LIST"],{prefix:"approval/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"approvalActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/approvalActionType.js")},588:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(35),i=a.n(n)()(["GET_ALL_API_LIST"],{prefix:"apiManage/"});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(i,"apiManageActionType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/apiManageActionType.js")},863:function(e,t,a){"use strict";a.r(t);var n=a(62),i=a(106),r=a(154),s=a(127),o=a(108),l=a(11),u={loading:!1,sourceQuery:[],sourceType:[],sourceList:[],tagSourceList:[],sourceTable:[],sourceColumn:[],sourcePart:[],sourcePreview:{}};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments[1],a=t.type,n=t.payload;switch(a){case o.a.CHANGE_LOADING:var i=Object(l.cloneDeep)(e),r=i.loading;return i.loading=!r,i;case o.a.GET_DATA_SOURCES:var s=Object(l.cloneDeep)(e);s.sourceQuery;return s.sourceQuery=n,s;case o.a.GET_DATA_SOURCES_TYPE:var c=Object(l.cloneDeep)(e);c.sourceType;return c.sourceType=n,c;case o.a.GET_DATA_SOURCES_LIST:var p=Object(l.cloneDeep)(e);p.sourceList;return p.sourceList=n,p;case o.a.GET_TAG_DATA_SOURCES_LIST:var d=Object(l.cloneDeep)(e);d.tagSourceList;return d.tagSourceList=n,d;case o.a.GET_DATA_SOURCES_TABLE:var _=Object(l.cloneDeep)(e);_.sourceTable;return _.sourceTable=n,_;case o.a.RESET_DATA_SOURCES_TABLE:var m=Object(l.cloneDeep)(e);m.sourceTable;return m.sourceTable=[],m;case o.a.GET_DATA_SOURCES_COLUMN:var g=Object(l.cloneDeep)(e);g.sourceColumn;return g.sourceColumn=n,g;case o.a.RESET_DATA_SOURCES_COLUMN:var h=Object(l.cloneDeep)(e);h.sourceColumn;return h.sourceColumn=[],h;case o.a.GET_DATA_SOURCES_PREVIEW:var E=Object(l.cloneDeep)(e);E.sourcePreview;return E.sourcePreview=n,E;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(u,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/dataSource/index.js"),__REACT_HOT_LOADER__.register(c,"dataSource","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/dataSource/index.js"));var p=a(208),d={userList:[],menuList:[],periodType:[],notifyType:[]};function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1],a=t.type,n=t.payload;switch(a){case p.a.GET_USER_LIST:var i=Object(l.cloneDeep)(e);i.userList;return i.userList=n,i;case p.a.GET_ALL_MENU_LIST:var r=Object(l.cloneDeep)(e);r.menuList;return r.menuList=n,r;case p.a.GET_PERIOD_TYPE:var s=Object(l.cloneDeep)(e);s.periodType;return s.periodType=n,s;case p.a.GET_NOTIFY_TYPE:var o=Object(l.cloneDeep)(e);o.notifyType;return o.notifyType=n,o;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(d,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/common.js"),__REACT_HOT_LOADER__.register(_,"common","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/common.js"));var m=a(172),g={loading:!1,ruleTagList:[],registeredTagList:[],identifyColumn:[]};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments[1],a=t.type,n=t.payload;switch(a){case m.a.CHANGE_LOADING:var i=Object(l.cloneDeep)(e),r=i.loading;return i.loading=!r,i;case m.a.GET_RULE_TAG_LIST:var s=Object(l.cloneDeep)(e);s.ruleTagList;return s.ruleTagList=n,s;case m.a.GET_REGISTERED_TAG_LIST:var o=Object(l.cloneDeep)(e);o.registeredTagList;return o.registeredTagList=n,o;case m.a.GET_ALL_IDENTIFY_COLUMN:var u=Object(l.cloneDeep)(e);u.identifyColumn;return u.identifyColumn=n,u;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(g,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/tagConfig/index.js"),__REACT_HOT_LOADER__.register(h,"tagConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/tagConfig/index.js"));var E=a(185),f={apiCatalogue:[],apiList:[],api:{},apiCallInfo:{}};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments[1],a=t.type,n=t.payload;switch(a){case E.a.GET_CATALOGUE:var i=Object(l.cloneDeep)(e);return i.apiCatalogue=n,i;case E.a.GET_API_MARKET_LIST:var r=Object(l.cloneDeep)(e);return r.apiList=n,r;case E.a.GET_MARKET_API_DETAIL:var s=Object(l.cloneDeep)(e);return s.api[n.apiId]=n,s;case E.a.GET_API_EXT_INFO:var o=Object(l.cloneDeep)(e);return o.apiCallInfo[n.apiId]=n,o;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(f,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/apiMarket/index.js"),__REACT_HOT_LOADER__.register(T,"apiMarket","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/apiMarket/index.js"));var A=a(402),y={apiList:{applyingList:[],appliedList:[]}};function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments[1],a=t.type,n=t.payload;switch(a){case A.a.GET_APPLYING_LIST:var i=Object(l.cloneDeep)(e);return i.apiList.applyingList=n,i;case A.a.GET_APPLYED_LIST:var r=Object(l.cloneDeep)(e);return r.apiList.appliedList=n,r;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(y,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/mine/index.js"),__REACT_HOT_LOADER__.register(C,"mine","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/mine/index.js"));var b=a(588),v={apiList:[]};function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments[1],a=t.type,n=t.payload;switch(a){case b.a.GET_ALL_API_LIST:var i=Object(l.cloneDeep)(e);return i.apiList=n,i;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(v,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/apiManage/index.js"),__REACT_HOT_LOADER__.register(D,"apiManage","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/apiManage/index.js"));var k=a(587),O={approvalList:[]};function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments[1],a=t.type,n=t.payload;switch(a){case k.a.GET_ALL_APPLY_LIST:var i=Object(l.cloneDeep)(e);return i.approvalList=n,i;default:return e}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(O,"initialState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/approval/index.js"),__REACT_HOT_LOADER__.register(R,"apiMarket","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/modules/approval/index.js"));var L=Object(n.c)({routing:i.routerReducer,user:r.a,app:s.a,apps:s.b,tagConfig:h,dataSource:c,common:_,apiMarket:T,mine:C,apiManage:D,approval:R}),S=L;t.default=S,"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(L,"rootReducer","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/index.js"),__REACT_HOT_LOADER__.register(S,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/reducers/index.js"))},872:function(e,t,a){"use strict";a.r(t);var n={};a.d(n,"dataFilterDoc",function(){return Qi}),a.d(n,"switchKey",function(){return Ji}),a.d(n,"hdfsPath",function(){return Wi}),a.d(n,"jobSpeedLimit",function(){return Xi}),a.d(n,"jobConcurrence",function(){return Zi}),a.d(n,"errorCount",function(){return $i}),a.d(n,"hdfsConfig",function(){return er}),a.d(n,"rdbConfig",function(){return tr}),a.d(n,"hBaseConfig",function(){return ar}),a.d(n,"recordDirtyData",function(){return nr}),a.d(n,"errorPercentConfig",function(){return ir});var i,r=a(0),s=a.n(r),o=a(59),l=a.n(o),u=a(183),c=a(155),p=a(8),d=a.n(p),_=a(5),m=a.n(_),g=a(7),h=a.n(g),E=a(1),f=a.n(E),T=a(6),A=a.n(T),y=a(14),C=a(21),b=(a(218),a(357),a(216),a(214),a(882),a(134),a(73),a(116),a(171)),v=a(164),D=a(125),k=a(169),O=a(168),R=a(126),L=a(167),S=a(166),w=a(165),x=a(2),I=a.n(x),H=a(12),N=a(3),P=a(4),U=a.n(P),j=(a(61),a(23)),M=a.n(j),G=a(94),V=Object(C.b)(function(e){return{user:e.user,apps:e.apps,routing:e.routing,app:e.app,common:e.common}})(i=function(e){function t(e){m()(this,t);var a=f()(this,(t.__proto__||d()(t)).call(this,e));return a.state={},a}return A()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=(e.user,e.apps,e.common),a="/dataLabel.html#",n=[{id:"dl/market",name:"标签市场",link:a+"/dl/market",enable:t.menuList.indexOf("tag_market_menu")>-1},{id:"dl/mine",name:"我的标签",link:a+"/dl/mine",enable:t.menuList.indexOf("tag_mytag_menu")>-1},{id:"dl/tagConfig",name:"标签配置",link:a+"/dl/tagConfig",enable:t.menuList.indexOf("tag_config_menu")>-1},{id:"dl/approval",name:"审批授权",link:a+"/dl/approval",enable:t.menuList.indexOf("tag_authorized_menu")>-1},{id:"dl/manage",name:"服务管理",link:a+"/dl/manage",enable:t.menuList.indexOf("tag_service_menu")>-1},{id:"dl/dataSource",name:"数据源管理",link:a+"/dl/dataSource",enable:t.menuList.indexOf("datasource_menu")>-1}],i=s.a.createElement("span",null,s.a.createElement(M.a,{style:{fontSize:"18px",color:"#2491F7",marginRight:"10px"},type:"tags-o"}),s.a.createElement("span",{style:{fontSize:"14px",color:"#ffffff"}},"DTinsight.Tag"));return s.a.createElement(G.c,U()({logo:i,menuItems:n},this.props))}}]),t}(r.Component))||i,F=V,q=F,B=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(V,"Header","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/layout/header.js"),__REACT_HOT_LOADER__.register(F,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/layout/header.js")),a(56),a(29)),Y=a.n(B),z=(a(48),a(26)),K=a.n(z),Q=(a(58),a(30)),J=a.n(Q),W=(a(49),a(16)),X=a.n(W),Z=(a(43),a(15)),$=a.n(Z),ee=(a(53),a(17)),te=a.n(ee),ae=a(185),ne=a(63),ie=a.n(ne),re=(a(219),a(84)),se=(a(361),a(157)),oe=a.n(se),le=a(76),ue=a.n(le),ce=(a(36),a(13)),pe=a.n(ce),de=a(65),_e={DL_ROLE_QUERY:N.d+"/role/pageQuery",DL_ROLE_UPDATE:N.d+"/role/addOrUpdateRole",DL_ROLE_DELETE:N.d+"/role/deleteRole",DL_ROLE_PERMISSION_TREE:N.d+"/permission/tree",DL_ROLE_PERMISSION:N.d+"/permission/getPermissionIdsByRoleId",DL_GET_USER_BY_ID:N.d+"/user/getUserById",DL_GET_USER_PAGES:N.d+"/user/pageQuery",DL_GET_USER_NOT_IN_PROJECT:N.d+"/user/listNotIn",DL_USER_ROLE_ADD:N.d+"/roleUser/addRoleUser",DL_USER_ROLE_DELETE:N.d+"/roleUser/remove",DL_USER_ROLE_UPDATE:N.d+"/roleUser/updateUserRole",MASSAGE_QUERY:N.d+"/notify/pageQuery",GET_MASSAGE_BY_ID:N.d+"/notify/getOne",MASSAGE_MARK_AS_READ:N.d+"/notify/tabRead",MASSAGE_MARK_AS_ALL_READ:N.d+"/notify/allRead",MASSAGE_DELETE:N.d+"/notify/delete",DL_GET_USER_LIST:N.d+"/user/list",GET_ALL_MENU_LIST:N.d+"/user/showMenuList",GET_PERIOD_TYPE:N.d+"/tag/listPeriodType",GET_NOTIFY_TYPE:N.d+"/tag/listNotifyType",QUERY_REGISTERED_TAG:N.d+"/tag/registerQuery",ADD_REGISTER_TAG:N.d+"/tag/registerAdd",QUERY_RULE_TAG:N.d+"/tag/customQuery",ADD_RULE_TAG:N.d+"/tag/customAdd",UPDATE_TAG_SQL_INFO:N.d+"/tag/computeInfoUpdate",GET_TAG_CONDITION:N.d+"/tag/listCustomCondition",EDIT_TAG_CONDITION:N.d+"/tag/editCustomCondition",DELETE_TAG_CONDITION:N.d+"/tag/deleteCustomCondition",UPDATE_TAG_BASE_INFO:N.d+"/tag/baseInfoUpdate",DELETE_TAG:N.d+"/tag/deleteTag",GET_RULE_TAG_RETAIL:N.d+"/tag/getOne",QUERY_TAG_LOG:N.d+"/tag/logPageQuery",PUBLISH_CHECK:N.d+"/tag/publishCheck",PUBLISH_TAG:N.d+"/tag/publishTag",QUERY_IDENTIFY_COLUMN:N.d+"/identify/pageQuery",GET_ALL_IDENTIFY_COLUMN:N.d+"/identify/identities",ADD_IDENTIFY_COLUMN:N.d+"/identify/add",UPDATE_IDENTIFY_COLUMN:N.d+"/identify/update",DELETE_IDENTIFY_COLUMN:N.d+"/identify/delete",GET_DATA_SOURCES:N.d+"/dataSource/pageQuery",CHECK_CONNECTION:N.d+"/dataSource/checkConnection",ADD_DATA_SOURCE:N.d+"/dataSource/addSource",UPDATE_DATA_SOURCE:N.d+"/dataSource/updateSource",DELETE_DATA_SOURCE:N.d+"/dataSource/deleteSource",GET_DATA_SOURCE_BY_ID:N.d+"/dataSource/getBySourceId",GET_DATA_SOURCES_LIST:N.d+"/dataSource/list",GET_TAG_DATA_SOURCES_LIST:N.d+"/dataSource/listTargetSource",GET_DATA_SOURCES_TYPE:N.d+"/dataSource/getTypes",GET_DATA_SOURCES_TABLE:N.d+"/dataSource/tablelist",GET_DATA_SOURCES_COLUMN:N.d+"/dataSource/tablecolumn",GET_COMPUTE_SOURCE:N.d+"/dataSource/listComputeSource",GET_DATA_SOURCES_PREVIEW:N.d+"/dataSource/preview",GET_API_FAIL_RANK:N.d+"/apis/listApiCallFailRateTopNForNormal",GET_API_FAIL_RANK_ADMIN:N.d+"/apis/listApiCallFailRateTopNForManager",GET_API_CALL_INFO:N.d+"/apis/getApiCallInfoForNormal",GET_USER_API_CALL_RANK:N.d+"/apis/listApiCallNumTopN",GET_USER_API_SUB_INFO:N.d+"/apply/getApiSubscribe",GET_MARKET_API_CALL_RANK:N.d+"/apis/listUserCallTopN",GET_API_CALL_ERROR_INFO_ADMIN:N.d+"/log/getApiCallErrorInfoForManager",GET_MARKET_API_APPLY_INFO:N.d+"/apply/getApplyCount",HANDLE_APPLY:N.d+"/apply/handleApply",GET_ALL_APPLY_LIST:N.d+"/apply/allApplyList",GET_ALL_API_LIST:N.d+"/tag/manageQuery",GET_DATASOURCE_BASE_INFO:N.d+"/dataSource/listDataSourceBaseInfo",DELETE_API:N.d+"/apis/deleteApi",UPDATE_API:N.d+"/apis/updateApiStatus",GET_API_CALL_RANK:N.d+"/apis/getApiCallUserRankList",GET_API_BUY_STATE:N.d+"/apply/getApiApplyList",DELETE_CATAGORY:N.d+"/catalogue/deleteCatalogue",ADD_CATAGORY:N.d+"/catalogue/addCatalogue",UPDATE_CATAGORY:N.d+"/catalogue/updateCatalogue",NEW_API:N.d+"/apis/createApi",CHANGE_API:N.d+"/apis/updateApi",GET_TABLE_BY_DATASOURCE:N.d+"/dataSource/tablelist",GET_TABLE_COLUMNS_DETAIL:N.d+"/dataSource/tablecolumn",GET_TABLE_PREVIEW_DATA:N.d+"/dataSource/preview",GET_API_DETAIL_INFO:N.d+"/apis/getApiInfo",GET_APPLY_LIST:N.d+"/apply/userApplyList",UPDATE_APPLY_STATUS:N.d+"/apply/updateApplyStatusForNormal",UPDATE_APPLY_STATUS_ADMIN:N.d+"/apply/updateApplyStatusForManager",GET_USER_API_CALL_INFO:N.d+"/apis/getApiCallInfoForNormal",GET_USER_API_CALL_INFO_ADMIN:N.d+"/apis/getApiCallInfoForManager",GET_API_CALL_ERROR_INFO:N.d+"/log/getApiCallErrorInfoForNormal",GET_API_CALL_ERROR_LOG:N.d+"/log/queryApiCallLogForNormal",GET_API_CALL_ERROR_LOG_ADMIN:N.d+"/log/queryApiCallLogForManager",GET_API_CALL_URL:N.d+"/apis/getApiCallUrl",GET_API_CREATOR_INFO:N.d+"/apis/getApiCreatorInfo",GET_CATALOGUE:N.d+"/catalogue/getCatalogue",GET_API_MARKET_LIST:N.d+"/tag/marketQuery",GET_MARKET_API_DETAIL:N.d+"/apis/getApiDetail",GET_API_EXT_INFO:N.d+"/apis/getApiExtInfoForNormal",GET_API_EXT_INFO_ADMIN:N.d+"/apis/getApiExtInfoForManager",APPLY_API:N.d+"/apply/apiApply",GET_MARKET_TOP_CALL_FUNC:N.d+"/apis/listApiCallNumTopNForManager"},me=_e,ge=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(_e,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/reqUrls.js"),APP_CONF.UIC_URL||""),he=APP_CONF.UIC_DOMAIN||"",Ee={logout:function(){var e=this;Oe.post(me.APP_LOGOUT).then(function(t){1===t.code&&e.openLogin()})},openLogin:function(){de.a.clear(),H.a.deleteCookie("dt_user_id",he,"/"),H.a.deleteCookie("dt_token",he,"/"),H.a.deleteCookie("dt_tenant_id",he,"/"),H.a.deleteCookie("dt_tenant_name",he,"/"),H.a.deleteCookie("dt_username",he,"/"),H.a.deleteCookie("dt_is_tenant_admin",he,"/"),H.a.deleteCookie("dt_is_tenant_creator",he,"/"),H.a.deleteCookie("project_id",he,"/"),window.location.href=ge+"/#/login"},getLoginedUser:function(){return Oe.post(me.DL_GET_USER_BY_ID)},getUserList:function(){return Oe.post(me.DL_GET_USER_LIST)}},fe=Ee;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ge,"UIC_URL_TARGET","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/user.js"),__REACT_HOT_LOADER__.register(he,"UIC_DOMAIN_URL","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/user.js"),__REACT_HOT_LOADER__.register(Ee,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/user.js"));function Te(e){switch(e.status){case 402:case 200:return e;case 302:pe.a.info("登录超时, 请重新登录！");default:return e}}function Ae(e){switch(e.code){case 1:return e;case 0:return fe.openLogin(),ue.a.reject(e);case 3:return oe.a.error({message:"权限通知",description:e.message}),ue.a.reject(e);case 16:hashHistory.push("/");default:return e.message&&pe.a.error(e.message,3),e}}function ye(){var e=H.a.getCookie("project_id");e&&"undefined"!==e||H.a.deleteCookie("project_id")}function Ce(){return de.a.get("session")}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Te,"authBeforeFormate","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/interceptor.js"),__REACT_HOT_LOADER__.register(Ae,"authAfterFormated","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/interceptor.js"),__REACT_HOT_LOADER__.register(ye,"isSelectedProject","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/interceptor.js"),__REACT_HOT_LOADER__.register(Ce,"isLogin","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/interceptor.js"));var be,ve,De=function(){function e(){m()(this,e)}return h()(e,[{key:"get",value:function(e,t){var a=t?this.build(e,t):e;return this.request(a,{method:"GET"})}},{key:"post",value:function(e,t){var a={method:"POST"};return t&&(a.body=ie()(t)),this.request(e,a)}},{key:"postAsFormData",value:function(e,t){var a={method:"POST"};return t&&(a.body=this.buildFormData(t)),this.request(e,a)}},{key:"postForm",value:function(e,t){var a={method:"POST"};return t&&(a.body=new FormData(t)),this.request(e,a)}},{key:"request",value:function(e,t){return re.a.show(),t.credentials="same-origin",fetch(e,t).then(Te).then(function(e){return setTimeout(function(){re.a.hide()},300),e.json()}).then(Ae).catch(function(e){re.a.hide()})}},{key:"defaultHeader",value:function(){return{Accept:"*/*","Content-Type":"application/json"}}},{key:"build",value:function(e,t){var a=[];if(t)for(var n in t)n&&a.push(n+"="+encodeURIComponent(t[n]));return e+"?"+a.join("&")}},{key:"buildFormData",value:function(e){if(e){var t=new FormData;for(var a in e)a&&t.append(a,e[a]);return t}}}]),e}(),ke=new De,Oe=ke,Re=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(De,"Http","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/http.js"),__REACT_HOT_LOADER__.register(ke,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/http.js")),{getCatalogue:function(e){return Oe.post(me.GET_CATALOGUE,e)},listByCondition:function(e){return Oe.post(me.GET_API_MARKET_LIST,e)},getApiDetail:function(e){return Oe.post(me.GET_MARKET_API_DETAIL,e)},apiApply:function(e){return Oe.post(me.APPLY_API,e)},getApiExtInfoForNormal:function(e){return Oe.post(me.GET_API_EXT_INFO,e)},getApiExtInfoForManager:function(e){return Oe.post(me.GET_API_EXT_INFO_ADMIN,e)}}),Le=Re,Se=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Re,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/apiMarket.js"),{getCatalogue:function(e){return function(t){Le.getCatalogue({pid:e,lvNum:10}).then(function(e){1===e.code&&t({type:ae.a.GET_CATALOGUE,payload:e.data})})}},getApiMarketList:function(e){return function(t){return Le.listByCondition(e).then(function(e){if(1===e.code)return t({type:ae.a.GET_API_MARKET_LIST,payload:e.data.data}),e})}},getApiDetail:function(e){return function(t){return Le.getApiDetail(e).then(function(e){if(1===e.code)return t({type:ae.a.GET_MARKET_API_DETAIL,payload:e.data}),e})}},getApiExtInfo:function(e){var t="getApiExtInfoForNormal";return e.useAdmin&&(t="getApiExtInfoForManager"),function(a){return Le[t](e).then(function(e){if(1===e.code)return a({type:ae.a.GET_API_EXT_INFO,payload:e.data}),e})}},apiApply:function(e){return function(t){return Le.apiApply(e).then(function(e){if(1===e.code)return e})}}}),we=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Se,"apiMarketActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/apiMarket/index.js"),a(47),a(20)),xe=a.n(we),Ie=a(40),He=te.a.Item,Ne=$.a.TextArea,Pe=function(e){return{apiApply:function(t,a){return e(Se.apiApply({apiId:t,applyContent:a}))},getApiExtInfo:function(t){e(Se.getApiExtInfo({tagId:t}))}}},Ue=Object(C.b)(null,Pe)(be=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={loading:!1},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"handleOk",value:function(){var e=this;this.props.form.validateFields(function(t,a){t||(e.setState({loading:!0}),e.props.apiApply(e.props.apiId,a.applyMsg).then(function(t){e.setState({loading:!1}),e.props.getMarketApi&&e.props.getMarketApi(),t&&(pe.a.success("操作成功"),e.props.successCallBack())}))})}},{key:"handleCancel",value:function(){this.props.form.resetFields(),this.props.cancelCallback()}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",null,s.a.createElement(J.a,{title:"申请API",visible:this.props.show,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),footer:[s.a.createElement(xe.a,{key:"back",size:"large",onClick:this.handleCancel.bind(this)},"取消"),s.a.createElement(xe.a,{key:"submit",type:"primary",size:"large",loading:this.state.loading,onClick:this.handleOk.bind(this)},"提交")]},s.a.createElement(te.a,null,s.a.createElement(He,U()({label:"标签名称"},Ie.k),s.a.createElement("p",null,this.props.name)),s.a.createElement(He,U()({label:"标签描述"},Ie.k),s.a.createElement("p",null,this.props.desc)),s.a.createElement(He,U()({label:"申请说明",hasFeedback:!0,required:!0},Ie.k),e("applyMsg",{rules:[{required:!0,message:"请输入申请信息"},{max:200,message:"最大字符不能超过200"}]})(s.a.createElement(Ne,{placeholder:"请输入申请信息",autosize:{minRows:4,maxRows:8}}))))))}}]),t}(r.Component))||be,je=te.a.create()(Ue),Me=je,Ge=Me,Ve=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(He,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js"),__REACT_HOT_LOADER__.register(Ne,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js"),__REACT_HOT_LOADER__.register(Pe,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js"),__REACT_HOT_LOADER__.register(Ue,"ApplyBox","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js"),__REACT_HOT_LOADER__.register(je,"WrappedApplyBox","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js"),__REACT_HOT_LOADER__.register(Me,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/applyBox.js")),te.a.Item),Fe=$.a.TextArea,qe=X.a.Option,Be=$.a.Search,Ye=void 0,ze=function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},Ke=function(e){return{getCatalogue:function(t){e(Se.getCatalogue(t))},getApiMarketList:function(t){return e(Se.getApiMarketList(t))}}},Qe=Object(C.b)(ze,Ke)(ve=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={searchValue:"",pageIndex:1,loading:!0,applyBox:!1,apply:{apiId:"",tagName:"",tagDesc:""},type1:void 0,type2:void 0,apiName:"",pageSize:20,total:0,sorter:{}},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.openDetail=function(){var e;return(e=n).__openDetail__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getMarketApi",value:function(){var e=this;this.setState({loading:!0});this.props.getApiMarketList({name:this.state.searchValue,pid:this.state.type1||-1,cid:this.state.type2||-1,currentPage:this.state.pageIndex,pageSize:this.state.pageSize,orderBy:{updateTime:"gmt_modified"}[this.state.sorter.columnKey],sort:{ascend:"asc",descend:"desc"}[this.state.sorter.order]}).then(function(t){e.setState({loading:!1,total:t.data.totalCount})}).catch(function(t){e.setState({loading:!1})})}},{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.getMarketApi()}},{key:"renderSourceType",value:function(e,t){function a(e){return!e||e.length<1?null:e.map(function(e){return s.a.createElement(qe,{key:e.id},e.name)})}var n=[],i=this.props.apiMarket.apiCatalogue;if(t){if(!i)return null;for(var r=0;r<i.length;r++)n.push({id:i[r].id,name:i[r].catalogueName});return a(n)}if(!i)return null;for(var o=void 0,l=0;l<i.length;l++)if(i[l].id==e){o=i[l].childCatalogue;break}if(!o)return null;for(var u=0;u<o.length;u++)o[u].api||n.push({id:o[u].id,name:o[u].catalogueName});return a(n)}},{key:"onSourceChange",value:function(e){var t=this;this.setState({type1:e,type2:void 0},function(){t.getMarketApi()})}},{key:"onUserSourceChange",value:function(e){var t=this;this.setState({type2:e},function(){t.getMarketApi()})}},{key:"handleSearch",value:function(e){var t=this;this.setState({searchValue:e,pageIndex:1},function(){t.getMarketApi()})}},{key:"getDealType",value:function(e){return{complete:"查看使用情况",nothing:"申请",applying:"查看审批进度"}[e||"nothing"]}},{key:"doApply",value:function(e){this.setState({applyBox:!0,apply:{name:e.name,apiId:e.apiId,tagDesc:e.tagDesc}})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,sorter:a},function(){n.getMarketApi()})}},{key:"__openDetail__REACT_HOT_LOADER__",value:function(e){window.open("dataLabel.html#/dl/market/detail/"+e+"?isHideBack=true")}},{key:"initColumns",value:function(){var e=this;return[{title:"标签名称",dataIndex:"name",key:"name",width:"20%",render:function(e,t){return s.a.createElement(y.c,{to:"/dl/market/detail/"+t.apiId},e)}},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:"15%"},{title:"昨日调用次数",dataIndex:"totalYd",key:"totalYd",width:"15%"},{title:"更新时间",dataIndex:"gmtModified",key:"gmtModified",width:"20%",render:function(e){return H.a.formatDateTime(e)},sorter:!0},{title:"操作",dataIndex:"applyStatus",width:"15%",render:function(t,a){switch(t){case 0:return s.a.createElement(y.c,{to:"/dl/mine?apiId="+a.id},"查看审批进度");case 1:case 3:case 4:return s.a.createElement(y.c,{to:"/dl/mine/approved?apiId="+a.id},"查看使用情况");case-1:case 2:return s.a.createElement("a",{onClick:e.doApply.bind(e,a)},"申请");default:return""}}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:this.state.pageSize,total:this.state.total}}},{key:"getCardTitle",value:function(){return s.a.createElement("div",{className:"flex font-12"},s.a.createElement(Be,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),s.a.createElement("div",{className:"m-l-8"},"标签分类：",s.a.createElement(X.a,{placeholder:"选择标签分类",value:this.state.type1,allowClear:!0,onChange:this.onSourceChange.bind(this),style:{width:120}},this.renderSourceType(0,!0))),s.a.createElement("div",{className:"m-l-8"},"二级分类：",s.a.createElement(X.a,{placeholder:"选择二级分类",value:this.state.type2,allowClear:!0,onChange:this.onUserSourceChange.bind(this),style:{width:150}},this.renderSourceType(this.state.type1,!1))))}},{key:"jumpToMine",value:function(){Ye.destroy(),this.props.router.push("/dl/mine")}},{key:"showApplySuccessModal",value:function(){Ye=J.a.success({title:"申请提交成功",content:s.a.createElement("span",null,"您可以在 ",s.a.createElement("a",{onClick:this.jumpToMine.bind(this)},"我的标签")," 中查看审批进度"),okText:"确定"})}},{key:"handleOk",value:function(){this.setState({applyBox:!1}),this.showApplySuccessModal()}},{key:"handleCancel",value:function(){this.setState({applyBox:!1})}},{key:"render",value:function(){var e=this.props,t=(e.children,e.apiMarket);return s.a.createElement("div",{className:"api-market"},s.a.createElement(Ge,{show:this.state.applyBox,successCallBack:this.handleOk.bind(this),cancelCallback:this.handleCancel.bind(this),apiId:this.state.apply.apiId,name:this.state.apply.name,desc:this.state.apply.tagDesc,getMarketApi:this.getMarketApi.bind(this)}),s.a.createElement("div",{className:"m-card box-1"},s.a.createElement(Y.a,{noHovering:!0,title:this.getCardTitle()},s.a.createElement(K.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:t.apiList||[],onChange:this.onTableChange}))))}}]),t}(r.Component))||ve,Je=Qe,We=Je,Xe=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ve,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Fe,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(qe,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Be,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Ye,"modal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(ze,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Ke,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Qe,"APIMarket","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js"),__REACT_HOT_LOADER__.register(Je,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/index.js")),a(35)),Ze=a.n(Xe)()(["GET_USER","UPDATE_USER","GET_NOT_PROJECT_USERS","GET_PROJECT_USERS","GET_USER_LIST"],{prefix:"user/"}),$e=Ze,et=$e;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ze,"userActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/userActions.js"),__REACT_HOT_LOADER__.register($e,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/consts/userActions.js"));function tt(){return function(e){fe.getLoginedUser().then(function(t){if(1===t.code)return e({type:et.GET_USER,data:t.data})})}}function at(e){return{type:et.UPDATE_USER,data:e}}function nt(e){return function(t){fe.getUserList(e).then(function(e){1===e.code&&t({type:et.GET_USER_LIST,data:e.data})})}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(tt,"getUser","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/user.js"),__REACT_HOT_LOADER__.register(at,"updateUser","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/user.js"),__REACT_HOT_LOADER__.register(nt,"getUserList","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/user.js"));var it,rt=a(108),st={getDataSources:function(e){return Oe.post(me.GET_DATA_SOURCES,e)},testDSConnection:function(e){return Oe.post(me.CHECK_CONNECTION,e)},addDataSource:function(e){return Oe.post(me.ADD_DATA_SOURCE,e)},updateDataSource:function(e){return Oe.post(me.UPDATE_DATA_SOURCE,e)},deleteDataSource:function(e){return Oe.post(me.DELETE_DATA_SOURCE,e)},getDataSourcesType:function(e){return Oe.post(me.GET_DATA_SOURCES_TYPE,e)},getDataSourcesList:function(e){return Oe.post(me.GET_DATA_SOURCES_LIST,e)},getTagDataSourcesList:function(e){return Oe.post(me.GET_TAG_DATA_SOURCES_LIST,e)},getDataSourcesTable:function(e){return Oe.post(me.GET_DATA_SOURCES_TABLE,e)},getDataSourcesColumn:function(e){return Oe.post(me.GET_DATA_SOURCES_COLUMN,e)},getDataSourcesPreview:function(e){return Oe.post(me.GET_DATA_SOURCES_PREVIEW,e)}},ot=st,lt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(st,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/dataSource.js"),{getDataSources:function(e){return function(t){t({type:rt.a.CHANGE_LOADING}),ot.getDataSources(e).then(function(e){1===e.code&&t({type:rt.a.GET_DATA_SOURCES,payload:e.data}),t({type:rt.a.CHANGE_LOADING})})}},getDataSourcesType:function(e){return function(t){ot.getDataSourcesType(e).then(function(e){1===e.code&&t({type:rt.a.GET_DATA_SOURCES_TYPE,payload:e.data})})}},getDataSourcesList:function(e){return function(t){ot.getDataSourcesList(e).then(function(e){1===e.code&&t({type:rt.a.GET_DATA_SOURCES_LIST,payload:e.data})})}},getTagDataSourcesList:function(e){return function(t){ot.getTagDataSourcesList(e).then(function(e){1===e.code&&t({type:rt.a.GET_TAG_DATA_SOURCES_LIST,payload:e.data})})}},getDataSourcesTable:function(e){return function(t){ot.getDataSourcesTable(e).then(function(e){1===e.code?t({type:rt.a.GET_DATA_SOURCES_TABLE,payload:e.data}):t({type:rt.a.GET_DATA_SOURCES_TABLE,payload:[]})})}},resetDataSourcesTable:function(){return function(e){e({type:rt.a.RESET_DATA_SOURCES_TABLE})}},getDataSourcesColumn:function(e){return function(t){ot.getDataSourcesColumn(e).then(function(e){1===e.code&&t({type:rt.a.GET_DATA_SOURCES_COLUMN,payload:e.data})})}},resetDataSourcesColumn:function(){return function(e){e({type:rt.a.RESET_DATA_SOURCES_COLUMN})}},getDataSourcesPreview:function(e){return function(t){ot.getDataSourcesPreview(e).then(function(e){if(1===e.code){var a=e.data,n=a.columnList,i=a.dataList;e.data.dataList=i.map(function(e,t){var a={};return e.forEach(function(e,i){a.key=t,a[n[i]]=e}),a}),t({type:rt.a.GET_DATA_SOURCES_PREVIEW,payload:e.data})}})}}}),ut=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(lt,"dataSourceActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/dataSource/index.js"),a(208)),ct={getUserList:function(){return Oe.post(me.DL_GET_USER_LIST)},getAllMenuList:function(){return Oe.post(me.GET_ALL_MENU_LIST)},getPeriodType:function(){return Oe.post(me.GET_PERIOD_TYPE)},getNotifyType:function(){return Oe.post(me.GET_NOTIFY_TYPE)}},pt=ct,dt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(ct,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/common.js"),{getUserList:function(e){return function(t){pt.getUserList(e).then(function(e){1===e.code&&t({type:ut.a.GET_USER_LIST,payload:e.data})})}},getAllMenuList:function(e){return function(t){pt.getAllMenuList(e).then(function(e){1===e.code&&t({type:ut.a.GET_ALL_MENU_LIST,payload:e.data})})}},getPeriodType:function(e){return function(t){pt.getPeriodType(e).then(function(e){1===e.code&&t({type:ut.a.GET_PERIOD_TYPE,payload:e.data})})}},getNotifyType:function(e){return function(t){pt.getNotifyType(e).then(function(e){1===e.code&&t({type:ut.a.GET_NOTIFY_TYPE,payload:e.data})})}}}),_t=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(dt,"commonActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/common.js"),a(153)),mt={children:I.a.node},gt={children:[]},ht=Object(C.b)()(it=function(e){function t(){return m()(this,t),f()(this,(t.__proto__||d()(t)).apply(this,arguments))}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e(tt()),e(Object(_t.a)(N.j)),e(dt.getUserList()),e(dt.getAllMenuList()),e(dt.getPeriodType()),e(dt.getNotifyType()),e(lt.getDataSourcesType())}},{key:"render",value:function(){var e=this.props.children;return s.a.createElement("div",{className:"main"},s.a.createElement(q,null),s.a.createElement("div",{className:"container"},e||s.a.createElement(We,null)))}}]),t}(r.Component))||it;ht.propTypes=mt,ht.defaultProps=gt;var Et=ht,ft=Et,Tt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(mt,"propType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/index.js"),__REACT_HOT_LOADER__.register(gt,"defaultPro","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/index.js"),__REACT_HOT_LOADER__.register(ht,"Main","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/index.js"),__REACT_HOT_LOADER__.register(Et,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/index.js")),a(81),a(34)),At=a.n(Tt),yt=a(402),Ct={getApplyList:function(e){return Oe.post(me.GET_APPLY_LIST,e)},updateApplyStatusForNormal:function(e){return Oe.post(me.UPDATE_APPLY_STATUS,e)},updateApplyStatusForManager:function(e){return Oe.post(me.UPDATE_APPLY_STATUS_ADMIN,e)},getApiCallInfoForNormal:function(e){return Oe.post(me.GET_API_CALL_INFO,e)},getApiCallInfoForManager:function(e){return Oe.post(me.GET_USER_API_CALL_INFO_ADMIN,e)},getApiCallErrorInfoForNormal:function(e){return Oe.post(me.GET_API_CALL_ERROR_INFO,e)},getApiCallErrorInfoForManager:function(e){return Oe.post(me.GET_API_CALL_ERROR_INFO_ADMIN,e)},getApiCallUrl:function(e){return Oe.post(me.GET_API_CALL_URL,e)},queryApiCallLogForNormal:function(e){return Oe.post(me.GET_API_CALL_ERROR_LOG,e)},queryApiCallLogForManager:function(e){return Oe.post(me.GET_API_CALL_ERROR_LOG_ADMIN,e)},getApiCreatorInfo:function(e){return Oe.post(me.GET_API_CREATOR_INFO,e)}},bt=Ct,vt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ct,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/mine.js"),{getApplyingList:function(e){return(e=e||{}).status=[0],function(t){return bt.getApplyList(e).then(function(e){1===e.code&&t({type:yt.a.GET_APPLYING_LIST,payload:e.data})})}},getAppliedList:function(e){return(e=e||{}).status&&0!==e.status.length||(e.status=[1,2,3,4]),function(t){return bt.getApplyList(e).then(function(e){if(1===e.code)return t({type:yt.a.GET_APPLYED_LIST,payload:e.data}),e})}},updateApplyStatus:function(e){var t="updateApplyStatusForNormal";return e.useAdmin&&(t="updateApplyStatusForManager"),function(a){return bt[t](e).then(function(e){if(1===e.code)return e})}},getApiCallInfo:function(e){var t="getApiCallInfoForNormal";return e.useAdmin&&(t="getApiCallInfoForManager"),function(a){return bt[t](e).then(function(e){if(1===e.code)return e})}},getApiCallErrorInfo:function(e){return function(t){return bt.getApiCallErrorInfoForNormal(e).then(function(e){if(1===e.code)return e})}},getApiCallUrl:function(e){return function(t){return bt.getApiCallUrl(e).then(function(e){if(1===e.code)return e})}},queryApiCallLog:function(e){var t="queryApiCallLogForNormal";return e.useAdmin&&(t="queryApiCallLogForManager"),function(a){return bt[t](e).then(function(e){if(1===e.code)return e})}},getApiCreatorInfo:function(e){return function(t){return bt.getApiCreatorInfo(e).then(function(e){if(1===e.code)return e})}}}),Dt=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(vt,"mineActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/mine/index.js"),a(82)),kt=$.a.TextArea,Ot=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"render",value:function(){this.props.showRecord&&this.props.showRecord.replyTime;return s.a.createElement(Dt.a,{visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"300px"},onClose:this.props.closeSlidePane},s.a.createElement("h1",{className:"box-title approved-card-pane-title"},"审批情况"),s.a.createElement("div",{style:{paddingLeft:30,marginBottom:30}},s.a.createElement("p",{className:"before-title-pane textarea-p","data-title":"申请说明："},s.a.createElement(kt,{disabled:!0,value:this.props.showRecord&&this.props.showRecord.applyContent,style:{width:200,color:"#999",fontSize:14},rows:4})),s.a.createElement("p",{style:{paddingLeft:70}},H.a.formatDateTime(this.props.showRecord&&this.props.showRecord.applyTime)),this.props.isApproved?s.a.createElement("div",null,s.a.createElement("p",{className:"before-title-pane textarea-p","data-title":"审批说明："},s.a.createElement(kt,{disabled:!0,value:this.props.showRecord&&this.props.showRecord.replyContent,style:{width:200,color:"#999",fontSize:14},rows:4})),s.a.createElement("p",{style:{paddingLeft:70}},H.a.formatDateTime(this.props.showRecord&&this.props.showRecord.replyTime))):null))}}]),t}(r.Component),Rt=Ot,Lt=Rt,St=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(kt,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedSlidePane.js"),__REACT_HOT_LOADER__.register(Ot,"ApprovedSlidePane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedSlidePane.js"),__REACT_HOT_LOADER__.register(Rt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedSlidePane.js")),{applyTime:"gmt_modified"}),wt={ascend:"asc",descend:"desc"},xt=$.a.TextArea,It=$.a.Search,Ht=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageIndex:1,slidePaneShow:!1,sortedInfo:{},loading:!1,showRecord:{},apiName:void 0},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getApplyingList",value:function(e){var t=this;this.setState({loading:!0}),this.props.getApplyingList(this.state.pageIndex,St[this.state.sortedInfo.columnKey],wt[this.state.sortedInfo.order],this.state.apiName).then(function(){t.setState({loading:!1}),e&&e()})}},{key:"componentDidMount",value:function(){var e=this;this.getApplyingList(function(){e.openCard(e.props.apiId)})}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId!=e.apiId&&e.apiId&&this.openCard(e.apiId)}},{key:"openCard",value:function(e){var t=this.getSource();if(t)for(var a in t){var n=t[a];if(e==n.apiId){this.openApprovedState(n);break}}}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,sortedInfo:a},function(){n.getApplyingList()})}},{key:"openApprovedState",value:function(e){this.setState({slidePaneShow:!0,showRecord:e||{}})}},{key:"initColumns",value:function(){var e=this;this.state.sortedInfo;return[{title:"标签名称",dataIndex:"apiName",key:"apiName",width:"20%",render:function(t,a){return s.a.createElement("a",{onClick:e.openApprovedState.bind(e,a)},t)}},{title:"描述",dataIndex:"apiDesc",key:"apiDesc",width:"30%"},{title:"申请说明",dataIndex:"applyContent",key:"applyContent",width:"30%"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime",width:"20%",sorter:!0,render:function(e){return H.a.formatDateTime(e)}}]}},{key:"getSource",value:function(){return this.props.mine.apiList.applyingList.data}},{key:"getTotal",value:function(){return this.props.mine.apiList.applyingList&&this.props.mine.apiList.applyingList.totalCount||0}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.getTotal()}}},{key:"closeSlidePane",value:function(){this.setState({slidePaneShow:!1,showRecord:{}})}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getApplyingList()})}},{key:"render",value:function(){var e=this;return s.a.createElement(Y.a,{noHovering:!0,bordered:!1},s.a.createElement(Lt,U()({},this.props,{slidePaneShow:this.state.slidePaneShow,showRecord:this.state.showRecord,closeSlidePane:this.closeSlidePane.bind(this)})),s.a.createElement("div",{className:"flex font-12"},s.a.createElement(It,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"10px"},onSearch:this.handleApiSearch.bind(this)})),s.a.createElement(K.a,{rowKey:"id",rowClassName:function(t,a){return e.state.showRecord.apiId==t.apiId?"row-select":""},className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))}}]),t}(r.Component),Nt=Ht,Pt=Nt,Ut=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(St,"sortType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js"),__REACT_HOT_LOADER__.register(wt,"orderType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js"),__REACT_HOT_LOADER__.register(xt,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js"),__REACT_HOT_LOADER__.register(It,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js"),__REACT_HOT_LOADER__.register(Ht,"NoApprovedCard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js"),__REACT_HOT_LOADER__.register(Nt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/noApprovedCard.js")),$.a.TextArea),jt=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={phone:"",dtuicUserId:"",email:""},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getApiCreatorInfo()}},{key:"componentWillReceiveProps",value:function(e){this.props.showRecord&&this.props.showRecord.apiId!==e.showRecord.apiId&&e.slidePaneShow&&this.getApiCreatorInfo(e.showRecord.apiId)}},{key:"getApiCreatorInfo",value:function(e){var t=this;(e=e||this.props.showRecord.apiId)&&this.props.getApiCreatorInfo(e).then(function(e){e&&t.setState({phone:e.data.phoneNumber,dtuicUserId:e.data.userName,email:e.data.email})})}},{key:"render",value:function(){return s.a.createElement(Dt.a,{visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"300px"},onClose:this.props.closeSlidePane},s.a.createElement("h1",{className:"box-title approved-card-pane-title"},"详情"),s.a.createElement("div",{style:{paddingLeft:30,paddingTop:20}},s.a.createElement("p",null,"管理员已取消此接口的授权，您可以联系管理员咨询详细情况，管理员信息"),s.a.createElement("p",{style:{marginTop:20}},"用户名：",this.state.dtuicUserId),s.a.createElement("p",null,"手机号码：",this.state.phone),s.a.createElement("p",null,"邮箱：",this.state.email)))}}]),t}(r.Component),Mt=jt,Gt=Mt,Vt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ut,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/disabledCardSlidePane.js"),__REACT_HOT_LOADER__.register(jt,"DisabledCardSlidePane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/disabledCardSlidePane.js"),__REACT_HOT_LOADER__.register(Mt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/disabledCardSlidePane.js")),a(91),a(51)),Ft=a.n(Vt),qt=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={callUrl:""},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getApiCallUrl",value:function(e){var t=this;e=e||this.props.showRecord.apiId,this.props.getApiCallUrl(e).then(function(e){e&&t.setState({callUrl:e.data})})}},{key:"componentDidMount",value:function(){this.getApiCallUrl()}},{key:"componentWillReceiveProps",value:function(e){e.showRecord&&this.props.showRecord.apiId!=e.showRecord.apiId&&e.slidePaneShow&&this.getApiCallUrl(e.showRecord.apiId)}},{key:"render",value:function(){var e="/dl/market/detail/"+this.props.showRecord.apiId;return s.a.createElement("div",{style:{paddingLeft:30}},s.a.createElement("p",{style:{lineHeight:"30px"}},"调用URL：",this.state.callUrl),s.a.createElement(y.c,{to:e},"在标签市场中查看"))}}]),t}(r.Component),Bt=qt,Yt=Bt,zt=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(qt,"ApiCallMethod","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/apiCallMethod.js"),__REACT_HOT_LOADER__.register(Bt,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/apiCallMethod.js")),a(66),a(25)),Kt=a.n(zt),Qt=(a(74),a(19)),Jt=a.n(Qt),Wt=a(86),Xt=a(11),Zt=a(78);a(148),a(200),a(139),a(138);var $t,ea=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={apiId:"",data:{}},n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getInfo",value:function(){var e=this;this.state.apiId&&this.props.getApiCallInfo(this.state.apiId,this.props.dateType).then(function(t){t&&e.setState({data:t.data},function(){e.initLineChart()})})}},{key:"componentDidMount",value:function(){this.setState({apiId:this.props.showRecord&&this.props.showRecord.apiId}),this.getInfo()}},{key:"componentWillReceiveProps",value:function(e){var t=this;(e.showRecord&&this.state.apiId!==e.showRecord.apiId||this.props.dateType!==e.dateType)&&this.setState({apiId:e.showRecord.apiId},function(){e.slidePaneShow&&t.getInfo()})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"initLineChart",value:function(){if(this.state.data&&this.state.data.infoList){for(var e=this.state.data.infoList,t=[],a=[],n=[],i=0;i<e.length;i++)if(t.push(e[i].callCount),a.push(e[i].failRate),this.props.dateType)switch(this.props.dateType){case"1":n.push(H.a.formatHours(e[i].time));break;case"7":n.push(H.a.formatDateHours(e[i].time));break;case"30":n.push(H.a.formatDate(e[i].time))}var r=Zt.init(document.getElementById("MyApiDetailState")),s=Object(Xt.cloneDeep)(Ie.j);s.grid.right="40px",s.tooltip.formatter=function(e){for(var t=e[0].name,a=0,n=e.length;a<n;a++){var i="次";"失败率"==e[a].seriesName&&(i="%"),t+='<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e[a].color+'"></span>'+e[a].seriesName+" : "+e[a].value+i}return t},s.series=[{symbol:"none",name:"调用次数",data:t,type:"line",smooth:!0,itemStyle:{normal:{color:"#1C86EE"}}},{symbol:"none",name:"失败率",data:a,type:"line",smooth:!0,yAxisIndex:1,itemStyle:{normal:{color:"#EE0000"}}}],s.xAxis[0].data=n,r.setOption(s),this.setState({lineChart:r})}}},{key:"getDateText",value:function(){switch(this.props.dateType){case"1":return"24小时";case"7":return"7天";case"30":return"30天";default:return""}}},{key:"render",value:function(){return s.a.createElement("div",{style:{paddingLeft:30}},s.a.createElement(Kt.a,{gutter:130,className:"m-count padding-l20 height-101"},s.a.createElement(Jt.a,{span:8},s.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},s.a.createElement("span",{className:"m-count-title text-left"},"最近",this.getDateText(),"累计调用"),s.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.data&&this.state.data.callCount||0,s.a.createElement("span",{style:{fontSize:12}},"次")))),s.a.createElement(Jt.a,{span:6},s.a.createElement("section",{className:"m-count-section margin-t20",style:{width:100}},s.a.createElement("span",{className:"m-count-title text-left"},"最近",this.getDateText(),"失败率"),s.a.createElement("span",{className:"m-count-content font-red text-left"},this.state.data&&this.state.data.failRate||0,s.a.createElement("span",{style:{fontSize:12}},"%")))),s.a.createElement(Jt.a,{span:8},s.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},s.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),s.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.data&&this.state.data.totalCount||"---")))),s.a.createElement(Wt.a,{onResize:this.resize},s.a.createElement("article",{id:"MyApiDetailState",style:{width:"100%",height:"300px"}})))}}]),t}(r.Component),ta=ea,aa=ta,na=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ea,"ApiCallState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/apiCallState.js"),__REACT_HOT_LOADER__.register(ta,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/apiCallState.js")),{1:"禁用",2:"未认证",3:"参数错误",4:"超时",5:"超出限制",6:"其他"}),ia=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={error:{},data:[],loading:!1,pageIndex:1,total:0,filter:{}},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getErrorInfo()}},{key:"getErrorInfo",value:function(e){var t=this;(e=e||this.props.showRecord.apiId)&&(this.props.getApiCallErrorInfo(e).then(function(e){if(e){for(var a={},n=0;n<e.data.recordInfoList.length;n++){var i=e.data.recordInfoList[n],r=na[i.type];r&&(a[r]={percent:i.rate,count:i.callNum})}t.setState({error:a})}}),this.props.queryApiCallLog(e,this.state.pageIndex,this.state.filter.bizType&&this.state.filter.bizType[0]).then(function(e){e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"componentWillReceiveProps",value:function(e){this.props.showRecord&&this.props.showRecord.apiId!==e.showRecord.apiId&&e.slidePaneShow&&this.getErrorInfo(e.showRecord.apiId)}},{key:"initColumns",value:function(){var e=this;return[{title:"调用时间",dataIndex:"invokeTime",key:"invokeTime",render:function(e){return H.a.formatDateTime(e)}},{title:"错误类型",dataIndex:"bizType",key:"bizType",render:function(e){return na[e]},filters:[{text:"参数错误",value:"3"},{text:"禁用",value:"1"},{text:"未认证",value:"2"},{text:"超时",value:"4"},{text:"超出限制",value:"5"},{text:"其他",value:"6"}],filterMultiple:!1},{title:"错误日志",dataIndex:"content",key:"content",width:"50%"},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return s.a.createElement("a",{onClick:e.lookAllErrorText.bind(e,a.content)},"查看全部")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:5,total:this.state.total}}},{key:"getSource",value:function(){return this.state.data}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,filter:t},function(){n.getErrorInfo()})}},{key:"lookAllErrorText",value:function(e){J.a.info({title:"错误日志",content:s.a.createElement("div",null,s.a.createElement("p",null,e)),onOk:function(){}})}},{key:"getErrorPercent",value:function(e){return this.state.error[e]&&this.state.error[e].percent||0}},{key:"getErrorCount",value:function(e){return this.state.error[e]&&this.state.error[e].count||0}},{key:"render",value:function(){return s.a.createElement("div",{style:{paddingLeft:20}},s.a.createElement("p",{style:{lineHeight:"30px",paddingLeft:"20px"},className:"child-span-padding-r20"},s.a.createElement("span",null,"参数错误: ",this.getErrorPercent("参数错误"),"% (",this.getErrorCount("参数错误"),"次)"),s.a.createElement("span",null,"禁用: ",this.getErrorPercent("禁用"),"% (",this.getErrorCount("禁用"),"次)"),s.a.createElement("span",null,"未认证: ",this.getErrorPercent("未认证"),"% (",this.getErrorCount("未认证"),"次)"),s.a.createElement("span",null,"超时: ",this.getErrorPercent("超时"),"% (",this.getErrorCount("超时"),"次)"),s.a.createElement("span",null,"超出限制: ",this.getErrorPercent("超出限制"),"% (",this.getErrorCount("超出限制"),"次)"),s.a.createElement("span",null,"其他: ",this.getErrorPercent("其他"),"% (",this.getErrorCount("其他"),"次)")),s.a.createElement(K.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))}}]),t}(r.Component),ra=ia,sa=ra,oa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(na,"errorType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/errorLog.js"),__REACT_HOT_LOADER__.register(ia,"errorLog","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/errorLog.js"),__REACT_HOT_LOADER__.register(ra,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/others/errorLog.js")),Ft.a.Button),la=Ft.a.Group,ua=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={approvedText:"同意",applyText:"申请调用此接口，请批准",nowView:"callState",callStateDate:"1",errorLogDate:"7"},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"callback",value:function(e){this.setState({nowView:e})}},{key:"chooseCallStateDate",value:function(e){this.setState({callStateDate:e.target.value})}},{key:"chooseErrorLogDate",value:function(e){this.setState({errorLogDate:e.target.value})}},{key:"getDateTypeView",value:function(){switch(this.state.nowView){case"callState":return s.a.createElement("div",{className:"m-radio-group",key:"callStateDate",style:{marginTop:4,marginRight:28}},s.a.createElement(la,{name:"callStateDate",defaultValue:this.state.callStateDate,className:"no-bd nobackground",onChange:this.chooseCallStateDate.bind(this)},s.a.createElement(oa,{value:"1"},"最近24小时"),s.a.createElement(oa,{value:"7"},"最近7天"),s.a.createElement(oa,{value:"30"},"最近30天")));case"errorLog":return s.a.createElement("div",{className:"m-radio-group",key:"errorLogDate",style:{marginTop:4,marginRight:28}},s.a.createElement(la,{name:"errorLogDate",defaultValue:this.state.errorLogDate,className:"no-bd nobackground",onChange:this.chooseErrorLogDate.bind(this)},s.a.createElement(oa,{value:"7"},"最近7天")));default:return null}}},{key:"render",value:function(){var e=3==this.props.showRecord.status||1==this.props.showRecord.apiStatus?null:s.a.createElement(At.a.TabPane,{tab:"调用方式",key:"callMethod"},s.a.createElement(Yt,this.props));return s.a.createElement(Dt.a,{className:"m-tabs tabs-filter-show",visible:this.props.slidePaneShow,style:{right:"-20px",width:"80%",minHeight:"350px"},onClose:this.props.closeSlidePane},s.a.createElement(At.a,{activeKey:this.state.nowView,onChange:this.callback.bind(this),tabBarExtraContent:this.getDateTypeView()},s.a.createElement(At.a.TabPane,{tab:"调用情况",key:"callState"},s.a.createElement(aa,U()({},this.props,{dateType:this.state.callStateDate}))),s.a.createElement(At.a.TabPane,{tab:"错误日志",key:"errorLog"},s.a.createElement(sa,U()({},this.props,{dateType:this.state.errorLogDate}))),e))}}]),t}(r.Component),ca=ua,pa=ca,da=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(oa,"RadioButton","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/detailSlidePane.js"),__REACT_HOT_LOADER__.register(la,"RadioGroup","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/detailSlidePane.js"),__REACT_HOT_LOADER__.register(ua,"detailSlidePane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/detailSlidePane.js"),__REACT_HOT_LOADER__.register(ca,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/detailSlidePane.js")),J.a.confirm),_a=$.a.Search,ma={0:"inhand",1:"success",2:"notPass",3:"stop",4:"disabled"},ga={applyTime:"gmt_create"},ha={ascend:"asc",descend:"desc"},Ea=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageIndex:1,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,slidePaneShowSuccess:!1,loading:!1,sortedInfo:{},filterInfo:{},showRecord:{},apiName:void 0},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getAppliedList",value:function(){var e=this;this.setState({loading:!0});var t=this.state,a=t.filterInfo,n=t.sortedInfo,i=t.pageIndex,r=t.apiName;this.props.getAppliedList(i,ga[n.columnKey],ha[n.order],a.status,r).then(function(t){if(e.props.apiId&&t)for(var a in t.data.data){var n=t.data.data[a];if(e.props.apiId==n.apiId){e.apiClick(n);break}}e.setState({loading:!1})})}},{key:"componentDidMount",value:function(){this.getAppliedList()}},{key:"componentWillReceiveProps",value:function(e){if(this.props.apiId!=e.apiId&&e.apiId){var t=this.getSource();if(t)for(var a in t.data){var n=t.data[a];if(e.apiId==n.apiId){this.dealClick(n);break}}}}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,sortedInfo:a,filterInfo:t},function(){n.getAppliedList()})}},{key:"closeSlidePane",value:function(){this.setState({slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,slidePaneShowSuccess:!1,showRecord:{}})}},{key:"apiClick",value:function(e){var t=this["state"+ma[e.status]];t&&t.call(this,e)}},{key:"statesuccess",value:function(e){this.setState({slidePaneShowSuccess:!0,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statenotPass",value:function(e){this.setState({slidePaneShowSuccess:!1,slidePaneShowNoApproved:!0,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statestop",value:function(e){this.setState({slidePaneShowSuccess:!0,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!1,showRecord:e||{}})}},{key:"statedisabled",value:function(e){this.setState({slidePaneShowSuccess:!1,slidePaneShowNoApproved:!1,slidePaneShowDisabled:!0,showRecord:e||{}})}},{key:"dealClick",value:function(e){var t=this["deal"+ma[e.status]];t&&t.call(this,e)}},{key:"dealsuccess",value:function(e){var t=this;da({title:"确认停止",content:"确认停止接口？",onOk:function(){t.props.updateApplyStatus(e.id,3).then(function(e){e&&pe.a.success("停止成功"),t.getAppliedList()})},onCancel:function(){}})}},{key:"dealstop",value:function(e){var t=this;da({title:"确认开启",content:"确认开启接口？",onOk:function(){t.props.updateApplyStatus(e.id,1).then(function(e){e&&pe.a.success("开启成功"),t.getAppliedList()})},onCancel:function(){}})}},{key:"dealnotPass",value:function(e){this.props.router.push("/dl/market")}},{key:"initColumns",value:function(){var e=this;return[{title:"标签名称",dataIndex:"apiName",key:"apiName",render:function(t,a){if(a.apiDeleted)return s.a.createElement("a",{className:"disable-all",onClick:e.apiClick.bind(e,a)},t+"(已删除)");var n=1==a.apiStatus,i=n?"(全平台禁用)":"";return s.a.createElement("a",{className:n?"disable-all":"",onClick:e.apiClick.bind(e,a)},t+i)}},{title:"授权状态",dataIndex:"status",key:"status",render:function(e){return s.a.createElement("span",{className:"state-"+ma[e]},{success:"已通过",disabled:"取消授权",stop:"停用",notPass:"已拒绝"}[ma[e]])},filters:[{text:"已通过",value:"1"},{text:"已拒绝",value:"2"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}]},{title:"描述",dataIndex:"apiDesc",key:"apiDesc",width:300},{title:"最近24小时调用(次)",dataIndex:"recentCallNum",key:"recentCallNum"},{title:"最近24小时失败率",dataIndex:"recentFailRate",key:"recentFailRate",render:function(e){return e+"%"}},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",sorter:!0,render:function(e){return H.a.formatDateTime(e)}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a){var n={success:"停用",disabled:"",stop:"启用",notPass:"再次申请"};return n[ma[a.status]]?s.a.createElement("a",{onClick:e.dealClick.bind(e,a)},n[ma[a.status]]):null}}]}},{key:"getSource",value:function(){return this.props.mine.apiList.appliedList.data||[]}},{key:"getTotal",value:function(){return this.props.mine.apiList.appliedList&&this.props.mine.apiList.appliedList.totalCount||0}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.getTotal()}}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getAppliedList()})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(Y.a,{noHovering:!0,bordered:!1},s.a.createElement(Lt,U()({},this.props,{isApproved:!0,showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowNoApproved,closeSlidePane:this.closeSlidePane.bind(this)})),s.a.createElement(Gt,U()({},this.props,{showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowDisabled,closeSlidePane:this.closeSlidePane.bind(this)})),s.a.createElement(pa,U()({style:{right:"0px"}},this.props,{showRecord:this.state.showRecord,slidePaneShow:this.state.slidePaneShowSuccess,closeSlidePane:this.closeSlidePane.bind(this)})),s.a.createElement("div",{className:"flex font-12"},s.a.createElement(_a,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"10px"},onSearch:this.handleApiSearch.bind(this)})),s.a.createElement(K.a,{rowClassName:function(t,a){return e.state.showRecord.apiId==t.apiId?"row-select":""},rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange})))}}]),t}(r.Component),fa=Ea,Ta=fa,Aa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(da,"confirm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(_a,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(ma,"exchangeDic","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(ga,"sortType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(ha,"orderType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(Ea,"ApprovedCard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js"),__REACT_HOT_LOADER__.register(fa,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/approvedCard.js")),function(e){var t=e.user;return{mine:e.mine,user:t}}),ya=function(e){return{getApplyingList:function(t,a,n,i){return e(vt.getApplyingList({currentPage:t,pageSize:20,orderBy:a,sort:n,apiName:i}))},getAppliedList:function(t,a,n,i,r){return e(vt.getAppliedList({currentPage:t,pageSize:20,orderBy:a,sort:n,status:i,apiName:r}))},updateApplyStatus:function(t,a){return e(vt.updateApplyStatus({applyId:t,status:a}))},getApiCallInfo:function(t,a){return e(vt.getApiCallInfo({apiId:t,time:a}))},getApiCallErrorInfo:function(t){return e(vt.getApiCallErrorInfo({apiId:t}))},getApiCallUrl:function(t){return e(vt.getApiCallUrl({apiId:t}))},queryApiCallLog:function(t,a,n){return e(vt.queryApiCallLog({apiId:t,currentPage:a,bizType:n,pageSize:5}))},getApiCreatorInfo:function(t){return e(vt.getApiCreatorInfo({apiId:t}))}}},Ca=Object(C.b)(Aa,ya)($t=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={nowView:"notApproved",pageIndex:1},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"handleClick",value:function(e){this.setState({nowView:e}),"approved"==e?this.props.router.replace("/dl/mine/approved"):this.props.router.replace("/dl/mine")}},{key:"componentWillMount",value:function(){var e=this.props.router.params.view;e&&this.setState({nowView:e})}},{key:"getCardView",value:function(){return this.state.nowView&&"notApproved"==this.state.nowView?s.a.createElement(Pt,this.props):s.a.createElement(Ta,this.props)}},{key:"render",value:function(){this.props.children;return s.a.createElement("div",{style:{height:"100%",overflowX:"hidden"}},s.a.createElement("div",{className:"box-1 m-card shadow m-tabs"},s.a.createElement(At.a,{animated:!1,defaultActiveKey:this.state.nowView,onChange:this.handleClick.bind(this),style:{height:"auto",overflow:"inherit"}},s.a.createElement(At.a.TabPane,{tab:"未审批",key:"notApproved"},s.a.createElement(Pt,U()({apiId:this.props.location.query&&this.props.location.query.apiId},this.props))),s.a.createElement(At.a.TabPane,{tab:"已审批",key:"approved"},s.a.createElement(Ta,U()({apiId:this.props.location.query&&this.props.location.query.apiId},this.props))))))}}]),t}(r.Component))||$t,ba=Ca,va=ba,Da=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Aa,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/index.js"),__REACT_HOT_LOADER__.register(ya,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/index.js"),__REACT_HOT_LOADER__.register(Ca,"MyAPI","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/index.js"),__REACT_HOT_LOADER__.register(ba,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/myApi/index.js")),a(588)),ka={getAllApiList:function(e){return Oe.post(me.GET_ALL_API_LIST,e)},getDataSourceByBaseInfo:function(e){return Oe.post(me.GET_DATASOURCE_BASE_INFO,e)},deleteApi:function(e){return Oe.post(me.DELETE_API,e)},updateApiStatus:function(e){return Oe.post(me.UPDATE_API,e)},getApiCallUserRankList:function(e){return Oe.post(me.GET_API_CALL_RANK,e)},getApiUserApplyList:function(e){return Oe.post(me.GET_API_BUY_STATE,e)},updateCatalogue:function(e){return Oe.post(me.UPDATE_CATAGORY,e)},addCatalogue:function(e){return Oe.post(me.ADD_CATAGORY,e)},deleteCatalogue:function(e){return Oe.post(me.DELETE_CATAGORY,e)},createApi:function(e){return Oe.post(me.NEW_API,e)},tablelist:function(e){return Oe.post(me.GET_TABLE_BY_DATASOURCE,e)},tablecolumn:function(e){return Oe.post(me.GET_TABLE_COLUMNS_DETAIL,e)},previewData:function(e){return Oe.post(me.GET_TABLE_PREVIEW_DATA,e)},updateApi:function(e){return Oe.post(me.CHANGE_API,e)},getApiInfo:function(e){return Oe.post(me.GET_API_DETAIL_INFO,e)},getApiCallErrorInfoForManager:function(e){return Oe.post(me.GET_API_CALL_ERROR_INFO_ADMIN,e)}},Oa=ka,Ra=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(ka,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/apiManage.js"),{getAllApiList:function(e){return function(t){return Oa.getAllApiList(e).then(function(e){if(1===e.code)return t({type:Da.a.GET_ALL_API_LIST,payload:e.data.data}),e})}},getDataSourceByBaseInfo:function(e){return function(t){return Oa.getDataSourceByBaseInfo(e).then(function(e){if(1===e.code)return e})}},deleteApi:function(e){return function(t){return Oa.deleteApi(e).then(function(e){if(1===e.code)return e})}},openApi:function(e){return function(t){return Oa.updateApiStatus({apiId:e,apiStatus:0}).then(function(e){if(1===e.code)return e})}},closeApi:function(e){return function(t){return Oa.updateApiStatus({apiId:e,apiStatus:1}).then(function(e){if(1===e.code)return e})}},getApiCallUserRankList:function(e){return function(t){return Oa.getApiCallUserRankList(e).then(function(e){if(1===e.code)return e})}},getApiUserApplyList:function(e){return function(t){return Oa.getApiUserApplyList(e).then(function(e){if(1===e.code)return e})}},updateCatalogue:function(e){return function(t){return Oa.updateCatalogue(e).then(function(e){if(1===e.code)return e})}},deleteCatalogue:function(e){return function(t){return Oa.deleteCatalogue(e).then(function(e){if(1===e.code)return e})}},addCatalogue:function(e){return function(t){return Oa.addCatalogue(e).then(function(e){if(1===e.code)return e})}},createApi:function(e){return function(t){return Oa.createApi(e).then(function(e){if(1===e.code)return e})}},updateApi:function(e){return function(t){return Oa.updateApi(e).then(function(e){if(1===e.code)return e})}},tablelist:function(e){return function(t){return Oa.tablelist(e).then(function(e){if(1===e.code)return e})}},tablecolumn:function(e){return function(t){return Oa.tablecolumn(e).then(function(e){if(1===e.code)return e})}},previewData:function(e){return function(t){return Oa.previewData(e).then(function(e){if(1===e.code)return e})}},getApiInfo:function(e){return function(t){return Oa.getApiInfo(e).then(function(e){if(1===e.code)return e})}},getApiCallErrorInfo:function(e){return function(t){return Oa.getApiCallErrorInfoForManager(e).then(function(e){if(1===e.code)return e})}}});"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ra,"apiManageActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/apiManage/index.js"),a(68);function La(e){switch(e){case Ie.b.MYSQL:return"MySQL";case Ie.b.ORACLE:return"Oracle";case Ie.b.SQLSERVER:return"SQLServer";case Ie.b.HDFS:return"HDFS";case Ie.b.HIVE:return"Hive";case Ie.b.HBASE:return"HBase";case Ie.b.FTP:return"FTP";case Ie.b.MAXCOMPUTE:return"MaxCompute";default:return"其他"}}function Sa(e){switch(e.value){case!0:return s.a.createElement("span",null,"通过");case!1:return s.a.createElement("span",null,"未通过");default:return s.a.createElement("span",null,"--")}}"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(La,"dataSourceText","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/components/display/index.js"),__REACT_HOT_LOADER__.register(Sa,"DetailCheckStatus","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/components/display/index.js"));var wa,xa,Ia,Ha=$.a.Search,Na=X.a.Option,Pa=J.a.confirm,Ua=function(e){return{user:e.user,apiMarket:e.apiMarket,apiManage:e.apiManage,dataSource:e.dataSource}},ja=function(e){return{getCatalogue:function(t){e(Se.getCatalogue(t))},getAllApiList:function(t){return e(Ra.getAllApiList(t))},getDataSourceList:function(t){return e(Ra.getDataSourceByBaseInfo({type:t}))},deleteApi:function(t){return e(Ra.deleteApi({apiIds:[t]}))},openApi:function(t){return e(Ra.openApi(t))},closeApi:function(t){return e(Ra.closeApi(t))},getDataSourcesType:function(){return e(lt.getDataSourcesType())}}},Ma=Object(C.b)(Ua,ja)(wa=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageSize:20,pageIndex:1,type1:void 0,type2:void 0,total:0,dataSourceType:void 0,dataSource:void 0,searchName:null,filter:{},sortedInfo:{},changeMan:null,loading:!1},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.dataSourceTypeChange=function(){var e;return(e=n).__dataSourceTypeChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.getAllApi(),this.getDataSource(null),this.props.getDataSourcesType()}},{key:"exchangeSourceType",value:function(){var e=[],t={},a=this.props.dataSource.sourceType;for(var n in a){var i=a[n];t[i.value]=i.name,e.push({text:i.name,value:i.value})}return{typeList:e,typeDic:t}}},{key:"getAllApi",value:function(){var e=this,t={};t.name=this.state.searchName,t.pid=this.state.type1,t.cid=this.state.type2,t.dataSourceType=this.state.dataSourceType&&parseInt(this.state.dataSourceType),t.dataSourceId=this.state.dataSource&&parseInt(this.state.dataSource),t.modifyUserId=this.state.changeMan,t.orderBy={gmtModified:"gmt_modified"}[this.state.sortedInfo.columnKey],t.sort={ascend:"asc",descend:"desc"}[this.state.sortedInfo.order],t.currentPage=this.state.pageIndex,t.pageSize=this.state.pageSize,this.setState({loading:!0}),this.props.getAllApiList(t).then(function(t){e.setState({loading:!1}),t&&e.setState({total:t.data.totalCount})})}},{key:"renderSourceType",value:function(e,t){function a(e){return!e||e.length<1?null:e.map(function(e){return s.a.createElement(Na,{key:e.id},e.name)})}var n=[],i=this.props.apiMarket.apiCatalogue;if(t){if(!i)return null;for(var r=0;r<i.length;r++)n.push({id:i[r].id,name:i[r].catalogueName});return a(n)}if(!i)return null;for(var o=void 0,l=0;l<i.length;l++)if(i[l].id==e){o=i[l].childCatalogue;break}if(!o)return null;for(var u=0;u<o.length;u++)o[u].api||n.push({id:o[u].id,name:o[u].catalogueName});return a(n)}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({type1:e,type2:void 0},function(){t.getAllApi()})}},{key:"onUserSourceChange",value:function(e){var t=this;this.setState({type2:e},function(){t.getAllApi()})}},{key:"handleSearch",value:function(e){var t=this;this.setState({searchName:e||void 0,pageIndex:1},function(){t.getAllApi()})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,filter:t,sortedInfo:a},function(){n.getAllApi()})}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.state.total}}},{key:"openDetail",value:function(e){this.props.router.push("/dl/manage/detail/"+e)}},{key:"initColumns",value:function(){var e=this;return[{width:"10%",title:"标签名称",dataIndex:"name",key:"name",render:function(t,a){return s.a.createElement("a",{onClick:e.openDetail.bind(e,a.apiId)},t)}},{width:100,title:"类型",dataIndex:"type",key:"type",render:function(e,t){return Ie.h[e]}},{width:"10%",title:"描述",dataIndex:"tagDesc",key:"tagDesc"},{width:"10%",title:"数据源",dataIndex:"dataSourceType",key:"dataSourceType",render:function(e,t){return La(t.dataSourceType)+" / "+t.dataSourceName}},{width:"10%",title:"最近24小时调用",dataIndex:"total1d",key:"total1d"},{width:"8%",title:"累计调用",dataIndex:"invokeTotal",key:"invokeTotal"},{width:"10%",title:"最近修改人",dataIndex:"modifyUser",key:"modifyUser"},{width:"10%",title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",sorter:!0,render:function(e){return H.a.formatDateTime(e)}},{width:"10%",title:"创建人",dataIndex:"createUser",key:"createUser"},{width:100,title:"启用状态",dataIndex:"apiStatus",key:"apiStatus",render:function(e,t){return Ie.a[e]}},{width:120,title:"操作",dataIndex:"deal",key:"deal",render:function(t,a){return 0==a.apiStatus?s.a.createElement("a",{onClick:e.closeApi.bind(e,a.apiId)},"禁用"):s.a.createElement("div",null,s.a.createElement("a",{onClick:e.openApi.bind(e,a.apiId)},"开启"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.editApi.bind(e,a.id)},"编辑"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.deleteApi.bind(e,a.apiId)},"删除"))}}]}},{key:"getSource",value:function(){return this.props.apiManage.apiList}},{key:"editApi",value:function(e){this.props.router.push("/dl/manage/editApi/"+e)}},{key:"openApi",value:function(e){var t=this;Pa({title:"确认开启?",content:"确认开启标签",onOk:function(){t.setState({loading:!0}),t.props.openApi(e).then(function(e){t.setState({loading:!1}),pe.a.success("开启成功"),e&&t.getAllApi()})},onCancel:function(){}})}},{key:"closeApi",value:function(e){var t=this;Pa({title:"确认禁用?",content:"确认禁用标签",onOk:function(){t.setState({loading:!0}),t.props.closeApi(e).then(function(e){t.setState({loading:!1}),pe.a.success("禁用成功"),e&&t.getAllApi()})},onCancel:function(){}})}},{key:"deleteApi",value:function(e){var t=this;Pa({title:"确认删除?",content:"确认删除标签",onOk:function(){t.setState({loading:!0}),t.props.deleteApi(e).then(function(e){t.setState({loading:!1}),1===e.code&&(pe.a.success("删除成功"),t.getAllApi())})},onCancel:function(){}})}},{key:"gerDataSourceView",value:function(){var e=this.state.dataSourceList;return e?e.map(function(e,t){return s.a.createElement(Na,{key:e.id},e.name)}):null}},{key:"getDataSource",value:function(){var e=this;this.props.getDataSourceList(this.state.dataSourceType).then(function(t){if(t){var a=t.data;e.setState({dataSourceList:a})}})}},{key:"getDataSourceTypeView",value:function(){var e=this.exchangeSourceType(),t=e.typeList;e.typeDic;return!t||t.length<1?null:t.map(function(e){return s.a.createElement(Na,{key:e.value},e.text)})}},{key:"__dataSourceTypeChange__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({dataSourceType:e,dataSource:void 0},function(){t.getDataSource(),t.getAllApi()})}},{key:"dataSourceChange",value:function(e){var t=this;this.setState({dataSource:e},function(){t.getAllApi()})}},{key:"changeManCheck",value:function(e){var t=this,a=null;e.target.checked&&(a=this.props.user.id),this.setState({changeMan:a},function(){t.getAllApi()})}},{key:"openApiType",value:function(){this.props.router.push("/dl/manage/apiType")}},{key:"newApi",value:function(){this.props.router.push("/dl/manage/newApi")}},{key:"render",value:function(){this.props.children;var e=s.a.createElement("div",{className:"flex font-12"},s.a.createElement(Ha,{placeholder:"输入标签名称搜索",style:{width:200,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),s.a.createElement("div",{className:"m-l-8"},"标签分类：",s.a.createElement(X.a,{allowClear:!0,value:this.state.type1,style:{width:150},onChange:this.onSourceChange},this.renderSourceType(0,!0))),s.a.createElement("div",{className:"m-l-8"},"类型：",s.a.createElement(X.a,{allowClear:!0,value:this.state.dataSourceType,style:{width:150},onChange:this.dataSourceTypeChange},this.getDataSourceTypeView()))),t=s.a.createElement("div",{style:{paddingTop:"10px"}},s.a.createElement(xe.a,{onClick:this.openApiType.bind(this),style:{marginRight:"8px"},type:"primary"},"类目管理"));return s.a.createElement("div",{className:"api-management"},s.a.createElement("div",{style:{marginTop:"20px"},className:"margin-0-20 m-card box-2"},s.a.createElement(Y.a,{noHovering:!0,title:e,extra:t},s.a.createElement(K.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))))}}]),t}(r.Component))||wa,Ga=Ma,Va=Ga,Fa=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Ha,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(Na,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(Pa,"confirm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(Ua,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(ja,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(Ma,"APIMana","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js"),__REACT_HOT_LOADER__.register(Ga,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/index.js")),a(587)),qa={allApplyList:function(e){return Oe.post(me.GET_ALL_APPLY_LIST,e)},handleApply:function(e){return Oe.post(me.HANDLE_APPLY,e)}},Ba=qa,Ya=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(qa,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/approval.js"),{allApplyList:function(e){return function(t){return Ba.allApplyList(e).then(function(e){if(1===e.code)return t({type:Fa.a.GET_ALL_APPLY_LIST,payload:e.data.data}),e})}},handleApply:function(e){return function(t){return Ba.handleApply(e).then(function(e){if(1===e.code)return e})}}}),za=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ya,"approvalActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/approval/index.js"),$.a.TextArea),Ka=$.a.Search,Qa=te.a.Item,Ja={applyTime:"gmt_modified"},Wa={ascend:"asc",descend:"desc"},Xa=function(e){var t=e.user;return{approval:e.approval,apiManage:e.apiManage,user:t}},Za=function(e){return{approvalList:function(t){return e(Ya.allApplyList(t))},handleApply:function(t){return e(Ya.handleApply(t))}}},$a=Object(C.b)(Xa,Za)(xa=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageIndex:1,spVisible:!1,msgVisible:!1,data:[],sorter:{},filter:{status:null},userName:"",applyContent:"",replyContent:"",apiName:void 0,spApplyMsg:{},total:0},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=this.props.router.location.query&&this.props.router.location.query.status,a=[];t&&a.push(t.toString()),this.setState({filter:{status:a&&a.length>0?a:null}},function(){e.getApprovalList()})}},{key:"getApprovalList",value:function(){var e=this;this.props.approvalList({userName:this.state.userName,status:this.state.filter.status&&this.state.filter.status[0],currentPage:this.state.pageIndex,pageSize:20,sort:Wa[this.state.sorter.order],orderBy:Ja[this.state.sorter.columnKey],apiName:this.state.apiName}).then(function(t){t&&e.setState({total:t.data.totalCount})})}},{key:"handleSearch",value:function(e){var t=this;this.setState({userName:e,pageIndex:1},function(){t.getApprovalList()})}},{key:"handleApiSearch",value:function(e){var t=this;this.setState({apiName:e,pageIndex:1},function(){t.getApprovalList()})}},{key:"onSourceChange",value:function(){}},{key:"handleCancel",value:function(){this.setState({spVisible:!1,msgVisible:!1})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,filter:t,sorter:a},function(){n.getApprovalList()})}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:20,total:this.state.total}}},{key:"getDealType",value:function(e){return{notApproved:"立即审批",pass:"查看详情",rejected:"查看详情",stop:"查看详情",disabled:"查看详情"}[e||"nothing"]}},{key:"deal",value:function(e){var t=this["deal"+Ie.e[e.status]];t&&t.call(this,e)}},{key:"dealrejected",value:function(e){this.lookDetail(e)}},{key:"dealstop",value:function(e){this.lookDetail(e)}},{key:"dealdisabled",value:function(e){this.lookDetail(e)}},{key:"dealpass",value:function(e){this.lookDetail(e)}},{key:"dealnotApproved",value:function(e){this.spShow(e)}},{key:"getSource",value:function(){return this.props.approval.approvalList}},{key:"initColumns",value:function(){var e=this;return[{title:"申请人",dataIndex:"applyUserName",key:"applyUserName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return s.a.createElement("span",{className:"state-"+Ie.e[e]},{notApproved:"未审批",pass:"已通过",rejected:"已拒绝",stop:"停用",disabled:"取消授权"}[Ie.e[e]])},filterMultiple:!1,filters:[{text:"未审批",value:"0"},{text:"已通过",value:"1"},{text:"已拒绝",value:"2"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}],filteredValue:this.state.filter.status||null},{title:"申请标签",dataIndex:"apiName",key:"apiName"},{title:"申请说明",dataIndex:"applyContent",key:"applyContent",width:"250px"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime",sorter:!0,render:function(e){return H.a.formatDateTime(e)}},{title:"操作",dataIndex:"deal",render:function(t,a){return s.a.createElement("a",{onClick:e.deal.bind(e,a)},e.getDealType(Ie.e[a.status]))}}]}},{key:"renderSourceType",value:function(){return null}},{key:"getCardTitle",value:function(){return s.a.createElement("div",{className:"flex font-12"},s.a.createElement(Ka,{placeholder:"输入用户名称搜索",style:{width:150,margin:"10px 0"},onSearch:this.handleSearch.bind(this)}),s.a.createElement(Ka,{placeholder:"输入标签名称搜索",style:{width:150,margin:"10px 0px",marginLeft:"30px"},onSearch:this.handleApiSearch.bind(this)}))}},{key:"sp",value:function(e){var t=this;this.props.form.validateFields(function(a,n){if(!a){var i=t.state.spApplyMsg.id,r=n.APIGroup;t.props.handleApply({applyId:i,isPassed:e,approvalContent:r}).then(function(e){t.setState({spVisible:!1}),e&&(pe.a.success("审批成功"),t.getApprovalList())})}})}},{key:"spShow",value:function(e){this.props.form.resetFields(),this.setState({spVisible:!0,spApplyMsg:e})}},{key:"lookDetail",value:function(e){this.setState({msgVisible:!0,applyContent:e.applyContent,replyContent:e.replyContent})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return s.a.createElement("div",{className:"api-approval"},s.a.createElement("h1",{className:"box-title"},"审批授权"),s.a.createElement("div",{className:"margin-0-20 m-card"},s.a.createElement(Y.a,{noHovering:!0,title:this.getCardTitle(),className:"shadow"},s.a.createElement(K.a,{rowKey:"id",className:"m-table monitor-table",columns:this.initColumns(),loading:!1,pagination:this.getPagination(),dataSource:this.getSource(),onChange:this.onTableChange}))),s.a.createElement(J.a,{title:"审批授权",visible:this.state.spVisible,onCancel:this.handleCancel.bind(this),footer:s.a.createElement("div",null,s.a.createElement(xe.a,{type:"danger",onClick:this.sp.bind(this,!1)},"拒绝"),s.a.createElement(xe.a,{type:"primary",onClick:this.sp.bind(this,!0)},"同意"))},s.a.createElement(te.a,null,s.a.createElement(Qa,U()({},Ie.k,{label:"申请说明"}),s.a.createElement(za,{disabled:!0,value:this.state.spApplyMsg.applyContent})),s.a.createElement(Qa,U()({},Ie.k,{label:"审批说明"}),e("APIGroup",{rules:[{required:!0,message:"请填写审批说明"},{max:200,message:"最大字数不能超过200"}]})(s.a.createElement(za,null))))),s.a.createElement(J.a,{title:"审批详情",visible:this.state.msgVisible,footer:s.a.createElement(xe.a,{type:"primary",onClick:this.handleCancel.bind(this)},"关闭"),onCancel:this.handleCancel.bind(this)},s.a.createElement(te.a,null,s.a.createElement(Qa,U()({},Ie.k,{label:"申请说明"}),s.a.createElement(za,{disabled:!0,value:this.state.applyContent})),s.a.createElement(Qa,U()({},Ie.k,{label:"审批说明"}),s.a.createElement(za,{disabled:!0,value:this.state.replyContent})))))}}]),t}(r.Component))||xa,en=te.a.create()($a),tn=en,an=tn,nn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(za,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Ka,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Qa,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Ja,"sortType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Wa,"orderType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Xa,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(Za,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register($a,"APIApproval","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(en,"WrapComponent","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js"),__REACT_HOT_LOADER__.register(tn,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/approval/index.js")),a(33)),rn=a.n(nn),sn=(a(201),a(98)),on=a.n(sn),ln=(a(102),a(67)),un=a.n(ln),cn=(a(176),a(52)),pn=a.n(cn),dn=(a(406),a(206)),_n=a.n(dn),mn=a(172),gn={queryRegisteredTag:function(e){return Oe.post(me.QUERY_REGISTERED_TAG,e)},addRegisterTag:function(e){return Oe.post(me.ADD_REGISTER_TAG,e)},queryRuleTag:function(e){return Oe.post(me.QUERY_RULE_TAG,e)},addRuleTag:function(e){return Oe.post(me.ADD_RULE_TAG,e)},updateTagSqlInfo:function(e){return Oe.post(me.UPDATE_TAG_SQL_INFO,e)},getTagCondition:function(e){return Oe.post(me.GET_TAG_CONDITION,e)},editTagCondition:function(e){return Oe.post(me.EDIT_TAG_CONDITION,e)},deleteTagCondition:function(e){return Oe.post(me.DELETE_TAG_CONDITION,e)},getComputeSource:function(e){return Oe.post(me.GET_COMPUTE_SOURCE,e)},queryTagLogInfo:function(e){return Oe.post(me.QUERY_TAG_LOG,e)},updateTagBaseInfo:function(e){return Oe.post(me.UPDATE_TAG_BASE_INFO,e)},deleteTag:function(e){return Oe.post(me.DELETE_TAG,e)},checkPublish:function(e){return Oe.post(me.PUBLISH_CHECK,e)},publishTag:function(e){return Oe.post(me.PUBLISH_TAG,e)},getRuleTagDetail:function(e){return Oe.post(me.GET_RULE_TAG_RETAIL,e)},getAllIdentifyColumn:function(e){return Oe.post(me.GET_ALL_IDENTIFY_COLUMN,e)},queryIdentifyColumn:function(e){return Oe.post(me.QUERY_IDENTIFY_COLUMN,e)},addIdentifyColumn:function(e){return Oe.post(me.ADD_IDENTIFY_COLUMN,e)},updateIdentifyColumn:function(e){return Oe.post(me.UPDATE_IDENTIFY_COLUMN,e)},deleteIdentifyColumn:function(e){return Oe.post(me.DELETE_IDENTIFY_COLUMN,e)}},hn=gn,En=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(gn,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/api/tagConfig.js"),{getRegisteredTagList:function(e){return function(t){t({type:mn.a.CHANGE_LOADING}),hn.getRegisteredTag(e).then(function(e){1===e.code&&t({type:mn.a.GET_REGISTERED_TAG_LIST,payload:e.data}),t({type:mn.a.CHANGE_LOADING})})}},getRuleTagList:function(e){return function(t){t({type:mn.a.CHANGE_LOADING}),hn.queryRuleTag(e).then(function(e){1===e.code&&t({type:mn.a.GET_RULE_TAG_LIST,payload:e.data}),t({type:mn.a.CHANGE_LOADING})})}},getAllIdentifyColumn:function(e){return function(t){hn.getAllIdentifyColumn(e).then(function(e){1===e.code&&t({type:mn.a.GET_ALL_IDENTIFY_COLUMN,payload:e.data})})}}}),fn=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(En,"tagConfigActions","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/actions/tagConfig/index.js"),X.a.Option),Tn=te.a.Item,An=$.a.TextArea,yn=function(e){return{tagConfig:e.tagConfig,dataSource:e.dataSource,apiMarket:e.apiMarket}},Cn=function(e){return{getTagDataSourcesList:function(t){e(lt.getTagDataSourcesList(t))},getAllIdentifyColumn:function(t){e(En.getAllIdentifyColumn(t))},getDataSourcesTable:function(t){e(lt.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(lt.resetDataSourcesTable())},getDataSourcesColumn:function(t){e(lt.getDataSourcesColumn(t))},resetDataSourcesColumn:function(){e(lt.resetDataSourcesColumn())}}},bn=Object(C.b)(yn,Cn)(Ia=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={},n.initCatagoryOption=function(){var e;return(e=n).__initCatagoryOption__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceChange=function(){var e;return(e=n).__onSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourceTableChange=function(){var e;return(e=n).__onSourceTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.getTagDataSourcesList(),this.props.getAllIdentifyColumn()}},{key:"__initCatagoryOption__REACT_HOT_LOADER__",value:function(e){var t=this;return e.some(function(e){return!0===e.api})?[]:e.map(function(e){return{value:e.id,label:e.catalogueName,children:t.initCatagoryOption(e.childCatalogue)}})}},{key:"__onSourceChange__REACT_HOT_LOADER__",value:function(e){this.props.form.setFieldsValue({originTable:void 0,originColumn:void 0,identityColumn:void 0}),this.props.resetDataSourcesTable(),this.props.resetDataSourcesColumn(),this.props.getDataSourcesTable({sourceId:e})}},{key:"__onSourceTableChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form;t.setFieldsValue({originColumn:void 0,identityColumn:void 0}),this.props.resetDataSourcesColumn(),this.props.getDataSourcesColumn({sourceId:t.getFieldValue("dataSourceId"),tableName:e})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.visible,n=e.editData,i=e.apiMarket,r=e.dataSource,o=e.tagConfig,l=t.getFieldDecorator,u=i.apiCatalogue,c=o.identifyColumn,p=r.tagSourceList,d=r.sourceTable,_=r.sourceColumn,m="已发布"===Ie.f[n.publishStatus],g=(n.name?"编辑":"新建")+Ie.h[n.type];return s.a.createElement(J.a,{title:g,wrapClassName:"ruleTagModal",width:"50%",visible:a,maskClosable:!1,okText:"保存",cancelText:"取消",onOk:this.props.saveTag.bind(this,t),onCancel:this.props.cancel.bind(this,t)},s.a.createElement(te.a,null,s.a.createElement(Tn,U()({},Ie.k,{label:"标签名称"}),l("name",{rules:[{required:!0,message:"标签名称不可为空"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:n.name})(s.a.createElement($.a,{disabled:m}))),s.a.createElement(Tn,U()({},Ie.k,{label:"标签描述"}),l("tagDesc",{rules:[{max:200,message:"描述字符不能超过200"}],initialValue:n.tagDesc})(s.a.createElement(An,{placeholder:"标签描述",autosize:{minRows:2,maxRows:6}}))),s.a.createElement(Tn,U()({},Ie.k,{label:"标签类目"}),l("catalogueId",{rules:[{required:!0,message:"标签类目不可为空"}],initialValue:n.catalogueId})(s.a.createElement(_n.a,{showSearch:!0,popupClassName:"noheight",options:this.initCatagoryOption(u),placeholder:"请选择分组"}))),s.a.createElement(Tn,U()({},Ie.k,{label:"值域"}),l("tagRange",{rules:[{required:!0,message:"值域不可为空"},{max:200,message:"请控制在200个字符以内！"}],initialValue:n.tagRange})(s.a.createElement(An,{placeholder:"值域",autosize:{minRows:2,maxRows:6}}))),s.a.createElement(Tn,U()({},Ie.k,{label:"目标数据库"}),l("dataSourceId",{rules:[{required:!0,message:"目标数据库不可为空"}],initialValue:n.dataSourceId?n.dataSourceId.toString():void 0})(s.a.createElement(X.a,{showSearch:!0,optionFilterProp:"title",placeholder:"选择目标数据库",disabled:m,onChange:this.onSourceChange},p.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return s.a.createElement(fn,{key:e.id,value:e.id.toString(),title:t},t)})))),"注册标签"===Ie.h[n.type]?s.a.createElement("div",null,s.a.createElement(Tn,U()({},Ie.k,{label:"来源表"}),l("originTable",{rules:[{required:!0,message:"请选择来源表"}],initialValue:n.originTable})(s.a.createElement(X.a,{showSearch:!0,placeholder:"选择来源表",disabled:m,onChange:this.onSourceTableChange},d.map(function(e){return s.a.createElement(fn,{key:e,value:e},e)})))),s.a.createElement(Tn,U()({},Ie.k,{label:"来源列"}),l("originColumn",{rules:[{required:!0,message:"请选择来源列"}],initialValue:n.originColumn})(s.a.createElement(X.a,{showSearch:!0,disabled:m,placeholder:"选择来源列"},_.map(function(e){return s.a.createElement(fn,{key:e.key,value:e.key},e.key)})))),s.a.createElement(Tn,U()({},Ie.k,{label:"识别列ID"}),l("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"}],initialValue:n.identityColumn})(s.a.createElement(X.a,{showSearch:!0,disabled:m,placeholder:"选择识别列ID"},_.map(function(e){return s.a.createElement(fn,{key:e.key,value:e.key},e.key)}))))):s.a.createElement("div",null,s.a.createElement(Tn,U()({},Ie.k,{label:"来源表"}),l("originTable",{rules:[{required:!0,message:"来源表不可为空"},{max:64,message:"请控制在64个字符以内！"}],initialValue:n.originTable})(s.a.createElement($.a,{disabled:m}))),s.a.createElement(Tn,U()({},Ie.k,{label:"识别列ID"}),l("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"},{max:64,message:"请控制在64个字符以内！"}],initialValue:n.identityColumn})(s.a.createElement($.a,{disabled:m})))),s.a.createElement(Tn,U()({},Ie.k,{label:"识别列类型"}),l("identityId",{rules:[{required:!0,message:"识别列类型不可为空"}],initialValue:n.identityId?n.identityId.toString():void 0})(s.a.createElement(X.a,{showSearch:!0,optionFilterProp:"title",placeholder:"选择识别列类型",disabled:m},c.map(function(e){return s.a.createElement(fn,{key:e.id,value:e.id.toString(),title:e.name},e.name)}))))))}}]),t}(r.Component))||Ia;bn=te.a.create()(bn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(fn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"),__REACT_HOT_LOADER__.register(Tn,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"),__REACT_HOT_LOADER__.register(An,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"),__REACT_HOT_LOADER__.register(yn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"),__REACT_HOT_LOADER__.register(Cn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"),__REACT_HOT_LOADER__.register(bn,"EditTagModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/editTagModal.js"));var vn,Dn,kn,On=$.a.Search,Rn=X.a.Option,Ln=function(e){return{apiMarket:e.apiMarket}},Sn=function(e){return{getDataSourcesTable:function(t){e(lt.getDataSourcesTable(t))},getDataSourcesColumn:function(t){e(lt.getDataSourcesColumn(t))}}},wn=Object(C.b)(Ln,Sn)(vn=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={visible:!1,loading:!1,queryParams:{currentPage:1,pageSize:20},tagList:{},editData:{},catalogue2Data:[]},n.getTagListData=function(){var e;return(e=n).__getTagListData__REACT_HOT_LOADER__.apply(e,arguments)},n.initRuleTagTable=function(){var e;return(e=n).__initRuleTagTable__REACT_HOT_LOADER__.apply(e,arguments)},n.initRegisterTagTable=function(){var e;return(e=n).__initRegisterTagTable__REACT_HOT_LOADER__.apply(e,arguments)},n.checkPublish=function(){var e;return(e=n).__checkPublish__REACT_HOT_LOADER__.apply(e,arguments)},n.addTag=function(){var e;return(e=n).__addTag__REACT_HOT_LOADER__.apply(e,arguments)},n.editBaseInfo=function(){var e;return(e=n).__editBaseInfo__REACT_HOT_LOADER__.apply(e,arguments)},n.removeTag=function(){var e;return(e=n).__removeTag__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},n.openModal=function(){var e;return(e=n).__openModal__REACT_HOT_LOADER__.apply(e,arguments)},n.closeModal=function(){var e;return(e=n).__closeModal__REACT_HOT_LOADER__.apply(e,arguments)},n.saveTag=function(){var e;return(e=n).__saveTag__REACT_HOT_LOADER__.apply(e,arguments)},n.onFirstCatalogueChange=function(){var e;return(e=n).__onFirstCatalogueChange__REACT_HOT_LOADER__.apply(e,arguments)},n.getSecondCatalogue=function(){var e;return(e=n).__getSecondCatalogue__REACT_HOT_LOADER__.apply(e,arguments)},n.onSecondCatalogueChange=function(){var e;return(e=n).__onSecondCatalogueChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onTagNameSearch=function(){var e;return(e=n).__onTagNameSearch__REACT_HOT_LOADER__.apply(e,arguments)},n.getCatalogueArray=function(){var e;return(e=n).__getCatalogueArray__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getTagListData(this.state.queryParams)}},{key:"__getTagListData__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({loading:!0}),("rule"===this.props.tagType?hn.queryRuleTag:hn.queryRegisteredTag)(e).then(function(e){1===e.code&&t.setState({loading:!1,tagList:e.data})})}},{key:"__initRuleTagTable__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"标签名称",dataIndex:"name",key:"name",width:"10%"},{title:"标签描述",dataIndex:"tagDesc",key:"tagDesc",width:"12%"},{title:"标签类目",dataIndex:"catalogueName",key:"catalogueName",width:"10%"},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:100},{title:"目标数据库",dataIndex:"dataSourceName",key:"dataSourceName",width:"8%"},{title:"来源表",dataIndex:"originTable",key:"originTable",width:"8%"},{title:"识别列ID",dataIndex:"identityColumn",key:"identityColumn",width:100},{title:"识别列类型",dataIndex:"identityName",key:"identityName",width:"8%"},{title:"更新日期",dataIndex:"gmtModified",key:"gmtModified",width:"10%",render:function(e){return e?H.a.formatDateTime(e):"--"}},{title:"状态",dataIndex:"status",key:"status",width:100,render:function(e){return Ie.g[e]}},{title:"发布状态",dataIndex:"publishStatus",key:"publishStatus",width:90,render:function(e){return Ie.f[e]}},{title:"操作",width:90,render:function(t,a){var n=s.a.createElement(pn.a,null,"更新中"!=Ie.g[a.status]&&s.a.createElement(pn.a.Item,{key:"edit"},s.a.createElement("a",{onClick:e.editBaseInfo.bind(e,a)},"编辑")),"更新中"!=Ie.g[a.status]&&"未发布"===Ie.f[a.publishStatus]&&s.a.createElement(pn.a.Item,{key:"edit2"},s.a.createElement(y.c,{to:"/dl/tagConfig/ruleTagEdit/"+a.id},"配置计算逻辑")),"更新完成"==Ie.g[a.status]&&"未发布"===Ie.f[a.publishStatus]&&s.a.createElement(pn.a.Item,{key:"pub"},s.a.createElement("a",{onClick:e.checkPublish.bind(e,a.id)},"发布")),s.a.createElement(pn.a.Item,{key:"log"},s.a.createElement(y.c,{to:"/dl/tagConfig/tagLog/"+a.id},"查看更新历史")),s.a.createElement(pn.a.Item,{key:"del"},s.a.createElement(un.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:e.removeTag.bind(e,a.id)},s.a.createElement("a",null,"删除"))));return s.a.createElement("span",{id:"tag_"+a.id},s.a.createElement(on.a,{getPopupContainer:function(){return document.getElementById("tag_"+a.id)},overlay:n,trigger:["click"]},s.a.createElement(xe.a,null,"操作",s.a.createElement(M.a,{type:"down"}))))}}]}},{key:"__initRegisterTagTable__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"标签名称",dataIndex:"name",key:"name",width:"10%"},{title:"标签描述",dataIndex:"tagDesc",key:"tagDesc",width:"10%"},{title:"标签类目",dataIndex:"catalogueName",key:"catalogueName",width:"8%"},{title:"值域",dataIndex:"tagRange",key:"tagRange",width:120},{title:"目标数据库",dataIndex:"dataSourceName",key:"dataSourceName",width:"8%"},{title:"识别列ID",dataIndex:"identityColumn",key:"identityColumn",width:"8%"},{title:"识别列类型",dataIndex:"identityName",key:"identityName",width:"8%"},{title:"来源表",dataIndex:"originTable",key:"originTable",width:"8%"},{title:"来源列",dataIndex:"originColumn",key:"originColumn",width:"8%"},{title:"状态",dataIndex:"status",key:"status",width:100,render:function(e){return Ie.g[e]}},{title:"发布状态",dataIndex:"publishStatus",key:"publishStatus",width:90,render:function(e){return Ie.f[e]}},{title:"操作",width:110,render:function(t,a){var n=s.a.createElement(pn.a,null,s.a.createElement(pn.a.Item,{key:"1"},s.a.createElement(y.c,{to:"/dl/manage/newApi/"+a.id},"发布")),s.a.createElement(pn.a.Item,{key:"2"},s.a.createElement(un.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:e.removeTag.bind(e,a.id)},s.a.createElement("a",null,"删除")))),i="tag_"+a.id;return s.a.createElement("div",null,s.a.createElement("a",{onClick:function(){e.editBaseInfo(a)}},"编辑"),s.a.createElement("span",{className:"ant-divider",id:i}),"已发布"==Ie.f[a.publishStatus]?s.a.createElement(un.a,{title:"确定删除此标签？",okText:"确定",cancelText:"取消",onConfirm:e.removeTag.bind(e,a.id)},s.a.createElement("a",null,"删除")):s.a.createElement(on.a,{getPopupContainer:function(){return document.getElementById(i)},overlay:n,trigger:["click"]},s.a.createElement("a",{className:"ant-dropdown-link"},"更多 ",s.a.createElement(M.a,{type:"down"}))))}}]}},{key:"__checkPublish__REACT_HOT_LOADER__",value:function(e){hn.checkPublish({tagId:e}).then(function(t){1===t.code&&t.data&&y.g.push("/dl/manage/newApi/"+e)})}},{key:"__addTag__REACT_HOT_LOADER__",value:function(e){this.openModal(),this.setState({editData:{type:"rule"===this.props.tagType?2:1}})}},{key:"__editBaseInfo__REACT_HOT_LOADER__",value:function(e){var t=U()({},e,{catalogueId:this.getCatalogueArray(e.catalogueId)});this.openModal(),this.setState({editData:t}),"register"===this.props.tagType&&"未发布"===Ie.f[t.publishStatus]&&(this.props.getDataSourcesTable({sourceId:t.dataSourceId}),this.props.getDataSourcesColumn({sourceId:t.dataSourceId,tableName:t.originTable}))}},{key:"__removeTag__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.queryParams;e&&hn.deleteTag({tagId:e}).then(function(e){1===e.code&&(pe.a.success("删除成功！"),t.getTagListData(a))})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(e){this.closeModal(),e.resetFields()}},{key:"__openModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!0})}},{key:"__closeModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!1})}},{key:"__saveTag__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state,n=a.queryParams,i=a.editData;e.validateFields(function(a,r){var s=void 0,o=void 0,l=void 0;a||(r.catalogueId=[].concat(rn()(r.catalogueId)).pop(),i.id?(s=hn.updateTagBaseInfo,o=U()({},r,{id:i.id}),l="更新成功"):(s="rule"===t.props.tagType?hn.addRuleTag:hn.addRegisterTag,o=r,l="新增成功"),s(o).then(function(a){1===a.code&&(pe.a.success(l),t.closeModal(),e.resetFields(),t.getTagListData(n),t.setState({editData:{}}))}))})}},{key:"__onFirstCatalogueChange__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.queryParams,{currentPage:1,pid:e||void 0});e?this.getSecondCatalogue(e):this.setState({catalogue2Data:[]}),this.getTagListData(t),this.setState({queryParams:t})}},{key:"__getSecondCatalogue__REACT_HOT_LOADER__",value:function(e){var t=this.props.apiMarket.apiCatalogue.filter(function(t){return t.id==e})[0].childCatalogue;t=t.some(function(e){return e.api})?[]:t,this.setState({catalogue2Data:t})}},{key:"__onSecondCatalogueChange__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.queryParams,{currentPage:1,cid:e||void 0});this.getTagListData(t),this.setState({queryParams:t})}},{key:"__onTagNameSearch__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.queryParams,{currentPage:1,name:e||void 0});this.getTagListData(t),this.setState({queryParams:t})}},{key:"__getCatalogueArray__REACT_HOT_LOADER__",value:function(e){var t=[];return function a(n){for(var i=0;i<n.length;i++){if(n[i].api)return;if(n[i].id===e)return t.push(n[i].id),n[i].id;if(a(n[i].childCatalogue))return t.push(n[i].id),n[i].id}}(this.props.apiMarket.apiCatalogue),t.reverse()}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=U()({},this.state.queryParams,{currentPage:e.current});this.getTagListData(n),this.setState({queryParams:n})}},{key:"render",value:function(){var e=this.props.apiMarket.apiCatalogue,t=this.state,a=t.queryParams,n=t.visible,i=t.loading,r=t.tagList,o=t.editData,l=t.catalogue2Data,u="rule"===this.props.tagType?this.initRuleTagTable:this.initRegisterTagTable,c=s.a.createElement("div",{className:"flex font-12"},s.a.createElement(On,{placeholder:"标签名称",onSearch:this.onTagNameSearch,style:{width:200,margin:"10px 0"}}),s.a.createElement("div",{className:"m-l-8"},"标签分类：",s.a.createElement(X.a,{allowClear:!0,showSearch:!0,style:{width:150},placeholder:"选择标签分类",optionFilterProp:"title",onChange:this.onFirstCatalogueChange},e.map(function(e){return s.a.createElement(Rn,{key:e.id,value:e.id.toString(),title:e.catalogueName},e.catalogueName)}))),s.a.createElement("div",{className:"m-l-8"},"二级分类：",s.a.createElement(X.a,{allowClear:!0,showSearch:!0,style:{width:150},optionFilterProp:"title",placeholder:"选择二级分类",onChange:this.onSecondCatalogueChange},l.map(function(e){return s.a.createElement(Rn,{key:e.id,value:e.id.toString(),title:e.catalogueName},e.catalogueName)})))),p=s.a.createElement("div",null,s.a.createElement(y.c,{to:"dl/tagConfig/identify"},s.a.createElement(xe.a,{type:"primary",style:{margin:10}},"识别列配置")),s.a.createElement(xe.a,{type:"primary",onClick:this.addTag},"新建标签")),d={current:a.currentPage,pageSize:a.pageSize,total:r.totalCount};return s.a.createElement(Y.a,{title:c,extra:p,noHovering:!0,bordered:!1},s.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:u(),loading:i,pagination:d,dataSource:r.data,onChange:this.onTableChange}),s.a.createElement(bn,{visible:n,editData:o,saveTag:this.saveTag,cancel:this.cancel}))}}]),t}(r.Component))||vn,xn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(On,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/tagPane.js"),__REACT_HOT_LOADER__.register(Rn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/tagPane.js"),__REACT_HOT_LOADER__.register(Ln,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/tagPane.js"),__REACT_HOT_LOADER__.register(Sn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/tagPane.js"),__REACT_HOT_LOADER__.register(wn,"TagPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/tagPane.js")),a(880),At.a.TabPane),In=Object(C.b)()(Dn=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={},n.showInfo=function(){var e;return(e=n).__showInfo__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Se.getCatalogue(0))}},{key:"__showInfo__REACT_HOT_LOADER__",value:function(){J.a.info({title:"注册标签与新建标签的区别",maskClosable:!0,width:"40%",content:s.a.createElement("div",null,s.a.createElement("p",null,"注册标签：您已有计算好的标签结果，不需要配置标签计算逻辑，注册标签后即可提供标签服务"),s.a.createElement("p",null,"使用流程：点击“注册标签”->配置标签服务的信息->发布"),s.a.createElement("p",{style:{marginTop:10}},"新建标签：您只有原始数据，需要通过加工原始数据来形成标签"),s.a.createElement("p",null,"使用流程：点击“新建标签”->配置标签计算逻辑->配置标签服务信息->发布"))})}},{key:"render",value:function(){return s.a.createElement("div",{className:"box-1 m-card shadow m-tabs"},s.a.createElement(At.a,{animated:!1,defaultActiveKey:"1",style:{height:"auto"}},s.a.createElement(xn,{tab:"规则标签",key:"1"},s.a.createElement(wn,{tagType:"rule"})),s.a.createElement(xn,{tab:"注册标签",key:"2"},s.a.createElement(wn,{tagType:"register"}))),s.a.createElement("div",{className:"diff-tooltip"},s.a.createElement("a",{onClick:this.showInfo},"注册与新建有什么区别？")))}}]),t}(r.Component))||Dn,Hn=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(xn,"TabPane","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/index.js"),__REACT_HOT_LOADER__.register(In,"TagConfigIndex","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/dashboard/index.js")),a(80),a(46)),Nn=a.n(Hn),Pn=(a(104),a(71)),Un=a.n(Pn),jn=a(18),Mn=a.n(jn),Gn=a(72),Vn=X.a.Option,Fn=te.a.Item,qn=$.a.TextArea,Bn={beginDate:Mn()().format("YYYY-MM-DD"),endDate:Mn()().add(100,"years").format("YYYY-MM-DD"),periodType:"2",day:void 0,weekDay:void 0,hour:0,min:0,beginHour:0,beginMin:0,gapHour:void 0,endHour:0,endMin:0},Yn={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:10}}},zn=function(e){return{common:e.common,dataSource:e.dataSource}},Kn=function(e){return{getDataSourcesList:function(t){e(lt.getDataSourcesList(t))},getDataSourcesTable:function(t){e(lt.getDataSourcesTable(t))},resetDataSourcesTable:function(){e(lt.resetDataSourcesTable())}}},Qn=Object(C.b)(zn,Kn)(kn=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={tagId:n.props.routeParams.id,currentData:{},curCondition:{},conditionList:[],computeList:[],scheduleConfObj:Bn,notifyVO:{sendTypes:[],receivers:[]}},n.getTagDetailInfo=function(){var e;return(e=n).__getTagDetailInfo__REACT_HOT_LOADER__.apply(e,arguments)},n.getComputeSourceData=function(){var e;return(e=n).__getComputeSourceData__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.renderEditTD=function(){var e;return(e=n).__renderEditTD__REACT_HOT_LOADER__.apply(e,arguments)},n.renderTD=function(){var e;return(e=n).__renderTD__REACT_HOT_LOADER__.apply(e,arguments)},n.onDataSourceChange=function(){var e;return(e=n).__onDataSourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.addNewCondition=function(){var e;return(e=n).__addNewCondition__REACT_HOT_LOADER__.apply(e,arguments)},n.onPeriodTypeChange=function(){var e;return(e=n).__onPeriodTypeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onSendTypesChange=function(){var e;return(e=n).__onSendTypesChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onReceiversChange=function(){var e;return(e=n).__onReceiversChange__REACT_HOT_LOADER__.apply(e,arguments)},n.changeScheduleConfTime=function(){var e;return(e=n).__changeScheduleConfTime__REACT_HOT_LOADER__.apply(e,arguments)},n.onBeginDateChange=function(){var e;return(e=n).__onBeginDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.onEndDateChange=function(){var e;return(e=n).__onEndDateChange__REACT_HOT_LOADER__.apply(e,arguments)},n.checkTime=function(){var e;return(e=n).__checkTime__REACT_HOT_LOADER__.apply(e,arguments)},n.checkDate=function(){var e;return(e=n).__checkDate__REACT_HOT_LOADER__.apply(e,arguments)},n.saveRuleTag=function(){var e;return(e=n).__saveRuleTag__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getTagDetailInfo(),this.getComputeSourceData(),this.props.getDataSourcesList()}},{key:"__getTagDetailInfo__REACT_HOT_LOADER__",value:function(){var e=this;hn.getRuleTagDetail({tagId:this.state.tagId}).then(function(t){1===t.code&&(e.setState({currentData:t.data,conditionList:t.data.conditions}),t.data.scheduleConf&&e.setState({scheduleConfObj:JSON.parse(t.data.scheduleConf)}),t.data.notifyVO&&e.setState({notifyVO:t.data.notifyVO}))})}},{key:"__getComputeSourceData__REACT_HOT_LOADER__",value:function(){var e=this;hn.getComputeSource().then(function(t){1===t.code&&e.setState({computeList:t.data})})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"数据源",dataIndex:"dataSourceId",key:"dataSourceId",width:"25%",render:function(t,a){return e.renderColumns(t,a,"dataSourceId")}},{title:"表名",dataIndex:"tableName",key:"tableName",width:"25%",render:function(t,a){return e.renderColumns(t,a,"tableName")}},{title:"过滤条件",dataIndex:"sqlCondition",key:"sqlCondition",width:"40%",render:function(t,a){return e.renderColumns(t,a,"sqlCondition")}},{title:"操作",width:"10%",render:function(t,a){return s.a.createElement("div",null,a.editable?s.a.createElement("span",null,s.a.createElement("a",{className:"m-r-8",onClick:e.saveCondition.bind(e,a.id)},"保存"),s.a.createElement("a",{onClick:e.cancelEdit.bind(e,a.id)},"取消")):s.a.createElement("span",null,s.a.createElement("a",{className:"m-r-8",onClick:e.editCondition.bind(e,a.id)},"编辑"),s.a.createElement(un.a,{title:"确定要删除吗？",onConfirm:e.deleteCondition.bind(e,a.id)},s.a.createElement("a",null,"删除"))))}}]}},{key:"renderColumns",value:function(e,t,a){return{children:s.a.createElement(te.a,{layout:"inline"},t.editable?this.renderEditTD(e,t,a):this.renderTD(e,t,a)),props:{}}}},{key:"__renderEditTD__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props,i=n.form,r=n.dataSource,o=i.getFieldDecorator,l=r.sourceList,u=r.sourceTable;switch(a){case"dataSourceId":return s.a.createElement(Fn,U()({},Ie.m,{className:"edit-td"}),o("dataSourceId",{rules:[{required:!0,message:"数据源不可为空"}],initialValue:t.dataSourceId.toString()})(s.a.createElement(X.a,{showSearch:!0,optionFilterProp:"title",onChange:this.onDataSourceChange},l.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return s.a.createElement(Vn,{key:e.id,value:e.id.toString(),title:t},t)}))));case"tableName":return s.a.createElement(Fn,U()({},Ie.m,{className:"edit-td"}),o("tableName",{rules:[{required:!0,message:"数据表不可为空"}],initialValue:t.tableName})(s.a.createElement(X.a,{showSearch:!0},u.map(function(e){return s.a.createElement(Vn,{key:e,value:e},e)}))));case"sqlCondition":return s.a.createElement(Fn,U()({},Ie.m,{className:"edit-td"}),o("sqlCondition",{rules:[],initialValue:t.sqlCondition})(s.a.createElement($.a,{placeholder:"sql过滤条件"})))}}},{key:"__renderTD__REACT_HOT_LOADER__",value:function(e,t,a){switch(a){case"dataSourceId":return t.dataSourceName+"（"+t.sourceTypeValue+"）";default:return e}}},{key:"__onDataSourceChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form;this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:e}),t.setFieldsValue({tableName:void 0})}},{key:"editCondition",value:function(e){var t=this.state,a=t.curCondition,n=t.conditionList,i=[].concat(rn()(n)),r=i.filter(function(t){return e===t.id})[0];Object(Xt.isEmpty)(a)||("edit"===a.editStatus?(delete a.editable,delete a.editStatus):i.shift()),r&&(r.editable=!0,r.editStatus="edit",this.props.resetDataSourcesTable(),this.props.getDataSourcesTable({sourceId:r.dataSourceId}),this.setState({curCondition:r,conditionList:i}))}},{key:"cancelEdit",value:function(e){var t=this.state.conditionList,a=[].concat(rn()(t)),n=a.filter(function(t){return e===t.id})[0];"edit"===n.editStatus?(delete n.editable,delete n.editStatus):a.splice(a.indexOf(n),1),this.setState({curCondition:{},conditionList:a})}},{key:"deleteCondition",value:function(e){var t=[].concat(rn()(this.state.conditionList)),a=t.filter(function(t){return e===t.id})[0],n=t.indexOf(a);a&&(t.splice(n,1),this.setState({conditionList:t}))}},{key:"saveCondition",value:function(e){var t=this,a=this.props,n=a.form,i=a.dataSource.sourceList,r=this.state,s=(r.tagId,r.curCondition),o=r.conditionList,l=[].concat(rn()(o)),u=l.filter(function(t){return e===t.id})[0],c=l.indexOf(u);n.validateFields(["dataSourceId","tableName","sqlCondition"],function(e,a){if(!e){delete s.editable;var n=[].concat(rn()(i)).filter(function(e){return e.id==a.dataSourceId})[0];l[c]=U()({},s,a,{dataSourceName:n.dataName,sourceTypeValue:n.sourceTypeValue}),t.setState({curCondition:{},conditionList:l})}})}},{key:"__addNewCondition__REACT_HOT_LOADER__",value:function(){var e=this.props.form,t=this.state,a=t.tagId,n=t.conditionList,i=t.curCondition,r=[].concat(rn()(n));Object(Xt.isEmpty)(i)||("edit"===i.editStatus?(delete i.editable,delete i.editStatus):(r.shift(),e.resetFields()));var s={id:r[0]?r[0].id+1:1,editStatus:"new",editable:!0,tagId:a,dataSourceId:"",tableName:"",sqlCondition:""};r.unshift(s),this.setState({curCondition:s,conditionList:r})}},{key:"__onPeriodTypeChange__REACT_HOT_LOADER__",value:function(e){var t=U()({},Bn,{periodType:e});this.setState({scheduleConfObj:t})}},{key:"__onSendTypesChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state.notifyVO,n=t.getFieldValue("receivers");0===e.length&&0===n.length&&t.setFieldsValue({receivers:[]}),this.setState({notifyVO:U()({},a,{sendTypes:e})})}},{key:"__onReceiversChange__REACT_HOT_LOADER__",value:function(e){var t=this.props.form,a=this.state.notifyVO,n=t.getFieldValue("sendTypes");0===e.length&&0===n.length&&t.setFieldsValue({sendTypes:[]}),this.setState({notifyVO:U()({},a,{receivers:e})})}},{key:"__changeScheduleConfTime__REACT_HOT_LOADER__",value:function(e,t){var a=this.state.scheduleConfObj,n={};n[e]=t,this.setState({scheduleConfObj:U()({},a,n)})}},{key:"__onBeginDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("beginDate",t)}},{key:"__onEndDateChange__REACT_HOT_LOADER__",value:function(e,t){this.changeScheduleConfTime("endDate",t)}},{key:"renderDynamic",value:function(){var e=this,t=this.props,a=t.form,n=t.common,i=a.getFieldDecorator,r=(n.periodType,n.notifyType,this.state.scheduleConfObj),o=function(t){for(var a=[],n=0;n<=23;n++)a.push(s.a.createElement(Vn,{key:n,value:""+n},n<10?"0"+n:n));return s.a.createElement(X.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)},l=function(t){for(var a=[],n=0;n<=59;n++)a.push(s.a.createElement(Vn,{key:n,value:""+n},n<10?"0"+n:n));return s.a.createElement(X.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,t)},a)};switch(r.periodType){case"1":return s.a.createElement("div",null,s.a.createElement(Fn,U()({},Yn,{label:"开始时间"}),i("beginHour",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.beginHour})(o("beginHour")),s.a.createElement("span",{className:"m-8"},"时"),i("beginMin",{rules:[{required:!0,message:"开始时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.beginMin})(l("beginMin")),s.a.createElement("span",{className:"m-8"},"分")),s.a.createElement(Fn,U()({},Yn,{label:"间隔时间"}),i("gapHour",{rules:[{required:!0,message:"间隔时间不能为空"}],initialValue:r.gapHour?r.gapHour:void 0})(function(){for(var t=[],a=1;a<=23;a++)t.push(s.a.createElement(Vn,{key:a,value:""+a},a,"小时"));return s.a.createElement(X.a,{style:{width:150},onChange:e.changeScheduleConfTime.bind(e,"gapHour")},t)}())),s.a.createElement(Fn,U()({},Yn,{label:"结束时间"}),i("endHour",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.endHour})(o("endHour")),s.a.createElement("span",{className:"m-8"},"时"),i("endMin",{rules:[{required:!0,message:"结束时间不能为空"},{validator:this.checkTime.bind(this)}],initialValue:""+r.endMin})(l("endMin")),s.a.createElement("span",{className:"m-8"},"分")));case"2":return s.a.createElement(Fn,U()({},Yn,{label:"起调周期"}),i("hour",{rules:[{required:!0}],initialValue:""+r.hour})(o("hour")),s.a.createElement("span",{className:"m-8"},"时"),i("min",{rules:[{required:!0}],initialValue:""+r.min})(l("min")),s.a.createElement("span",{className:"m-8"},"分"));case"3":return s.a.createElement("div",null,s.a.createElement(Fn,U()({},Yn,{label:"选择时间"}),i("weekDay",{rules:[{required:!0,message:"周内天数不能为空"}],initialValue:r.weekDay?r.weekDay:[]})(s.a.createElement(X.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"weekDay")},s.a.createElement(Vn,{key:1,value:"1"},"星期一"),s.a.createElement(Vn,{key:2,value:"2"},"星期二"),s.a.createElement(Vn,{key:3,value:"3"},"星期三"),s.a.createElement(Vn,{key:4,value:"4"},"星期四"),s.a.createElement(Vn,{key:5,value:"5"},"星期五"),s.a.createElement(Vn,{key:6,value:"6"},"星期六"),s.a.createElement(Vn,{key:7,value:"7"},"星期天")))),s.a.createElement(Fn,U()({},Yn,{label:"起调周期"}),i("hour1",{rules:[{required:!0}],initialValue:""+r.hour})(o("hour")),s.a.createElement("span",{className:"m-8"},"时"),i("min1",{rules:[{required:!0}],initialValue:""+r.min})(l("min")),s.a.createElement("span",{className:"m-8"},"分")));case"4":return s.a.createElement("div",null,s.a.createElement(Fn,U()({},Yn,{label:"选择时间"}),i("day",{rules:[{required:!0,message:"月内天数不能为空"}],initialValue:r.day?r.day:[]})(function(){for(var t=[],a=1;a<=31;a++)t.push(s.a.createElement(Vn,{key:a,value:""+a},"每月"+a+"号"));return s.a.createElement(X.a,{mode:"multiple",style:{width:328},onChange:e.changeScheduleConfTime.bind(e,"day")},t)}())),s.a.createElement(Fn,U()({},Yn,{label:"起调周期"}),i("hour2",{rules:[{required:!0}],initialValue:""+r.hour})(o("hour")),s.a.createElement("span",{className:"m-8"},"时"),i("min2",{rules:[{required:!0}],initialValue:""+r.min})(l("min")),s.a.createElement("span",{className:"m-8"},"分")))}}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,i=n.getFieldValue("beginHour"),r=n.getFieldValue("beginMin"),s=n.getFieldValue("endHour"),o=n.getFieldValue("endMin");60*parseInt(i)+parseInt(r)>=60*parseInt(s)+parseInt(o)?a("开始时间不能晚于结束时间"):n.setFieldsValue({beginHour:i,beginMin:r,endHour:s,endMin:o}),a()}},{key:"__checkDate__REACT_HOT_LOADER__",value:function(e,t,a){var n=this.props.form,i=n.getFieldValue("beginDate"),r=n.getFieldValue("endDate");i&&r?i.valueOf()>r.valueOf()?a("生效日期的开始时间不能晚于结束时间"):n.setFieldsValue({beginDate:i,endDate:r}):a(),a()}},{key:"__saveRuleTag__REACT_HOT_LOADER__",value:function(){var e=this.props.form,t=this.state,a=t.tagId,n=t.curCondition,i=t.conditionList,r=t.scheduleConfObj,s=t.notifyVO;Object(Xt.isEmpty)(n)?i.length<1?pe.a.error("请添加基本信息"):e.validateFields(function(e,t){e&&e.endDate&&pe.a.error(e.endDate.errors[0].message),e||(i.forEach(function(e,t){"new"===e.editStatus&&delete e.id}),hn.updateTagSqlInfo({id:a,conditions:i,notifyVO:s,scheduleConf:ie()(r),sqlText:t.sqlText,computeSourceId:t.computeSourceId}).then(function(e){1===e.code&&(pe.a.success("保存成功"),y.g.push("/dl/tagConfig"))}))}):pe.a.error("基本信息未保存")}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.common,n=t.getFieldDecorator,i=a.periodType,r=a.notifyType,o=a.userList,l=this.state,u=l.currentData,c=l.conditionList,p=l.computeList,d=l.scheduleConfObj,_=l.notifyVO,m=_.sendTypes,g=_.receivers,h=s.a.createElement("div",null,s.a.createElement(Gn.a,null)," 配置计算逻辑");return s.a.createElement("div",{className:"box-1 m-card shadow"},s.a.createElement(Y.a,{title:h,extra:!1,noHovering:!0,bordered:!1},s.a.createElement("div",{className:"tag-edit-step"},s.a.createElement("h2",null,s.a.createElement("div",{className:"rank-number m-r-8"},"1"),"基本信息",s.a.createElement(xe.a,{type:"primary",className:"right",onClick:this.addNewCondition},"添加")),s.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),pagination:!1,dataSource:c})),s.a.createElement("div",{className:"tag-edit-step"},s.a.createElement("h2",null,s.a.createElement("div",{className:"rank-number m-r-8"},"2"),"同步目标计算引擎"),s.a.createElement(Fn,null,n("computeSourceId",{rules:[{required:!0,message:"不可为空"}],initialValue:u.computeSourceId?u.computeSourceId.toString():void 0})(s.a.createElement(X.a,{style:{width:300},placeholder:"选择要同步的计算引擎"},p.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return s.a.createElement(Vn,{key:e.id,value:e.id.toString(),title:t},t)}))))),s.a.createElement("div",{className:"tag-edit-step"},s.a.createElement("h2",null,s.a.createElement("div",{className:"rank-number m-r-8"},"3"),"根据以上数据源输入指标计算SQL"),s.a.createElement(Fn,null,n("sqlText",{rules:[{required:!0,message:"SQL不可为空"}],initialValue:u.sqlText})(s.a.createElement(qn,{placeholder:"在此输入指标计算sql",autosize:{minRows:6}})))),s.a.createElement("div",{className:"tag-edit-step"},s.a.createElement("h2",null,s.a.createElement("div",{className:"rank-number m-r-8"},"4"),"调度时间设置"),s.a.createElement(Fn,U()({},Yn,{label:"调度周期"}),n("periodType",{rules:[{required:!0,message:"执行周期不能为空"}],initialValue:""+d.periodType})(s.a.createElement(X.a,{style:{width:328},onChange:this.onPeriodTypeChange},i.map(function(e){return s.a.createElement(Vn,{key:e.value,value:e.value.toString()},e.name)})))),5!=d.periodType&&s.a.createElement(Fn,U()({},Yn,{label:"生效日期"}),n("beginDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:Mn()(d.beginDate)})(s.a.createElement(Un.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"开始日期",onChange:this.onBeginDateChange})),s.a.createElement("span",{className:"m-8"},"到"),n("endDate",{rules:[{required:!0,message:"生效日期不能为空"},{validator:this.checkDate.bind(this)}],initialValue:Mn()(d.endDate)})(s.a.createElement(Un.a,{style:{width:150},format:"YYYY-MM-DD",placeholder:"结束日期",onChange:this.onEndDateChange}))),this.renderDynamic(),s.a.createElement(Fn,U()({},Yn,{label:"通知方式"}),n("sendTypes",{rules:[{required:g.length,message:"选择通知方式"}],initialValue:m.map(function(e){return e.toString()})})(s.a.createElement(Nn.a.Group,{onChange:this.onSendTypesChange},r.map(function(e){return s.a.createElement(Nn.a,{key:e.value,value:e.value.toString()},e.name)})))),s.a.createElement(Fn,U()({},Yn,{label:"通知接收人"}),n("receivers",{rules:[{required:m.length,message:"选择通知接收人"}],initialValue:g.map(function(e){return e.toString()})})(s.a.createElement(X.a,{allowClear:!0,mode:"multiple",style:{width:328},onChange:this.onReceiversChange},o.map(function(e){return s.a.createElement(Vn,{key:e.id,value:e.id.toString()},e.userName)}))))),s.a.createElement("div",{className:"tag-edit-step txt-right"},s.a.createElement(y.c,{to:"/dl/tagConfig"},s.a.createElement(xe.a,{type:"primary",className:"m-r-8"},"取消")),s.a.createElement(xe.a,{type:"primary",onClick:this.saveRuleTag},"保存"))))}}]),t}(r.Component))||kn;Qn=te.a.create()(Qn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Vn,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(Fn,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(qn,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(Bn,"initialSchedule","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(Yn,"formItemLayout","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(zn,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(Kn,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"),__REACT_HOT_LOADER__.register(Qn,"RuleTagEdit","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/ruleTagEdit/index.js"));var Jn=te.a.Item,Wn=$.a.TextArea,Xn=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={visible:!1,loading:!1,queryParams:{currentPage:1,pageSize:20},columnData:{},currentData:{}},n.getColumnData=function(){var e;return(e=n).__getColumnData__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.addColumn=function(){var e;return(e=n).__addColumn__REACT_HOT_LOADER__.apply(e,arguments)},n.saveColumn=function(){var e;return(e=n).__saveColumn__REACT_HOT_LOADER__.apply(e,arguments)},n.editColumn=function(){var e;return(e=n).__editColumn__REACT_HOT_LOADER__.apply(e,arguments)},n.deleteColumn=function(){var e;return(e=n).__deleteColumn__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},n.openModal=function(){var e;return(e=n).__openModal__REACT_HOT_LOADER__.apply(e,arguments)},n.closeModal=function(){var e;return(e=n).__closeModal__REACT_HOT_LOADER__.apply(e,arguments)},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getColumnData(this.state.queryParams)}},{key:"__getColumnData__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({loading:!0}),hn.queryIdentifyColumn(e).then(function(e){1===e.code&&t.setState({columnData:e.data,loading:!1})})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"识别列类型",dataIndex:"name",key:"name",width:"45%"},{title:"描述",dataIndex:"identityDesc",key:"identityDesc",width:"45%"},{title:"操作",width:"10%",render:function(t,a){return s.a.createElement("div",null,s.a.createElement("a",{onClick:e.editColumn.bind(e,a)},"编辑"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement(un.a,{title:"确定删除此识别列？",okText:"确定",cancelText:"取消",onConfirm:e.deleteColumn.bind(e,a.id)},s.a.createElement("a",null,"删除")))}}]}},{key:"__addColumn__REACT_HOT_LOADER__",value:function(){this.openModal(),this.setState({currentData:{}})}},{key:"__saveColumn__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.form,a=this.state,n=a.queryParams,i=a.currentData;t.validateFields(function(a,r){var s=void 0,o=void 0,l=void 0;a||(i.id?(s=hn.updateIdentifyColumn,o=U()({},r,{id:i.id}),l="更新成功"):(s=hn.addIdentifyColumn,o=r,l="新增成功"),s(o).then(function(a){1===a.code&&(pe.a.success(l),e.getColumnData(n),e.closeModal(),e.setState({currentData:{}}),t.resetFields())}))})}},{key:"__editColumn__REACT_HOT_LOADER__",value:function(e){this.openModal(),this.setState({currentData:e})}},{key:"__deleteColumn__REACT_HOT_LOADER__",value:function(e){var t=this,a=this.state.queryParams;e&&hn.deleteIdentifyColumn({identifyId:e}).then(function(e){1===e.code&&(pe.a.success("删除成功！"),t.getColumnData(a))})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){this.closeModal(),this.props.form.resetFields()}},{key:"__openModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!0})}},{key:"__closeModal__REACT_HOT_LOADER__",value:function(){this.setState({visible:!1})}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=U()({},this.state.queryParams,{currentPage:e.current});this.getColumnData(n),this.setState({queryParams:n})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.visible,n=t.queryParams,i=t.loading,r=t.columnData,o=t.currentData,l=s.a.createElement("div",null,s.a.createElement(Gn.a,null)," 识别列类型配置"),u=s.a.createElement(xe.a,{type:"primary",style:{margin:10},onClick:this.addColumn},"新建识别列"),c={current:n.currentPage,pageSize:n.pageSize,total:r.totalCount};return s.a.createElement("div",{className:"box-1 m-card shadow"},s.a.createElement(Y.a,{title:l,extra:u,noHovering:!0,bordered:!1},s.a.createElement(K.a,{rowKey:"id",className:"m-table",columns:this.initColumns(),loading:i,pagination:c,dataSource:r.data,onChange:this.onTableChange}),s.a.createElement(J.a,{title:o.id?"编辑识别列":"新建识别列",width:"50%",visible:a,maskClosable:!1,okText:"确定",cancelText:"取消",onOk:this.saveColumn,onCancel:this.cancel},s.a.createElement(te.a,null,s.a.createElement(Jn,U()({},Ie.k,{label:"类型名称"}),e("name",{rules:[{required:!0,message:"类型名称不可为空"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:o.name})(s.a.createElement($.a,{placeholder:"请输入类型名称"}))),s.a.createElement(Jn,U()({},Ie.k,{label:"描述"}),e("identityDesc",{rules:[{max:200,message:"描述字符不能超过200"}],initialValue:o.identityDesc})(s.a.createElement(Wn,{placeholder:"类型描述",autosize:{minRows:3,maxRows:6}})))))))}}]),t}(r.Component);Xn=te.a.create()(Xn);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Jn,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/identifyColumn/index.js"),__REACT_HOT_LOADER__.register(Wn,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/identifyColumn/index.js"),__REACT_HOT_LOADER__.register(Xn,"IdentifyColumn","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/identifyColumn/index.js")),a(77);var Zn,$n=a(32),ei=a.n($n),ti=X.a.Option,ai=Un.a.RangePicker,ni=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={loading:!1,queryParams:{tagId:n.props.routeParams.id,currentPage:1,pageSize:20},logList:{}},n.getTagLogData=function(){var e;return(e=n).__getTagLogData__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.showInfo=function(){var e;return(e=n).__showInfo__REACT_HOT_LOADER__.apply(e,arguments)},n.onUpdateTimeChange=function(){var e;return(e=n).__onUpdateTimeChange__REACT_HOT_LOADER__.apply(e,arguments)},n.disabledDate=function(){var e;return(e=n).__disabledDate__REACT_HOT_LOADER__.apply(e,arguments)},n.onStatueChange=function(){var e;return(e=n).__onStatueChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getTagLogData(this.state.queryParams)}},{key:"__getTagLogData__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({loading:!0}),hn.queryTagLogInfo(e).then(function(e){1===e.code&&t.setState({loading:!1,logList:e.data})})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"标签名称",dataIndex:"tagName",key:"tagName",width:"15%"},{title:"更新时间",dataIndex:"gmtModifiedFormat",key:"gmtModifiedFormat",width:"15%"},{title:"状态",dataIndex:"status",key:"status",width:"15%",render:function(e){return Ie.g[e]}},{title:"日志内容",dataIndex:"log",key:"log",width:"45%",render:function(e){return s.a.createElement(ei.a,{overlayClassName:"m-tooltip",placement:"bottom",title:e,arrowPointAtCenter:!0},s.a.createElement("div",{className:"ellipsis-td"},e))}},{title:"操作",key:"operation",render:function(t,a){return s.a.createElement("a",{onClick:e.showInfo.bind(e,a)},"查看详情")}}]}},{key:"__showInfo__REACT_HOT_LOADER__",value:function(e){J.a.info({title:e.tagName+" 日志内容",maskClosable:!0,width:"40%",content:s.a.createElement("div",{style:{maxHeight:400,overflowY:"auto",whiteSpace:"pre-line"}},e.log)})}},{key:"__onUpdateTimeChange__REACT_HOT_LOADER__",value:function(e,t){var a=U()({},this.state.queryParams,{currentPage:1,startTime:e[0]?e[0].startOf("day").valueOf():void 0,endTime:e[1]?e[1].startOf("day").valueOf():void 0});this.getTagLogData(a),this.setState({queryParams:a})}},{key:"__disabledDate__REACT_HOT_LOADER__",value:function(e){return e&&e.valueOf()>Date.now()}},{key:"__onStatueChange__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.queryParams,{currentPage:1,tagStatus:e||void 0});this.getTagLogData(t),this.setState({queryParams:t})}},{key:"render",value:function(){var e=this.state,t=e.queryParams,a=e.loading,n=e.logList,i=s.a.createElement("div",{className:"flex font-12"},s.a.createElement("div",{className:"flex",style:{alignItems:"center"}},"更新时间：",s.a.createElement(ai,{format:"YYYY-MM-DD",style:{width:250},placeholder:["更新开始时间","更新结束时间"],disabledDate:this.disabledDate,onChange:this.onUpdateTimeChange})),s.a.createElement("div",{className:"m-l-8"},"状态：",s.a.createElement(X.a,{allowClear:!0,style:{width:150},placeholder:"选择状态",onChange:this.onStatueChange},s.a.createElement(ti,{key:"3"},"更新完成"),s.a.createElement(ti,{key:"4"},"更新失败")))),r={current:t.currentPage,pageSize:t.pageSize,total:n.totalCount};return s.a.createElement("div",null,s.a.createElement("h1",{className:"box-title"},s.a.createElement(Gn.a,null)," 标签日志更新历史"),s.a.createElement("div",{className:"box-2 m-card shadow"},s.a.createElement(Y.a,{title:i,extra:!1,noHovering:!0,bordered:!1},s.a.createElement(K.a,{rowKey:"id",className:"m-table fixed-table",columns:this.initColumns(),loading:a,pagination:r,dataSource:n.data,onChange:this.onTableChange}))))}}]),t}(r.Component),ii=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ti,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/log/index.js"),__REACT_HOT_LOADER__.register(ai,"RangePicker","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/log/index.js"),__REACT_HOT_LOADER__.register(ni,"TagLog","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/tagConfig/log/index.js")),a(381),a(130)),ri=a.n(ii),si=(a(177),a(93)),oi=a.n(si),li=a(152),ui=te.a.Item,ci=X.a.Option,pi=$.a.TextArea,di=function(e){return{dataSource:e.dataSource,tagConfig:e.tagConfig,apiMarket:e.apiMarket}},_i=function(e){return{getDataSourcesList:function(t){e(lt.getDataSourcesList(t))},getDataSourcesPreview:function(t){e(lt.getDataSourcesPreview(t))},getCatalogue:function(t){e(Se.getCatalogue(t))},getAllIdentifyColumn:function(t){e(En.getAllIdentifyColumn(t))}}},mi=Object(C.b)(di,_i)(Zn=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={showPreview:!1},n.initCatagoryOption=function(){var e;return(e=n).__initCatagoryOption__REACT_HOT_LOADER__.apply(e,arguments)},n.getCatalogueArray=function(){var e;return(e=n).__getCatalogueArray__REACT_HOT_LOADER__.apply(e,arguments)},n.onSourcePreview=function(){var e;return(e=n).__onSourcePreview__REACT_HOT_LOADER__.apply(e,arguments)},n.previewTableColumns=function(){var e;return(e=n).__previewTableColumns__REACT_HOT_LOADER__.apply(e,arguments)},n.getScroll=function(){var e;return(e=n).__getScroll__REACT_HOT_LOADER__.apply(e,arguments)},n.next=function(){var e;return(e=n).__next__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.getCatalogue(0),this.props.getDataSourcesList(),this.props.getAllIdentifyColumn()}},{key:"__initCatagoryOption__REACT_HOT_LOADER__",value:function(e){var t=this;return e.some(function(e){return!0===e.api})?[]:e.map(function(e){return{value:e.id,label:e.catalogueName,children:t.initCatagoryOption(e.childCatalogue)}})}},{key:"__getCatalogueArray__REACT_HOT_LOADER__",value:function(e){var t=this.props.apiMarket.apiCatalogue,a=[];if(!e)return[];return function t(n){for(var i=0;i<n.length;i++){if(n[i].api)return;if(n[i].id===e)return a.push(n[i].id),n[i].id;if(t(n[i].childCatalogue))return a.push(n[i].id),n[i].id}}(t),a.reverse()}},{key:"__onSourcePreview__REACT_HOT_LOADER__",value:function(){var e=this.props,t=(e.form,e.basicInfo),a=this.state.showPreview,n=t.dataSourceId,i=t.originTable;n&&i?(a||this.props.getDataSourcesPreview({dataSourceId:n,tableName:i}),this.setState({showPreview:!a})):pe.a.error("未选择数据源或数据表")}},{key:"__previewTableColumns__REACT_HOT_LOADER__",value:function(e){return e&&e.map(function(e){return{title:e,key:e,dataIndex:e,width:80,render:function(e){return s.a.createElement(li.a,{className:"no-scroll-bar",value:e||void 0,readOnly:!0,style:{minWidth:80,width:"100%",resize:"none"}})}}})}},{key:"__getScroll__REACT_HOT_LOADER__",value:function(e){var t=this.props.dataSource.sourcePreview;return t.columnList?e*t.columnList.length:0}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props,a=t.currentStep,n=t.navToStep;t.form.validateFields({force:!0},function(t,i){t||(i.catalogueId=[].concat(rn()(i.catalogueId)).pop(),e.props.changeBasicInfo(i),n(a+1))})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.url,a=e.history;t?a?y.f.push(t):y.g.push(t):y.f.go(-1)}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.tagType,n=e.tagConfig,i=e.apiMarket,r=e.dataSource,o=e.basicInfo,l=e.editStatus,u=t.getFieldDecorator,c=i.apiCatalogue,p=n.identifyColumn,d=r.sourceList,_=(r.sourceTable,r.sourceColumn,r.sourcePreview),m=this.state.showPreview;return s.a.createElement("div",null,s.a.createElement("div",{className:"steps-content"},s.a.createElement(te.a,null,s.a.createElement(ui,U()({},Ie.l,{label:"所属分组"}),u("catalogueId",{rules:[{required:!0,message:"请选择分组"}],initialValue:this.getCatalogueArray(o.catalogueId)})(s.a.createElement(_n.a,{showSearch:!0,popupClassName:"noheight",options:this.initCatagoryOption(c),placeholder:"请选择分组"}))),s.a.createElement(ui,U()({},Ie.l,{label:"标签名称"}),u("name",{rules:[{required:!0,message:"请输入标签名称"},{max:20,message:"最大字数不能超过20"},{pattern:new RegExp(/^([\w|\u4e00-\u9fa5]*)$/),message:"名称只能以字母，数字，下划线组成"}],initialValue:o.name})(s.a.createElement($.a,{disabled:"edit"===l}))),s.a.createElement(ui,U()({},Ie.l,{label:"标签描述"}),u("tagDesc",{rules:[{max:200,message:"标签描述字符不能超过200"}],initialValue:o.tagDesc})(s.a.createElement(pi,{placeholder:"标签描述",autosize:{minRows:2,maxRows:6}}))),s.a.createElement(ui,U()({},Ie.l,{label:"值域"}),u("tagRange",{rules:[{required:!0,message:"值域不可为空"}],initialValue:o.tagRange})(s.a.createElement(pi,{placeholder:"值域",autosize:{minRows:2,maxRows:6}}))),s.a.createElement(ui,U()({},Ie.l,{label:"调用限制"}),u("reqLimit",{rules:[{required:!0,message:"请输入调用次数限制"},{validator:function(e,t,a){t&&(t>1e3||t<1)?a("请输入不大于1000的正整数"):a()}}],initialValue:o.reqLimit})(s.a.createElement(oi.a,{min:1,step:1,max:1e3,precision:0,style:{width:"100%"},placeholder:"单用户每秒最高调用次数"}))),s.a.createElement(ui,U()({},Ie.l,{label:"返回条数限制"}),u("respLimit",{rules:[{required:!0,message:"请输入最大返回条数"}],initialValue:o.respLimit})(s.a.createElement(oi.a,{min:1,step:1,max:2e3,precision:0,style:{width:"100%"},placeholder:"单次最大返回数据条数 (最高支持2000条)"}))),s.a.createElement(ui,U()({},Ie.l,{label:"目标数据库"}),u("dataSourceId",{rules:[{required:!0,message:"请选择数据源"}],initialValue:o.dataSourceId?o.dataSourceId.toString():void 0})(s.a.createElement(X.a,{showSearch:!0,disabled:!0,placeholder:"请选择数据源"},d.map(function(e){var t=e.dataName+"（"+e.sourceTypeValue+"）";return s.a.createElement(ci,{key:e.id,value:e.id.toString(),title:t},t)})))),"注册标签"==Ie.h[a]&&s.a.createElement(ui,U()({},Ie.l,{label:"来源表"}),u("originTable",{rules:[{required:!0,message:"不可为空"}],initialValue:o.originTable})(s.a.createElement($.a,{disabled:!0}))),"注册标签"==Ie.h[a]&&s.a.createElement(ui,U()({},Ie.l,{label:"来源列"}),u("originColumn",{rules:[{required:!0,message:"不可为空"}],initialValue:o.originColumn})(s.a.createElement($.a,{disabled:!0}))),s.a.createElement(ui,U()({},Ie.l,{label:"识别列ID"}),u("identityColumn",{rules:[{required:!0,message:"识别列ID不可为空"}],initialValue:o.identityColumn})(s.a.createElement($.a,{disabled:!0}))),s.a.createElement(ui,U()({},Ie.l,{label:"识别列类型"}),u("identityId",{rules:[{required:!0,message:"识别列类型不可为空"}],initialValue:o.identityId?o.identityId.toString():void 0})(s.a.createElement(X.a,{showSearch:!0,disabled:!0,optionFilterProp:"title",placeholder:"选择识别列类型"},p.map(function(e){return s.a.createElement(ci,{key:e.id,value:e.id.toString(),title:e.name},e.name)})))),s.a.createElement("div",{className:"txt-center font-14"},s.a.createElement("a",{onClick:this.onSourcePreview.bind(this)},"数据预览",s.a.createElement(M.a,{type:m?"up":"down",style:{marginLeft:5}}))),m&&s.a.createElement(Y.a,{className:"box-2",style:{marginTop:"10px"},noHovering:!0},s.a.createElement(K.a,{rowKey:function(e,t){return t},className:"m-table m-cells",columns:this.previewTableColumns(_.columnList),dataSource:_.dataList,pagination:!1,scroll:{x:this.getScroll(80),y:400}})))),s.a.createElement("div",{className:"steps-action"},s.a.createElement(xe.a,{className:"m-r-8",onClick:this.cancel},"取消"),s.a.createElement(xe.a,{type:"primary",onClick:this.next},"下一步")))}}]),t}(r.Component))||Zn;mi=te.a.create()(mi);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ui,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"),__REACT_HOT_LOADER__.register(ci,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"),__REACT_HOT_LOADER__.register(pi,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"),__REACT_HOT_LOADER__.register(di,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"),__REACT_HOT_LOADER__.register(_i,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"),__REACT_HOT_LOADER__.register(mi,"StepOne","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepOne.js"));var gi,hi,Ei,fi=$.a.TextArea,Ti=X.a.Option,Ai=function(e){return{dataSource:e.dataSource}},yi=Object(C.b)(Ai)(gi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={loading:!1,tableColumns:[],dataSource:[]},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){e.addInputsignal&&!this.props.addInputsignal&&this.addInput(),e.initValue!=this.props.initValue&&this.initDataSource(e.initValue)}},{key:"initDataSource",value:function(e){this.backMsg(e),this.setState({dataSource:e})}},{key:"backMsg",value:function(e,t){var a=[];for(var n in e){var i=e[n];i.tmp?a.push(i.tmp):i.isEdit||a.push(i)}this.props.inputParamsChange(a,t)}},{key:"addInput",value:function(){var e=this,t=Object(Xt.cloneDeep)(this.state.dataSource);t.unshift({key:Math.random(),fieldName:"",paramType:"",paramName:"",operator:"",required:!0,desc:"",isEdit:!0}),this.setState({dataSource:t},function(){e.props.changeAddinputOverSignal()})}},{key:"getTableColumns",value:function(){var e=this;this.props.tablecolumn(this.props.dataSourceId,this.props.tableId).then(function(t){t&&e.setState({tableColumns:t.data})})}},{key:"getColumnsView",value:function(){return this.props.dataSource.sourceColumn.map(function(e){return s.a.createElement(Ti,{title:e.key,key:e.key,value:e.type+"@@"+e.key},e.key)})}},{key:"changeTableParam",value:function(e,t){if(t=t.split("@@")){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].paramType=t[0],a[e].fieldName=t[1],this.setState({dataSource:a})}}},{key:"setRequired",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].required=t.target.checked,this.setState({dataSource:a})}},{key:"textAreaChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].desc=a,this.setState({dataSource:n})}},{key:"paramNameChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].paramName=a,this.setState({dataSource:n})}},{key:"operatorsChange",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].operator=t,this.setState({dataSource:a})}},{key:"checkInfo",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource),n=a[e];if(t&&(n=n.tmp),!n.fieldName)return pe.a.error("请选择字段"),!1;if(!n.paramName)return pe.a.error("请填写参数名"),!1;if(!n.operator)return pe.a.error("请选择操作符"),!1;if(!this.checkVal(n))return!1;for(var i in a)if(i!=e&&a[i].fieldName==n.fieldName&&a[i].operator==n.operator)return t?pe.a.error("原数据与现有数据重复，请修改保存"):pe.a.error("不能设置相同字段的相同规则"),!1;return!0}},{key:"checkVal",value:function(e){return e.desc&&e.desc.length>200?(pe.a.error("说明不得大于200字符"),!1):!(e.paramName&&e.paramName.length>16)||(pe.a.error("参数名不得大于16字符"),!1)}},{key:"saveInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(this.checkInfo(e)){t[e].isEdit=!1;var a=!t[e].tmp;t[e].tmp&&(t[e].tmp=null),a?this.backMsg(t,t[e]):this.backMsg(t),this.setState({dataSource:t})}}},{key:"cancelSave",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(t[e].tmp){if(!this.checkInfo(e,!0))return;t[e]=Object(Xt.cloneDeep)(t[e].tmp),t[e].isEdit=!1}else t.splice(e,1);this.setState({dataSource:t})}},{key:"editInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t[e].tmp=Object(Xt.cloneDeep)(t[e]),t[e].isEdit=!0,this.setState({dataSource:t})}},{key:"removeInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t.splice(e,1),this.backMsg(t),this.setState({dataSource:t})}},{key:"initColumns",value:function(){var e=this;return[{title:"字段",dataIndex:"fieldName",key:"fieldName",width:"200px",render:function(t,a,n){return a.isEdit?s.a.createElement(X.a,{showSearch:!0,defaultValue:a.paramType?a.paramType+"@@"+a.fieldName:null,onChange:e.changeTableParam.bind(e,n),style:{width:"100%"}},e.getColumnsView()):a.fieldName}},{title:"参数名",dataIndex:"paramName",key:"paramName",width:"100px",render:function(t,a,n){return a.isEdit?s.a.createElement($.a,{onBlur:e.paramNameChange.bind(e,n),defaultValue:a.paramName}):a.paramName}},{title:"数据类型",dataIndex:"paramType",key:"paramType",render:function(e,t){return t.paramType||""}},{title:"操作符",dataIndex:"operator",key:"operator",width:"100px",render:function(t,a,n){return a.isEdit?s.a.createElement(X.a,{style:{width:"100%"},defaultValue:a.operator,onChange:e.operatorsChange.bind(e,n)},s.a.createElement(Ti,{value:"="},"="),s.a.createElement(Ti,{value:">"},">"),s.a.createElement(Ti,{value:">="},">="),s.a.createElement(Ti,{value:"<"}," <"),s.a.createElement(Ti,{value:"<="},"<="),s.a.createElement(Ti,{value:"!="},"!="),s.a.createElement(Ti,{value:"in"},"in"),s.a.createElement(Ti,{value:"not in"},"not in"),s.a.createElement(Ti,{value:"like"},"like"),s.a.createElement(Ti,{value:"not like"},"not like")):a.operator}},{title:"是否必填",dataIndex:"required",key:"required",render:function(t,a,n){return a.isEdit?s.a.createElement(Nn.a,{onClick:e.setRequired.bind(e,n),defaultChecked:a.required}):s.a.createElement(Nn.a,{defaultChecked:a.required,disabled:!0})}},{title:"说明",dataIndex:"desc",key:"desc",render:function(t,a,n){return a.isEdit?s.a.createElement(fi,{onBlur:e.textAreaChange.bind(e,n),defaultValue:a.desc}):s.a.createElement(fi,{key:"textareadisabled",defaultValue:a.desc,disabled:!0})}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a,n){return a.isEdit?s.a.createElement("div",null,s.a.createElement("a",{onClick:e.saveInfo.bind(e,n)},"保存"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.cancelSave.bind(e,n)},"取消")):s.a.createElement("div",null,s.a.createElement("a",{onClick:e.editInfo.bind(e,n)},"编辑"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.removeInfo.bind(e,n)},"删除"))}}]}},{key:"render",value:function(){return s.a.createElement(K.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:!1,dataSource:this.state.dataSource})}}]),t}(r.Component))||gi,Ci=yi,bi=Ci,vi=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(fi,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/inputParams.js"),__REACT_HOT_LOADER__.register(Ti,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/inputParams.js"),__REACT_HOT_LOADER__.register(Ai,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/inputParams.js"),__REACT_HOT_LOADER__.register(yi,"InputParams","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/inputParams.js"),__REACT_HOT_LOADER__.register(Ci,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/inputParams.js")),$.a.TextArea),Di=X.a.Option,ki=function(e){return{dataSource:e.dataSource}},Oi=function(e){return{}},Ri=Object(C.b)(ki,Oi)(hi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={loading:!1,tableColumns:[],dataSource:[]},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){e.addOutputsignal&&!this.props.addOutputsignal&&this.addOutput(e.inputToOutputData),e.initValue!=this.props.initValue&&this.initDataSource(e.initValue)}},{key:"initDataSource",value:function(e){var t=e;e||(t=[]),e&&e.some(function(e){return!e.fieldName})&&(t=[]),this.backMsg(t),this.setState({dataSource:t})}},{key:"backMsg",value:function(e){var t=[];for(var a in e){var n=e[a];n.tmp?t.push(n.tmp):n.isEdit||t.push(n)}this.props.outputParamsChange(t)}},{key:"addOutput",value:function(e){var t=this,a=Object(Xt.cloneDeep)(this.state.dataSource),n={key:Math.random(),fieldName:"",paramType:"",paramName:"",operator:"",required:!0,desc:"",isEdit:!0};e&&(n.fieldName=e.fieldName,n.paramType=e.paramType,n.paramName=e.paramName,n.operator=e.operator,n.required=e.required,n.desc=e.desc),a.unshift(n),this.setState({dataSource:a},function(){t.props.changeAddoutputOverSignal()})}},{key:"getTableColumns",value:function(){var e=this;this.props.tablecolumn(this.props.dataSourceId,this.props.tableId).then(function(t){t&&e.setState({tableColumns:t.data})})}},{key:"getColumnsView",value:function(){return this.props.dataSource.sourceColumn.map(function(e){return s.a.createElement(Di,{title:e.key,key:e.key,value:e.type+"@@"+e.key},e.key)})}},{key:"changeTableParam",value:function(e,t){if(t=t.split("@@")){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].paramType=t[0],a[e].fieldName=t[1],this.setState({dataSource:a})}}},{key:"setRequired",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].required=t.target.checked,this.setState({dataSource:a})}},{key:"textAreaChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].desc=a,this.setState({dataSource:n})}},{key:"paramNameChange",value:function(e,t){var a=t.target.value,n=Object(Xt.cloneDeep)(this.state.dataSource);n[e].paramName=a,this.setState({dataSource:n})}},{key:"operatorsChange",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource);a[e].operator=t,this.setState({dataSource:a})}},{key:"checkInfo",value:function(e,t){var a=Object(Xt.cloneDeep)(this.state.dataSource),n=a[e];if(t&&(n=n.tmp),!n.fieldName)return pe.a.error("请选择字段"),!1;if(!n.paramName)return pe.a.error("请填写参数名"),!1;if(!this.checkVal(n))return!1;for(var i in a)if(i!=e&&a[i].fieldName==n.fieldName)return t?pe.a.error("原数据与现有数据重复，请修改保存"):pe.a.error("不能设置相同字段"),!1;return!0}},{key:"checkVal",value:function(e){return e.desc&&e.desc.length>200?(pe.a.error("说明不得大于200字符"),!1):!(e.paramName&&e.paramName.length>16)||(pe.a.error("参数名不得大于16字符"),!1)}},{key:"saveInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);this.checkInfo(e)&&(t[e].isEdit=!1,t[e].tmp&&(t[e].tmp=null),this.backMsg(t),this.setState({dataSource:t}))}},{key:"cancelSave",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);if(t[e].tmp){if(!this.checkInfo(e,!0))return;t[e]=Object(Xt.cloneDeep)(t[e].tmp),t[e].isEdit=!1}else t.splice(e,1);this.setState({dataSource:t})}},{key:"editInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t[e].tmp=Object(Xt.cloneDeep)(t[e]),t[e].isEdit=!0,this.setState({dataSource:t})}},{key:"removeInfo",value:function(e){var t=Object(Xt.cloneDeep)(this.state.dataSource);t.splice(e,1),this.backMsg(t),this.setState({dataSource:t})}},{key:"initColumns",value:function(){var e=this;return[{title:"字段",dataIndex:"fieldName",key:"fieldName",width:"200px",render:function(t,a,n){return a.isEdit?s.a.createElement(X.a,{showSearch:!0,defaultValue:a.paramType?a.paramType+"@@"+a.paramType:null,onChange:e.changeTableParam.bind(e,n),style:{width:"100%"}},e.getColumnsView()):a.fieldName}},{title:"参数名",dataIndex:"paramName",key:"paramName",width:"100px",render:function(t,a,n){return a.isEdit?s.a.createElement($.a,{onBlur:e.paramNameChange.bind(e,n),defaultValue:a.paramName}):a.paramName}},{title:"数据类型",dataIndex:"paramType",key:"paramType",render:function(e,t){return t.paramType||""}},{title:"说明",dataIndex:"desc",key:"desc",render:function(t,a,n){return a.isEdit?s.a.createElement(vi,{onBlur:e.textAreaChange.bind(e,n),defaultValue:a.desc}):s.a.createElement(vi,{key:"textareadisabled",defaultValue:a.desc,disabled:!0})}},{title:"操作",dataIndex:"deal",key:"deal",render:function(t,a,n){return a.isEdit?s.a.createElement("div",null,s.a.createElement("a",{onClick:e.saveInfo.bind(e,n)},"保存"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.cancelSave.bind(e,n)},"取消")):s.a.createElement("div",null,s.a.createElement("a",{onClick:e.editInfo.bind(e,n)},"编辑"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement("a",{onClick:e.removeInfo.bind(e,n)},"删除"))}}]}},{key:"render",value:function(){return s.a.createElement(K.a,{className:"m-table monitor-table",columns:this.initColumns(),loading:this.state.loading,pagination:!1,dataSource:this.state.dataSource})}}]),t}(r.Component))||hi,Li=Ri,Si=Li,wi=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(vi,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js"),__REACT_HOT_LOADER__.register(Di,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js"),__REACT_HOT_LOADER__.register(ki,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js"),__REACT_HOT_LOADER__.register(Oi,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js"),__REACT_HOT_LOADER__.register(Ri,"OutputParams","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js"),__REACT_HOT_LOADER__.register(Li,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/paramsTable/outputParams.js")),te.a.Item),xi=X.a.Option,Ii=$.a.TextArea,Hi=function(e){return{dataSource:e.dataSource,tagConfig:e.tagConfig,apiMarket:e.apiMarket}},Ni=function(e){return{getDataSourcesColumn:function(t){e(lt.getDataSourcesColumn(t))}}},Pi=Object(C.b)(Hi,Ni)(Ei=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={addInputsignal:!1,addOutputsignal:!1,inputData:[],outputData:[],inputToOutputData:{},initInputValue:[],initOutputValue:[]},n.changeAddinputOverSignal=function(){var e;return(e=n).__changeAddinputOverSignal__REACT_HOT_LOADER__.apply(e,arguments)},n.addInput=function(){var e;return(e=n).__addInput__REACT_HOT_LOADER__.apply(e,arguments)},n.inputParamsChange=function(){var e;return(e=n).__inputParamsChange__REACT_HOT_LOADER__.apply(e,arguments)},n.changeAddoutputOverSignal=function(){var e;return(e=n).__changeAddoutputOverSignal__REACT_HOT_LOADER__.apply(e,arguments)},n.addOutput=function(){var e;return(e=n).__addOutput__REACT_HOT_LOADER__.apply(e,arguments)},n.outputParamsChange=function(){var e;return(e=n).__outputParamsChange__REACT_HOT_LOADER__.apply(e,arguments)},n.prev=function(){var e;return(e=n).__prev__REACT_HOT_LOADER__.apply(e,arguments)},n.next=function(){var e;return(e=n).__next__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.basicInfo,a=e.paramsConfig;Object(Xt.isEmpty)(a)||this.setState({initInputValue:a.inputParams,initOutputValue:a.outputParams}),this.props.getDataSourcesColumn({sourceId:t.dataSourceId,tableName:t.originTable})}},{key:"__changeAddinputOverSignal__REACT_HOT_LOADER__",value:function(){this.setState({addInputsignal:!1})}},{key:"__addInput__REACT_HOT_LOADER__",value:function(e){this.setState({addInputsignal:!0})}},{key:"__inputParamsChange__REACT_HOT_LOADER__",value:function(e,t){this.setState({inputData:e})}},{key:"__changeAddoutputOverSignal__REACT_HOT_LOADER__",value:function(){this.setState({addOutputsignal:!1})}},{key:"__addOutput__REACT_HOT_LOADER__",value:function(e){e&&!e.param&&(e=null),this.setState({addOutputsignal:!0,inputToOutputData:e})}},{key:"__outputParamsChange__REACT_HOT_LOADER__",value:function(e){this.setState({outputData:e})}},{key:"__prev__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.inputData,a=e.outputData,n=this.props,i=n.currentStep;(0,n.navToStep)(i-1),this.props.changeParamsConfig({inputParams:t,outputParams:a})}},{key:"__next__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.inputData,a=e.outputData,n=this.props,i=n.tagId,r=n.currentStep,s=n.navToStep,o=n.basicInfo;if(!t||t.length<1)pe.a.error("请设置输入参数");else if(!a||a.length<1)pe.a.error("请设置输出参数");else if(t&&a&&t.length>0&&a.length>0){if(!t.some(function(e){return e.required}))return void pe.a.error("输入参数必须有一个必填项");this.props.changeParamsConfig({inputParams:t,outputParams:a}),hn.publishTag(U()({},o,{id:i,inputParams:t,outputParams:a})).then(function(e){1===e.code&&s(r+1)})}else pe.a.error("请设置输入输出参数")}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.tagConfig,n=e.apiMarket,i=e.dataSource,r=(t.getFieldDecorator,n.apiCatalogue,a.identifyColumn,i.sourceColumn,this.state),o=r.initInputValue,l=r.initOutputValue;return s.a.createElement("div",null,s.a.createElement("div",{className:"steps-content"},s.a.createElement(Y.a,{title:s.a.createElement("span",null,s.a.createElement("span",{style:{color:"#f04134"}},"*")," 输入参数"),extra:s.a.createElement(xe.a,{onClick:this.addInput,style:{marginTop:"10px"},type:"primary"},"添加输入参数"),className:"box-2",noHovering:!0},s.a.createElement(bi,U()({initValue:o,inputParamsChange:this.inputParamsChange,changeAddinputOverSignal:this.changeAddinputOverSignal,addInputsignal:this.state.addInputsignal},this.props))),s.a.createElement(Y.a,{title:s.a.createElement("span",null,s.a.createElement("span",{style:{color:"#f04134"}},"*")," 输出参数"),extra:s.a.createElement(xe.a,{onClick:this.addOutput,style:{marginTop:"10px"},type:"primary"},"添加输出参数"),style:{marginTop:"20px"},className:"box-2",noHovering:!0},s.a.createElement(Si,U()({initValue:l,inputToOutputData:this.state.inputToOutputData,outputParamsChange:this.outputParamsChange,changeAddoutputOverSignal:this.changeAddoutputOverSignal,addOutputsignal:this.state.addOutputsignal},this.props)))),s.a.createElement("div",{className:"steps-action"},s.a.createElement(xe.a,{className:"m-r-8",onClick:this.prev},"上一步"),s.a.createElement(xe.a,{type:"primary",onClick:this.next},"下一步")))}}]),t}(r.Component))||Ei;Pi=te.a.create()(Pi);"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(wi,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"),__REACT_HOT_LOADER__.register(xi,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"),__REACT_HOT_LOADER__.register(Ii,"TextArea","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"),__REACT_HOT_LOADER__.register(Hi,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"),__REACT_HOT_LOADER__.register(Ni,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"),__REACT_HOT_LOADER__.register(Pi,"StepTwo","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepTwo.js"));var Ui,ji,Mi,Gi,Vi,Fi=void 0,qi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={time:3},n.countDown=function(){var e;return(e=n).__countDown__REACT_HOT_LOADER__.apply(e,arguments)},n.back=function(){var e;return(e=n).__back__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"__countDown__REACT_HOT_LOADER__",value:function(e){var t=this;Fi=setInterval(function(){e-=1,t.setState({time:e}),0===e&&y.g.push("/dl/manage")},1e3)}},{key:"componentDidMount",value:function(){this.countDown(this.state.time)}},{key:"componentWillUnmount",value:function(){clearInterval(Fi)}},{key:"__back__REACT_HOT_LOADER__",value:function(){y.g.push("/dl/manage")}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"txt-center"},s.a.createElement("div",{style:{fontSize:"30px",marginTop:"40px"}},s.a.createElement(M.a,{type:"check-circle",style:{fontSize:"60px",color:"#00CD00"}}),s.a.createElement("br",null),"操作成功",s.a.createElement("br",null))),s.a.createElement("div",{className:"txt-center",style:{fontSize:"14px",marginTop:"30px"}},this.state.time,"秒后自动返回"),s.a.createElement("div",{className:"txt-center",style:{padding:"20px 0"}},s.a.createElement(xe.a,{size:"large",style:{marginLeft:"8px"}},s.a.createElement("a",{onClick:this.back},"返回"))))}}]),t}(r.Component),Bi=qi,Yi=Bi,zi=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Fi,"timeClock","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepThree.js"),__REACT_HOT_LOADER__.register(qi,"ManageComplete","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepThree.js"),__REACT_HOT_LOADER__.register(Bi,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/stepThree.js")),ri.a.Step),Ki=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={current:0,editStatus:"new",basicInfo:{},paramsConfig:{},tagId:n.props.routeParams.tagId,tagType:1},n.navToStep=function(){var e;return(e=n).__navToStep__REACT_HOT_LOADER__.apply(e,arguments)},n.changeBasicInfo=function(){var e;return(e=n).__changeBasicInfo__REACT_HOT_LOADER__.apply(e,arguments)},n.changeParamsConfig=function(){var e;return(e=n).__changeParamsConfig__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.tagId;Oa.getApiInfo({tagId:t}).then(function(t){if(1===t.code){var a=t.data,n={name:a.name,catalogueId:a.catalogueId,tagDesc:a.tagDesc,tagRange:a.tagRange,reqLimit:a.reqLimit,respLimit:a.respLimit,dataSourceId:a.dataSourceId,identityColumn:a.identityColumn,identityId:a.identityId,originTable:a.originTable,originColumn:a.originColumn};e.setState({basicInfo:n,paramsConfig:{inputParams:a.inputParam,outputParams:a.outputParam},tagType:a.type})}}),this.props.route.path.indexOf("editApi")>-1&&this.setState({editStatus:"edit"})}},{key:"__navToStep__REACT_HOT_LOADER__",value:function(e){this.setState({current:e})}},{key:"__changeBasicInfo__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.basicInfo,e);this.setState({basicInfo:t})}},{key:"__changeParamsConfig__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.paramsConfig,e);this.setState({paramsConfig:t})}},{key:"render",value:function(){var e=this.state,t=e.tagId,a=e.tagType,n=e.current,i=e.basicInfo,r=e.paramsConfig,o=e.editStatus,l=[{title:"基本属性",content:s.a.createElement(mi,{tagType:a,currentStep:n,navToStep:this.navToStep,basicInfo:i,editStatus:o,changeBasicInfo:this.changeBasicInfo})},{title:"参数配置",content:s.a.createElement(Pi,{tagId:t,currentStep:n,navToStep:this.navToStep,basicInfo:i,paramsConfig:r,changeParamsConfig:this.changeParamsConfig})},{title:"完成",content:s.a.createElement(Yi,{currentStep:n,navToStep:this.navToStep})}];return s.a.createElement("div",{className:"box-1"},s.a.createElement("h1",{className:"box-title"},s.a.createElement(Gn.a,null),s.a.createElement("span",{className:"m-l-8"},"标签发布")),s.a.createElement("div",{className:"steps-container"},s.a.createElement(ri.a,{current:n},l.map(function(e){return s.a.createElement(zi,{key:e.title,title:e.title})})),l[n].content))}}]),t}(r.Component),Qi=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(zi,"Step","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/index.js"),__REACT_HOT_LOADER__.register(Ki,"PublishTag","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/publishTag/index.js")),s.a.createElement("div",null,"where 条件即针对源头数据筛选条件，根据指定的 column、table、where 条件拼接 SQL 进行数据抽取，暂时不支持limit关键字过滤。利用 where 条件可进行全量同步和增量同步，具体说明如下：",s.a.createElement("br",null),s.a.createElement("ul",null,s.a.createElement("li",null,"1）全量同步：第一次做数据导入时通常为全量导入，可不用设置 where 条件。"),s.a.createElement("li",null,"2）增量同步：增量导入在实际业务场景中，往往会选择当天的数据进行同步，通常需要编写 where 条件语句，请先确认表中描述增量字段（时间戳）为哪一个。如tableA增量的字段为create_time，则填写create_time > 您需要的日期，如果需要日期动态变化，请参考帮助文档。")))),Ji=s.a.createElement("ul",null,s.a.createElement("li",null,"MySQL：支持数值型切分键"),s.a.createElement("li",null,"Oracle：支持数值型、字符串类型切分键")),Wi=s.a.createElement("div",null,"user/hive/warehouse/projectName.db/",s.a.createElement("br",null),"tableName 是RD-OS默认的HDFS文件组织方式，projectName为项目名， 其中每个tableName是HDFS内的一个目录，储存着一张表的数据。 如果此表的数据存储在当前项目空间内，只需修改tableName即可， 否则需要根据HDFS的存储位置填写。"),Xi=s.a.createElement("div",null,"设置作业速率上限，则数据同步作业的总速率将尽可能按照这个上限进行同步， 需根据实际硬件配置调整，默认为1"),Zi=s.a.createElement("ul",null,s.a.createElement("li",null," 1.作业速率上限=作业并发数单作业的传输速率，当作业速率上限已定，选择的并发数越高则单并发的速率越低，同时所占用的内存会越高，这可以根据你的业务需求选择设定的值"),s.a.createElement("li",null,"2.作业并发数下拉框选择对象，取决作业速率上限。作业速率上限选择值nMB/s，作业并发数最大能选择n")),$i=s.a.createElement("div",null,"表示脏数据的最大容忍条数，如果您配置0， 则表示严格不允许脏数据存在；如果不填则代表容忍脏数据"),er=s.a.createElement("div",null,"高可用模式下的填写规则：",s.a.createElement("ul",null,s.a.createElement("li",null,"1、分别要填写：nameservice名称、 namenode名称（多个以逗号分隔）、proxy.provider参数；"),s.a.createElement("li",null,"2、所有参数以JSON格式填写；"),s.a.createElement("li",null,"3、格式为：",s.a.createElement("br",null),'"dfs.nameservices": "nameservice名称", "dfs.ha.namenodes.nameservice名称": "namenode名称，以逗号分隔", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.namenode.rpc-address.nameservice名称.namenode名称": "", "dfs.client.failover.proxy.provider.',s.a.createElement("br",null),'nameservice名称": "org.apache.hadoop.',s.a.createElement("br",null),"hdfs.server.namenode.ha.",s.a.createElement("br",null),'ConfiguredFailoverProxyProvider"'),s.a.createElement("li",null,"4、详细参数含义请参考《帮助文档》或",s.a.createElement("a",{href:"http://hadoop.apache.org/docs/r2.7.4/hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html",target:"blank"},"Hadoop官方文档")))),tr=s.a.createElement("div",null,"JDBC URL配置参考：",s.a.createElement("ul",null,s.a.createElement("li",null,"MySQL: jdbc:mysql://host:port/batch?useCursorFetch=true"),s.a.createElement("li",null,"Oracle: jdbc:oracle:thin:@host:port:ORCL"),s.a.createElement("li",null,"Hive: jdbc:hive2://host:port/projectName"))),ar=s.a.createElement("div",null,"HBase配置说明：",s.a.createElement("ul",null,s.a.createElement("li",null,'1、Zookeeper 集群的地址，多个地址间用逗号分割。例 如：" IP1:Port, IP2:Port, IP3:Port/子目录".默认是 localhost,是给伪分布式用的。要修改才能在完全分布式的情况下使用。如果在hbase-env.sh设置了HBASEMANAGESZK， 这些ZooKeeper节点就会和HBase一起启动'),s.a.createElement("li",null,"2、Port: ZooKeeper的zoo.conf中的配置。客户端连接的端口， 默认2181"),s.a.createElement("li",null,"3、子目录：HBase在ZooKeeper中配置的子目录"))),nr=s.a.createElement("div",null,s.a.createElement("p",null,"保存到默认位置，您可以在“数据管理-脏数据管理”中查看，表名：defaultName（生命周期：30天）")),ir=s.a.createElement("div",null,s.a.createElement("p",null,"任务执行结束后统计错误记录占比，当比例过高时，将此任务实例置为失败")),rr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Qi,"dataFilterDoc","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Ji,"switchKey","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Wi,"hdfsPath","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Xi,"jobSpeedLimit","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(Zi,"jobConcurrence","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register($i,"errorCount","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(er,"hdfsConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(tr,"rdbConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(ar,"hBaseConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(nr,"recordDirtyData","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js"),__REACT_HOT_LOADER__.register(ir,"errorPercentConfig","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/docs.js")),function(e){function t(){return m()(this,t),f()(this,(t.__proto__||d()(t)).apply(this,arguments))}return A()(t,e),h()(t,[{key:"render",value:function(){var e=this.props.doc;return s.a.createElement(ei.a,{key:e,title:n[e]},s.a.createElement(M.a,U()({className:"help-doc"},this.props.style,{type:"question-circle-o"})))}}]),t}(s.a.Component)),sr=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(rr,"HelpDoc","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/helpDoc/index.js"),te.a.Item),or=X.a.Option,lr='{\n    "defaultFS": "",\n    "hadoopConfig": {\n        "dfs.nameservices": "defaultDfs", \n        "dfs.ha.namenodes.defaultDfs": "namenode1", \n        "dfs.namenode.rpc-address.defaultDfs.namenode1": "", \n        "dfs.client.failover.proxy.provider.defaultDfs": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider" \n    }\n}',ur=function(e){return{dataSource:e.dataSource}},cr=function(e){return{getDataSourcesType:function(t){e(lt.getDataSourcesType(t))}}},pr=Object(C.b)(ur,cr)(Ui=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={sourceType:void 0,hasHdfsConfig:!1,hadoopConfig:"defaultDfs"},n.onOk=function(){var e;return(e=n).__onOk__REACT_HOT_LOADER__.apply(e,arguments)},n.testConnection=function(){var e;return(e=n).__testConnection__REACT_HOT_LOADER__.apply(e,arguments)},n.cancel=function(){var e;return(e=n).__cancel__REACT_HOT_LOADER__.apply(e,arguments)},n.sourceChange=function(){var e;return(e=n).__sourceChange__REACT_HOT_LOADER__.apply(e,arguments)},n.enableHdfsConfig=function(){var e;return(e=n).__enableHdfsConfig__REACT_HOT_LOADER__.apply(e,arguments)},n.renderSourceType=function(){var e;return(e=n).__renderSourceType__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.sourceData,a=e.sourceData;a&&a!==t&&(7===a.type?this.setState({sourceType:a.type||1,hasHdfsConfig:!0}):this.setState({sourceType:a.type||1}))}},{key:"__onOk__REACT_HOT_LOADER__",value:function(e){var t=this.props,a=t.editDataSource,n=t.form;n.validateFields(function(e,t){e||(t.dataJson.jdbcUrl&&(t.dataJson.jdbcUrl=H.a.trim(t.dataJson.jdbcUrl)),t.dataJson.defaultFS&&(t.dataJson.defaultFS=H.a.trim(t.dataJson.defaultFS)),a(t,n))})}},{key:"__testConnection__REACT_HOT_LOADER__",value:function(){var e=this.state.sourceType,t=this.props.form,a=void 0;e===Ie.b.MAXCOMPUTE&&(a=["type","dataName","dataJson.project","dataJson.endPoint","dataJson.accessKey","dataJson.accessId"]),t.validateFields(a,function(e,t){e||ot.testDSConnection(t).then(function(e){e.data?pe.a.success("数据源连接正常！"):pe.a.error("数据库连接失败！")})})}},{key:"__cancel__REACT_HOT_LOADER__",value:function(){var e=this.props,t=e.form,a=e.handCancel;t.resetFields(),a()}},{key:"__sourceChange__REACT_HOT_LOADER__",value:function(e){this.setState({sourceType:parseInt(e)}),this.props.form.resetFields()}},{key:"__enableHdfsConfig__REACT_HOT_LOADER__",value:function(e){this.setState({hasHdfsConfig:!e.target.value})}},{key:"renderDynamic",value:function(){var e=this.state,t=e.hasHdfsConfig,a=e.sourceType,n=this.props,i=n.form,r=n.sourceData,o=i.getFieldDecorator,l=r.dataJson||{};switch(a){case Ie.b.HIVE:return s.a.createElement("div",null,s.a.createElement(sr,U()({},Ie.k,{label:"JDBC URL",hasFeedback:!0}),o("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:l.jdbcUrl||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"用户名"}),o("dataJson.username",{rules:[],initialValue:l.username||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"密码"}),o("dataJson.password",{rules:[],initialValue:""})(s.a.createElement($.a,{type:"password"}))),s.a.createElement(sr,U()({},Ie.k,{label:"defaultFS",hasFeedback:!0}),o("dataJson.defaultFS",{rules:[{required:!0,message:"defaultFS不可为空！"}],initialValue:l.defaultFS||""})(s.a.createElement($.a,{placeholder:"hdfs://host:port"}))),s.a.createElement(sr,Ie.n,o("hasHdfsConfig",{initialValue:!1})(s.a.createElement(Nn.a,{checked:t,onChange:this.enableHdfsConfig},"高可用配置"))),s.a.createElement(sr,U()({},Ie.k,{label:"高可用配置",style:{display:t?"block":"none"}}),o("dataJson.hadoopConfig",{rules:[],initialValue:l.hadoopConfig||""})(s.a.createElement($.a,{type:"textarea",rows:5,placeholder:lr})),s.a.createElement(rr,{doc:"hdfsConfig"})));case Ie.b.MAXCOMPUTE:return s.a.createElement("div",null,s.a.createElement(sr,U()({},Ie.k,{label:"AccessId",hasFeedback:!0}),o("dataJson.accessId",{rules:[{required:!0,message:"access ID不可为空！"}],initialValue:l.accessId||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"AccessKey",hasFeedback:!0}),o("dataJson.accessKey",{rules:[{required:!0,message:"access Key不可为空！"}],initialValue:l.accessKey||""})(s.a.createElement($.a,{type:"password",autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"Project Name",hasFeedback:!0}),o("dataJson.project",{rules:[{required:!0,message:"Project Name不可为空！"}],initialValue:l.project||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"End Point",hasFeedback:!0}),o("dataJson.endPoint",{rules:[{required:!0,message:"End Point不可为空！"}],initialValue:l.endPoint||""})(s.a.createElement($.a,{autoComplete:"off"}))));case Ie.b.MYSQL:case Ie.b.ORACLE:case Ie.b.SQLSERVER:return s.a.createElement("div",null,s.a.createElement(sr,U()({},Ie.k,{label:"JDBC URL",hasFeedback:!0}),o("dataJson.jdbcUrl",{rules:[{required:!0,message:"jdbcUrl不可为空！"}],initialValue:l.jdbcUrl||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"用户名",hasFeedback:!0}),o("dataJson.username",{rules:[{required:!0,message:"用户名不可为空！"}],initialValue:l.username||""})(s.a.createElement($.a,{autoComplete:"off"}))),s.a.createElement(sr,U()({},Ie.k,{label:"密码",hasFeedback:!0}),o("dataJson.password",{rules:[{required:!0,message:"密码不可为空！"}],initialValue:""})(s.a.createElement($.a,{type:"password"}))))}}},{key:"__renderSourceType__REACT_HOT_LOADER__",value:function(e){return e.map(function(e){return s.a.createElement(or,{key:e.value,value:e.value.toString()},e.name)})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.form,n=e.title,i=e.sourceData,r=e.status,o=e.dataSource,l=(this.state.hasHdfsConfig,a.getFieldDecorator);return s.a.createElement(J.a,{title:n,maskClosable:!1,wrapClassName:"vertical-center-modal",visible:t,onCancel:this.cancel,footer:!1},s.a.createElement(te.a,null,s.a.createElement(sr,U()({},Ie.k,{label:"数据源类型",hasFeedback:!0}),l("type",{rules:[{required:!0,message:"数据源类型不可为空！"}],initialValue:i.type?i.type.toString():"1"})(s.a.createElement(X.a,{onChange:this.sourceChange,disabled:"edit"===r},this.renderSourceType(o.sourceType)))),s.a.createElement(sr,U()({},Ie.k,{label:"数据源名称",hasFeedback:!0}),l("dataName",{rules:[{required:!0,message:"数据源名称不可为空！"},{max:128,message:"数据源名称不得超过128个字符！"},{pattern:/^[A-Za-z0-9_]+$/,message:"名称只能由字母与数字、下划线组成"}],initialValue:i.dataName||""})(s.a.createElement($.a,{autoComplete:"off",disabled:"edit"===r}))),s.a.createElement(sr,U()({},Ie.k,{label:"数据源描述",hasFeedback:!0}),l("dataDesc",{rules:[{max:200,message:"描述请控制在200个字符以内！"}],initialValue:i.dataDesc||""})(s.a.createElement($.a,{type:"textarea",rows:4}))),this.renderDynamic(),s.a.createElement(sr,Ie.n,s.a.createElement(xe.a,{icon:"sync",type:"primary","data-target":"test",onClick:this.testConnection,style:{marginRight:"10px"}},"测试连通性"),s.a.createElement(xe.a,{type:"primary",style:{marginRight:"10px"},onClick:this.onOk},"确定"),s.a.createElement(xe.a,{onClick:this.cancel},"取消"))))}}]),t}(r.Component))||Ui,dr=te.a.create()(pr),_r=dr,mr=_r,gr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(sr,"FormItem","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(or,"Option","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(lr,"hdfsConf","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(ur,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(cr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(pr,"DataSourceModal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(dr,"DataSourceFormWrapper","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js"),__REACT_HOT_LOADER__.register(_r,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/editModal.js")),a(878),$.a.Search),hr=function(e){return{dataSource:e.dataSource}},Er=function(e){return{getDataSources:function(t){e(lt.getDataSources(t))}}},fr=Object(C.b)(hr,Er)(ji=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={visible:!1,title:"新增数据源",status:"add",source:{},params:{currentPage:1,pageSize:20,name:void 0,type:void 0,active:void 0}},n.searchDataSources=function(){var e;return(e=n).__searchDataSources__REACT_HOT_LOADER__.apply(e,arguments)},n.editDataSource=function(){var e;return(e=n).__editDataSource__REACT_HOT_LOADER__.apply(e,arguments)},n.remove=function(){var e;return(e=n).__remove__REACT_HOT_LOADER__.apply(e,arguments)},n.handleTableChange=function(){var e;return(e=n).__handleTableChange__REACT_HOT_LOADER__.apply(e,arguments)},n.initEdit=function(){var e;return(e=n).__initEdit__REACT_HOT_LOADER__.apply(e,arguments)},n.initColumns=function(){var e;return(e=n).__initColumns__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.getDataSources(this.state.params)}},{key:"__searchDataSources__REACT_HOT_LOADER__",value:function(e){var t=U()({},this.state.params,{name:e||void 0,currentPage:1});this.props.getDataSources(t),this.setState({params:t})}},{key:"__editDataSource__REACT_HOT_LOADER__",value:function(e,t){var a=this,n=this.state,i=n.title,r=n.status,s=n.source,o=n.params;"edit"===r?ot.updateDataSource(U()({},s,e)).then(function(e){1===e.code&&(pe.a.success(i+"成功！"),a.props.getDataSources(o))}):ot.addDataSource(e).then(function(e){1===e.code&&(pe.a.success(i+"成功！"),a.props.getDataSources(o))}),t.resetFields(),this.setState({visible:!1,source:{}})}},{key:"__remove__REACT_HOT_LOADER__",value:function(e){var t=this;1!==e.active?ot.deleteDataSource({sourceId:e.id}).then(function(e){1===e.code&&(pe.a.success("移除数据源成功！"),t.props.getDataSources(t.state.params))}):pe.a.info("此数据源已在任务中被引用，无法删除!")}},{key:"__handleTableChange__REACT_HOT_LOADER__",value:function(e,t){var a=t.active,n=t.type,i=U()({},this.state.params,{currentPage:e.current,active:a?a[0]:void 0,type:n?n[0]:void 0});this.props.getDataSources(i),this.setState({params:i})}},{key:"__initEdit__REACT_HOT_LOADER__",value:function(e){this.setState({visible:!0,title:"编辑数据源",status:"edit",source:e})}},{key:"__initColumns__REACT_HOT_LOADER__",value:function(){var e=this;return[{title:"数据源名称",dataIndex:"dataName",key:"dataName",width:"18%",render:function(e){return s.a.createElement("div",{className:"ellipsis-td",title:e},e)}},{title:"类型",dataIndex:"type",key:"type",filters:Ie.i,filterMultiple:!1,width:"10%",render:function(e,t){return t.sourceTypeValue}},{title:"描述信息",dataIndex:"dataDesc",key:"dataDesc",width:"22%"},{title:"最近修改人",dataIndex:"modifyUserName",key:"modifyUserName",width:"15%"},{title:"最近修改时间",dataIndex:"gmtModified",key:"gmtModified",render:function(e){return Mn()(e).format("YYYY-MM-DD HH:mm:ss")},width:"15%"},{title:"状态",dataIndex:"active",key:"active",filters:[{text:"未启用",value:0},{text:"使用中",value:1}],filterMultiple:!1,render:function(e,t){return 1===t.active?"使用中":"未启用"},width:"10%"},{title:"操作",width:"10%",render:function(t,a){return s.a.createElement("span",null,s.a.createElement("a",{onClick:function(){e.initEdit(a)}},"编辑"),s.a.createElement("span",{className:"ant-divider"}),s.a.createElement(un.a,{title:"确定删除此数据源？",okText:"确定",cancelText:"取消",onConfirm:function(){e.remove(a)}},s.a.createElement("a",null,"删除")))}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.title,i=t.status,r=t.source,o=t.params,l=this.props.dataSource,u=l.sourceQuery,c=l.loading,p={current:o.currentPage,pageSize:o.pageSize,total:u.totalCount},d=s.a.createElement(gr,{placeholder:"数据源名称",style:{width:200,margin:"10px 0"},onSearch:this.searchDataSources}),_=s.a.createElement(xe.a,{type:"primary",style:{margin:"10px 0"},className:"right",onClick:function(){e.setState({visible:!0,source:{},status:"add",title:"添加数据源"})}},"新增数据源");return s.a.createElement("div",{className:"source-page"},s.a.createElement("h1",{className:"box-title"},"数据源管理"),s.a.createElement("div",{className:"box-2 m-card shadow"},s.a.createElement(Y.a,{noHovering:!0,bordered:!1,title:d,extra:_},s.a.createElement(K.a,{rowKey:"id",loading:c,className:"m-table fixed-table",pagination:p,columns:this.initColumns(),dataSource:u.data,onChange:this.handleTableChange}))),s.a.createElement(mr,{title:n,status:i,visible:a,sourceData:r,editDataSource:this.editDataSource,handCancel:function(){e.setState({visible:!1,source:{}})}}))}}]),t}(r.Component))||ji,Tr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(gr,"Search","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(hr,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(Er,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/index.js"),__REACT_HOT_LOADER__.register(fr,"DataSource","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/dataSource/index.js")),void 0),Ar=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={applyBox:!1,apply:{apiId:"",apiName:"",desc:""}},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"getTopRightButton",value:function(){var e=this.getValue("applyStatus");return 1==e||3==e?null:0==e?s.a.createElement(xe.a,{onClick:this.jumpToMine.bind(this),size:"large",type:"primary"},"查看审批情况"):s.a.createElement(xe.a,{onClick:this.doApply.bind(this),size:"large",type:"primary"},"立即订购")}},{key:"doApply",value:function(){this.setState({applyBox:!0,apply:{apiId:this.props.apiId,name:this.getApiValue("name"),desc:this.getApiValue("desc")}})}},{key:"back",value:function(){this.props.router.replace("/dl/market")}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.props.apiId];return t?t[e]:null}},{key:"getApiValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.api&&this.props.apiMarket.api[this.props.apiId];return t?t[e]:null}},{key:"showApplySuccessModal",value:function(){Tr=J.a.success({title:"申请提交成功",content:s.a.createElement("span",null,"您可以在 ",s.a.createElement("a",{onClick:this.jumpToMine.bind(this)},"我的API")," 中查看审批进度"),okText:"确定"})}},{key:"jumpToMine",value:function(){Tr&&Tr.destroy(),this.props.router.push("/dl/mine")}},{key:"jumpToMineApproved",value:function(){this.props.router.push("/dl/mine/approved?apiId="+this.props.apiId)}},{key:"handleOk",value:function(){this.setState({applyBox:!1}),this.showApplySuccessModal()}},{key:"handleCancel",value:function(){this.setState({applyBox:!1})}},{key:"render",value:function(){var e=this.props.router.location.query&&this.props.router.location.query.isHideBack?null:s.a.createElement(Jt.a,{span:1},s.a.createElement(M.a,{type:"left-circle-o",onClick:this.back.bind(this),style:{fontSize:18,cursor:"pointer"}}));return s.a.createElement(Y.a,{className:"box-1",noHovering:!0},s.a.createElement(Ge,{show:this.state.applyBox,successCallBack:this.handleOk.bind(this),cancelCallback:this.handleCancel.bind(this),apiId:this.state.apply.apiId,name:this.state.apply.name,desc:this.state.apply.desc}),s.a.createElement(Kt.a,{className:"m-count",style:{height:"auto"}},e,s.a.createElement(Jt.a,{span:12},s.a.createElement(Kt.a,{className:"header-title"},this.getApiValue("name")),s.a.createElement(Kt.a,{className:"header-content"},this.getApiValue("desc"))),s.a.createElement(Jt.a,{span:3},s.a.createElement("section",{className:"m-count-section ",style:{width:150,marginTop:0}},s.a.createElement("span",{className:"m-count-title text-left"},"订购人数"),s.a.createElement("span",{className:"m-count-content font-black text-left"},H.a.toQfw(this.getValue("applyNum")||0),s.a.createElement("span",{style:{fontSize:12}})))),s.a.createElement(Jt.a,{span:5},s.a.createElement("section",{className:"m-count-section",style:{width:200,marginTop:0}},s.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),s.a.createElement("span",{className:"m-count-content font-black text-left"},H.a.toQfw(this.getValue("apiCallNum")||0),s.a.createElement("span",{style:{fontSize:12}})))),s.a.createElement(Jt.a,{span:3},this.getTopRightButton())))}}]),t}(r.Component),yr=Ar,Cr=yr,br=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Tr,"modal","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/topCard.js"),__REACT_HOT_LOADER__.register(Ar,"TopCard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/topCard.js"),__REACT_HOT_LOADER__.register(yr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/topCard.js")),function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}}),vr=function(e){return{getApiDetail:function(t){e(Se.getApiDetail({apiId:t}))},getApiExtInfo:function(t){e(Se.getApiExtInfo({apiId:t}))}}},Dr=Object(C.b)(br,vr)(Mi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={apiId:""},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.router.params&&this.props.router.params.api;t&&this.setState({apiId:t},function(){e.props.getApiDetail(t),e.props.getApiExtInfo(t)})}},{key:"getRequestDataSource",value:function(){return this.getValue("reqParam")||[]}},{key:"getRequestColumns",value:function(){return[{title:"参数名",dataIndex:"paramName",key:"paramName"},{title:"数据类型",dataIndex:"paramType",key:"paramType"},{title:"是否必填",dataIndex:"required",key:"required",render:function(e){return e?"是":"否"}},{title:"说明",dataIndex:"desc",key:"desc"}]}},{key:"getResponseDataSource",value:function(){return this.getValue("respParam")||[]}},{key:"getResponseColumns",value:function(){return[{title:"参数名",dataIndex:"paramName",key:"paramName"},{title:"数据类型",dataIndex:"paramType",key:"paramType"},{title:"是否必填",dataIndex:"required",key:"required",render:function(e){return e?"是":"否"}},{title:"说明",dataIndex:"desc",key:"desc"}]}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.api&&this.props.apiMarket.api[this.state.apiId];return t?t[e]:null}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Cr,U()({},this.state,this.props)),s.a.createElement(Y.a,{className:"box-1",noHovering:!0},s.a.createElement("div",null,s.a.createElement("h1",{className:"title-border-l-blue"},"基本信息"),s.a.createElement("div",{style:{marginTop:15}},s.a.createElement("p",{"data-title":"支持格式：",className:"pseudo-title p-line"},this.getValue("supportType")),s.a.createElement("p",{"data-title":"请求协议：",className:"pseudo-title p-line"},this.getValue("reqProtocol")),s.a.createElement("p",{"data-title":"请求方式：",className:"pseudo-title p-line"},this.getValue("reqMethod")))),s.a.createElement(Kt.a,{gutter:30,style:{marginTop:20}},s.a.createElement(Jt.a,{span:12},s.a.createElement("section",null,s.a.createElement("h1",{className:"title-border-l-blue"},"请求参数"),s.a.createElement(K.a,{rowKey:"paramName",style:{marginTop:15},className:"m-table border-table",pagination:!1,dataSource:this.getRequestDataSource(),columns:this.getRequestColumns()}))),s.a.createElement(Jt.a,{span:12},s.a.createElement("section",null,s.a.createElement("h1",{className:"title-border-l-blue"},"返回参数"),s.a.createElement(K.a,{rowKey:"paramName",style:{marginTop:15},className:"m-table border-table",pagination:!1,dataSource:this.getResponseDataSource(),columns:this.getResponseColumns()})))),s.a.createElement("div",{style:{marginTop:20}},s.a.createElement("h1",{className:"title-border-l-blue"},"JSON样例"),s.a.createElement("div",{style:{marginTop:15}},s.a.createElement("pre",null,ie()({inFields:{id:175,date:"2017-09-08 12:33:23",in:"12,34,45"}},null,"    \r"))))))}}]),t}(r.Component))||Mi,kr=Dr,Or=kr,Rr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(br,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/index.js"),__REACT_HOT_LOADER__.register(vr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/index.js"),__REACT_HOT_LOADER__.register(Dr,"APIDetail","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/index.js"),__REACT_HOT_LOADER__.register(kr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/market/detail/index.js")),function(e){function t(){return m()(this,t),f()(this,(t.__proto__||d()(t)).apply(this,arguments))}return A()(t,e),h()(t,[{key:"getTopRightButton",value:function(){var e=Ie.c[this.getValue("status")];return e?"stop"==e?s.a.createElement("div",null,s.a.createElement(xe.a,{onClick:this.props.openApi,style:{marginRight:"5px"}},"开启"),s.a.createElement(xe.a,{onClick:this.editApi.bind(this,this.props.apiId),style:{marginRight:"5px"},type:"primary"},"编辑"),s.a.createElement(xe.a,{onClick:this.props.deleteApi,type:"danger"},"删除")):s.a.createElement(xe.a,{onClick:this.props.closeApi,size:"large",type:"danger"},"禁用"):null}},{key:"editApi",value:function(e){this.props.router.push("/dl/manage/editApi/"+e)}},{key:"back",value:function(){this.props.router.goBack()}},{key:"openApiDetail",value:function(){window.open(location.origin+location.pathname+"#/dl/market/detail/"+this.props.apiId+"?isHideBack=true")}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.props.apiId];return t?t[e]:null}},{key:"render",value:function(){return s.a.createElement(Y.a,{className:"box-1",noHovering:!0},s.a.createElement(Kt.a,{className:"m-count",style:{height:"auto"}},s.a.createElement(Jt.a,{span:1},s.a.createElement(M.a,{type:"left-circle-o",onClick:this.back.bind(this),style:{fontSize:18,cursor:"pointer"}})),s.a.createElement(Jt.a,{span:10},s.a.createElement(Kt.a,{className:"header-title"},this.getValue("apiName")),s.a.createElement(Kt.a,{className:"header-content"},this.getValue("apiDesc")),s.a.createElement(Kt.a,{className:"header-content"},s.a.createElement("a",{onClick:this.openApiDetail.bind(this)},"查看详情"))),s.a.createElement(Jt.a,{span:3},s.a.createElement("section",{className:"m-count-section ",style:{width:150,marginTop:0}},s.a.createElement("span",{className:"m-count-title text-left"},"订购人数"),s.a.createElement("span",{className:"m-count-content font-black text-left"},H.a.toQfw(this.getValue("applyNum")||0),s.a.createElement("span",{style:{fontSize:12}})))),s.a.createElement(Jt.a,{span:5},s.a.createElement("section",{className:"m-count-section",style:{width:200,marginTop:0}},s.a.createElement("span",{className:"m-count-title text-left"},"累计调用"),s.a.createElement("span",{className:"m-count-content font-black text-left"},H.a.toQfw(this.getValue("apiCallNum")||0),s.a.createElement("span",{style:{fontSize:12}})))),s.a.createElement(Jt.a,{span:5},this.getTopRightButton())))}}]),t}(r.Component)),Lr=Rr,Sr=Lr,wr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Rr,"ManageTopCard","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/topCard.js"),__REACT_HOT_LOADER__.register(Lr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/topCard.js")),{1:"disable",2:"unauthorize",3:"paramerror",4:"timeout",5:"outlimit",6:"other"}),xr={disable:"禁用",unauthorize:"未认证",paramerror:"参数错误",timeout:"超时",outlimit:"超过限制",other:"其他"},Ir=function(e){return{}},Hr=function(e){return{getApiCallErrorInfo:function(t,a){return e(Ra.getApiCallErrorInfo({apiId:t,time:a}))},queryApiCallLog:function(t,a,n){return e(vt.queryApiCallLog({apiId:t,currentPage:a,bizType:n,useAdmin:!0}))}}},Nr=Object(C.b)(Ir,Hr)(Gi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={error:{},data:[],loading:!1,pageIndex:1,total:0,filter:{}},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.getErrorInfo()}},{key:"getErrorInfo",value:function(e){var t=this;(e=e||this.props.apiId)&&(this.props.getApiCallErrorInfo(e,this.props.dateType).then(function(e){if(e){for(var a={},n=0;n<e.data.recordInfoList.length;n++){var i=e.data.recordInfoList[n],r=wr[i.type];r&&(a[r]={percent:i.rate,count:i.callNum})}t.setState({error:a})}}),this.props.queryApiCallLog(e,this.state.pageIndex,this.state.filter.bizType&&this.state.filter.bizType[0]).then(function(e){e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId!==e.apiId&&this.getErrorInfo(e.apiId)}},{key:"initColumns",value:function(){var e=this;return[{title:"调用时间",dataIndex:"invokeTime",key:"invokeTime",render:function(e){return H.a.formatDateTime(e)}},{title:"调用用户",dataIndex:"userName",key:"userName"},{title:"错误类型",dataIndex:"bizType",key:"bizType",render:function(e){return xr[wr[e]]},filters:[{text:"参数错误",value:"3"},{text:"禁用",value:"1"},{text:"未认证",value:"2"},{text:"超时",value:"4"},{text:"超过限制",value:"5"},{text:"其他",value:"6"}],filterMultiple:!1},{title:"错误日志",dataIndex:"content",key:"content",width:"50%"},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return s.a.createElement("a",{onClick:e.lookAllErrorText.bind(e,a.content)},"查看全部")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.state.total}}},{key:"getSource",value:function(){return this.state.data}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){var n=this;this.setState({pageIndex:e.current,filter:t},function(){n.getErrorInfo()})}},{key:"lookAllErrorText",value:function(e){J.a.info({title:"错误日志",content:s.a.createElement("div",null,s.a.createElement("p",null,e)),onOk:function(){}})}},{key:"getErrorPercent",value:function(e){return this.state.error[e]&&this.state.error[e].percent||0}},{key:"getErrorCount",value:function(e){return this.state.error[e]&&this.state.error[e].count||0}},{key:"render",value:function(){var e=this.getSource(),t="m-table monitor-table table-p-l20";return e.length<3&&(t+=" mini-filter"),s.a.createElement("div",null,s.a.createElement("p",{style:{lineHeight:"1",padding:"14px 0px 14px 20px"},className:"child-span-padding-r20"},s.a.createElement("span",null,"参数错误: ",this.getErrorPercent("paramerror"),"% (",this.getErrorCount("paramerror"),"次)"),s.a.createElement("span",null,"禁用: ",this.getErrorPercent("disable"),"% (",this.getErrorCount("disable"),"次)"),s.a.createElement("span",null,"未认证: ",this.getErrorPercent("unauthorize"),"% (",this.getErrorCount("unauthorize"),"次)"),s.a.createElement("span",null,"超时: ",this.getErrorPercent("timeout"),"% (",this.getErrorCount("timeout"),"次)"),s.a.createElement("span",null,"超过限制: ",this.getErrorPercent("outlimit"),"% (",this.getErrorCount("outlimit"),"次)"),s.a.createElement("span",null,"其他: ",this.getErrorPercent("other"),"% (",this.getErrorCount("other"),"次)")),s.a.createElement(K.a,{rowKey:"id",className:t,columns:this.initColumns(),loading:this.state.loading,pagination:this.getPagination(),dataSource:e,onChange:this.onTableChange}))}}]),t}(r.Component))||Gi,Pr=Nr,Ur=Pr,jr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(wr,"errorType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js"),__REACT_HOT_LOADER__.register(xr,"errorExchange","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js"),__REACT_HOT_LOADER__.register(Ir,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js"),__REACT_HOT_LOADER__.register(Hr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js"),__REACT_HOT_LOADER__.register(Nr,"ManageErrorLog","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js"),__REACT_HOT_LOADER__.register(Pr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/errorLog.js")),function(e){function t(){return m()(this,t),f()(this,(t.__proto__||d()(t)).apply(this,arguments))}return A()(t,e),h()(t,[{key:"getSource",value:function(){return this.props.data||[]}},{key:"render",value:function(){return s.a.createElement(K.a,{rowKey:function(e){return e.userId},style:{marginTop:"20px",marginBottom:"20px"},className:"m-table border-table table-p-l20",rowClassName:function(){return"h-33"},pagination:!1,columns:[{title:"排名",dataIndex:"rank",key:"rank",className:"color-666",render:function(e,t,a){return s.a.createElement("span",{className:"rank-number rank-number_"+(a+1)},a+1)}},{title:"用户",dataIndex:"userName",key:"userName",className:"color-666"},{title:"调用次数",dataIndex:"callNum",key:"callNum",className:"color-666"}],dataSource:this.getSource(),onChange:this.onTableChange})}}]),t}(r.Component)),Mr=jr,Gr=Mr,Vr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(jr,"ManageTopCall","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/topCall.js"),__REACT_HOT_LOADER__.register(Mr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/topCall.js")),a(78));a(148),a(200),a(139),a(138);var Fr,qr,Br,Yr=function(e){var t=e.user;return{apiMarket:e.apiMarket,apiManage:e.apiManage,user:t}},zr=function(e){return{getApiCallUserRankList:function(t,a){return e(Ra.getApiCallUserRankList({apiId:t,time:a}))},getApiCallInfo:function(t,a){return e(vt.getApiCallInfo({apiId:t,time:a,useAdmin:!0}))}}},Kr=Object(C.b)(Yr,zr)(Vi=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={topCallUser:"",failPercent:"",callCount:"",callList:[],topCallList:[],apiId:"",dateType:""},n.resize=function(){var e;return(e=n).__resize__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({apiId:this.props.apiId,dateType:this.props.dateType},function(){e.getApiCallUserRankList(),e.getApiCallInfoList()})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.state.apiId==e.apiId&&this.state.dateType==e.dateType||this.setState({apiId:e.apiId,dateType:e.dateType},function(){t.getApiCallUserRankList(),t.getApiCallInfoList()})}},{key:"getApiCallInfoList",value:function(){var e=this,t=this.state.apiId,a=this.state.dateType;t&&a&&this.props.getApiCallInfo(t,a).then(function(t){t&&e.setState({callList:t.data.infoList,topCallUser:t.data.topCallUserName,failPercent:t.data.failRate,callCount:t.data.callCount},function(){e.initLineChart()})})}},{key:"getApiCallUserRankList",value:function(){var e=this,t=this.state.apiId,a=this.state.dateType;t&&a&&this.props.getApiCallUserRankList(t,a).then(function(t){t&&e.setState({topCallList:t.data})})}},{key:"__resize__REACT_HOT_LOADER__",value:function(){this.state.lineChart&&this.state.lineChart.resize()}},{key:"initLineChart",value:function(){for(var e=this.state.callList,t=[],a=[],n=[],i=0;i<e.length;i++)switch(t.push(e[i].callCount),a.push(e[i].failRate),this.props.dateType){case"1":n.push(H.a.formatHours(e[i].time));break;case"7":n.push(H.a.formatDateHours(e[i].time));break;case"30":case"-1":n.push(H.a.formatDate(e[i].time))}var r=Vr.init(document.getElementById("manageApiDetail")),s=Object(Xt.cloneDeep)(Ie.j);s.tooltip.formatter=function(e){for(var t=e[0].name,a=0,n=e.length;a<n;a++){var i="次";"失败率"==e[a].seriesName&&(i="%"),t+='<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+e[a].color+'"></span>'+e[a].seriesName+" : "+e[a].value+i}return t},s.series=[{symbol:"none",name:"调用次数",data:t,type:"line",smooth:!0,itemStyle:{normal:{color:"#1C86EE"}}},{symbol:"none",name:"失败率",data:a,type:"line",smooth:!0,yAxisIndex:1,itemStyle:{normal:{color:"#EE0000"}}}],s.xAxis[0].data=n,r.setOption(s),this.setState({lineChart:r})}},{key:"getDateText",value:function(){switch(this.props.dateType){case"1":return"24小时";case"7":return"7天";case"30":return"30天";case"-1":return"历史以来";default:return""}}},{key:"render",value:function(){return s.a.createElement("div",{style:{paddingLeft:"20px",paddingRight:"20px"}},s.a.createElement(Kt.a,null,s.a.createElement(Jt.a,{span:16},s.a.createElement(Kt.a,{gutter:100,className:"m-count padding-l20 height-101"},s.a.createElement(Jt.a,{span:6},s.a.createElement("section",{className:"m-count-section margin-t20",style:{width:150}},s.a.createElement("span",{className:"m-count-title text-left"},this.getDateText(),"累计调用"),s.a.createElement("span",{className:"m-count-content font-black text-left"},this.state.callCount||0,s.a.createElement("span",{style:{fontSize:12}},"次")))),s.a.createElement(Jt.a,{span:4},s.a.createElement("section",{className:"m-count-section margin-t20",style:{width:100}},s.a.createElement("span",{className:"m-count-title text-left"},this.getDateText(),"失败率"),s.a.createElement("span",{className:"m-count-content font-red text-left"},this.state.failPercent||0,s.a.createElement("span",{style:{fontSize:12}},"%"))))),s.a.createElement(Wt.a,{onResize:this.resize},s.a.createElement("article",{id:"manageApiDetail",style:{width:"100%",height:"300px"}}))),s.a.createElement(Jt.a,{span:8,style:{paddingTop:"20px"}},s.a.createElement("p",{style:{fontWeight:"bold",lineHeight:1,fontSize:"14px"}},"排行榜"),s.a.createElement(Gr,{data:this.state.topCallList}))))}}]),t}(r.Component))||Vi,Qr=Kr,Jr=Qr,Wr=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Yr,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/callState.js"),__REACT_HOT_LOADER__.register(zr,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/callState.js"),__REACT_HOT_LOADER__.register(Kr,"ApiManageCallState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/callState.js"),__REACT_HOT_LOADER__.register(Qr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/callState.js")),function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageIndex:1,filter:{},sortedInfo:{}},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"initColumns",value:function(){var e=this;return[{title:"用户",dataIndex:"userName",key:"userName"},{title:"状态",dataIndex:"status",key:"status",filters:[{text:"正常",value:"1"},{text:"停用",value:"3"},{text:"取消授权",value:"4"}],render:function(e,t){return s.a.createElement("span",{className:"state-"+Ie.d[e]},{success:"正常",stop:"停用",disabled:"取消授权"}[Ie.d[e]])}},{title:"最近24小时调用",dataIndex:"recent24HCallNum",key:"recent24HCallNum"},{title:"最近24小时失败率",dataIndex:"recent24HFailRate",key:"recent24HFailRate",render:function(e){return e+"%"}},{title:"最近7天调用",dataIndex:"recent7DCallNum",key:"recent7DCallNum"},{title:"最近30天调用",dataIndex:"recent30DCallNum",key:"recent30DCallNum"},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",render:function(e){return H.a.formatDateTime(e)}},{title:"操作",dataIndex:"",key:"deal",render:function(t,a){return"disabled"!=Ie.d[a.status]?s.a.createElement("a",{onClick:function(){e.props.cancelApi(a.applyId)}},"取消授权"):s.a.createElement("a",{onClick:function(){e.props.applyApi(a.applyId)}},"恢复授权")}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.props.total}}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){this.setState({pageIndex:e.current,filter:t,sortedInfo:a}),this.props.tableChange({page:e.current,filter:t,sortedInfo:a})}},{key:"lookAllErrorText",value:function(){}},{key:"render",value:function(){return s.a.createElement(K.a,{rowKey:"applyId",className:"m-table monitor-table table-p-l20",columns:this.initColumns(),loading:this.props.loading,pagination:this.getPagination(),dataSource:this.props.data,onChange:this.onTableChange})}}]),t}(r.Component)),Xr=Wr,Zr=Xr,$r=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Wr,"EnableTable","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyStateTable/enableTable.js"),__REACT_HOT_LOADER__.register(Xr,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyStateTable/enableTable.js")),function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={pageIndex:1,filter:{},sortedInfo:{}},n.onTableChange=function(){var e;return(e=n).__onTableChange__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"initColumns",value:function(){return[{title:"用户",dataIndex:"userName",key:"userName"},{title:"最近24小时调用",dataIndex:"recent24HCallNum",key:"recent24HCallNum"},{title:"最近24小时失败率",dataIndex:"recent24HFailRate",key:"recent24HFailRate",render:function(e){return e+"%"}},{title:"最近7天调用",dataIndex:"recent7DCallNum",key:"recent7DCallNum"},{title:"最近30天调用",dataIndex:"recent30DCallNum",key:"recent30DCallNum"},{title:"累计调用",dataIndex:"totalCallNum",key:"totalCallNum"},{title:"订购时间",dataIndex:"applyTime",key:"applyTime",render:function(e){return H.a.formatDateTime(e)}}]}},{key:"getPagination",value:function(){return{current:this.state.pageIndex,pageSize:10,total:this.props.total}}},{key:"__onTableChange__REACT_HOT_LOADER__",value:function(e,t,a){this.setState({pageIndex:e.current,filter:t,sortedInfo:a}),this.props.tableChange({page:e.current,filter:t,sortedInfo:a})}},{key:"lookAllErrorText",value:function(){}},{key:"render",value:function(){return s.a.createElement(K.a,{rowKey:"applyId",className:"m-table monitor-table table-p-l20",columns:this.initColumns(),loading:this.props.loading,pagination:this.getPagination(),dataSource:this.props.data,onChange:this.onTableChange})}}]),t}(r.Component)),es=$r,ts=es,as=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register($r,"DisableTable","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyStateTable/disableTable.js"),__REACT_HOT_LOADER__.register(es,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyStateTable/disableTable.js")),J.a.confirm),ns=function(e){var t=e.user;return{apiMarket:e.apiMarket,apiManage:e.apiManage,user:t}},is=function(e){return{getApiUserApplyList:function(t){return e(Ra.getApiUserApplyList(t))},updateUserApiStatus:function(t){return e(vt.updateApplyStatus(t))}}},rs=Object(C.b)(ns,is)(Fr=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={data:[],total:0,disAbleKey:"init",enAbleKey:"init",loading:!1},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.tableChange({filter:{},sortedInfo:{},page:1})}},{key:"initState",value:function(){this.setState({disAbleKey:Math.random(),enAbleKey:Math.random(),total:0,dataDisable:[],dataEnable:[]})}},{key:"componentWillReceiveProps",value:function(e){this.props.apiId==e.apiId&&this.props.disAble==e.disAble||(this.initState(),this.tableChange({filter:{},sortedInfo:{},page:1},e.apiId))}},{key:"tableChange",value:function(e,t){var a=e.filter,n=(e.sortedInfo,e.page),i=a.status;(!i||i.length<1)&&(i=["1","3","4"]);var r={};r.apiId=t||this.props.apiId,r.pageSize=10,r.currentPage=n,r.status=i,this.getData(r)}},{key:"getData",value:function(e){var t=this;e||(e=this.state.requestParams),e.apiId&&(this.setState({loading:!0,requestParams:e}),this.props.getApiUserApplyList(e).then(function(e){t.setState({loading:!1}),e&&t.setState({data:e.data.data,total:e.data.totalCount})}))}},{key:"cancelApi",value:function(e){var t=this;as({title:"确认取消?",content:"确认取消授权",onOk:function(){t.props.updateUserApiStatus({applyId:e,useAdmin:!0,status:4}).then(function(e){e&&(pe.a.success("取消成功"),t.getData())})},onCancel:function(){}})}},{key:"applyApi",value:function(e){var t=this;as({title:"确认授权?",content:"确认授权",onOk:function(){t.props.updateUserApiStatus({applyId:e,useAdmin:!0,status:1}).then(function(e){e&&(pe.a.success("授权成功"),t.getData())})},onCancel:function(){}})}},{key:"lookAllErrorText",value:function(){}},{key:"getTable",value:function(){return this.props.statusDisAble?s.a.createElement(ts,{loading:this.state.loading,key:this.state.disAbleKey,total:this.state.total,data:this.state.data,tableChange:this.tableChange.bind(this)}):s.a.createElement(Zr,{cancelApi:this.cancelApi.bind(this),applyApi:this.applyApi.bind(this),loading:this.state.loading,key:this.state.enAbleKey,total:this.state.total,data:this.state.data,tableChange:this.tableChange.bind(this)})}},{key:"render",value:function(){return s.a.createElement("div",null,this.getTable())}}]),t}(r.Component))||Fr,ss=rs,os=ss,ls=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(as,"confirm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyState.js"),__REACT_HOT_LOADER__.register(ns,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyState.js"),__REACT_HOT_LOADER__.register(is,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyState.js"),__REACT_HOT_LOADER__.register(rs,"BuyManageState","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyState.js"),__REACT_HOT_LOADER__.register(ss,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/tabPanes/buyState.js")),J.a.confirm),us=Ft.a.Button,cs=Ft.a.Group,ps=function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}},ds=function(e){return{getApiDetail:function(t){e(Se.getApiDetail({apiId:t}))},getApiExtInfo:function(t){e(Se.getApiExtInfo({apiId:t,useAdmin:!0}))},deleteApi:function(t){return e(Ra.deleteApi({apiIds:[t]}))},openApi:function(t){return e(Ra.openApi(t))},closeApi:function(t){return e(Ra.closeApi(t))}}},_s=Object(C.b)(ps,ds)(qr=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.state={apiId:"",nowView:"callState",callStateDate:"1",errorLogDate:"7"},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"deleteApi",value:function(){var e=this,t=this.state.apiId;ls({title:"确认删除该标签？",onOk:function(){e.props.deleteApi(t).then(function(t){t&&(pe.a.success("删除成功"),e.getApiExtInfo())})},onCancel:function(){}})}},{key:"openApi",value:function(){var e=this,t=this.state.apiId;ls({title:"确认开启该标签？",onOk:function(){e.props.openApi(t).then(function(t){pe.a.success("开启成功"),t&&e.getApiExtInfo()})},onCancel:function(){}})}},{key:"closeApi",value:function(){var e=this,t=this.state.apiId;ls({title:"确认禁用该标签？",onOk:function(){e.props.closeApi(t).then(function(t){pe.a.success("禁用成功"),t&&e.getApiExtInfo()})},onCancel:function(){}})}},{key:"getApiExtInfo",value:function(){this.props.getApiExtInfo(this.state.apiId)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.router.params&&this.props.router.params.api;t&&this.setState({apiId:t},function(){e.getApiExtInfo()})}},{key:"callback",value:function(e){this.setState({nowView:e})}},{key:"chooseCallStateDate",value:function(e){this.setState({callStateDate:e.target.value})}},{key:"chooseErrorLogDate",value:function(e){this.setState({errorLogDate:e.target.value})}},{key:"getValue",value:function(e){var t=this.props.apiMarket&&this.props.apiMarket.apiCallInfo&&this.props.apiMarket.apiCallInfo[this.state.apiId];return t?t[e]:null}},{key:"getDateTypeView",value:function(){switch(this.state.nowView){case"callState":return s.a.createElement("div",{className:"m-radio-group",key:"callStateDate",style:{marginTop:"4px",marginRight:"8px"}},s.a.createElement(cs,{name:"callStateDate",defaultValue:this.state.callStateDate,className:"no-bd nobackground",onChange:this.chooseCallStateDate.bind(this)},s.a.createElement(us,{value:"1"},"最近24小时"),s.a.createElement(us,{value:"7"},"最近7天"),s.a.createElement(us,{value:"30"},"最近30天"),s.a.createElement(us,{value:"-1"},"历史以来")));case"errorLog":return s.a.createElement("div",{className:"m-radio-group",key:"errorLogDate",style:{marginTop:"4px",marginRight:"8px"}},s.a.createElement(cs,{name:"errorLogDate",defaultValue:this.state.errorLogDate,className:"no-bd nobackground",onChange:this.chooseErrorLogDate.bind(this)},s.a.createElement(us,{value:"7"},"最近7天")));default:return null}}},{key:"render",value:function(){var e=void 0;return"stop"==Ie.c[this.getValue("status")]&&(e=!0),s.a.createElement("div",null,s.a.createElement(Sr,U()({},this.state,this.props,{deleteApi:this.deleteApi.bind(this),openApi:this.openApi.bind(this),closeApi:this.closeApi.bind(this)})),s.a.createElement("div",{className:"tabs-box m-tabs noheight tabs-filter-show"},s.a.createElement(At.a,{defaultActiveKey:this.state.nowView,onChange:this.callback.bind(this),tabBarExtraContent:this.getDateTypeView()},s.a.createElement(At.a.TabPane,{tab:"调用情况",key:"callState"},s.a.createElement(Jr,{dateType:this.state.callStateDate,apiId:this.state.apiId})),s.a.createElement(At.a.TabPane,{tab:"错误日志",key:"errorLog"},s.a.createElement(Ur,{dateType:this.state.errorLogDate,apiId:this.state.apiId})),s.a.createElement(At.a.TabPane,{tab:"订购情况",key:"buyState"},s.a.createElement(os,{statusDisAble:e,apiId:this.state.apiId})))))}}]),t}(r.Component))||qr,ms=_s,gs=ms,hs=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(ls,"confirm","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(us,"RadioButton","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(cs,"RadioGroup","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(ps,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(ds,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(_s,"APIManageDetail","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js"),__REACT_HOT_LOADER__.register(ms,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiDetail/index.js")),a(189),a(90)),Es=a.n(hs),fs=Es.a.TreeNode,Ts=function(e){function t(e){m()(this,t);var a=f()(this,(t.__proto__||d()(t)).call(this,e));return a.state={maxDeepLength:2,expandedKeys:[],editNode:null,mode:"",addPid:"",autoExpandParent:!0},a.onSelect=function(){return a.__onSelect__REACT_HOT_LOADER__.apply(a,arguments)},a.onCheck=function(){return a.__onCheck__REACT_HOT_LOADER__.apply(a,arguments)},a.checkVal=function(){return a.__checkVal__REACT_HOT_LOADER__.apply(a,arguments)},a.onExpands=function(){return a.__onExpands__REACT_HOT_LOADER__.apply(a,arguments)},a.editInput=null,a}return A()(t,e),h()(t,[{key:"componentDidMount",value:function(){this.props.maxDeepLength&&(this.state.maxDeepLength=this.props.maxDeepLength)}},{key:"componentWillReceiveProps",value:function(e){e.maxDeepLength&&this.props.maxDeepLength!=e.maxDeepLength&&this.setState({maxDeepLength:e.maxDeepLength})}},{key:"getTreeView",value:function(){var e=this.props.tree,t=[];return e?{view:function e(a,n){for(var i=[],r=0;r<a.length;r++){var o=a[r],l=!(o.childCatalogue.length>0);o.api?i.push(s.a.createElement(fs,{title:o.catalogueName,key:o.id})):(t.push(o.id.toString()),i.push(s.a.createElement(fs,{title:this.getTreeNodeTitle.call(this,o.id,o.catalogueName,!1,l,n),key:o.id},e.call(this,o.childCatalogue,n+1))))}return i}.call(this,e,1),expandedKeys:t}:null}},{key:"__onSelect__REACT_HOT_LOADER__",value:function(e,t){}},{key:"__onCheck__REACT_HOT_LOADER__",value:function(e,t){}},{key:"deleteNode",value:function(e){this.props.deleteCatalogue(e)}},{key:"__checkVal__REACT_HOT_LOADER__",value:function(e){var t=/^([\w|\u4e00-\u9fa5]{1,20})$/.test(e);return t||pe.a.error("类目名称不能超过20个字符，只能以字母、数字、下划线和汉字组成！"),t}},{key:"getTreeNodeTitle",value:function(e,t,a,n,i){var r=this.state.maxDeepLength,o=void 0;return o=a?s.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},s.a.createElement(ei.a,{title:"添加新分类"},s.a.createElement(M.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)}))):n?i>=r?s.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},s.a.createElement(ei.a,{title:"编辑"},s.a.createElement(M.a,{type:"edit",onClick:this.editNode.bind(this,e)})),s.a.createElement(ei.a,{title:"删除"},s.a.createElement(un.a,{title:"您确定删除该分类吗",onConfirm:this.deleteNode.bind(this,e),okText:"确定",cancelText:"取消"},s.a.createElement(M.a,{type:"minus-square-o"})))):s.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},s.a.createElement(ei.a,{title:"添加新分类"},s.a.createElement(M.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)})),s.a.createElement(ei.a,{title:"编辑"},s.a.createElement(M.a,{type:"edit",onClick:this.editNode.bind(this,e)})),s.a.createElement(ei.a,{title:"删除"},s.a.createElement(un.a,{title:"您确定删除该分类吗",onConfirm:this.deleteNode.bind(this,e),okText:"确定",cancelText:"取消"},s.a.createElement(M.a,{type:"minus-square-o"})))):i<r?s.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},s.a.createElement(ei.a,{title:"添加新分类"},s.a.createElement(M.a,{type:"plus-square-o",onClick:this.addNode.bind(this,e)})),s.a.createElement(ei.a,{title:"编辑"},s.a.createElement(M.a,{type:"edit",onClick:this.editNode.bind(this,e)}))):s.a.createElement("span",{className:"tree-hover-show-item tree-item",style:{marginLeft:"3px"}},s.a.createElement(ei.a,{title:"编辑"},s.a.createElement(M.a,{type:"edit",onClick:this.editNode.bind(this,e)}))),s.a.createElement("span",{className:"tree-hover-show"},this.state.editNode==e?s.a.createElement("input",{ref:this.setRange.bind(this),autoFocus:!0,defaultValue:t,onBlur:this.editOver.bind(this,e)}):t,o)}},{key:"setRange",value:function(e){if(e){var t=e.value.length;e.setSelectionRange(t,t),this.editInput=e}}},{key:"editOver",value:function(e,t){var a=this,n=this.editInput.value;if(!this.checkVal(n))return this.props.getCatalogue(0),void this.setState({editNode:null});this.setState({editNode:null},function(){"add"!=a.state.mode?a.props.updateCatalogue(e,n):a.props.addCatalogue(a.state.addPid,n)})}},{key:"editNode",value:function(e){this.setState({editNode:e,mode:"edit"})}},{key:"addNode",value:function(e){var t=Object(Xt.cloneDeep)(this.props.tree),a=Math.random();!function e(t,n){if(0!=n)for(var i=0;i<t.length;i++){var r=t[i];if(r.id==n)return void r.childCatalogue.push({id:a,catalogueName:"新建分类名"+r.childCatalogue.length,childCatalogue:[]});e(r.childCatalogue,n)}else t.push({id:a,catalogueName:"新建分类名",childCatalogue:[]})}(t,e),this.setState({editNode:a,mode:"add",addPid:e}),this.props.addCatalogueEdit(t)}},{key:"__onExpands__REACT_HOT_LOADER__",value:function(e,t){this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"render",value:function(){var e=this.getTreeView(),t=e.view,a=e.expandedKeys,n=this.state.expandedKeys.length>0?this.state.expandedKeys:a;return s.a.createElement(Es.a,{showIcon:!0,expandedKeys:n,onSelect:this.onSelect,onCheck:this.onCheck,onExpand:this.onExpands,autoExpandParent:this.state.autoExpandParent},s.a.createElement(fs,{title:this.getTreeNodeTitle.call(this,0,"标签管理",!0,!1,0),key:0},t))}}]),t}(r.Component),As=Ts,ys=As,Cs=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(fs,"TreeNode","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiTypeTree.js"),__REACT_HOT_LOADER__.register(Ts,"ApiTypeTree","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiTypeTree.js"),__REACT_HOT_LOADER__.register(As,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiTypeTree.js")),function(e){var t=e.user;return{apiMarket:e.apiMarket,user:t}}),bs=function(e){return{getCatalogue:function(t){e(Se.getCatalogue(t))},deleteCatalogue:function(t){return e(Ra.deleteCatalogue({id:t}))},updateCatalogue:function(t,a){return e(Ra.updateCatalogue({id:t,nodeName:a}))},addCatalogue:function(t,a){return e(Ra.addCatalogue({pid:t,nodeName:a}))},addCatalogueEdit:function(t){e({type:ae.a.GET_CATALOGUE,payload:t})}}},vs=Object(C.b)(Cs,bs)(Br=function(e){function t(){var e,a,n,i;m()(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=n=f()(this,(e=t.__proto__||d()(t)).call.apply(e,[this].concat(s))),n.onSelect=function(){var e;return(e=n).__onSelect__REACT_HOT_LOADER__.apply(e,arguments)},n.onCheck=function(){var e;return(e=n).__onCheck__REACT_HOT_LOADER__.apply(e,arguments)},i=a,f()(n,i)}return A()(t,e),h()(t,[{key:"__onSelect__REACT_HOT_LOADER__",value:function(e,t){}},{key:"__onCheck__REACT_HOT_LOADER__",value:function(e,t){}},{key:"componentDidMount",value:function(){this.props.getCatalogue(0)}},{key:"deleteCatalogue",value:function(e){var t=this;this.props.deleteCatalogue(e).then(function(e){e&&pe.a.success("删除成功"),t.props.getCatalogue(0)})}},{key:"addCatalogue",value:function(e,t){var a=this;this.props.addCatalogue(e,t).then(function(e){e&&pe.a.success("新增成功"),a.props.getCatalogue(0)})}},{key:"updateCatalogue",value:function(e,t){var a=this;this.props.updateCatalogue(e,t).then(function(e){e&&pe.a.success("更改成功"),a.props.getCatalogue(0)})}},{key:"render",value:function(){return s.a.createElement("div",{className:"m-card"},s.a.createElement("h1",{className:"box-title"}," ",s.a.createElement(Gn.a,null)," 类目管理"),s.a.createElement(Y.a,{className:"box-2 g-datamanage",noHovering:!0},s.a.createElement(ys,{getCatalogue:this.props.getCatalogue,addCatalogue:this.addCatalogue.bind(this),addCatalogueEdit:this.props.addCatalogueEdit,updateCatalogue:this.updateCatalogue.bind(this),deleteCatalogue:this.deleteCatalogue.bind(this),tree:this.props.apiMarket.apiCatalogue})))}}]),t}(r.Component))||Br,Ds=vs,ks=Ds,Os=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(Cs,"mapStateToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiType.js"),__REACT_HOT_LOADER__.register(bs,"mapDispatchToProps","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiType.js"),__REACT_HOT_LOADER__.register(vs,"ApiType","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiType.js"),__REACT_HOT_LOADER__.register(Ds,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/views/management/apiType.js")),s.a.createElement(y.d,{path:"/",component:b.a},s.a.createElement(y.b,{component:ft}),s.a.createElement(y.d,{path:"/message",component:v.a},s.a.createElement(y.b,{component:D.a}),s.a.createElement(y.d,{path:"list",component:D.a}),s.a.createElement(y.d,{path:"detail/:msgId",component:k.a})),s.a.createElement(y.d,{path:"/admin",component:O.a},s.a.createElement(y.b,{component:R.a}),s.a.createElement(y.d,{path:"user",component:R.a}),s.a.createElement(y.d,{path:"role",component:L.a}),s.a.createElement(y.d,{path:"role/add",component:S.a}),s.a.createElement(y.d,{path:"role/edit/:roleId",component:w.a})),s.a.createElement(y.d,{path:"/dl",component:ft},s.a.createElement(y.b,{component:We}),s.a.createElement(y.d,{path:"market",component:We}),s.a.createElement(y.d,{path:"market/detail/:api",component:Or}),s.a.createElement(y.d,{path:"mine",component:va}),s.a.createElement(y.d,{path:"mine/:view",component:va}),s.a.createElement(y.d,{path:"approval",component:an}),s.a.createElement(y.d,{path:"manage",component:Va}),s.a.createElement(y.d,{path:"manage/detail/:api",component:gs}),s.a.createElement(y.d,{path:"manage/apiType",component:ks}),s.a.createElement(y.d,{path:"manage/newApi/:tagId",component:Ki}),s.a.createElement(y.d,{path:"manage/editApi/:tagId",component:Ki}),s.a.createElement(y.d,{path:"tagConfig",component:In}),s.a.createElement(y.d,{path:"tagConfig/identify",component:Xn}),s.a.createElement(y.d,{path:"tagConfig/ruleTagEdit/:id",component:Qn}),s.a.createElement(y.d,{path:"tagConfig/tagLog/:id",component:ni}),s.a.createElement(y.d,{path:"dataSource",component:fr})))),Rs=Os,Ls=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Os,"default","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/routers.js"),function(e){function t(){return m()(this,t),f()(this,(t.__proto__||d()(t)).apply(this,arguments))}return A()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.store,a=e.history;return s.a.createElement(C.a,{store:t},s.a.createElement(y.e,{routes:Rs,history:a,key:Math.random()}))}}]),t}(s.a.Component)),Ss=("undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ls,"Root","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/root.js"),function(e){var t=a(863).default,n=Object(c.a)(t,"hash"),i=n.store,r=n.history;l.a.render(s.a.createElement(u.AppContainer,null,s.a.createElement(e,{store:i,history:r})),document.getElementById("app"))});Ss(Ls);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(Ss,"render","/Users/xuexiaokang/Documents/数据中台/git/data-stack-web/src/webapps/dataLabel/app.js")},878:function(e,t,a){},880:function(e,t,a){},882:function(e,t,a){}},[[872,10,12,11,14,17,13,18]]]);