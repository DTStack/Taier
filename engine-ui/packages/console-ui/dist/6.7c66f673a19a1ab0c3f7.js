(self.webpackJsonp=self.webpackJsonp||[]).push([[6],{"76p7":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a("QbLZ"),r=a.n(n),s={OPEN_COMMAND_LINE:"editor.action.quickCommand",OPEN_FIND_TOOL:"actions.find",OPEN_REPLACE_TOOL:"editor.action.startFindReplaceAction"};function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r()({},{find:"find",replace:"replace",commandPane:"commandPane"},t);return function(t){switch(t){case a.find:return void e.trigger("anyString",s.OPEN_FIND_TOOL);case a.replace:return void e.trigger("anyString",s.OPEN_REPLACE_TOOL);case a.commandPane:return void e.trigger("anyString",s.OPEN_COMMAND_LINE)}}}},"I/n2":function(e,t,a){"use strict";a("fwXI");var n=a("CC+v"),r=a.n(n),s=(a("zmYW"),a("DtFj")),i=a.n(s),o=(a("tL+A"),a("QpBz")),l=a.n(o),c=a("Yz+Y"),u=a.n(c),d=a("iCc5"),m=a.n(d),p=a("V7oC"),h=a.n(p),f=a("FYw3"),v=a.n(f),y=a("mRg0"),g=a.n(y),k=a("sbe7"),E=a.n(k),b=a("7Qib"),T=a("P2sY"),C=a.n(T),_=a("GQeE"),S=a.n(_),N=a("QbLZ"),D=a.n(N),x=a("17x9"),w=a.n(x),P=a("+KTK"),F=(a("w9QG"),a("iLY9"),a("2J7O"),a("Ex8E"),a("re/k"),a("ebop")),R=function(e){function t(e){m()(this,t);var a=v()(this,(t.__proto__||u()(t)).call(this,e));return a.monacoDom=null,a.monacoInstance=null,a}return g()(t,e),h()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"componentDidMount",value:function(){this.initMonaco(),"function"==typeof this.props.editorInstanceRef&&this.props.editorInstanceRef(this._originalEditor)}},{key:"componentWillReceiveProps",value:function(e){var t=e.sync,a=e.original,n=void 0===a?{}:a,r=e.modified,s=void 0===r?{}:r,i=e.options,o=void 0===i?{}:i;if(this.props.original&&this.props.original.value!==n.value&&t){var l=n.value?n.value:"";this.updateValueWithNoEvent(l)}this.props.modified&&this.props.modified.value!==s.value&&this._modifiedEditor.setValue(s.value),this.props.options!==o&&this.monacoInstance.updateOptions(D()({},o,{originalEditable:!o.readOnly}))}},{key:"componentWillUnmount",value:function(){this.destroyMonaco()}},{key:"isValueExist",value:function(e){return!!S()(e).includes("value")}},{key:"log",value:function(){var e;this.props.isLog&&(e=console).log.apply(e,arguments)}},{key:"destroyMonaco",value:function(){this.monacoInstance&&(this._modifiedEditor.dispose(),this._originalEditor.dispose(),this.monacoInstance.dispose())}},{key:"initMonaco",value:function(){var e=this.props,t=e.original,a=void 0===t?{}:t,n=e.modified,r=void 0===n?{}:n,s=e.language,i=e.options;if(this.monacoDom){window.MonacoEnvironment={getWorkerUrl:function(e,t){return"json"===t?"./json.worker.js":"css"===t?"./css.worker.js":"html"===t?"./html.worker.js":"typescript"===t||"javascript"===t?"./typescript.worker.js":"./editor.worker.js"}};var o=C()(F.a,i,{originalEditable:!i||!i.readOnly,renderIndicators:!1,scrollbar:{horizontal:"visible"}});this._originalModel=P.editor.createModel(a.value,s||"sql"),this._modifiedModel=P.editor.createModel(r.value,s||"sql"),this.monacoInstance=P.editor.createDiffEditor(this.monacoDom,o),this.monacoInstance.setModel({original:this._originalModel,modified:this._modifiedModel}),this._originalEditor=this.monacoInstance.getOriginalEditor(),this._modifiedEditor=this.monacoInstance.getModifiedEditor(),this._modifiedEditor.updateOptions({readOnly:!0}),this._originalEditor&&a.cursorPosition&&(this._originalEditor.setPosition(a.cursorPosition),this._originalEditor.focus(),this._originalEditor.revealPosition(a.cursorPosition,P.editor.ScrollType.Immediate)),this.initEditor()}}},{key:"initEditor",value:function(){this.initTheme(),this.initEditorEvent()}},{key:"initTheme",value:function(){P.editor.defineTheme("flippedDiffTheme",{base:"vs",inherit:!0,rules:[],colors:{"diffEditor.insertedTextBackground":"#ff000033","diffEditor.removedTextBackground":"#28d22833"}}),P.editor.setTheme("flippedDiffTheme")}},{key:"updateValueWithNoEvent",value:function(e){this._originalEditor.setValue(e)}},{key:"initEditorEvent",value:function(){var e=this;this._originalEditor.onDidChangeModelContent(function(t){e.log("编辑器事件");var a=e.props,n=a.onChange,r=(a.value,e._originalEditor.getValue());n&&(e.log("订阅事件触发"),n(r,e._originalEditor))}),this._originalEditor.onDidBlurEditor(function(t){e.log("编辑器事件 onDidBlur");var a=e.props,n=a.onBlur,r=a.value;n&&n(r,e._originalEditor.getValue())}),this._originalEditor.onDidFocusEditor(function(t){e.log("编辑器事件 onDidFocus");var a=e.props,n=a.onFocus,r=a.value;n&&n(r,e._originalEditor.getValue())}),this._originalEditor.onDidChangeCursorSelection(function(t){e.log("编辑器事件 onDidChangeCursorSelection");for(var a=e.props.onCursorSelection,n=e._originalEditor.getSelections(),r=e._originalEditor.getModel(),s="",i=0;i<n.length;i++)s=s+=r.getValueInRange(n[i]);a&&a(s)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.style,r="code-editor";r=a?r+" "+a:r;var s={position:"relative",minHeight:"400px",width:"100%",marginTop:"20px"};return s=n?C()(s,n):s,E.a.createElement("div",{className:r,style:s,ref:function(t){e.monacoDom=t}})}}]),t}(E.a.Component);R.propTypes={editorInstanceRef:w.a.function,original:w.a.shape({value:w.a.string,cursorPosition:w.a.Object}),modified:w.a.shape({value:w.a.string}),onChange:w.a.function,onBlur:w.a.function,onFocus:w.a.function,onCursorSelection:w.a.function,sync:w.a.bool,isLog:w.a.bool};var I=R,O=a("djHj"),M=a("gDS+"),L=a.n(M),V=(a("93XW"),a("d1El")),z=a.n(V),Y=(a("hr7U"),a("9xET")),j=a.n(Y),q=(a("fv9D"),a("ZPTe")),K=a.n(q),H=(a("Z8Mf"),a("j7zX")),A=a.n(H),W=a("/MKj"),B=a("sVOr"),J=A.a.TabPane,Q=function(e){function t(e){m()(this,t);var a=v()(this,(t.__proto__||u()(t)).call(this,e));return a.getvalue=function(e){a.setState({currentValue:e.currentValue||{},historyvalue:e.historyvalue||{},contrastResults:e.contrastResults||{}})},a.versionInfo=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.attributes,r=a.upstreamTask,s=a.crosscycleDependence,i={color:"#f00"};return E.a.createElement(K.a,{span:12},E.a.createElement("div",{className:"title"},e),E.a.createElement("div",{className:"box-padding"},E.a.createElement("div",{className:"schedulingCycle"},E.a.createElement("div",{className:"sub-title",style:n?i:{}},"调度属性"),E.a.createElement("div",{className:"line"}),E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"调度状态 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.scheduleStatus)),E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"生效日期 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.effectiveDate)),E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"调度周期 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle&&t.schedulingCycle.period)),t.schedulingCycle&&t.schedulingCycle.beginTime?E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"开始时间 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle.beginTime)):"",t.schedulingCycle&&t.schedulingCycle.gapTime?E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"间隔时间 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle.gapTime)):"",t.schedulingCycle&&t.schedulingCycle.endTime?E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"结束时间 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle.endTime)):"",t.schedulingCycle&&t.schedulingCycle.selectTime?E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"选择时间 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle.selectTime)):"",t.schedulingCycle&&t.schedulingCycle.specificTime?E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"6",className:"txt-left"},"具体时间 : "),E.a.createElement(K.a,{span:"18",className:"txt-left"},t.schedulingCycle.specificTime)):""),E.a.createElement("div",{className:"sub-title",style:r?i:{}},"任务间依赖"),E.a.createElement("div",{className:"line"}),E.a.createElement(j.a,null,E.a.createElement(K.a,{span:"24",className:"txt-left"},"上游任务 : "),E.a.createElement(z.a,{title:t.upstreamTask,overlayStyle:{fontSize:"14px"}},E.a.createElement(K.a,{span:"20",className:"word-break"},t.upstreamTask))),E.a.createElement("div",{className:"sub-title",style:s?i:{}},"跨周期依赖"),E.a.createElement("div",{className:"line"}),E.a.createElement(j.a,null,E.a.createElement(z.a,{title:t.crosscycleDependence,overlayStyle:{fontSize:"14px"}},E.a.createElement(K.a,{span:"20",className:"word-break"},t.crosscycleDependence)))))},a.state={currentValue:a.props.currentValue||{},historyvalue:a.props.historyvalue||{},contrastResults:a.props.contrastResults||{}},a}return g()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){e!=this.props&&this.getvalue(e)}},{key:"render",value:function(){var e=this.state,t=e.currentValue,a=e.historyvalue,n=e.contrastResults;return E.a.createElement(j.a,{gutter:16,className:"diff-params",style:{padding:"0 10px"}},this.versionInfo("当前版本",t,n),this.versionInfo("历史版本",a))}}]),t}(E.a.Component),X=function(e){function t(e){m()(this,t);var a=v()(this,(t.__proto__||u()(t)).call(this,e));return a.getData=function(e){a.setState({historyvalue:{}}),B.a.taskVersionScheduleConf({versionId:e}).then(function(e){1==e.code?a.setState({historyvalue:e.data||{}},a.contrastData):a.setState({historyvalue:{}},a.contrastData)})},a.getRealData=function(){a.setState({historyvalue:a.props.currentRealTabData&&a.props.currentRealTabData.taskVersions[0]||{}},a.contrastData)},a.checkTime=function(e){var t="00";return e&&(t=e.toString().length>1?e:"0"+e),t},a.dealWeekDay=function(e){var t=void 0;switch(e.toString()){case"1":t="一";break;case"2":t="二";break;case"3":t="三";break;case"4":t="四";break;case"5":t="五";break;case"6":t="六";break;case"7":t="七"}return t?"星期"+t:" "},a.parseScheduleConf=function(e,t){var n={},r=e.scheduleConf&&JSON.parse(e.scheduleConf)||{};2==e.scheduleStatus?n.scheduleStatus="已冻结":1==e.scheduleStatus?n.scheduleStatus="未冻结":n.scheduleStatus="";var s=r.beginDate&&r.endDate?r.beginDate+" ~ "+r.endDate:"";n.effectiveDate=s;var i={};switch(r.periodType){case"0":i.period="分钟",i.gapTime=r.gapMin?r.gapMin+"分钟":" ",i.beginTime=a.checkTime(r.beginHour)+":"+a.checkTime(r.beginMin),i.endTime=a.checkTime(r.endHour)+":"+a.checkTime(r.endMin);break;case"1":i.period="小时",i.gapTime=r.gapHour?r.gapHour+"小时":" ",i.beginTime=a.checkTime(r.beginHour)+":"+a.checkTime(r.beginMin),i.endTime=a.checkTime(r.endHour)+":"+a.checkTime(r.endMin);break;case"2":i.period="天",i.specificTime=a.checkTime(r.hour)+":"+a.checkTime(r.min);break;case"3":i.period="周";var o=r.weekDay?r.weekDay.split(",").map(function(e){return a.dealWeekDay(e)}):[];i.selectTime=o?o.join(","):" ",i.specificTime=a.checkTime(r.hour)+":"+a.checkTime(r.min);break;case"4":i.period="月",i.selectTime=r.day?"每月"+r.day+"号":" ",i.specificTime=a.checkTime(r.hour)+":"+a.checkTime(r.min);break;default:i.period=""}if(n.schedulingCycle=i,1===t){var l=e.dependencyTaskNames&&e.dependencyTaskNames.join(" 、");n.upstreamTask=l}else{var c=(e.taskVOS||[]).map(function(e){return e.name});c=c.join(" 、"),n.upstreamTask=c}var u=void 0;switch(r.selfReliance){case 0:case!1:u="不依赖上一调度周期";break;case 1:case!0:u="自依赖，等待上一调度周期成功，才能继续运行";break;case 3:u="自依赖，等待上一调度周期结束，才能继续运行";break;case 2:u="等待下游任务的上一周期成功，才能继续运行";break;case 4:u="等待下游任务的上一周期结束，才能继续运行";break;default:u="不依赖上一调度周期"}return n.crosscycleDependence=u,n},a.contrastData=function(){var e=a.state,t=e.historyvalue,n=e.contrastResults;n.attributes=!1,n.upstreamTask=!1,n.crosscycleDependence=!1;var r=a.parseScheduleConf(t,1),s=a.parseScheduleConf(a.state.currentValue,2);["scheduleStatus","effectiveDate","schedulingCycle"].forEach(function(e){L()(r[e])==L()(s[e])||(n.attributes=!0)}),Boolean(r.upstreamTask)!=Boolean(s.upstreamTask)&&(n.upstreamTask=!0),r.crosscycleDependence!=r.crosscycleDependence&&(n.crosscycleDependence=!0),a.setState({currentParse:s,historyParse:r,contrastResults:n})},a.componentDidMount=function(){"realTimeTask"!=a.props.taskType?a.getData(a.versionId):a.getRealData()},a.callback=function(e){a.setState({tabKey:e})},a.codeChange=function(e,t){a.props.setTaskParams(t)},a.state={historyvalue:{},historyParse:{},contrastResults:{attributes:!1,upstreamTask:!1,crosscycleDependence:!1},currentValue:"realTimeTask"===a.props.taskType?a.props.currentRealTabData:a.props.currentTabData,currentParse:{},tabKey:"realTimeTask"===a.props.taskType?"params":"config"},a.versionId=a.props.diffParams&&a.props.diffParams.id,a}return g()(t,e),h()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.taskType||e.diffParams.id==this.props.diffParams.id?"realTimeTask"===this.props.taskType&&(this.getRealData(),this.setState({currentValue:e.currentRealTabData})):(e.diffParams.id&&(this.getData(e.diffParams.id),this.setState({currentValue:e.currentTabData})),this.setState({tabKey:"config"}))}},{key:"render",value:function(){var e=this.props.taskType,t=this.state,a=t.contrastResults,n=t.historyParse,r=t.currentParse,s=t.historyvalue,i=t.tabKey;return E.a.createElement("div",{className:"m-taksdetail",style:{marginTop:"5px"}},E.a.createElement(A.a,{onChange:this.callback,type:"card",activeKey:i},"realTimeTask"===e?"":E.a.createElement(J,{tab:"调度配置",key:"config"},E.a.createElement(Q,{historyvalue:n,contrastResults:a,currentValue:r})),this.state.currentValue.taskType!==O.y.SYNC&&this.state.currentValue.taskType!==O.y.WORKFLOW&&E.a.createElement(J,{tab:"环境参数",key:"params"},E.a.createElement(I,{language:"ini",className:"merge-text",style:{height:"500px"},options:{readOnly:!0},sync:!0,modified:{value:s&&s.taskParams||" "},original:{value:this.state.currentValue&&this.state.currentValue.taskParams||" "},value:this.state.currentValue&&this.state.currentValue.taskParams||" "}))))}}]),t}(E.a.Component),Z=Object(W.b)(function(e){var t=e.offlineTask.workbench,a=t.currentTab,n=t.tabs,r=e.realtimeTask.currentPage;return{currentTabData:n.filter(function(e){return e.id===a})[0],currentRealTabData:r}})(X);a.d(t,"a",function(){return U});var U=function(e){function t(e){m()(this,t);var a=v()(this,(t.__proto__||u()(t)).call(this,e));return a.state={showDiff:!1,campareTo:"",diffParams:{showDiffparams:!1,tableInfo:""}},a.diffCode=function(e){a.setState({showDiff:!0,campareTo:e})},a.diffParams=function(e){var t=a.state.diffParams;t.showDiffparams=!0,t.tableInfo=e,a.setState({diffParams:t})},a.close=function(){a.setState({showDiff:!1,campareTo:{}}),a._modalKey=~~(1e4*Math.random())},a.closeParamsModal=function(){var e=a.state.diffParams;e.showDiffparams=!1,e.tableInfo="",a.setState({diffParams:e})},a.codeChange=function(e){a.props.changeSql(e)},a.getFomatedJSON=function(e){if(!e)return"";var t=b.a.jsonFormat(e);return t||(l.a.error("您的数据同步JSON配置格式有误"),e)},a.taskTypeJudge=function(e,t){return e.taskType===O.y.SQL||e.taskType===O.y.SYNC||e.taskType==O.y.DATA_COLLECTION?E.a.createElement("div",null,E.a.createElement("a",{onClick:function(){return a.diffCode(t)}},"代码"),E.a.createElement("span",{className:"ant-divider"}),E.a.createElement("a",{onClick:function(){return a.diffParams(t)}},"参数")):e.taskType===O.y.WORKFLOW?E.a.createElement("div",null,E.a.createElement("a",{onClick:function(){return a.diffParams(t)}},"参数")):"-"},a.taskVersionCols=function(){var e=a.props.isPro,t=a.props.taskInfo,n=e?"发布":"提交";return[{width:120,title:n+"时间",dataIndex:"gmtCreate",key:"gmtCreate",render:function(e){return b.a.formatDateTime(e)}},{title:n+"人",dataIndex:"userName",key:"userName"},{width:120,title:"描述",dataIndex:"publishDesc",key:"publishDesc"},{title:"操作",dataIndex:"operation",width:80,key:"operation",render:function(e,n){return a.taskTypeJudge(t,n)}}]},a}return g()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.taskInfo,a=e.taskType,n=this.state,s=n.showDiff,o=n.campareTo,l=n.diffParams,c=t.sqlText,u=o.sqlText,d=void 0;switch(t.taskType){case O.y.SYNC:d="json";break;case O.y.PYTHON_23:d="python";break;case O.y.SQL:d="dtsql";break;default:d="dtsql"}return E.a.createElement("div",null,E.a.createElement(i.a,{className:"m-table",rowKey:"id",dataSource:t.taskVersions||[],columns:this.taskVersionCols(),pagination:!1}),E.a.createElement(r.a,{key:this._modalKey,wrapClassName:"vertical-center-modal modal-body-nopadding",title:"代码对比",width:"900px",bodyStyle:{height:"500px"},visible:s,onCancel:this.close,cancelText:"关闭",footer:null},E.a.createElement(I,{className:"merge-text",original:{value:c},modified:{value:u},options:{readOnly:!0},onChange:this.codeChange,language:d})),E.a.createElement(r.a,{wrapClassName:"vertical-center-modal modal-body-nopadding",title:"参数对比",width:"900px",bodyStyle:{minHeight:"500px",paddingBottom:20},visible:l.showDiffparams,onCancel:this.closeParamsModal,cancelText:"关闭",footer:null},E.a.createElement(Z,{value:t,diffParams:l.tableInfo,taskType:a})))}}]),t}(E.a.Component)},Ohfy:function(e,t,a){"use strict";var n=a("QbLZ"),r=a.n(n),s=a("Yz+Y"),i=a.n(s),o=a("iCc5"),l=a.n(o),c=a("V7oC"),u=a.n(c),d=a("FYw3"),m=a.n(d),p=a("mRg0"),h=a.n(p),f=a("sbe7"),v=a.n(f),y=a("17x9"),g=a.n(y),k=a("hJue"),E=a.n(k),b=a("moyJ"),T=(a("G851"),a("ZvzK")),C=a.n(T),_=(a("FGdI"),a("Pbn2")),S=a.n(_),N=(a("MaXC"),a("4IMT")),D=a.n(N),x=(a("PFYH"),a("Jv8k")),w=a.n(x),P=function(e){function t(){var e,a,n,r;l()(this,t);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=n=m()(this,(e=t.__proto__||i()(t)).call.apply(e,[this].concat(o))),n.editMenu=function(){var e=n.props.onFileEdit;return v.a.createElement(w.a,{onClick:function(t){var a=t.key;e(a)}},v.a.createElement(w.a.Item,{key:"find"},"查找（Cmd/Ctrl）+ F"),v.a.createElement(w.a.Item,{key:"replace"},"替换（Cmd/Ctrl）+ F"),v.a.createElement(w.a.Item,{key:"commandPane"},"命令面板 (F1)"))},n.renderRun=function(){var e=n.props,t=e.isRunning,a=e.onRun,r=e.onStop;return e.enableRun?[v.a.createElement(D.a,{key:"btnRun",onClick:a,loading:t,disabled:t,title:"立即运行",icon:"play-circle-o",style:{marginLeft:"0px"}}," ","运行"),v.a.createElement(D.a,{key:"btnStop",onClick:r,icon:"pause-circle-o",title:"立即停止",disabled:!t},"停止")]:""},r=a,m()(n,r)}return h()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.onFormat,a=e.enableFormat,n=e.leftCustomButton,r=e.rightCustomButton,s=e.disAbleEdit;return v.a.createElement("div",{className:"toolbar ide-toolbar clear-offset"},this.renderRun(),n,a&&v.a.createElement(D.a,{icon:"appstore-o",title:"格式化",onClick:t},"格式化"),!s&&v.a.createElement(C.a,{overlay:this.editMenu(),trigger:["click"]},v.a.createElement(D.a,{icon:"edit",title:"编辑"},"编辑",v.a.createElement(S.a,{type:"down"}))),v.a.createElement("span",{style:{float:"right",position:"relative",marginRight:"18px",lineHeight:"28px",zIndex:"901"}},r))}}]),t}(f.Component),F=(a("93XW"),a("d1El")),R=a.n(F),I=(a("zmYW"),a("DtFj")),O=a.n(I),M=(a("Z8Mf"),a("j7zX")),L=a.n(M),V=a("LvDl"),z=a("pKDC"),Y=a("pAlz"),j=L.a.TabPane,q={position:"relative",top:"-45px",height:"30px"},K="console-log",H=function(e){function t(){var e,a,n,r;l()(this,t);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=n=m()(this,(e=t.__proto__||i()(t)).call.apply(e,[this].concat(o))),n.state={currentPage:1},n.onChange=function(e){n.setState({currentPage:e.current})},r=a,m()(n,r)}return h()(t,e),u()(t,[{key:"generateCols",value:function(e){var t=this.state.currentPage;if(e&&e.length>0){var a=[{title:"序号",key:"t-id",render:function(e,a,n){return 10*(t-1)+(n+1)}}];return e.forEach(function(e,t){a.push({title:e,key:t+e,render:function(e,a){return v.a.createElement("textarea",{title:a[t],value:a[t]})}})}),a}return[]}},{key:"render",value:function(){var e=this.props.data,t=e.slice(1,e.length),a=this.generateCols(e[0]);return v.a.createElement(O.a,{rowKey:"id",scroll:{x:!0},className:"console-table",bordered:!0,dataSource:t,onChange:this.onChange,columns:a})}}]),t}(f.Component),A=function(e){function t(){var e,a,n,r;l()(this,t);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=n=m()(this,(e=t.__proto__||i()(t)).call.apply(e,[this].concat(o))),n.state={activeKey:K},n.onEdit=function(e,t){n[t](e)},n.onTabChange=function(e){var t=n.props.onConsoleTabChange;n.setState({activeKey:e},function(){e===K?(n.focusEditor(),t(1)):t(0)})},n.focusEditor=function(){var e=n.editor.self;e.doc.setCursor(e.lineCount(),null)},n.remove=function(e){var t=n.props.onRemoveTab;t&&t(parseInt(e,10))},r=a,m()(n,r)}return h()(t,e),u()(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.data,a=this.props.data;t.showRes&&t.results.length>0&&!Object(V.isEqual)(t.results,a.results)?(this.setState({activeKey:""+(t.results.length-1)}),this.props.onConsoleTabChange(0)):0===t.results.length&&this.setState({activeKey:K},this.focusEditor)}},{key:"renderTabs",value:function(e){var t=this;return e&&e.length>0?e.map(function(e,a){var n=v.a.createElement("span",null,"结果",e.id?e.id:a+1);return v.a.createElement(j,{style:{minHeight:"100%",position:"relative"},tab:n,key:""+a},v.a.createElement(H,{data:e.data}),e.jobId?v.a.createElement("a",{href:t.props.downloadUri+"?jobId="+e.jobId,download:!0},v.a.createElement(D.a,{className:"btn-download",style:q},"下载")):null)}):[]}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.setSplitMax,r=t.setSplitMin,s=t.activedTab,i=t.onConsoleClose,o=s?"console-log":this.state.activeKey;return Y.a.readOnly=!0,Y.a.lineNumbers=!1,v.a.createElement("div",{className:"ide-console"},v.a.createElement(L.a,{hideAdd:!0,type:"editable-card",activeKey:o,onChange:this.onTabChange,onEdit:this.onEdit},v.a.createElement(j,{tab:"日志",key:"console-log"},v.a.createElement("div",{style:{position:"relative"}},v.a.createElement(z.a,{cursorAlwaysInEnd:!0,style:{minHeight:"auto"},ref:function(t){e.editor=t},options:Y.a,key:"output-log",sync:!0,value:a.log}))),this.renderTabs(a.results)),v.a.createElement(S.a,{onClick:n,className:"console-icon up",type:"up-square-o"}),v.a.createElement(S.a,{onClick:r,className:"console-icon down",type:"down-square-o"}),v.a.createElement(R.a,{placement:"top",title:"关闭控制台"},v.a.createElement(S.a,{className:"close-console",type:"close",onClick:i})))}}]),t}(f.Component),W={editor:g.a.object,toolbar:g.a.object,console:g.a.object},B=function(e){function t(){var e,a,n,r;l()(this,t);for(var s=arguments.length,o=Array(s),c=0;c<s;c++)o[c]=arguments[c];return a=n=m()(this,(e=t.__proto__||i()(t)).call.apply(e,[this].concat(o))),n.state={changeTab:!0,size:void 0},n.changeTab=function(e){var t=n.state.changeTab;t=!!e,n.setState({changeTab:t})},r=a,m()(n,r)}return h()(t,e),u()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.editor,n=t.toolbar,s=t.console,i=t.editorInstanceRef,o=this.state.size,l=v.a.createElement(b.a,r()({editorInstanceRef:i},a));return v.a.createElement("div",{className:"ide-editor"},n&&n.enable?v.a.createElement("div",{className:"ide-header bd-bottom"},v.a.createElement(P,r()({},n,{changeTab:this.changeTab}))):"",v.a.createElement("div",{style:{zIndex:901},className:"ide-content"},s&&s.data&&s.data.log?v.a.createElement(E.a,{split:"horizontal",minSize:100,maxSize:-77,style:{paddingBottom:"40px"},defaultSize:"60%",primary:"first",size:o,onDragStarted:function(){e.setState({size:void 0})}},l,v.a.createElement(A,r()({onConsoleTabChange:this.changeTab,activedTab:this.state.changeTab,setSplitMax:function(){e.setState({size:"100px"})},setSplitMin:function(){e.setState({size:"calc(100% - 40px)"})}},s))):l))}}]),t}(f.Component);B.propTypes=W;t.a=B},VoFA:function(e,t,a){"use strict";a.d(t,"a",function(){return v});var n=a("Yz+Y"),r=a.n(n),s=a("iCc5"),i=a.n(s),o=a("V7oC"),l=a.n(o),c=a("FYw3"),u=a.n(c),d=a("mRg0"),m=a.n(d),p=a("sbe7"),h=a.n(p),f=a("djHj"),v=function(e){function t(){return i()(this,t),u()(this,(t.__proto__||r()(t)).apply(this,arguments))}return m()(t,e),l()(t,[{key:"render",value:function(){var e=this.props.tabData,t=e.pythonVersion,a=e.learningType,n=e.scriptText,r=e.taskType,s=e.type,i="";if(null==n)switch(r){case f.y.SQL:i="sql.svg";break;case f.y.MR:case f.y.HAHDOOPMR:i="mr.svg";break;case f.y.SYNC:i="datasync.svg";break;case f.y.PYTHON:i="spark_python.svg";break;case f.y.VIRTUAL_NODE:i="virtual.svg";break;case f.y.DEEP_LEARNING:if(a==f.j.MXNET){i="mxnet.svg";break}if(a==f.j.TENSORFLOW){i="tensorflow.svg";break}i="deepLearning.svg";break;case f.y.PYTHON_23:if(t==f.o.PYTHON2){i="python2.svg";break}if(t==f.o.PYTHON3){i="python3.svg";break}i="python.svg";break;case f.y.SHELL:i="shell.svg";break;case f.y.DATA_COLLECTION:i="collection.svg";break;case f.y.WORKFLOW:i="workflow.svg"}else switch(s){case f.t.SQL:i="sql.svg";break;case f.t.PYTHON2:i="python2.svg";break;case f.t.PYTHON3:i="python3.svg";break;case f.t.SHELL:i="shell.svg"}return h.a.createElement("img",{className:"s-icon",style:{width:"14px",height:"14px",position:"absolute",top:"8px",left:"10px"},src:"/public/rdos/img/"+i})}}]),t}(p.Component)},ZU0t:function(e,t,a){"use strict";a("G851");var n=a("ZvzK"),r=a.n(n),s=(a("MaXC"),a("4IMT")),i=a.n(s),o=(a("FGdI"),a("Pbn2")),l=a.n(o),c=(a("PFYH"),a("Jv8k")),u=a.n(c),d=a("Yz+Y"),m=a.n(d),p=a("iCc5"),h=a.n(p),f=a("V7oC"),v=a.n(f),y=a("FYw3"),g=a.n(y),k=a("mRg0"),E=a.n(k),b=a("sbe7"),T=a.n(b),C=function(e){function t(){var e,a,n,r;h()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=g()(this,(e=t.__proto__||m()(t)).call.apply(e,[this].concat(i))),n.viewMenu=function(){var e=n.props,t=e.onThemeChange,a=e.editorTheme;return T.a.createElement(u.a,{selectedKeys:[a],onClick:function(e){var a=e.key;t(a)}},T.a.createElement(u.a.Item,{key:"vs"},"默认"),T.a.createElement(u.a.Item,{key:"vs-dark"},"深色"),T.a.createElement(u.a.Item,{key:"hc-black"},"高对比深色"))},r=a,g()(n,r)}return E()(t,e),v()(t,[{key:"render",value:function(){return T.a.createElement(r.a,{overlay:this.viewMenu(),trigger:["click"]},T.a.createElement(i.a,{icon:"skin",title:"主题",style:{paddingLeft:0}},"主题",T.a.createElement(l.a,{type:"down"})))}}]),t}(b.Component);t.a=C},bAm3:function(e,t,a){"use strict";a("MaXC");var n=a("4IMT"),r=a.n(n),s=a("QbLZ"),i=a.n(s),o=a("Yz+Y"),l=a.n(o),c=a("iCc5"),u=a.n(c),d=a("V7oC"),m=a.n(d),p=a("FYw3"),h=a.n(p),f=a("mRg0"),v=a.n(f),y=a("sbe7"),g=a.n(y),k=a("/gYX"),E=a("YEIV"),b=a.n(E),T=a("P2sY"),C=a.n(T),_=function(e){function t(e){u()(this,t);var a=h()(this,(t.__proto__||l()(t)).call(this,e));return a.bindEvent=function(e){var t=a.props,n=t.onTrigger,r=t.keyMap,s=e.keyCode,i="keydown"===e.type;if(i){if(!0===r[s]){var o=C()(a.state.currentKeys,b()({},s,i));a.setState({currentKeys:o});var l=!0;for(var c in r)if(!o[c]){l=!1;break}l&&n(e)}}else a.setState({currentKeys:{}})},a.state={currentKeys:{}},a}return v()(t,e),m()(t,[{key:"componentDidMount",value:function(){addEventListener("keydown",this.bindEvent,!1),addEventListener("keyup",this.bindEvent,!1)}},{key:"componentWillUnmount",value:function(){removeEventListener("keydown",this.bindEvent,!1),removeEventListener("keyup",this.bindEvent,!1),this.setState({currentKeys:{}})}},{key:"render",value:function(){return this.props.children}}]),t}(g.a.Component);a.d(t,"a",function(){return S});var S=function(e){function t(){var e,a,n,r;u()(this,t);for(var s=arguments.length,i=Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=n=h()(this,(e=t.__proto__||l()(t)).call.apply(e,[this].concat(i))),n.state={isFullScreen:!1},n.keyPressFullScreen=function(e){e.preventDefault(),n.fullScreen()},n.fullScreen=function(){var e=n.props.target;if(n.state.isFullScreen)document.exitFullscreen?document.exitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{var t=document.getElementById(e)||document.body;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFUllscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}n.setState({isFullScreen:!n.state.isFullScreen})},r=a,h()(n,r)}return v()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this,t=document.body,a=function(a){var n=void 0;t.requestFullscreen?n=document.fullscreenElement:t.msRequestFullscreen?n=document.msFullscreenElement:t.mozRequestFullscreen?n=document.mozFullScreenElement:t.webkitRequestFullscreen&&(n=document.webkitFullscreenElement),e.setState({isFullScreen:!!n})};t.requestFullscreen?t.onfullscreenchange=a:t.msRequestFullscreen?t.onmsfullscreenchange=a:t.mozRequestFullscreen?t.onmozfullscreenchange=a:t.webkitRequestFullscreen&&(t.onwebkitfullscreenchange=a)}},{key:"componentWillUnmount",value:function(){var e=document.body;e.requestFullscreen?document.onfullscreenchange=null:e.msRequestFullscreen?document.onmsfullscreenchange=null:e.mozRequestFullscreen?document.onmozfullscreenchange=null:e.webkitRequestFullscreen&&(document.onwebkitfullscreenchange=null)}},{key:"render",value:function(){var e=this.state.isFullScreen?"退出全屏":"全屏",t=this.state.isFullScreen?"exit-fullscreen":"fullscreen";return g.a.createElement(_,{onTrigger:this.keyPressFullScreen,keyMap:{70:!0,91:!0,16:!0}},g.a.createElement(r.a,i()({},this.props,{onClick:this.fullScreen}),g.a.createElement(k.a,{className:"my-icon",type:t,themeDark:this.props.themeDark}),e))}}]),t}(y.Component)},tHbZ:function(e,t,a){"use strict";a.d(t,"a",function(){return y});a("93XW");var n=a("d1El"),r=a.n(n),s=a("Yz+Y"),i=a.n(s),o=a("iCc5"),l=a.n(o),c=a("V7oC"),u=a.n(c),d=a("FYw3"),m=a.n(d),p=a("mRg0"),h=a.n(p),f=a("sbe7"),v=a.n(f),y=function(e){function t(e){return l()(this,t),m()(this,(t.__proto__||i()(t)).call(this,e))}return h()(t,e),u()(t,[{key:"render",value:function(){return this.props.notSynced?v.a.createElement(r.a,{title:"修改已保存至本地存储但尚未同步到服务器，你可以点击上面的保存按钮立即同步。"},v.a.createElement("span",{className:"not-synced"})):null}}]),t}(v.a.Component)}}]);