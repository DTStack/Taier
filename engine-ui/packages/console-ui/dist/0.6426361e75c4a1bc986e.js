(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1450:function(e,t,r){"use strict";r(59);var a=r(29),n=r.n(a),i=(r(49),r(26)),o=r.n(i),s=(r(38),r(13)),l=r.n(s),c=r(8),u=r.n(c),f=r(5),h=r.n(f),d=r(7),g=r.n(d),p=r(1),_=r.n(p),m=r(6),v=r.n(m),k=r(0),T=r.n(k),y=r(12),C=r(41),E=r.n(C),O=r(9),b=(r(1465),r(1463),r(210));r(678),r(1461);var R=function(e){function t(){var e,r,a,n;h()(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=a=_()(this,(e=t.__proto__||u()(t)).call.apply(e,[this].concat(o))),a.initUI=function(){var e;return(e=a).__initUI__REACT_HOT_LOADER__.apply(e,arguments)},n=r,_()(a,n)}return v()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.value,r=e.compareTo;this.initUI(t,r)}},{key:"componentWillReceiveProps",value:function(e){var t=e.value,r=e.compareTo;e.tableRefresh&&(this._self.edit.doc.setValue(t),this._self.right.orig.doc.setValue(r)),t&&this.props.value!==t&&this._self.edit.doc.setValue(t),r&&this.props.compareTo!==r&&this._self.right.orig.doc.setValue(r)}},{key:"__initUI__REACT_HOT_LOADER__",value:function(e,t){var r=this.props,a=r.onChange,n=r.readOnly,i=this.getCodeMirrorIns().MergeView(this.diffView,{value:e,origLeft:null,orig:t,lineNumbers:!0,mode:"text/x-sql",highlightDifferences:!0,connect:null,collapseIdentical:!1,readOnly:n});i.edit.doc.on("change",function(t){a&&a(e,t.getValue())}),i.wrap.style.height="500px",this._self=i}},{key:"mergeViewHeight",value:function(e){function t(e){return e?e.getScrollInfo().height:0}return Math.max(t(e.leftOriginal()),t(e.editor()),t(e.rightOriginal()))}},{key:"resize",value:function(e){for(var t=this.mergeViewHeight(e);;){e.leftOriginal()&&e.leftOriginal().setSize(null,t),e.editor().setSize(null,t),e.rightOriginal()&&e.rightOriginal().setSize(null,t);var r=this.mergeViewHeight(e);if(r>=t)break;t=r}e.wrap.style.height=t+"px"}},{key:"getCodeMirrorIns",value:function(){return this._self||b}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,a=t.style,n="code-editor merge-text";n=r?n+" "+r:n;var i={position:"relative",borderTop:"1px solid #e9e9e9",marginTop:"20px"};return i=a?E()(i,a):i,T.a.createElement("div",{ref:function(t){e.diffView=t},className:n,style:i})}}]),t}(k.Component),D=R,A=D,w=("undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(R,"DiffEditor","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/components/diff-code-editor/index.js"),__REACT_HOT_LOADER__.register(D,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/components/diff-code-editor/index.js")),r(84),r(39)),L=r.n(w),S=(r(70),r(31)),H=r.n(S),x=(r(74),r(27)),M=r.n(x),N=(r(78),r(34)),V=r.n(N),P=r(20),F=r(23),I=(r(21),r(684),V.a.TabPane),B=function(e){function t(e){h()(this,t);var r=_()(this,(t.__proto__||u()(t)).call(this,e));return r.getvalue=function(){return r.__getvalue__REACT_HOT_LOADER__.apply(r,arguments)},r.versionInfo=function(){return r.__versionInfo__REACT_HOT_LOADER__.apply(r,arguments)},r.state={currentValue:r.props.currentValue||{},historyvalue:r.props.historyvalue||{},contrastResults:r.props.contrastResults||{}},r}return v()(t,e),g()(t,[{key:"componentWillReceiveProps",value:function(e){e!=this.props&&this.getvalue(e)}},{key:"__getvalue__REACT_HOT_LOADER__",value:function(e){this.setState({currentValue:e.currentValue||{},historyvalue:e.historyvalue||{},contrastResults:e.contrastResults||{}})}},{key:"__versionInfo__REACT_HOT_LOADER__",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.attributes,n=r.upstreamTask,i=r.crosscycleDependence,o={color:"#f00"};return T.a.createElement(M.a,{span:12},T.a.createElement("div",{className:"title"},e),T.a.createElement("div",{className:"box-padding"},T.a.createElement("div",{className:"sub-title",style:a?o:{}},"调度属性"),T.a.createElement("div",{className:"line"}),T.a.createElement(H.a,null,T.a.createElement(M.a,{span:"6",className:"txt-left"},"调度状态 : "),T.a.createElement(M.a,{span:"18",className:"txt-left"},t.scheduleStatus)),T.a.createElement(H.a,null,T.a.createElement(M.a,{span:"6",className:"txt-left"},"生效日期 : "),T.a.createElement(M.a,{span:"18",className:"txt-left"},t.effectiveDate)),T.a.createElement(H.a,null,T.a.createElement(M.a,{span:"6",className:"txt-left"},"调度周期 : "),T.a.createElement(M.a,{span:"18",className:"txt-left"},t.schedulingCycle)),T.a.createElement(H.a,null,T.a.createElement(M.a,{span:"6",className:"txt-left"},"具体时间 : "),T.a.createElement(M.a,{span:"18",className:"txt-left"},t.specificTime)),T.a.createElement("div",{className:"sub-title",style:n?o:{}},"任务间依赖"),T.a.createElement("div",{className:"line"}),T.a.createElement(H.a,null,T.a.createElement(M.a,{span:"24",className:"txt-left"},"上游任务 : "),T.a.createElement(L.a,{title:t.upstreamTask,overlayStyle:{fontSize:"14px"}},T.a.createElement(M.a,{span:"20",className:"word-break"},t.upstreamTask))),T.a.createElement("div",{className:"sub-title",style:i?o:{}},"跨周期依赖"),T.a.createElement("div",{className:"line"}),T.a.createElement(H.a,null,T.a.createElement(L.a,{title:t.crosscycleDependence,overlayStyle:{fontSize:"14px"}},T.a.createElement(M.a,{span:"20",className:"word-break"},t.crosscycleDependence)))))}},{key:"render",value:function(){var e=this.state,t=e.currentValue,r=e.historyvalue,a=e.contrastResults;return T.a.createElement(H.a,{gutter:16,className:"diff-params",style:{padding:"0 10px"}},this.versionInfo("当前版本",t,a),this.versionInfo("历史版本",r))}}]),t}(T.a.Component),W=function(e){function t(e){h()(this,t);var r=_()(this,(t.__proto__||u()(t)).call(this,e));return r.getData=function(){return r.__getData__REACT_HOT_LOADER__.apply(r,arguments)},r.getRealData=function(){return r.__getRealData__REACT_HOT_LOADER__.apply(r,arguments)},r.checkTime=function(){return r.__checkTime__REACT_HOT_LOADER__.apply(r,arguments)},r.parseScheduleConf=function(){return r.__parseScheduleConf__REACT_HOT_LOADER__.apply(r,arguments)},r.contrastData=function(){return r.__contrastData__REACT_HOT_LOADER__.apply(r,arguments)},r.componentDidMount=function(){return r.__componentDidMount__REACT_HOT_LOADER__.apply(r,arguments)},r.callback=function(){return r.__callback__REACT_HOT_LOADER__.apply(r,arguments)},r.codeChange=function(){return r.__codeChange__REACT_HOT_LOADER__.apply(r,arguments)},r.state={historyvalue:{},historyParse:{},contrastResults:{attributes:!1,upstreamTask:!1,crosscycleDependence:!1},currentParse:{},tabKey:"realTimeTask"===r.props.taskType?"params":"config",tableRefresh:Math.random()},r.currentValue="realTimeTask"===r.props.taskType?r.props.currentRealTabData:r.props.currentTabData,r.versionId=r.props.diffParams&&r.props.diffParams.id,r}return v()(t,e),g()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.taskType||e.diffParams.id==this.props.diffParams.id?"realTimeTask"===this.props.taskType&&(this.getRealData(),this.currentValue=e.currentRealTabData):(e.diffParams.id&&(this.getData(e.diffParams.id),this.currentValue=e.currentTabData),this.setState({tabKey:"config"}))}},{key:"__getData__REACT_HOT_LOADER__",value:function(e){var t=this;this.setState({historyvalue:{}}),F.a.taskVersionScheduleConf({versionId:e}).then(function(e){1==e.code?t.setState({historyvalue:e.data||{}},t.contrastData):t.setState({historyvalue:{}},t.contrastData)})}},{key:"__getRealData__REACT_HOT_LOADER__",value:function(){this.setState({historyvalue:this.props.currentRealTabData&&this.props.currentRealTabData.taskVersions[0]||{},tableRefresh:Math.random()},this.contrastData)}},{key:"__checkTime__REACT_HOT_LOADER__",value:function(e){var t="00";return e&&(t=e.toString().length>1?e:"0"+e),t}},{key:"__parseScheduleConf__REACT_HOT_LOADER__",value:function(e,t){var r={},a=e.scheduleConf&&JSON.parse(e.scheduleConf)||{};2==e.scheduleStatus?r.scheduleStatus="已冻结":1==e.scheduleStatus?r.scheduleStatus="未冻结":r.scheduleStatus="";var n=a.beginDate&&a.endDate?a.beginDate+" ~ "+a.endDate:"";r.effectiveDate=n;var i=void 0;switch(a.periodType){case"0":i="分钟";break;case"1":i="小时";break;case"2":i="天";break;case"3":i="周";break;case"4":i="月";break;default:i=""}r.schedulingCycle=i;var o=this.checkTime(a.hour)+":"+this.checkTime(a.min);if(r.specificTime=o,1===t){var s=e.dependencyTaskNames&&e.dependencyTaskNames.join(" 、");r.upstreamTask=s}else{var l=(e.taskVOS||[]).map(function(e){return e.name});l=l.join(" 、"),r.upstreamTask=l}var c=void 0;switch(a.selfReliance){case 0:case!1:c="不依赖上一调度周期";break;case 1:case!0:c="自依赖，等待上一调度周期成功，才能继续运行";break;case 3:c="自依赖，等待上一调度周期结束，才能继续运行";break;case 2:c="等待下游任务的上一周期成功，才能继续运行";break;case 4:c="等待下游任务的上一周期结束，才能继续运行";break;default:c="不依赖上一调度周期"}return r.crosscycleDependence=c,r}},{key:"__contrastData__REACT_HOT_LOADER__",value:function(){var e=this.state,t=e.historyvalue,r=e.contrastResults;r.attributes=!1,r.upstreamTask=!1,r.crosscycleDependence=!1;var a=this.parseScheduleConf(t,1),n=this.parseScheduleConf(this.currentValue,2);["scheduleStatus","effectiveDate","schedulingCycle","specificTime"].forEach(function(e){a[e]==n[e]||(r.attributes=!0)}),Boolean(a.upstreamTask)!=Boolean(n.upstreamTask)&&(r.upstreamTask=!0),a.crosscycleDependence!=a.crosscycleDependence&&(r.crosscycleDependence=!0),this.setState({currentParse:n,historyParse:a,contrastResults:r})}},{key:"__componentDidMount__REACT_HOT_LOADER__",value:function(){"realTimeTask"!=this.props.taskType?this.getData(this.versionId):this.getRealData()}},{key:"__callback__REACT_HOT_LOADER__",value:function(e){this.setState({tabKey:e,tableRefresh:Math.random()})}},{key:"__codeChange__REACT_HOT_LOADER__",value:function(e,t){this.props.setTaskParams(t)}},{key:"render",value:function(){var e=this.props.taskType,t=this.state,r=t.contrastResults,a=t.historyParse,n=t.currentParse,i=t.historyvalue,o=t.tabKey,s=t.tableRefresh;this.currentValue.readWriteLockVO&&this.currentValue.readWriteLockVO.getLock;return T.a.createElement("div",{className:"m-taksdetail"},T.a.createElement(V.a,{onChange:this.callback,type:"card",activeKey:o},"realTimeTask"===e?"":T.a.createElement(I,{tab:"调度配置",key:"config"},T.a.createElement(B,{historyvalue:a,contrastResults:r,currentValue:n})),T.a.createElement(I,{tab:"环境参数",key:"params"},T.a.createElement(A,{readOnly:!0,compareTo:i&&i.taskParams||" ",value:this.currentValue&&this.currentValue.taskParams||" ",tableRefresh:s}))))}}]),t}(T.a.Component),z=function(e){var t=e.offlineTask.workbench,r=t.currentTab,a=t.tabs,n=e.realtimeTask.currentPage;return{currentTabData:a.filter(function(e){return e.id===r})[0],currentRealTabData:n}},j=Object(P.b)(z)(W),U=j;"undefined"!=typeof __REACT_HOT_LOADER__&&(__REACT_HOT_LOADER__.register(I,"TabPane","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/diffParams.js"),__REACT_HOT_LOADER__.register(B,"TaskInfo","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/diffParams.js"),__REACT_HOT_LOADER__.register(W,"DiffParams","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/diffParams.js"),__REACT_HOT_LOADER__.register(z,"mapState","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/diffParams.js"),__REACT_HOT_LOADER__.register(j,"default","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/diffParams.js"));r.d(t,"a",function(){return J});var J=function(e){function t(e){h()(this,t);var r=_()(this,(t.__proto__||u()(t)).call(this,e));return r.state={showDiff:!1,campareTo:"",diffParams:{showDiffparams:!1,tableInfo:""}},r.diffCode=function(){return r.__diffCode__REACT_HOT_LOADER__.apply(r,arguments)},r.diffParams=function(){return r.__diffParams__REACT_HOT_LOADER__.apply(r,arguments)},r.close=function(){return r.__close__REACT_HOT_LOADER__.apply(r,arguments)},r.closeParamsModal=function(){return r.__closeParamsModal__REACT_HOT_LOADER__.apply(r,arguments)},r.codeChange=function(){return r.__codeChange__REACT_HOT_LOADER__.apply(r,arguments)},r.getFomatedJSON=function(){return r.__getFomatedJSON__REACT_HOT_LOADER__.apply(r,arguments)},r.taskTypeJudge=function(){return r.__taskTypeJudge__REACT_HOT_LOADER__.apply(r,arguments)},r.taskVersionCols=function(){return r.__taskVersionCols__REACT_HOT_LOADER__.apply(r,arguments)},r}return v()(t,e),g()(t,[{key:"__diffCode__REACT_HOT_LOADER__",value:function(e){this.setState({showDiff:!0,campareTo:e})}},{key:"__diffParams__REACT_HOT_LOADER__",value:function(e){var t=this.state.diffParams;t.showDiffparams=!0,t.tableInfo=e,this.setState({diffParams:t})}},{key:"__close__REACT_HOT_LOADER__",value:function(){this.setState({showDiff:!1,campareTo:""})}},{key:"__closeParamsModal__REACT_HOT_LOADER__",value:function(){var e=this.state.diffParams;e.showDiffparams=!1,e.tableInfo="",this.setState({diffParams:e})}},{key:"__codeChange__REACT_HOT_LOADER__",value:function(e,t){this.props.changeSql(t)}},{key:"__getFomatedJSON__REACT_HOT_LOADER__",value:function(e){if(!e)return"";var t=y.a.jsonFormat(e);return t||(l.a.error("您的数据同步JSON配置格式有误"),e)}},{key:"render",value:function(){var e=this.props,t=e.taskInfo,r=e.taskType,a=this.state,i=a.showDiff,s=a.campareTo,l=a.diffParams,c=t.readWriteLockVO&&!t.readWriteLockVO.getLock,u=t.sqlText,f=s.sqlText;return t.taskType===O.q.SYNC&&t.sqlText&&(u=this.getFomatedJSON(t.sqlText),f=this.getFomatedJSON(s.sqlText)),T.a.createElement("div",null,T.a.createElement(o.a,{className:"m-table",rowKey:"id",dataSource:t.taskVersions||[],columns:this.taskVersionCols(),pagination:!1}),T.a.createElement(n.a,{wrapClassName:"vertical-center-modal modal-body-nopadding",title:"代码对比",width:"900px",bodyStyle:{height:"500px"},visible:i,onCancel:this.close,cancelText:"关闭",footer:null},T.a.createElement(A,{readOnly:c,value:u,compareTo:f,onChange:this.codeChange})),T.a.createElement(n.a,{wrapClassName:"vertical-center-modal modal-body-nopadding",title:"参数对比",width:"900px",bodyStyle:{height:"500px"},visible:l.showDiffparams,onCancel:this.closeParamsModal,cancelText:"关闭",footer:null},T.a.createElement(U,{value:t,diffParams:l.tableInfo,taskType:r})))}},{key:"__taskTypeJudge__REACT_HOT_LOADER__",value:function(e,t){var r=this;return e.taskType===O.q.SQL||e.taskType===O.q.SYNC?T.a.createElement("div",null,T.a.createElement("a",{onClick:function(){return r.diffCode(t)}},"代码"),T.a.createElement("span",{className:"ant-divider"}),T.a.createElement("a",{onClick:function(){return r.diffParams(t)}},"参数")):"-"}},{key:"__taskVersionCols__REACT_HOT_LOADER__",value:function(){var e=this,t=this.props.taskInfo;return[{width:120,title:"发布时间",dataIndex:"gmtCreate",key:"gmtCreate",render:function(e){return y.a.formatDateTime(e)}},{title:"发布人",dataIndex:"userName",key:"userName"},{width:120,title:"描述",dataIndex:"publishDesc",key:"publishDesc"},{title:"操作",dataIndex:"operation",width:80,key:"operation",render:function(r,a){return e.taskTypeJudge(t,a)}}]}}]),t}(T.a.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(J,"TaskVersion","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/views/task/offline/taskVersion.js")},1451:function(e,t,r){"use strict";r.d(t,"a",function(){return m});r(84);var a=r(39),n=r.n(a),i=r(8),o=r.n(i),s=r(5),l=r.n(s),c=r(7),u=r.n(c),f=r(1),h=r.n(f),d=r(6),g=r.n(d),p=r(0),_=r.n(p),m=function(e){function t(e){return l()(this,t),h()(this,(t.__proto__||o()(t)).call(this,e))}return g()(t,e),u()(t,[{key:"render",value:function(){return this.props.notSynced?_.a.createElement(n.a,{title:"修改已保存至本地存储但尚未同步到服务器，你可以点击上面的保存按钮立即同步。"},_.a.createElement("span",{style:{display:"inline-block",marginRight:8,borderRadius:"50%",border:"4px solid ",borderColor:"#EF5350"}})):_.a.createElement("span",{style:{display:"inline-block",marginRight:8,borderRadius:"50%",border:"4px solid ",borderColor:"#00A755"}})}}]),t}(_.a.Component);"undefined"!=typeof __REACT_HOT_LOADER__&&__REACT_HOT_LOADER__.register(m,"SyncBadge","/Users/ziv/Documents/workspace/data-stack/src/webapps/rdos/components/sync-badge/index.js")},1461:function(e,t,r){var a=r(1460),n=(r(210),-1),i=1,o=0;!function(e){"use strict";var t=e.Pos,r="http://www.w3.org/2000/svg";function s(e,t){this.mv=e,this.type=t,this.classes="left"==t?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function l(t){t.diffOutOfDate&&(t.diff=S(t.orig.getValue(),t.edit.getValue(),t.mv.options.ignoreWhitespace),t.chunks=H(t.diff),t.diffOutOfDate=!1,e.signal(t.edit,"updateDiff",t.diff))}s.prototype={constructor:s,init:function(t,r,a){this.edit=this.mv.edit,(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this),this.orig=e(t,W({value:r,readOnly:!this.mv.options.allowEditingOriginals},W(a))),"align"==this.mv.options.connect&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new q(this.edit)),this.orig.state.trackAlignable=new q(this.orig)),this.orig.state.diffViews=[this];var n=a.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(n)&&(n=[n]),this.classes.classLocation=n,this.diff=S(w(r),w(a.value),this.mv.options.ignoreWhitespace),this.chunks=H(this.diff),this.diffOutOfDate=this.dealigned=!1,this.needsScrollSync=null,this.showDifferences=!1!==a.showDifferences},registerEvents:function(t){this.forceUpdate=function(t){var r,a={from:0,to:0,marked:[]},o={from:0,to:0,marked:[]},s=!1;function f(e){c=!0,s=!1,"full"==e&&(t.svg&&I(t.svg),t.copyButtons&&I(t.copyButtons),g(t.edit,a.marked,t.classes),g(t.orig,o.marked,t.classes),a.from=a.to=o.from=o.to=0),l(t),t.showDifferences&&(p(t.edit,t.diff,a,i,t.classes),p(t.orig,t.diff,o,n,t.classes)),"align"==t.mv.options.connect&&C(t),v(t),null!=t.needsScrollSync&&u(t,t.needsScrollSync),c=!1}function h(e){c||(t.dealigned=!0,d(e))}function d(e){c||s||(clearTimeout(r),!0===e&&(s=!0),r=setTimeout(f,!0===e?20:250))}function _(e,r){t.diffOutOfDate||(t.diffOutOfDate=!0,a.from=a.to=o.from=o.to=0),h(r.text.length-1!=r.to.line-r.from.line)}function m(){t.diffOutOfDate=!0,t.dealigned=!0,f("full")}return t.edit.on("change",_),t.orig.on("change",_),t.edit.on("swapDoc",m),t.orig.on("swapDoc",m),"align"==t.mv.options.connect&&(e.on(t.edit.state.trackAlignable,"realign",h),e.on(t.orig.state.trackAlignable,"realign",h)),t.edit.on("viewportChange",function(){d(!1)}),t.orig.on("viewportChange",function(){d(!1)}),f(),f}(this),h(this,!0,!1),function(e,t){e.edit.on("scroll",function(){u(e,!0)&&v(e)}),e.orig.on("scroll",function(){u(e,!1)&&v(e),t&&u(t,!0)&&v(t)})}(this,t)},setShowDifferences:function(e){(e=!1!==e)!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}};var c=!1;function u(e,t){if(e.diffOutOfDate)return e.lockScroll&&null==e.needsScrollSync&&(e.needsScrollSync=t),!1;if(e.needsScrollSync=null,!e.lockScroll)return!0;var r,a,n=+new Date;if(t?(r=e.edit,a=e.orig):(r=e.orig,a=e.edit),r.state.scrollSetBy==e&&(r.state.scrollSetAt||0)+250>n)return!1;var i=r.getScrollInfo();if("align"==e.mv.options.connect)_=i.top;else{var o,s,l=.5*i.clientHeight,c=i.top+l,u=r.lineAtHeight(c,"local"),h=function(e,t,r){for(var a,n,i,o,s=0;s<e.length;s++){var l=e[s],c=r?l.editFrom:l.origFrom,u=r?l.editTo:l.origTo;null==n&&(c>t?(n=l.editFrom,o=l.origFrom):u>t&&(n=l.editTo,o=l.origTo)),u<=t?(a=l.editTo,i=l.origTo):c<=t&&(a=l.editFrom,i=l.origFrom)}return{edit:{before:a,after:n},orig:{before:i,after:o}}}(e.chunks,u,t),d=f(r,t?h.edit:h.orig),g=f(a,t?h.orig:h.edit),p=(c-d.top)/(d.bot-d.top),_=g.top-l+p*(g.bot-g.top);if(_>i.top&&(s=i.top/l)<1)_=_*s+i.top*(1-s);else if((o=i.height-i.clientHeight-i.top)<l){var m=a.getScrollInfo(),v=m.height-m.clientHeight-_;v>o&&(s=o/l)<1&&(_=_*s+(m.height-m.clientHeight-o)*(1-s))}}return a.scrollTo(i.left,_),a.state.scrollSetAt=n,a.state.scrollSetBy=e,!0}function f(e,t){var r=t.after;return null==r&&(r=e.lastLine()+1),{top:e.heightAtLine(t.before||0,"local"),bot:e.heightAtLine(r,"local")}}function h(e,t,r){e.lockScroll=t,t&&0!=r&&u(e,i)&&v(e),e.lockButton.innerHTML=t?"⇛⇚":"⇛&nbsp;&nbsp;⇚"}function d(e,t,r){for(var a=r.classLocation,n=0;n<a.length;n++)e.removeLineClass(t,a[n],r.chunk),e.removeLineClass(t,a[n],r.start),e.removeLineClass(t,a[n],r.end)}function g(t,r,a){for(var n=0;n<r.length;++n){var i=r[n];i instanceof e.TextMarker?i.clear():i.parent&&d(t,i,a)}r.length=0}function p(e,t,r,a,n){var i=e.getViewport();e.operation(function(){r.from==r.to||i.from-r.to>20||r.from-i.to>20?(g(e,r.marked,n),m(e,t,a,r.marked,i.from,i.to,n),r.from=i.from,r.to=i.to):(i.from<r.from&&(m(e,t,a,r.marked,i.from,r.from,n),r.from=i.from),i.to>r.to&&(m(e,t,a,r.marked,r.to,i.to,n),r.to=i.to))})}function _(e,t,r,a,n,i){for(var o=r.classLocation,s=e.getLineHandle(t),l=0;l<o.length;l++)a&&e.addLineClass(s,o[l],r.chunk),n&&e.addLineClass(s,o[l],r.start),i&&e.addLineClass(s,o[l],r.end);return s}function m(e,r,a,i,s,l,c){var u=t(0,0),f=t(s,0),h=e.clipPos(t(l-1)),d=a==n?c.del:c.insert;function g(t,r){for(var a=Math.max(s,t),n=Math.min(l,r),o=a;o<n;++o)i.push(_(e,o,c,!0,o==t,o==r-1));t==r&&a==r&&n==r&&(a?i.push(_(e,a-1,c,!1,!1,!0)):i.push(_(e,a,c,!1,!0,!1)))}for(var p=0,m=!1,v=0;v<r.length;++v){var k=r[v],T=k[0],y=k[1];if(T==o){var C=u.line+(M(r,v)?0:1);z(u,y);var E=u.line+(x(r,v)?1:0);E>C&&(m&&(g(p,C),m=!1),p=E)}else if(m=!0,T==a){var O=z(u,y,!0),b=Y(f,u),R=K(h,O);G(b,R)||i.push(e.markText(b,R,{className:d})),u=O}}m&&g(p,u.line+1)}function v(e){if(e.showDifferences){if(e.svg){I(e.svg);var t=e.gap.offsetWidth;B(e.svg,"width",t,"height",e.gap.offsetHeight)}e.copyButtons&&I(e.copyButtons);for(var r=e.edit.getViewport(),a=e.orig.getViewport(),n=e.mv.wrap.getBoundingClientRect().top,i=n-e.edit.getScrollerElement().getBoundingClientRect().top+e.edit.getScrollInfo().top,o=n-e.orig.getScrollerElement().getBoundingClientRect().top+e.orig.getScrollInfo().top,s=0;s<e.chunks.length;s++){var l=e.chunks[s];l.editFrom<=r.to&&l.editTo>=r.from&&l.origFrom<=a.to&&l.origTo>=a.from&&b(e,l,o,i,t)}}}function k(e,t){for(var r=0,a=0,n=0;n<t.length;n++){var i=t[n];if(i.editTo>e&&i.editFrom<=e)return null;if(i.editFrom>e)break;r=i.editTo,a=i.origTo}return a+(e-r)}function T(e,t,r){for(var a=e.state.trackAlignable,n=e.firstLine(),i=0,o=[],s=0;;s++){for(var l=t[s],c=l?r?l.origFrom:l.editFrom:1e9;i<a.alignable.length;i+=2){var u=a.alignable[i]+1;if(!(u<=n)){if(!(u<=c))break;o.push(u)}}if(!l)break;o.push(n=r?l.origTo:l.editTo)}return o}function y(e,t,r,a){var n=0,i=0,o=0,s=0;e:for(;;n++){var l=e[n],c=t[i];if(!l&&null==c)break;for(var u=l?l[0]:1e9,f=null==c?1e9:c;o<r.length;){var h=r[o];if(h.origFrom<=f&&h.origTo>f){i++,n--;continue e}if(h.editTo>u){if(h.editFrom<=u)continue e;break}s+=h.origTo-h.origFrom-(h.editTo-h.editFrom),o++}if(u==f-s)l[a]=f,i++;else if(u<f-s)l[a]=u+s;else{var d=[f-s,null,null];d[a]=f,e.splice(n,0,d),i++}}}function C(e,t){if(e.dealigned||t){if(!e.orig.curOp)return e.orig.operation(function(){C(e,t)});e.dealigned=!1;var r=e.mv.left==e?e.mv.right:e.mv.left;r&&(l(r),r.dealigned=!1);for(var a=function(e,t){var r=T(e.edit,e.chunks,!1),a=[];if(t)for(var n=0,i=0;n<t.chunks.length;n++){for(var o=t.chunks[n].editTo;i<r.length&&r[i]<o;)i++;i!=r.length&&r[i]==o||r.splice(i++,0,o)}for(var n=0;n<r.length;n++)a.push([r[n],null,null]);return y(a,T(e.orig,e.chunks,!0),e.chunks,1),t&&y(a,T(t.orig,t.chunks,!0),t.chunks,2),a}(e,r),n=e.mv.aligners,i=0;i<n.length;i++)n[i].clear();n.length=0;var o=[e.edit,e.orig],s=[];r&&o.push(r.orig);for(var i=0;i<o.length;i++)s.push(o[i].getScrollInfo().top);for(var c=0;c<a.length;c++)E(o,a[c],n);for(var i=0;i<o.length;i++)o[i].scrollTo(null,s[i])}}function E(e,t,r){for(var a=0,n=[],i=0;i<e.length;i++)if(null!=t[i]){var o=e[i].heightAtLine(t[i],"local");n[i]=o,a=Math.max(a,o)}for(var i=0;i<e.length;i++)if(null!=t[i]){var s=a-n[i];s>1&&r.push(O(e[i],t[i],s))}}function O(e,t,r){var a=!0;t>e.lastLine()&&(t--,a=!1);var n=document.createElement("div");return n.className="CodeMirror-merge-spacer",n.style.height=r+"px",n.style.minWidth="1px",e.addLineWidget(t,n,{height:r,above:a,mergeSpacer:!0,handleMouseEvents:!0})}function b(e,t,a,n,i){var o="left"==e.type,s=e.orig.heightAtLine(t.origFrom,"local",!0)-a;if(e.svg){var l=s,c=e.edit.heightAtLine(t.editFrom,"local",!0)-n;if(o){var u=l;l=c,c=u}var f=e.orig.heightAtLine(t.origTo,"local",!0)-a,h=e.edit.heightAtLine(t.editTo,"local",!0)-n;if(o){var u=f;f=h,h=u}var d=" C "+i/2+" "+c+" "+i/2+" "+l+" "+(i+2)+" "+l,g=" C "+i/2+" "+f+" "+i/2+" "+h+" -1 "+h;B(e.svg.appendChild(document.createElementNS(r,"path")),"d","M -1 "+c+d+" L "+(i+2)+" "+f+g+" z","class",e.classes.connect)}if(e.copyButtons){var p=e.copyButtons.appendChild(F("div","left"==e.type?"⇝":"⇜","CodeMirror-merge-copy")),_=e.mv.options.allowEditingOriginals;if(p.title=_?"Push to left":"Revert chunk",p.chunk=t,p.style.top=(t.origTo>t.origFrom?s:e.edit.heightAtLine(t.editFrom,"local")-n)+"px",_){var m=e.edit.heightAtLine(t.editFrom,"local")-n,v=e.copyButtons.appendChild(F("div","right"==e.type?"⇝":"⇜","CodeMirror-merge-copy-reverse"));v.title="Push to right",v.chunk={editFrom:t.origFrom,editTo:t.origTo,origFrom:t.editFrom,origTo:t.editTo},v.style.top=m+"px","right"==e.type?v.style.left="2px":v.style.right="2px"}}}function R(e,r,a,n){if(!e.diffOutOfDate){var i=n.origTo>a.lastLine()?t(n.origFrom-1):t(n.origFrom,0),o=t(n.origTo,0),s=n.editTo>r.lastLine()?t(n.editFrom-1):t(n.editFrom,0),l=t(n.editTo,0),c=e.mv.options.revertChunk;c?c(e.mv,a,i,o,r,s,l):r.replaceRange(a.getRange(i,o),s,l)}}var D=e.MergeView=function(t,r){if(!(this instanceof D))return new D(t,r);this.options=r;var a=r.origLeft,n=null==r.origRight?r.orig:r.origRight,i=null!=a,o=null!=n,l=1+(i?1:0)+(o?1:0),c=[],u=this.left=null,f=this.right=null,h=this;if(i){u=this.left=new s(this,"left");var d=F("div",null,"CodeMirror-merge-pane CodeMirror-merge-left");c.push(d),c.push(A(u))}var g=F("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");if(c.push(g),o){f=this.right=new s(this,"right"),c.push(A(f));var p=F("div",null,"CodeMirror-merge-pane CodeMirror-merge-right");c.push(p)}(o?p:g).className+=" CodeMirror-merge-pane-rightmost",c.push(F("div",null,null,"height: 0; clear: both;"));var _=this.wrap=t.appendChild(F("div",c,"CodeMirror-merge CodeMirror-merge-"+l+"pane"));this.edit=e(g,W(r)),u&&u.init(d,a,r),f&&f.init(p,n,r),r.collapseIdentical&&this.editor().operation(function(){!function(e,t){"number"!=typeof t&&(t=2);for(var r=[],a=e.editor(),n=a.firstLine(),i=n,o=a.lastLine();i<=o;i++)r.push(!0);e.left&&P(e.left,t,n,r),e.right&&P(e.right,t,n,r);for(var s=0;s<r.length;s++)if(r[s]){for(var l=s+n,c=1;s<r.length-1&&r[s+1];s++,c++);if(c>t){var u=[{line:l,cm:a}];e.left&&u.push({line:k(l,e.left.chunks),cm:e.left.orig}),e.right&&u.push({line:k(l,e.right.chunks),cm:e.right.orig});var f=V(c,u);e.options.onCollapse&&e.options.onCollapse(e,l,c,f)}}}(h,r.collapseIdentical)}),"align"==r.connect&&(this.aligners=[],C(this.left||this.right,!0)),u&&u.registerEvents(f),f&&f.registerEvents(u);var m=function(){u&&v(u),f&&v(f)};e.on(window,"resize",m);var T=setInterval(function(){for(var t=_.parentNode;t&&t!=document.body;t=t.parentNode);t||(clearInterval(T),e.off(window,"resize",m))},5e3)};function A(t){var a=t.lockButton=F("div",null,"CodeMirror-merge-scrolllock");a.title="Toggle locked scrolling";var n=F("div",[a],"CodeMirror-merge-scrolllock-wrap");e.on(a,"click",function(){h(t,!t.lockScroll)});var i=[n];if(!1!==t.mv.options.revertButtons&&(t.copyButtons=F("div",null,"CodeMirror-merge-copybuttons-"+t.type),e.on(t.copyButtons,"click",function(e){var r=e.target||e.srcElement;r.chunk&&("CodeMirror-merge-copy-reverse"!=r.className?R(t,t.edit,t.orig,r.chunk):R(t,t.orig,t.edit,r.chunk))}),i.unshift(t.copyButtons)),"align"!=t.mv.options.connect){var o=document.createElementNS&&document.createElementNS(r,"svg");o&&!o.createSVGRect&&(o=null),t.svg=o,o&&i.push(o)}return t.gap=F("div",i,"CodeMirror-merge-gap")}function w(e){return"string"==typeof e?e:e.getValue()}D.prototype={constructor:D,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)},rightChunks:function(){if(this.right)return l(this.right),this.right.chunks},leftChunks:function(){if(this.left)return l(this.left),this.left.chunks}};var L=new a;function S(e,t,r){for(var a=L.diff_main(e,t),n=0;n<a.length;++n){var i=a[n];(r?/[^ \t]/.test(i[1]):i[1])?n&&a[n-1][0]==i[0]&&(a.splice(n--,1),a[n][1]+=i[1]):a.splice(n--,1)}return a}function H(e){for(var r=[],a=0,n=0,s=t(0,0),l=t(0,0),c=0;c<e.length;++c){var u=e[c],f=u[0];if(f==o){var h=!M(e,c)||s.line<a||l.line<n?1:0,d=s.line+h,g=l.line+h;z(s,u[1],null,l);var p=x(e,c)?1:0,_=s.line+p,m=l.line+p;_>d&&(c&&r.push({origFrom:n,origTo:g,editFrom:a,editTo:d}),a=_,n=m)}else z(f==i?s:l,u[1])}return(a<=s.line||n<=l.line)&&r.push({origFrom:n,origTo:l.line+1,editFrom:a,editTo:s.line+1}),r}function x(e,t){if(t==e.length-1)return!0;var r=e[t+1][1];return!(1==r.length&&t<e.length-2||10!=r.charCodeAt(0))&&(t==e.length-2||((r=e[t+2][1]).length>1||t==e.length-3)&&10==r.charCodeAt(0))}function M(e,t){if(0==t)return!0;var r=e[t-1][1];return 10==r.charCodeAt(r.length-1)&&(1==t||10==(r=e[t-2][1]).charCodeAt(r.length-1))}function N(r,a,n){r.addLineClass(a,"wrap","CodeMirror-merge-collapsed-line");var i=document.createElement("span");i.className="CodeMirror-merge-collapsed-widget",i.title="Identical text collapsed. Click to expand.";var o=r.markText(t(a,0),t(n-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:i,clearOnEnter:!0});function s(){o.clear(),r.removeLineClass(a,"wrap","CodeMirror-merge-collapsed-line")}return e.on(i,"click",s),{mark:o,clear:s}}function V(e,t){var r=[];function a(){for(var e=0;e<r.length;e++)r[e].clear()}for(var n=0;n<t.length;n++){var i=t[n],o=N(i.cm,i.line,i.line+e);r.push(o),o.mark.on("clear",a)}return r[0].mark}function P(e,t,r,a){for(var n=0;n<e.chunks.length;n++)for(var i=e.chunks[n],o=i.editFrom-t;o<i.editTo+t;o++){var s=o+r;s>=0&&s<a.length&&(a[s]=!1)}}function F(e,t,r,a){var n=document.createElement(e);if(r&&(n.className=r),a&&(n.style.cssText=a),"string"==typeof t)n.appendChild(document.createTextNode(t));else if(t)for(var i=0;i<t.length;++i)n.appendChild(t[i]);return n}function I(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild)}function B(e){for(var t=1;t<arguments.length;t+=2)e.setAttribute(arguments[t],arguments[t+1])}function W(e,t){for(var r in t||(t={}),e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function z(e,r,a,n){for(var i=a?t(e.line,e.ch):e,o=0;;){var s=r.indexOf("\n",o);if(-1==s)break;++i.line,n&&++n.line,o=s+1}return i.ch=(o?0:i.ch)+(r.length-o),n&&(n.ch=(o?0:n.ch)+(r.length-o)),i}var j=1,U=2,J=4;function q(e){this.cm=e,this.alignable=[],this.height=e.doc.height;var t=this;e.on("markerAdded",function(e,r){if(r.collapsed){var a=r.find(1);null!=a&&t.set(a.line,J)}}),e.on("markerCleared",function(e,r,a,n){null!=n&&r.collapsed&&t.check(n,J,t.hasMarker)}),e.on("markerChanged",this.signal.bind(this)),e.on("lineWidgetAdded",function(e,r,a){r.mergeSpacer||(r.above?t.set(a-1,U):t.set(a,j))}),e.on("lineWidgetCleared",function(e,r,a){r.mergeSpacer||(r.above?t.check(a-1,U,t.hasWidgetBelow):t.check(a,j,t.hasWidget))}),e.on("lineWidgetChanged",this.signal.bind(this)),e.on("change",function(e,r){var a=r.from.line,n=r.to.line-r.from.line,i=r.text.length-1,o=a+i;(n||i)&&t.map(a,n,i),t.check(o,J,t.hasMarker),(n||i)&&t.check(r.from.line,J,t.hasMarker)}),e.on("viewportChange",function(){t.cm.doc.height!=t.height&&t.signal()})}function K(e,t){return(e.line-t.line||e.ch-t.ch)<0?e:t}function Y(e,t){return(e.line-t.line||e.ch-t.ch)>0?e:t}function G(e,t){return e.line==t.line&&e.ch==t.ch}function Q(e,t,r){for(var a=e.length-1;a>=0;a--){var n=e[a],i=(r?n.origTo:n.editTo)-1;if(i<t)return i}}function X(e,t,r){for(var a=0;a<e.length;a++){var n=e[a],i=r?n.origFrom:n.editFrom;if(i>t)return i}}function Z(t,r){var a=null,n=t.state.diffViews,i=t.getCursor().line;if(n)for(var o=0;o<n.length;o++){var s=n[o],c=t==s.orig;l(s);var u=r<0?Q(s.chunks,i,c):X(s.chunks,i,c);null==u||null!=a&&!(r<0?u>a:u<a)||(a=u)}if(null==a)return e.Pass;t.setCursor(a,0)}q.prototype={signal:function(){e.signal(this,"realign"),this.height=this.cm.doc.height},set:function(e,t){for(var r=-1;r<this.alignable.length;r+=2){var a=this.alignable[r]-e;if(0==a){if((this.alignable[r+1]&t)==t)return;return this.alignable[r+1]|=t,void this.signal()}if(a>0)break}this.signal(),this.alignable.splice(r,0,e,t)},find:function(e){for(var t=0;t<this.alignable.length;t+=2)if(this.alignable[t]==e)return t;return-1},check:function(e,t,r){var a=this.find(e);if(-1!=a&&this.alignable[a+1]&t&&!r.call(this,e)){this.signal();var n=this.alignable[a+1]&~t;n?this.alignable[a+1]=n:this.alignable.splice(a,2)}},hasMarker:function(e){var t=this.cm.getLineHandle(e);if(t.markedSpans)for(var r=0;r<t.markedSpans.length;r++)if(t.markedSpans[r].mark.collapsed&&null!=t.markedSpans[r].to)return!0;return!1},hasWidget:function(e){var t=this.cm.getLineHandle(e);if(t.widgets)for(var r=0;r<t.widgets.length;r++)if(!t.widgets[r].above&&!t.widgets[r].mergeSpacer)return!0;return!1},hasWidgetBelow:function(e){if(e==this.cm.lastLine())return!1;var t=this.cm.getLineHandle(e+1);if(t.widgets)for(var r=0;r<t.widgets.length;r++)if(t.widgets[r].above&&!t.widgets[r].mergeSpacer)return!0;return!1},map:function(e,t,r){for(var a=r-t,n=e+t,i=-1,o=-1,s=0;s<this.alignable.length;s+=2){var l=this.alignable[s];l==e&&this.alignable[s+1]&U&&(i=s),l==n&&this.alignable[s+1]&U&&(o=s),l<=e||(l<n?this.alignable.splice(s--,2):this.alignable[s]+=a)}if(i>-1){var c=this.alignable[i+1];c==U?this.alignable.splice(i,2):this.alignable[i+1]=c&~U}o>-1&&r&&this.set(e+r,U)}},e.commands.goNextDiff=function(e){return Z(e,1)},e.commands.goPrevDiff=function(e){return Z(e,-1)}}(r(210))},1463:function(e,t,r){}}]);